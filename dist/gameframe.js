(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
/* global AFRAME, THREE */

let loading = false

AFRAME.registerComponent("include", {
  schema: { type: "string" },

  update: async function () {
    if (this.data && !loading) {
      loading = true
      console.log("Including", this.data)
      this.el.outerHTML = await (await fetch(this.data)).text()
      loading = false
      let next = this.el.sceneEl.querySelector("[include]")
      if (next)
        next.components.include.update()
    }
  }
})

},{}],2:[function(require,module,exports){
/* global AFRAME, THREE, OIMO */

let scripts = document.getElementsByTagName("script")
const workerUrl = scripts[scripts.length - 1].src

function stringify(val) {
  return JSON.stringify(val).replaceAll(" ", "\\u0020")
}

AFRAME.registerSystem("physics", {
  schema: {
    enabled: { type: "boolean", default: false },
    gravity: { type: "vec3", default: { x: 0, y: -9.8, z: 0 } },
    debug: { type: "boolean", default: false }
  },

  update: function () {
    if (this.data.enabled) {
      if (!this.worker) {
        this.worker = new Worker(workerUrl)
        this.worker.addEventListener("message", this.onMessage.bind(this))
      }
      this.bodies = this.bodies || []
      this.movingBodies = this.movingBodies || []
      this.buffers = [new Float64Array(8), new Float64Array(8)]
      this.worker.postMessage("world gravity = " + stringify(this.data.gravity))
      this._debug = this.data.debug
    } else {
      this.remove()
    }
  },

  remove: function () {
    this.worker && this.worker.terminate()
    this.worker = null
    this.bodies = []
    this.movingBodies = []
  },

  tick: function (time, timeDelta) {
    if (!this.worker) return
    if (this.buffers.length < 2) return
    let buffer = this.buffers.shift()
    if (buffer.length < 8 * this.movingBodies.length) {
      let len = buffer.length
      while (len < 8 * this.movingBodies.length) {
        len *= 2
      }
      let bods = this.movingBodies
      let b = new Float64Array(len)
      let vec = THREE.Vector3.temp()
      let quat = THREE.Quaternion.temp()
      b.set(buffer)
      for (let i = buffer.length / 8; i < bods.length; i++) {
        if (bods[i]) {
          bods[i].object3D.getWorldPosition(vec)
          b[i * 8 + 0] = vec.x
          b[i * 8 + 1] = vec.y
          b[i * 8 + 2] = vec.z
          bods[i].object3D.getWorldQuaternion(quat)
          b[i * 8 + 4] = quat.x
          b[i * 8 + 5] = quat.y
          b[i * 8 + 6] = quat.z
          b[i * 8 + 7] = quat.w
        }
      }
      buffer = b
    }
    this.worker.postMessage(buffer, [buffer.buffer])
  },

  onMessage: function (e) {
    if (e.data instanceof Float64Array) {
      this.buffers.push(e.data)
      while (this.buffers.length > 2)
        this.buffers.shift()
    }
  }
})

AFRAME.registerComponent("body", {
  dependencies: ["position", "rotation", "scale"],

  schema: {
    type: { type: "string", default: "static" }
  },

  init: function () {
    let worker = this.el.sceneEl.systems.physics.worker
    let bodies = this.el.sceneEl.systems.physics.bodies
    let movingBodies = this.el.sceneEl.systems.physics.movingBodies
    let buffer = this.el.sceneEl.systems.physics.buffers[0]
    if (!worker) return
    this.id = bodies.indexOf(null)
    if (this.id < 0) this.id = bodies.length
    bodies[this.id] = this.el
    if (this.data.type !== "static") {
      this.mid = movingBodies.indexOf(null)
      if (this.mid < 0) this.mid = movingBodies.length
      movingBodies[this.mid] = this.el

    } else {
      this.mid = null
    }
    let body = { mid: this.mid }
    body.type = this.data.type
    body.position = this.el.object3D.getWorldPosition(THREE.Vector3.temp())
    body.quaternion = this.el.object3D.getWorldQuaternion(THREE.Quaternion.temp())
    if (this.mid !== null) {
      buffer[this.mid * 8 + 0] = body.position.x
      buffer[this.mid * 8 + 1] = body.position.y
      buffer[this.mid * 8 + 2] = body.position.z
      buffer[this.mid * 8 + 4] = body.quaternion.x
      buffer[this.mid * 8 + 5] = body.quaternion.y
      buffer[this.mid * 8 + 6] = body.quaternion.z
      buffer[this.mid * 8 + 7] = body.quaternion.w
    }
    worker.postMessage("world body " + this.id + " create " + stringify(body))
  },

  update: function () {
    let worker = this.el.sceneEl.systems.physics.worker
    if (!worker) return
    worker.postMessage("world body " + this.id + " type = " + stringify(this.data.type))
  },

  play: function () {
    let worker = this.el.sceneEl.systems.physics.worker
    if (!worker) return
    worker.postMessage("world body " + this.id + " sleeping = false")
  },
  pause: function () {
    let worker = this.el.sceneEl.systems.physics.worker
    if (!worker) return
    worker.postMessage("world body " + this.id + " sleeping = true")
  },

  remove: function () {
    let worker = this.el.sceneEl.systems.physics.worker
    let bodies = this.el.sceneEl.systems.physics.bodies
    let movingBodies = this.el.sceneEl.systems.physics.movingBodies
    if (!worker) return
    bodies[this.id] = null
    if (this.mid !== null)
      movingBodies[this.mid] = null
    worker.postMessage("world body " + this.id + " remove")
  },

  tick: function () {
    let worker = this.el.sceneEl.systems.physics.worker
    let buffer = this.el.sceneEl.systems.physics.buffers[0]
    if (!worker) return
    if (this.mid !== null) {
      if (this.data.type === "kinematic") {
        let vec = this.el.object3D.getWorldPosition(THREE.Vector3.temp())
        buffer[this.mid * 8 + 0] = vec.x
        buffer[this.mid * 8 + 1] = vec.y
        buffer[this.mid * 8 + 2] = vec.z
        let quat = this.el.object3D.getWorldQuaternion(THREE.Quaternion.temp())
        buffer[this.mid * 8 + 4] = quat.x
        buffer[this.mid * 8 + 5] = quat.y
        buffer[this.mid * 8 + 6] = quat.z
        buffer[this.mid * 8 + 7] = quat.w
      } else {
        let quat = THREE.Quaternion.temp()

        this.el.object3D.position.x = buffer[this.mid * 8 + 0]
        this.el.object3D.position.y = buffer[this.mid * 8 + 1]
        this.el.object3D.position.z = buffer[this.mid * 8 + 2]
        this.el.object3D.parent.worldToLocal(this.el.object3D.position)

        this.el.object3D.getWorldQuaternion(quat)
        this.el.object3D.quaternion.multiply(quat.conjugate().normalize())
        quat.x = buffer[this.mid * 8 + 4]
        quat.y = buffer[this.mid * 8 + 5]
        quat.z = buffer[this.mid * 8 + 6]
        quat.w = buffer[this.mid * 8 + 7]
        this.el.object3D.quaternion.multiply(quat.normalize())
      }
    }
  }
})

AFRAME.registerComponent("shape", {
  dependencies: ["body"],
  multiple: true,
  schema: {
    type: { type: "string", default: "box" },
    size: { type: "vec3", default: { x: -1, y: -1, z: -1 } },
    posOffset: { type: "vec3", default: { x: 0, y: 0, z: 0 } },
    rotOffset: { type: "vec3", default: { x: 0, y: 0, z: 0 } },
    density: { type: "number", default: 1 },
    friction: { type: "number", default: 0.2 },
    restitution: { type: "number", default: 0.2 },
    belongsTo: { type: "int", default: 1 },
    collidesWith: { type: "int", default: 0xffffffff },
  },

  update: function () {
    if (!this.el.body) return setTimeout(() => this.update(), 256)
    if (!this.shape) {
      let sc = new OIMO.ShapeConfig()
      switch (this.data.type) {
        case "box":
          this.shape = new OIMO.Box(sc, 1, 1, 1)
          break
        case "cylinder":
          this.shape = new OIMO.Cylinder(sc, 1, 1)
          break
        case "sphere":
          this.shape = new OIMO.Sphere(sc, 1)
          break
        case "plane":
          this.shape = new OIMO.Plane(sc)
          break
      }
      this.el.body.addShape(this.shape)
    }
    this.shape.density = this.data.density
    this.shape.friction = this.data.friction
    this.shape.restitution = this.data.restitution
    this.shape.belongsTo = this.data.belongsTo
    this.shape.collidesWith = this.data.collidesWith
    this.shape.relativePosition.copy(this.data.posOffset)
    if (this.data.rotOffset.x || this.data.rotOffset.y || this.data.rotOffset.z) console.warn("rotOffset property not yet impemented!")
    // this.shape.relativeRotation.copy(this.data.rotOffset)

    let scale = THREE.Vector3.reuse()
    let size = THREE.Vector3.reuse().copy(this.data.size)
    if (size.x < 0) {
      size.set(1, 1, 1)
      let mesh = this.el.getObject3D("mesh")
      if (mesh && mesh.geometry) {
        mesh.geometry.computeBoundingBox()
        let box = mesh.geometry.boundingBox
        size.copy(box.max).sub(box.min)
      } else {
        this.el.addEventListener("model-loaded", this.update.bind(this))
      }
    }
    size.multiply(this.el.object3D.getWorldScale(scale))
    switch (this.data.type) {
      case "box":
        this.shape.width = size.x
        this.shape.height = size.y
        this.shape.depth = size.z
        this.shape.halfWidth = size.x / 2
        this.shape.halfHeight = size.y / 2
        this.shape.halfDepth = size.z / 2
        break
      case "cylinder":
        size.x = (size.x + size.z) / 4
        this.shape.radius = size.x
        this.shape.height = size.y
        this.shape.halfHeight = size.y / 2
        break
      case "sphere":
        size.x = (size.x + size.y + size.z) / 6
        this.shape.radius = size.x
        break
    }
    this.el.body.setupMass(this.el.body.type)

    size.recycle()
    scale.recycle()
  },

  remove: function () {
    if (this.shape) this.el.body.removeShape(this.shape)
    this.shape = null
  }
})

AFRAME.registerComponent("joint", {
  dependencies: ["body", "shape"],

  schema: {
    type: { type: "string", default: "prisme" },
    with: { type: "selector", default: "[body]" },
    min: { type: "number", default: 0 },
    max: { type: "number", default: 0 },
    pos1: { type: "vec3", default: { x: 0, y: 0, z: 0 } },
    pos2: { type: "vec3", default: { x: 0, y: 0, z: 0 } },
    axe1: { type: "vec3", default: { x: 1, y: 0, z: 0 } },
    axe2: { type: "vec3", default: { x: 1, y: 0, z: 0 } },
    collision: { type: "boolean", default: false },
    limit: { type: "array" },
    motor: { type: "array" },
    spring: { type: "array" },
  },

  update: function () {
    if (!this.el.body) return setTimeout(() => this.update(), 256)
    if (!this.data.with.body) return setTimeout(() => this.update(), 256)
    if (!this.joint) {
      let jc = new OIMO.JointConfig()
      jc.body1 = this.el.body
      jc.body2 = this.data.with.body
      let deg2rad = Math.PI / 180
      switch (this.data.type) {
        case "distance":
          this.joint = new OIMO.DistanceJoint(jc, this.data.min, this.data.max)
          break
        case "hinge":
          this.joint = new OIMO.HingeJoint(jc, this.data.min * deg2rad, this.data.max * deg2rad)
          break
        case "prisme":
          this.joint = new OIMO.PrismaticJoint(jc, this.data.min * deg2rad, this.data.max * deg2rad)
          break
        case "slide":
          this.joint = new OIMO.SliderJoint(jc, this.data.min, this.data.max)
          break
        case "ball":
          this.joint = new OIMO.BallAndSocketJoint(jc)
          break
        case "wheel":
          this.joint = new OIMO.WheelJoint(jc)
          break
      }
      this.el.sceneEl.physicsWorld.addJoint(this.joint)
    }
    this.joint.localAnchorPoint1.copy(this.data.pos1)
    this.joint.localAnchorPoint2.copy(this.data.pos2)
    if (this.joint.localAxis1) {
      this.joint.localAxis1.copy(this.data.axe1)
      this.joint.localAxis2.copy(this.data.axe2)
    }
    this.joint.allowCollision = this.data.collision

    let lm = this.joint.rotationalLimitMotor1 || this.joint.limitMotor
    // if (this.data.limit.length == 2)
    lm.setLimit(parseFloat(this.data.limit[0]) || 0, parseFloat(this.data.limit[1]) || 0)
    // if (this.data.motor.length == 2)
    lm.setMotor(parseFloat(this.data.motor[0]) || 0, parseFloat(this.data.motor[1]) || 0)
    // if (this.data.spring.length == 2)
    lm.setSpring(parseFloat(this.data.spring[0]) || 0, parseFloat(this.data.spring[1]) || 0)
  },

  remove: function () {
    if (this.joint) {
      this.joint.body1.awake()
      this.joint.body2.awake()
      this.joint.remove()
    }
    this.joint = null
  },

})


},{}],3:[function(require,module,exports){
if (typeof window == "undefined") {
  require("./oimoWorker")
} else {
  require("./libs/pools")
  require("./libs/copyWorldPosRot")

  require("./components/include")
  require("./components/physics")
}
},{"./components/include":1,"./components/physics":2,"./libs/copyWorldPosRot":4,"./libs/pools":6,"./oimoWorker":7}],4:[function(require,module,exports){
/* global AFRAME, THREE */

AFRAME.AEntity.prototype.copyWorldPosRot = function (srcEl) {
  let quat = THREE.Quaternion.temp()
  let src = srcEl.object3D
  let dest = this.object3D
  if (!src) return
  if (!dest) return
  if (!dest.parent) return
  src.getWorldPosition(dest.position)
  dest.parent.worldToLocal(dest.position)

  dest.getWorldQuaternion(quat)
  dest.quaternion.multiply(quat.conjugate().normalize())
  src.getWorldQuaternion(quat)
  dest.quaternion.multiply(quat.normalize())
}
},{}],5:[function(require,module,exports){
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
    typeof define === 'function' && define.amd ? define(['exports'], factory) :
      (global = global || self, factory(global.OIMO = {}));
}(this, function (exports) {
  'use strict';

  // Polyfills

  if (Number.EPSILON === undefined) {

    Number.EPSILON = Math.pow(2, - 52);

  }

  //

  if (Math.sign === undefined) {

    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Math/sign

    Math.sign = function (x) {

      return (x < 0) ? - 1 : (x > 0) ? 1 : + x;

    };

  }

  if (Function.prototype.name === undefined) {

    // Missing in IE9-11.
    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/name

    Object.defineProperty(Function.prototype, 'name', {

      get: function () {

        return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1];

      }

    });

  }

  if (Object.assign === undefined) {

    // Missing in IE.
    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign

    (function () {

      Object.assign = function (target) {

        if (target === undefined || target === null) {

          throw new TypeError('Cannot convert undefined or null to object');

        }

        var output = Object(target);

        for (var index = 1; index < arguments.length; index++) {

          var source = arguments[index];

          if (source !== undefined && source !== null) {

            for (var nextKey in source) {

              if (Object.prototype.hasOwnProperty.call(source, nextKey)) {

                output[nextKey] = source[nextKey];

              }

            }

          }

        }

        return output;

      };

    })();

  }

  /*
   * A list of constants built-in for
   * the physics engine.
   */

  var REVISION = '1.0.9';

  // BroadPhase
  var BR_NULL = 0;
  var BR_BRUTE_FORCE = 1;
  var BR_SWEEP_AND_PRUNE = 2;
  var BR_BOUNDING_VOLUME_TREE = 3;

  // Body type
  var BODY_NULL = 0;
  var BODY_DYNAMIC = 1;
  var BODY_STATIC = 2;
  var BODY_KINEMATIC = 3;
  var BODY_GHOST = 4;

  // Shape type
  var SHAPE_NULL = 0;
  var SHAPE_SPHERE = 1;
  var SHAPE_BOX = 2;
  var SHAPE_CYLINDER = 3;
  var SHAPE_PLANE = 4;
  var SHAPE_PARTICLE = 5;
  var SHAPE_TETRA = 6;

  // Joint type
  var JOINT_NULL = 0;
  var JOINT_DISTANCE = 1;
  var JOINT_BALL_AND_SOCKET = 2;
  var JOINT_HINGE = 3;
  var JOINT_WHEEL = 4;
  var JOINT_SLIDER = 5;
  var JOINT_PRISMATIC = 6;

  // AABB aproximation
  var AABB_PROX = 0.005;

  var _Math = {

    sqrt: Math.sqrt,
    abs: Math.abs,
    floor: Math.floor,
    cos: Math.cos,
    sin: Math.sin,
    acos: Math.acos,
    asin: Math.asin,
    atan2: Math.atan2,
    round: Math.round,
    pow: Math.pow,
    max: Math.max,
    min: Math.min,
    random: Math.random,

    degtorad: 0.0174532925199432957,
    radtodeg: 57.295779513082320876,
    PI: 3.141592653589793,
    TwoPI: 6.283185307179586,
    PI90: 1.570796326794896,
    PI270: 4.712388980384689,

    INF: Infinity,
    EPZ: 0.00001,
    EPZ2: 0.000001,

    lerp: function (x, y, t) {

      return (1 - t) * x + t * y;

    },

    randInt: function (low, high) {

      return low + _Math.floor(_Math.random() * (high - low + 1));

    },

    rand: function (low, high) {

      return low + _Math.random() * (high - low);

    },

    generateUUID: function () {

      // http://www.broofa.com/Tools/Math.uuid.htm

      var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');
      var uuid = new Array(36);
      var rnd = 0, r;

      return function generateUUID() {

        for (var i = 0; i < 36; i++) {

          if (i === 8 || i === 13 || i === 18 || i === 23) {

            uuid[i] = '-';

          } else if (i === 14) {

            uuid[i] = '4';

          } else {

            if (rnd <= 0x02) rnd = 0x2000000 + (Math.random() * 0x1000000) | 0;
            r = rnd & 0xf;
            rnd = rnd >> 4;
            uuid[i] = chars[(i === 19) ? (r & 0x3) | 0x8 : r];

          }

        }

        return uuid.join('');

      };

    }(),

    int: function (x) {

      return _Math.floor(x);

    },

    fix: function (x, n) {

      return x.toFixed(n || 3, 10);

    },

    clamp: function (value, min, max) {

      return _Math.max(min, _Math.min(max, value));

    },

    //clamp: function ( x, a, b ) { return ( x < a ) ? a : ( ( x > b ) ? b : x ); },



    distance: function (p1, p2) {

      var xd = p2[0] - p1[0];
      var yd = p2[1] - p1[1];
      var zd = p2[2] - p1[2];
      return _Math.sqrt(xd * xd + yd * yd + zd * zd);

    },

    /*unwrapDegrees: function ( r ) {

        r = r % 360;
        if (r > 180) r -= 360;
        if (r < -180) r += 360;
        return r;

    },

    unwrapRadian: function( r ){

        r = r % _Math.TwoPI;
        if (r > _Math.PI) r -= _Math.TwoPI;
        if (r < -_Math.PI) r += _Math.TwoPI;
        return r;

    },*/

    acosClamp: function (cos) {

      if (cos > 1) return 0;
      else if (cos < -1) return _Math.PI;
      else return _Math.acos(cos);

    },

    distanceVector: function (v1, v2) {

      var xd = v1.x - v2.x;
      var yd = v1.y - v2.y;
      var zd = v1.z - v2.z;
      return xd * xd + yd * yd + zd * zd;

    },

    dotVectors: function (a, b) {

      return a.x * b.x + a.y * b.y + a.z * b.z;

    },

  };

  function printError(clazz, msg) {
    console.error("[OIMO] " + clazz + ": " + msg);
  }

  // A performance evaluator

  function InfoDisplay(world) {

    this.parent = world;

    this.infos = new Float32Array(13);
    this.f = [0, 0, 0];

    this.times = [0, 0, 0, 0];

    this.broadPhase = this.parent.broadPhaseType;

    this.version = REVISION;

    this.fps = 0;

    this.tt = 0;

    this.broadPhaseTime = 0;
    this.narrowPhaseTime = 0;
    this.solvingTime = 0;
    this.totalTime = 0;
    this.updateTime = 0;

    this.MaxBroadPhaseTime = 0;
    this.MaxNarrowPhaseTime = 0;
    this.MaxSolvingTime = 0;
    this.MaxTotalTime = 0;
    this.MaxUpdateTime = 0;
  }
  Object.assign(InfoDisplay.prototype, {

    setTime: function (n) {
      this.times[n || 0] = performance.now();
    },

    resetMax: function () {

      this.MaxBroadPhaseTime = 0;
      this.MaxNarrowPhaseTime = 0;
      this.MaxSolvingTime = 0;
      this.MaxTotalTime = 0;
      this.MaxUpdateTime = 0;

    },

    calcBroadPhase: function () {

      this.setTime(2);
      this.broadPhaseTime = this.times[2] - this.times[1];

    },

    calcNarrowPhase: function () {

      this.setTime(3);
      this.narrowPhaseTime = this.times[3] - this.times[2];

    },

    calcEnd: function () {

      this.setTime(2);
      this.solvingTime = this.times[2] - this.times[1];
      this.totalTime = this.times[2] - this.times[0];
      this.updateTime = this.totalTime - (this.broadPhaseTime + this.narrowPhaseTime + this.solvingTime);

      if (this.tt === 100) this.resetMax();

      if (this.tt > 100) {
        if (this.broadPhaseTime > this.MaxBroadPhaseTime) this.MaxBroadPhaseTime = this.broadPhaseTime;
        if (this.narrowPhaseTime > this.MaxNarrowPhaseTime) this.MaxNarrowPhaseTime = this.narrowPhaseTime;
        if (this.solvingTime > this.MaxSolvingTime) this.MaxSolvingTime = this.solvingTime;
        if (this.totalTime > this.MaxTotalTime) this.MaxTotalTime = this.totalTime;
        if (this.updateTime > this.MaxUpdateTime) this.MaxUpdateTime = this.updateTime;
      }


      this.upfps();

      this.tt++;
      if (this.tt > 500) this.tt = 0;

    },


    upfps: function () {
      this.f[1] = Date.now();
      if (this.f[1] - 1000 > this.f[0]) { this.f[0] = this.f[1]; this.fps = this.f[2]; this.f[2] = 0; } this.f[2]++;
    },

    show: function () {
      var info = [
        "Oimo.js " + this.version + "<br>",
        this.broadPhase + "<br><br>",
        "FPS: " + this.fps + " fps<br><br>",
        "rigidbody " + this.parent.numRigidBodies + "<br>",
        "contact &nbsp;&nbsp;" + this.parent.numContacts + "<br>",
        "ct-point &nbsp;" + this.parent.numContactPoints + "<br>",
        "paircheck " + this.parent.broadPhase.numPairChecks + "<br>",
        "island &nbsp;&nbsp;&nbsp;" + this.parent.numIslands + "<br><br>",
        "Time in milliseconds<br><br>",
        "broadphase &nbsp;" + _Math.fix(this.broadPhaseTime) + " | " + _Math.fix(this.MaxBroadPhaseTime) + "<br>",
        "narrowphase " + _Math.fix(this.narrowPhaseTime) + " | " + _Math.fix(this.MaxNarrowPhaseTime) + "<br>",
        "solving &nbsp;&nbsp;&nbsp;&nbsp;" + _Math.fix(this.solvingTime) + " | " + _Math.fix(this.MaxSolvingTime) + "<br>",
        "total &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" + _Math.fix(this.totalTime) + " | " + _Math.fix(this.MaxTotalTime) + "<br>",
        "updating &nbsp;&nbsp;&nbsp;" + _Math.fix(this.updateTime) + " | " + _Math.fix(this.MaxUpdateTime) + "<br>"
      ].join("\n");
      return info;
    },

    toArray: function () {
      this.infos[0] = this.parent.broadPhase.types;
      this.infos[1] = this.parent.numRigidBodies;
      this.infos[2] = this.parent.numContacts;
      this.infos[3] = this.parent.broadPhase.numPairChecks;
      this.infos[4] = this.parent.numContactPoints;
      this.infos[5] = this.parent.numIslands;
      this.infos[6] = this.broadPhaseTime;
      this.infos[7] = this.narrowPhaseTime;
      this.infos[8] = this.solvingTime;
      this.infos[9] = this.updateTime;
      this.infos[10] = this.totalTime;
      this.infos[11] = this.fps;
      return this.infos;
    }

  });

  function Vec3(x, y, z) {

    this.x = x || 0;
    this.y = y || 0;
    this.z = z || 0;

  }

  Object.assign(Vec3.prototype, {

    Vec3: true,

    set: function (x, y, z) {

      this.x = x;
      this.y = y;
      this.z = z;
      return this;

    },

    add: function (a, b) {

      if (b !== undefined) return this.addVectors(a, b);

      this.x += a.x;
      this.y += a.y;
      this.z += a.z;
      return this;

    },

    addVectors: function (a, b) {

      this.x = a.x + b.x;
      this.y = a.y + b.y;
      this.z = a.z + b.z;
      return this;

    },

    addEqual: function (v) {

      this.x += v.x;
      this.y += v.y;
      this.z += v.z;
      return this;

    },

    sub: function (a, b) {

      if (b !== undefined) return this.subVectors(a, b);

      this.x -= a.x;
      this.y -= a.y;
      this.z -= a.z;
      return this;

    },

    subVectors: function (a, b) {

      this.x = a.x - b.x;
      this.y = a.y - b.y;
      this.z = a.z - b.z;
      return this;

    },

    subEqual: function (v) {

      this.x -= v.x;
      this.y -= v.y;
      this.z -= v.z;
      return this;

    },

    scale: function (v, s) {

      this.x = v.x * s;
      this.y = v.y * s;
      this.z = v.z * s;
      return this;

    },

    scaleEqual: function (s) {

      this.x *= s;
      this.y *= s;
      this.z *= s;
      return this;

    },

    multiply: function (v) {

      this.x *= v.x;
      this.y *= v.y;
      this.z *= v.z;
      return this;

    },

    /*scaleV: function( v ){

        this.x *= v.x;
        this.y *= v.y;
        this.z *= v.z;
        return this;

    },

    scaleVectorEqual: function( v ){

        this.x *= v.x;
        this.y *= v.y;
        this.z *= v.z;
        return this;

    },*/

    addScaledVector: function (v, s) {

      this.x += v.x * s;
      this.y += v.y * s;
      this.z += v.z * s;

      return this;

    },

    subScaledVector: function (v, s) {

      this.x -= v.x * s;
      this.y -= v.y * s;
      this.z -= v.z * s;

      return this;

    },

    /*addTime: function ( v, t ) {

        this.x += v.x * t;
        this.y += v.y * t;
        this.z += v.z * t;
        return this;

    },
    
    addScale: function ( v, s ) {

        this.x += v.x * s;
        this.y += v.y * s;
        this.z += v.z * s;
        return this;

    },

    subScale: function ( v, s ) {

        this.x -= v.x * s;
        this.y -= v.y * s;
        this.z -= v.z * s;
        return this;

    },*/

    cross: function (a, b) {

      if (b !== undefined) return this.crossVectors(a, b);

      var x = this.x, y = this.y, z = this.z;

      this.x = y * a.z - z * a.y;
      this.y = z * a.x - x * a.z;
      this.z = x * a.y - y * a.x;

      return this;

    },

    crossVectors: function (a, b) {

      var ax = a.x, ay = a.y, az = a.z;
      var bx = b.x, by = b.y, bz = b.z;

      this.x = ay * bz - az * by;
      this.y = az * bx - ax * bz;
      this.z = ax * by - ay * bx;

      return this;

    },

    tangent: function (a) {

      var ax = a.x, ay = a.y, az = a.z;

      this.x = ay * ax - az * az;
      this.y = - az * ay - ax * ax;
      this.z = ax * az + ay * ay;

      return this;

    },





    invert: function (v) {

      this.x = -v.x;
      this.y = -v.y;
      this.z = -v.z;
      return this;

    },

    negate: function () {

      this.x = - this.x;
      this.y = - this.y;
      this.z = - this.z;

      return this;

    },

    dot: function (v) {

      return this.x * v.x + this.y * v.y + this.z * v.z;

    },

    addition: function () {

      return this.x + this.y + this.z;

    },

    lengthSq: function () {

      return this.x * this.x + this.y * this.y + this.z * this.z;

    },

    length: function () {

      return _Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);

    },

    copy: function (v) {

      this.x = v.x;
      this.y = v.y;
      this.z = v.z;
      return this;

    },

    /*mul: function( b, a, m ){

        return this.mulMat( m, a ).add( b );

    },

    mulMat: function( m, a ){

        var e = m.elements;
        var x = a.x, y = a.y, z = a.z;

        this.x = e[ 0 ] * x + e[ 1 ] * y + e[ 2 ] * z;
        this.y = e[ 3 ] * x + e[ 4 ] * y + e[ 5 ] * z;
        this.z = e[ 6 ] * x + e[ 7 ] * y + e[ 8 ] * z;
        return this;

    },*/

    applyMatrix3: function (m, transpose) {

      //if( transpose ) m = m.clone().transpose();
      var x = this.x, y = this.y, z = this.z;
      var e = m.elements;

      if (transpose) {

        this.x = e[0] * x + e[1] * y + e[2] * z;
        this.y = e[3] * x + e[4] * y + e[5] * z;
        this.z = e[6] * x + e[7] * y + e[8] * z;

      } else {

        this.x = e[0] * x + e[3] * y + e[6] * z;
        this.y = e[1] * x + e[4] * y + e[7] * z;
        this.z = e[2] * x + e[5] * y + e[8] * z;
      }

      return this;

    },

    applyQuaternion: function (q) {

      var x = this.x;
      var y = this.y;
      var z = this.z;

      var qx = q.x;
      var qy = q.y;
      var qz = q.z;
      var qw = q.w;

      // calculate quat * vector

      var ix = qw * x + qy * z - qz * y;
      var iy = qw * y + qz * x - qx * z;
      var iz = qw * z + qx * y - qy * x;
      var iw = - qx * x - qy * y - qz * z;

      // calculate result * inverse quat

      this.x = ix * qw + iw * - qx + iy * - qz - iz * - qy;
      this.y = iy * qw + iw * - qy + iz * - qx - ix * - qz;
      this.z = iz * qw + iw * - qz + ix * - qy - iy * - qx;

      return this;

    },

    testZero: function () {

      if (this.x !== 0 || this.y !== 0 || this.z !== 0) return true;
      else return false;

    },

    testDiff: function (v) {

      return this.equals(v) ? false : true;

    },

    equals: function (v) {

      return v.x === this.x && v.y === this.y && v.z === this.z;

    },

    clone: function () {

      return new this.constructor(this.x, this.y, this.z);

    },

    toString: function () {

      return "Vec3[" + this.x.toFixed(4) + ", " + this.y.toFixed(4) + ", " + this.z.toFixed(4) + "]";

    },

    multiplyScalar: function (scalar) {

      if (isFinite(scalar)) {
        this.x *= scalar;
        this.y *= scalar;
        this.z *= scalar;
      } else {
        this.x = 0;
        this.y = 0;
        this.z = 0;
      }

      return this;

    },

    divideScalar: function (scalar) {

      return this.multiplyScalar(1 / scalar);

    },

    normalize: function () {

      return this.divideScalar(this.length());

    },

    toArray: function (array, offset) {

      if (offset === undefined) offset = 0;

      array[offset] = this.x;
      array[offset + 1] = this.y;
      array[offset + 2] = this.z;

    },

    fromArray: function (array, offset) {

      if (offset === undefined) offset = 0;

      this.x = array[offset];
      this.y = array[offset + 1];
      this.z = array[offset + 2];
      return this;

    },


  });

  function Quat(x, y, z, w) {

    this.x = x || 0;
    this.y = y || 0;
    this.z = z || 0;
    this.w = (w !== undefined) ? w : 1;

  }

  Object.assign(Quat.prototype, {

    Quat: true,

    set: function (x, y, z, w) {


      this.x = x;
      this.y = y;
      this.z = z;
      this.w = w;

      return this;

    },

    addTime: function (v, t) {

      var ax = v.x, ay = v.y, az = v.z;
      var qw = this.w, qx = this.x, qy = this.y, qz = this.z;
      t *= 0.5;
      this.x += t * (ax * qw + ay * qz - az * qy);
      this.y += t * (ay * qw + az * qx - ax * qz);
      this.z += t * (az * qw + ax * qy - ay * qx);
      this.w += t * (-ax * qx - ay * qy - az * qz);
      this.normalize();
      return this;

    },

    /*mul: function( q1, q2 ){

        var ax = q1.x, ay = q1.y, az = q1.z, as = q1.w,
        bx = q2.x, by = q2.y, bz = q2.z, bs = q2.w;
        this.x = ax * bs + as * bx + ay * bz - az * by;
        this.y = ay * bs + as * by + az * bx - ax * bz;
        this.z = az * bs + as * bz + ax * by - ay * bx;
        this.w = as * bs - ax * bx - ay * by - az * bz;
        return this;

    },*/

    multiply: function (q, p) {

      if (p !== undefined) return this.multiplyQuaternions(q, p);
      return this.multiplyQuaternions(this, q);

    },

    multiplyQuaternions: function (a, b) {

      var qax = a.x, qay = a.y, qaz = a.z, qaw = a.w;
      var qbx = b.x, qby = b.y, qbz = b.z, qbw = b.w;

      this.x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;
      this.y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;
      this.z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;
      this.w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;
      return this;

    },

    setFromUnitVectors: function (v1, v2) {

      var vx = new Vec3();
      var r = v1.dot(v2) + 1;

      if (r < _Math.EPS2) {

        r = 0;
        if (_Math.abs(v1.x) > _Math.abs(v1.z)) vx.set(- v1.y, v1.x, 0);
        else vx.set(0, - v1.z, v1.y);

      } else {

        vx.crossVectors(v1, v2);

      }

      this._x = vx.x;
      this._y = vx.y;
      this._z = vx.z;
      this._w = r;

      return this.normalize();

    },

    arc: function (v1, v2) {

      var x1 = v1.x;
      var y1 = v1.y;
      var z1 = v1.z;
      var x2 = v2.x;
      var y2 = v2.y;
      var z2 = v2.z;
      var d = x1 * x2 + y1 * y2 + z1 * z2;
      if (d == -1) {
        x2 = y1 * x1 - z1 * z1;
        y2 = -z1 * y1 - x1 * x1;
        z2 = x1 * z1 + y1 * y1;
        d = 1 / _Math.sqrt(x2 * x2 + y2 * y2 + z2 * z2);
        this.w = 0;
        this.x = x2 * d;
        this.y = y2 * d;
        this.z = z2 * d;
        return this;
      }
      var cx = y1 * z2 - z1 * y2;
      var cy = z1 * x2 - x1 * z2;
      var cz = x1 * y2 - y1 * x2;
      this.w = _Math.sqrt((1 + d) * 0.5);
      d = 0.5 / this.w;
      this.x = cx * d;
      this.y = cy * d;
      this.z = cz * d;
      return this;

    },

    normalize: function () {

      var l = this.length();
      if (l === 0) {
        this.set(0, 0, 0, 1);
      } else {
        l = 1 / l;
        this.x = this.x * l;
        this.y = this.y * l;
        this.z = this.z * l;
        this.w = this.w * l;
      }
      return this;

    },

    inverse: function () {

      return this.conjugate().normalize();

    },

    invert: function (q) {

      this.x = q.x;
      this.y = q.y;
      this.z = q.z;
      this.w = q.w;
      this.conjugate().normalize();
      return this;

    },

    conjugate: function () {

      this.x *= - 1;
      this.y *= - 1;
      this.z *= - 1;
      return this;

    },

    length: function () {

      return _Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);

    },

    lengthSq: function () {

      return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;

    },

    copy: function (q) {

      this.x = q.x;
      this.y = q.y;
      this.z = q.z;
      this.w = q.w;
      return this;

    },

    clone: function (q) {

      return new Quat(this.x, this.y, this.z, this.w);

    },

    testDiff: function (q) {

      return this.equals(q) ? false : true;

    },

    equals: function (q) {

      return this.x === q.x && this.y === q.y && this.z === q.z && this.w === q.w;

    },

    toString: function () {

      return "Quat[" + this.x.toFixed(4) + ", (" + this.y.toFixed(4) + ", " + this.z.toFixed(4) + ", " + this.w.toFixed(4) + ")]";

    },

    setFromEuler: function (x, y, z) {

      var c1 = Math.cos(x * 0.5);
      var c2 = Math.cos(y * 0.5);
      var c3 = Math.cos(z * 0.5);
      var s1 = Math.sin(x * 0.5);
      var s2 = Math.sin(y * 0.5);
      var s3 = Math.sin(z * 0.5);

      // XYZ
      this.x = s1 * c2 * c3 + c1 * s2 * s3;
      this.y = c1 * s2 * c3 - s1 * c2 * s3;
      this.z = c1 * c2 * s3 + s1 * s2 * c3;
      this.w = c1 * c2 * c3 - s1 * s2 * s3;

      return this;

    },

    setFromAxis: function (axis, rad) {

      axis.normalize();
      rad = rad * 0.5;
      var s = _Math.sin(rad);
      this.x = s * axis.x;
      this.y = s * axis.y;
      this.z = s * axis.z;
      this.w = _Math.cos(rad);
      return this;

    },

    setFromMat33: function (m) {

      var trace = m[0] + m[4] + m[8];
      var s;

      if (trace > 0) {

        s = _Math.sqrt(trace + 1.0);
        this.w = 0.5 / s;
        s = 0.5 / s;
        this.x = (m[5] - m[7]) * s;
        this.y = (m[6] - m[2]) * s;
        this.z = (m[1] - m[3]) * s;

      } else {

        var out = [];
        var i = 0;
        if (m[4] > m[0]) i = 1;
        if (m[8] > m[i * 3 + i]) i = 2;

        var j = (i + 1) % 3;
        var k = (i + 2) % 3;

        s = _Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);
        out[i] = 0.5 * fRoot;
        s = 0.5 / fRoot;
        this.w = (m[j * 3 + k] - m[k * 3 + j]) * s;
        out[j] = (m[j * 3 + i] + m[i * 3 + j]) * s;
        out[k] = (m[k * 3 + i] + m[i * 3 + k]) * s;

        this.x = out[1];
        this.y = out[2];
        this.z = out[3];

      }

      return this;

    },

    toArray: function (array, offset) {

      offset = offset || 0;

      array[offset] = this.x;
      array[offset + 1] = this.y;
      array[offset + 2] = this.z;
      array[offset + 3] = this.w;

    },

    fromArray: function (array, offset) {

      offset = offset || 0;
      this.set(array[offset], array[offset + 1], array[offset + 2], array[offset + 3]);
      return this;

    }

  });

  function Mat33(e00, e01, e02, e10, e11, e12, e20, e21, e22) {

    this.elements = [
      1, 0, 0,
      0, 1, 0,
      0, 0, 1
    ];

    if (arguments.length > 0) {

      console.error('OIMO.Mat33: the constructor no longer reads arguments. use .set() instead.');

    }

  }

  Object.assign(Mat33.prototype, {

    Mat33: true,

    set: function (e00, e01, e02, e10, e11, e12, e20, e21, e22) {

      var te = this.elements;
      te[0] = e00; te[1] = e01; te[2] = e02;
      te[3] = e10; te[4] = e11; te[5] = e12;
      te[6] = e20; te[7] = e21; te[8] = e22;
      return this;

    },

    add: function (a, b) {

      if (b !== undefined) return this.addMatrixs(a, b);

      var e = this.elements, te = a.elements;
      e[0] += te[0]; e[1] += te[1]; e[2] += te[2];
      e[3] += te[3]; e[4] += te[4]; e[5] += te[5];
      e[6] += te[6]; e[7] += te[7]; e[8] += te[8];
      return this;

    },

    addMatrixs: function (a, b) {

      var te = this.elements, tem1 = a.elements, tem2 = b.elements;
      te[0] = tem1[0] + tem2[0]; te[1] = tem1[1] + tem2[1]; te[2] = tem1[2] + tem2[2];
      te[3] = tem1[3] + tem2[3]; te[4] = tem1[4] + tem2[4]; te[5] = tem1[5] + tem2[5];
      te[6] = tem1[6] + tem2[6]; te[7] = tem1[7] + tem2[7]; te[8] = tem1[8] + tem2[8];
      return this;

    },

    addEqual: function (m) {

      var te = this.elements, tem = m.elements;
      te[0] += tem[0]; te[1] += tem[1]; te[2] += tem[2];
      te[3] += tem[3]; te[4] += tem[4]; te[5] += tem[5];
      te[6] += tem[6]; te[7] += tem[7]; te[8] += tem[8];
      return this;

    },

    sub: function (a, b) {

      if (b !== undefined) return this.subMatrixs(a, b);

      var e = this.elements, te = a.elements;
      e[0] -= te[0]; e[1] -= te[1]; e[2] -= te[2];
      e[3] -= te[3]; e[4] -= te[4]; e[5] -= te[5];
      e[6] -= te[6]; e[7] -= te[7]; e[8] -= te[8];
      return this;

    },

    subMatrixs: function (a, b) {

      var te = this.elements, tem1 = a.elements, tem2 = b.elements;
      te[0] = tem1[0] - tem2[0]; te[1] = tem1[1] - tem2[1]; te[2] = tem1[2] - tem2[2];
      te[3] = tem1[3] - tem2[3]; te[4] = tem1[4] - tem2[4]; te[5] = tem1[5] - tem2[5];
      te[6] = tem1[6] - tem2[6]; te[7] = tem1[7] - tem2[7]; te[8] = tem1[8] - tem2[8];
      return this;

    },

    subEqual: function (m) {

      var te = this.elements, tem = m.elements;
      te[0] -= tem[0]; te[1] -= tem[1]; te[2] -= tem[2];
      te[3] -= tem[3]; te[4] -= tem[4]; te[5] -= tem[5];
      te[6] -= tem[6]; te[7] -= tem[7]; te[8] -= tem[8];
      return this;

    },

    scale: function (m, s) {

      var te = this.elements, tm = m.elements;
      te[0] = tm[0] * s; te[1] = tm[1] * s; te[2] = tm[2] * s;
      te[3] = tm[3] * s; te[4] = tm[4] * s; te[5] = tm[5] * s;
      te[6] = tm[6] * s; te[7] = tm[7] * s; te[8] = tm[8] * s;
      return this;

    },

    scaleEqual: function (s) {// multiplyScalar

      var te = this.elements;
      te[0] *= s; te[1] *= s; te[2] *= s;
      te[3] *= s; te[4] *= s; te[5] *= s;
      te[6] *= s; te[7] *= s; te[8] *= s;
      return this;

    },

    multiplyMatrices: function (m1, m2, transpose) {

      if (transpose) m2 = m2.clone().transpose();

      var te = this.elements;
      var tm1 = m1.elements;
      var tm2 = m2.elements;

      var a0 = tm1[0], a3 = tm1[3], a6 = tm1[6];
      var a1 = tm1[1], a4 = tm1[4], a7 = tm1[7];
      var a2 = tm1[2], a5 = tm1[5], a8 = tm1[8];

      var b0 = tm2[0], b3 = tm2[3], b6 = tm2[6];
      var b1 = tm2[1], b4 = tm2[4], b7 = tm2[7];
      var b2 = tm2[2], b5 = tm2[5], b8 = tm2[8];

      te[0] = a0 * b0 + a1 * b3 + a2 * b6;
      te[1] = a0 * b1 + a1 * b4 + a2 * b7;
      te[2] = a0 * b2 + a1 * b5 + a2 * b8;
      te[3] = a3 * b0 + a4 * b3 + a5 * b6;
      te[4] = a3 * b1 + a4 * b4 + a5 * b7;
      te[5] = a3 * b2 + a4 * b5 + a5 * b8;
      te[6] = a6 * b0 + a7 * b3 + a8 * b6;
      te[7] = a6 * b1 + a7 * b4 + a8 * b7;
      te[8] = a6 * b2 + a7 * b5 + a8 * b8;

      return this;

    },

    /*mul: function ( m1, m2, transpose ) {

        if( transpose ) m2 = m2.clone().transpose();

        var te = this.elements;
        var tm1 = m1.elements;
        var tm2 = m2.elements;
        //var tmp;

        var a0 = tm1[0], a3 = tm1[3], a6 = tm1[6];
        var a1 = tm1[1], a4 = tm1[4], a7 = tm1[7];
        var a2 = tm1[2], a5 = tm1[5], a8 = tm1[8];

        var b0 = tm2[0], b3 = tm2[3], b6 = tm2[6];
        var b1 = tm2[1], b4 = tm2[4], b7 = tm2[7];
        var b2 = tm2[2], b5 = tm2[5], b8 = tm2[8];

        /*if( transpose ){

            tmp = b1; b1 = b3; b3 = tmp;
            tmp = b2; b2 = b6; b6 = tmp;
            tmp = b5; b5 = b7; b7 = tmp;

        }

        te[0] = a0*b0 + a1*b3 + a2*b6;
        te[1] = a0*b1 + a1*b4 + a2*b7;
        te[2] = a0*b2 + a1*b5 + a2*b8;
        te[3] = a3*b0 + a4*b3 + a5*b6;
        te[4] = a3*b1 + a4*b4 + a5*b7;
        te[5] = a3*b2 + a4*b5 + a5*b8;
        te[6] = a6*b0 + a7*b3 + a8*b6;
        te[7] = a6*b1 + a7*b4 + a8*b7;
        te[8] = a6*b2 + a7*b5 + a8*b8;

        return this;

    },*/

    transpose: function (m) {

      if (m !== undefined) {
        var a = m.elements;
        this.set(a[0], a[3], a[6], a[1], a[4], a[7], a[2], a[5], a[8]);
        return this;
      }

      var te = this.elements;
      var a01 = te[1], a02 = te[2], a12 = te[5];
      te[1] = te[3];
      te[2] = te[6];
      te[3] = a01;
      te[5] = te[7];
      te[6] = a02;
      te[7] = a12;
      return this;

    },



    /*mulScale: function ( m, sx, sy, sz, Prepend ) {

        var prepend = Prepend || false;
        var te = this.elements, tm = m.elements;
        if(prepend){
            te[0] = sx*tm[0]; te[1] = sx*tm[1]; te[2] = sx*tm[2];
            te[3] = sy*tm[3]; te[4] = sy*tm[4]; te[5] = sy*tm[5];
            te[6] = sz*tm[6]; te[7] = sz*tm[7]; te[8] = sz*tm[8];
        }else{
            te[0] = tm[0]*sx; te[1] = tm[1]*sy; te[2] = tm[2]*sz;
            te[3] = tm[3]*sx; te[4] = tm[4]*sy; te[5] = tm[5]*sz;
            te[6] = tm[6]*sx; te[7] = tm[7]*sy; te[8] = tm[8]*sz;
        }
        return this;

    },

    transpose: function ( m ) {

        var te = this.elements, tm = m.elements;
        te[0] = tm[0]; te[1] = tm[3]; te[2] = tm[6];
        te[3] = tm[1]; te[4] = tm[4]; te[5] = tm[7];
        te[6] = tm[2]; te[7] = tm[5]; te[8] = tm[8];
        return this;

    },*/

    setQuat: function (q) {

      var te = this.elements;
      var x = q.x, y = q.y, z = q.z, w = q.w;
      var x2 = x + x, y2 = y + y, z2 = z + z;
      var xx = x * x2, xy = x * y2, xz = x * z2;
      var yy = y * y2, yz = y * z2, zz = z * z2;
      var wx = w * x2, wy = w * y2, wz = w * z2;

      te[0] = 1 - (yy + zz);
      te[1] = xy - wz;
      te[2] = xz + wy;

      te[3] = xy + wz;
      te[4] = 1 - (xx + zz);
      te[5] = yz - wx;

      te[6] = xz - wy;
      te[7] = yz + wx;
      te[8] = 1 - (xx + yy);

      return this;

    },

    invert: function (m) {

      var te = this.elements, tm = m.elements,
        a00 = tm[0], a10 = tm[3], a20 = tm[6],
        a01 = tm[1], a11 = tm[4], a21 = tm[7],
        a02 = tm[2], a12 = tm[5], a22 = tm[8],
        b01 = a22 * a11 - a12 * a21,
        b11 = -a22 * a10 + a12 * a20,
        b21 = a21 * a10 - a11 * a20,
        det = a00 * b01 + a01 * b11 + a02 * b21;

      if (det === 0) {
        console.log("can't invert matrix, determinant is 0");
        return this.identity();
      }

      det = 1.0 / det;
      te[0] = b01 * det;
      te[1] = (-a22 * a01 + a02 * a21) * det;
      te[2] = (a12 * a01 - a02 * a11) * det;
      te[3] = b11 * det;
      te[4] = (a22 * a00 - a02 * a20) * det;
      te[5] = (-a12 * a00 + a02 * a10) * det;
      te[6] = b21 * det;
      te[7] = (-a21 * a00 + a01 * a20) * det;
      te[8] = (a11 * a00 - a01 * a10) * det;
      return this;

    },

    addOffset: function (m, v) {

      var relX = v.x;
      var relY = v.y;
      var relZ = v.z;

      var te = this.elements;
      te[0] += m * (relY * relY + relZ * relZ);
      te[4] += m * (relX * relX + relZ * relZ);
      te[8] += m * (relX * relX + relY * relY);
      var xy = m * relX * relY;
      var yz = m * relY * relZ;
      var zx = m * relZ * relX;
      te[1] -= xy;
      te[3] -= xy;
      te[2] -= yz;
      te[6] -= yz;
      te[5] -= zx;
      te[7] -= zx;
      return this;

    },

    subOffset: function (m, v) {

      var relX = v.x;
      var relY = v.y;
      var relZ = v.z;

      var te = this.elements;
      te[0] -= m * (relY * relY + relZ * relZ);
      te[4] -= m * (relX * relX + relZ * relZ);
      te[8] -= m * (relX * relX + relY * relY);
      var xy = m * relX * relY;
      var yz = m * relY * relZ;
      var zx = m * relZ * relX;
      te[1] += xy;
      te[3] += xy;
      te[2] += yz;
      te[6] += yz;
      te[5] += zx;
      te[7] += zx;
      return this;

    },

    // OK 

    multiplyScalar: function (s) {

      var te = this.elements;

      te[0] *= s; te[3] *= s; te[6] *= s;
      te[1] *= s; te[4] *= s; te[7] *= s;
      te[2] *= s; te[5] *= s; te[8] *= s;

      return this;

    },

    identity: function () {

      this.set(1, 0, 0, 0, 1, 0, 0, 0, 1);
      return this;

    },


    clone: function () {

      return new Mat33().fromArray(this.elements);

    },

    copy: function (m) {

      for (var i = 0; i < 9; i++) this.elements[i] = m.elements[i];
      return this;

    },

    determinant: function () {

      var te = this.elements;
      var a = te[0], b = te[1], c = te[2],
        d = te[3], e = te[4], f = te[5],
        g = te[6], h = te[7], i = te[8];

      return a * e * i - a * f * h - b * d * i + b * f * g + c * d * h - c * e * g;

    },

    fromArray: function (array, offset) {

      if (offset === undefined) offset = 0;

      for (var i = 0; i < 9; i++) {

        this.elements[i] = array[i + offset];

      }

      return this;

    },

    toArray: function (array, offset) {

      if (array === undefined) array = [];
      if (offset === undefined) offset = 0;

      var te = this.elements;

      array[offset] = te[0];
      array[offset + 1] = te[1];
      array[offset + 2] = te[2];

      array[offset + 3] = te[3];
      array[offset + 4] = te[4];
      array[offset + 5] = te[5];

      array[offset + 6] = te[6];
      array[offset + 7] = te[7];
      array[offset + 8] = te[8];

      return array;

    }


  });

  /**
   * An axis-aligned bounding box.
   *
   * @author saharan
   * @author lo-th
   */

  function AABB(minX, maxX, minY, maxY, minZ, maxZ) {

    this.elements = new Float32Array(6);
    var te = this.elements;

    te[0] = minX || 0; te[1] = minY || 0; te[2] = minZ || 0;
    te[3] = maxX || 0; te[4] = maxY || 0; te[5] = maxZ || 0;

  }
  Object.assign(AABB.prototype, {

    AABB: true,

    set: function (minX, maxX, minY, maxY, minZ, maxZ) {

      var te = this.elements;
      te[0] = minX;
      te[3] = maxX;
      te[1] = minY;
      te[4] = maxY;
      te[2] = minZ;
      te[5] = maxZ;
      return this;
    },

    intersectTest: function (aabb) {

      var te = this.elements;
      var ue = aabb.elements;
      return te[0] > ue[3] || te[1] > ue[4] || te[2] > ue[5] || te[3] < ue[0] || te[4] < ue[1] || te[5] < ue[2] ? true : false;

    },

    intersectTestTwo: function (aabb) {

      var te = this.elements;
      var ue = aabb.elements;
      return te[0] < ue[0] || te[1] < ue[1] || te[2] < ue[2] || te[3] > ue[3] || te[4] > ue[4] || te[5] > ue[5] ? true : false;

    },

    clone: function () {

      return new this.constructor().fromArray(this.elements);

    },

    copy: function (aabb, margin) {

      var m = margin || 0;
      var me = aabb.elements;
      this.set(me[0] - m, me[3] + m, me[1] - m, me[4] + m, me[2] - m, me[5] + m);
      return this;

    },

    fromArray: function (array) {

      this.elements.set(array);
      return this;

    },

    // Set this AABB to the combined AABB of aabb1 and aabb2.

    combine: function (aabb1, aabb2) {

      var a = aabb1.elements;
      var b = aabb2.elements;
      var te = this.elements;

      te[0] = a[0] < b[0] ? a[0] : b[0];
      te[1] = a[1] < b[1] ? a[1] : b[1];
      te[2] = a[2] < b[2] ? a[2] : b[2];

      te[3] = a[3] > b[3] ? a[3] : b[3];
      te[4] = a[4] > b[4] ? a[4] : b[4];
      te[5] = a[5] > b[5] ? a[5] : b[5];

      return this;

    },


    // Get the surface area.

    surfaceArea: function () {

      var te = this.elements;
      var a = te[3] - te[0];
      var h = te[4] - te[1];
      var d = te[5] - te[2];
      return 2 * (a * (h + d) + h * d);

    },


    // Get whether the AABB intersects with the point or not.

    intersectsWithPoint: function (x, y, z) {

      var te = this.elements;
      return x >= te[0] && x <= te[3] && y >= te[1] && y <= te[4] && z >= te[2] && z <= te[5];

    },

    /**
     * Set the AABB from an array
     * of vertices. From THREE.
     * @author WestLangley
     * @author xprogram
     */

    setFromPoints: function (arr) {
      this.makeEmpty();
      for (var i = 0; i < arr.length; i++) {
        this.expandByPoint(arr[i]);
      }
    },

    makeEmpty: function () {
      this.set(-Infinity, -Infinity, -Infinity, Infinity, Infinity, Infinity);
    },

    expandByPoint: function (pt) {
      var te = this.elements;
      this.set(
        _Math.min(te[0], pt.x), _Math.min(te[1], pt.y), _Math.min(te[2], pt.z),
        _Math.max(te[3], pt.x), _Math.max(te[4], pt.y), _Math.max(te[5], pt.z)
      );
    },

    expandByScalar: function (s) {

      var te = this.elements;
      te[0] += -s;
      te[1] += -s;
      te[2] += -s;
      te[3] += s;
      te[4] += s;
      te[5] += s;
    }

  });

  var count = 0;
  function ShapeIdCount() { return count++; }

  /**
   * A shape is used to detect collisions of rigid bodies.
   *
   * @author saharan
   * @author lo-th
   */

  function Shape(config) {

    this.type = SHAPE_NULL;

    // global identification of the shape should be unique to the shape.
    this.id = ShapeIdCount();

    // previous shape in parent rigid body. Used for fast interations.
    this.prev = null;

    // next shape in parent rigid body. Used for fast interations.
    this.next = null;

    // proxy of the shape used for broad-phase collision detection.
    this.proxy = null;

    // parent rigid body of the shape.
    this.parent = null;

    // linked list of the contacts with the shape.
    this.contactLink = null;

    // number of the contacts with the shape.
    this.numContacts = 0;

    // center of gravity of the shape in world coordinate system.
    this.position = new Vec3();

    // rotation matrix of the shape in world coordinate system.
    this.rotation = new Mat33();

    // position of the shape in parent's coordinate system.
    this.relativePosition = new Vec3().copy(config.relativePosition);

    // rotation matrix of the shape in parent's coordinate system.
    this.relativeRotation = new Mat33().copy(config.relativeRotation);

    // axis-aligned bounding box of the shape.
    this.aabb = new AABB();

    // density of the shape.
    this.density = config.density;

    // coefficient of friction of the shape.
    this.friction = config.friction;

    // coefficient of restitution of the shape.
    this.restitution = config.restitution;

    // bits of the collision groups to which the shape belongs.
    this.belongsTo = config.belongsTo;

    // bits of the collision groups with which the shape collides.
    this.collidesWith = config.collidesWith;

  }
  Object.assign(Shape.prototype, {

    Shape: true,

    // Calculate the mass information of the shape.

    calculateMassInfo: function (out) {

      printError("Shape", "Inheritance error.");

    },

    // Update the proxy of the shape.

    updateProxy: function () {

      printError("Shape", "Inheritance error.");

    }

  });

  /**
   * Box shape.
   * @author saharan
   * @author lo-th
   */

  function Box(config, Width, Height, Depth) {

    Shape.call(this, config);

    this.type = SHAPE_BOX;

    this.width = Width;
    this.height = Height;
    this.depth = Depth;

    this.halfWidth = Width * 0.5;
    this.halfHeight = Height * 0.5;
    this.halfDepth = Depth * 0.5;

    this.dimentions = new Float32Array(18);
    this.elements = new Float32Array(24);

  }
  Box.prototype = Object.assign(Object.create(Shape.prototype), {

    constructor: Box,

    calculateMassInfo: function (out) {

      var mass = this.width * this.height * this.depth * this.density;
      var divid = 1 / 12;
      out.mass = mass;
      out.inertia.set(
        mass * (this.height * this.height + this.depth * this.depth) * divid, 0, 0,
        0, mass * (this.width * this.width + this.depth * this.depth) * divid, 0,
        0, 0, mass * (this.width * this.width + this.height * this.height) * divid
      );

    },

    updateProxy: function () {

      var te = this.rotation.elements;
      var di = this.dimentions;
      // Width
      di[0] = te[0];
      di[1] = te[3];
      di[2] = te[6];
      // Height
      di[3] = te[1];
      di[4] = te[4];
      di[5] = te[7];
      // Depth
      di[6] = te[2];
      di[7] = te[5];
      di[8] = te[8];
      // half Width
      di[9] = te[0] * this.halfWidth;
      di[10] = te[3] * this.halfWidth;
      di[11] = te[6] * this.halfWidth;
      // half Height
      di[12] = te[1] * this.halfHeight;
      di[13] = te[4] * this.halfHeight;
      di[14] = te[7] * this.halfHeight;
      // half Depth
      di[15] = te[2] * this.halfDepth;
      di[16] = te[5] * this.halfDepth;
      di[17] = te[8] * this.halfDepth;

      var wx = di[9];
      var wy = di[10];
      var wz = di[11];
      var hx = di[12];
      var hy = di[13];
      var hz = di[14];
      var dx = di[15];
      var dy = di[16];
      var dz = di[17];

      var x = this.position.x;
      var y = this.position.y;
      var z = this.position.z;

      var v = this.elements;
      //v1
      v[0] = x + wx + hx + dx;
      v[1] = y + wy + hy + dy;
      v[2] = z + wz + hz + dz;
      //v2
      v[3] = x + wx + hx - dx;
      v[4] = y + wy + hy - dy;
      v[5] = z + wz + hz - dz;
      //v3
      v[6] = x + wx - hx + dx;
      v[7] = y + wy - hy + dy;
      v[8] = z + wz - hz + dz;
      //v4
      v[9] = x + wx - hx - dx;
      v[10] = y + wy - hy - dy;
      v[11] = z + wz - hz - dz;
      //v5
      v[12] = x - wx + hx + dx;
      v[13] = y - wy + hy + dy;
      v[14] = z - wz + hz + dz;
      //v6
      v[15] = x - wx + hx - dx;
      v[16] = y - wy + hy - dy;
      v[17] = z - wz + hz - dz;
      //v7
      v[18] = x - wx - hx + dx;
      v[19] = y - wy - hy + dy;
      v[20] = z - wz - hz + dz;
      //v8
      v[21] = x - wx - hx - dx;
      v[22] = y - wy - hy - dy;
      v[23] = z - wz - hz - dz;

      var w = di[9] < 0 ? -di[9] : di[9];
      var h = di[10] < 0 ? -di[10] : di[10];
      var d = di[11] < 0 ? -di[11] : di[11];

      w = di[12] < 0 ? w - di[12] : w + di[12];
      h = di[13] < 0 ? h - di[13] : h + di[13];
      d = di[14] < 0 ? d - di[14] : d + di[14];

      w = di[15] < 0 ? w - di[15] : w + di[15];
      h = di[16] < 0 ? h - di[16] : h + di[16];
      d = di[17] < 0 ? d - di[17] : d + di[17];

      var p = AABB_PROX;

      this.aabb.set(
        this.position.x - w - p, this.position.x + w + p,
        this.position.y - h - p, this.position.y + h + p,
        this.position.z - d - p, this.position.z + d + p
      );

      if (this.proxy != null) this.proxy.update();

    }
  });

  /**
   * Sphere shape
   * @author saharan
   * @author lo-th
   */

  function Sphere(config, radius) {

    Shape.call(this, config);

    this.type = SHAPE_SPHERE;

    // radius of the shape.
    this.radius = radius;

  }
  Sphere.prototype = Object.assign(Object.create(Shape.prototype), {

    constructor: Sphere,

    volume: function () {

      return _Math.PI * this.radius * 1.333333;

    },

    calculateMassInfo: function (out) {

      var mass = this.volume() * this.radius * this.radius * this.density; //1.333 * _Math.PI * this.radius * this.radius * this.radius * this.density;
      out.mass = mass;
      var inertia = mass * this.radius * this.radius * 0.4;
      out.inertia.set(inertia, 0, 0, 0, inertia, 0, 0, 0, inertia);

    },

    updateProxy: function () {

      var p = AABB_PROX;

      this.aabb.set(
        this.position.x - this.radius - p, this.position.x + this.radius + p,
        this.position.y - this.radius - p, this.position.y + this.radius + p,
        this.position.z - this.radius - p, this.position.z + this.radius + p
      );

      if (this.proxy != null) this.proxy.update();

    }

  });

  /**
   * Cylinder shape
   * @author saharan
   * @author lo-th
   */

  function Cylinder(config, radius, height) {

    Shape.call(this, config);

    this.type = SHAPE_CYLINDER;

    this.radius = radius;
    this.height = height;
    this.halfHeight = height * 0.5;

    this.normalDirection = new Vec3();
    this.halfDirection = new Vec3();

  }
  Cylinder.prototype = Object.assign(Object.create(Shape.prototype), {

    constructor: Cylinder,

    calculateMassInfo: function (out) {

      var rsq = this.radius * this.radius;
      var mass = _Math.PI * rsq * this.height * this.density;
      var inertiaXZ = ((0.25 * rsq) + (0.0833 * this.height * this.height)) * mass;
      var inertiaY = 0.5 * rsq;
      out.mass = mass;
      out.inertia.set(inertiaXZ, 0, 0, 0, inertiaY, 0, 0, 0, inertiaXZ);

    },

    updateProxy: function () {

      var te = this.rotation.elements;
      var len, wx, hy, dz, xx, yy, zz, w, h, d, p;

      xx = te[1] * te[1];
      yy = te[4] * te[4];
      zz = te[7] * te[7];

      this.normalDirection.set(te[1], te[4], te[7]);
      this.halfDirection.scale(this.normalDirection, this.halfHeight);

      wx = 1 - xx;
      len = _Math.sqrt(wx * wx + xx * yy + xx * zz);
      if (len > 0) len = this.radius / len;
      wx *= len;
      hy = 1 - yy;
      len = _Math.sqrt(yy * xx + hy * hy + yy * zz);
      if (len > 0) len = this.radius / len;
      hy *= len;
      dz = 1 - zz;
      len = _Math.sqrt(zz * xx + zz * yy + dz * dz);
      if (len > 0) len = this.radius / len;
      dz *= len;

      w = this.halfDirection.x < 0 ? -this.halfDirection.x : this.halfDirection.x;
      h = this.halfDirection.y < 0 ? -this.halfDirection.y : this.halfDirection.y;
      d = this.halfDirection.z < 0 ? -this.halfDirection.z : this.halfDirection.z;

      w = wx < 0 ? w - wx : w + wx;
      h = hy < 0 ? h - hy : h + hy;
      d = dz < 0 ? d - dz : d + dz;

      p = AABB_PROX;

      this.aabb.set(
        this.position.x - w - p, this.position.x + w + p,
        this.position.y - h - p, this.position.y + h + p,
        this.position.z - d - p, this.position.z + d + p
      );

      if (this.proxy != null) this.proxy.update();

    }

  });

  /**
   * Plane shape.
   * @author lo-th
   */

  function Plane(config, normal) {

    Shape.call(this, config);

    this.type = SHAPE_PLANE;

    // radius of the shape.
    this.normal = new Vec3(0, 1, 0);

  }
  Plane.prototype = Object.assign(Object.create(Shape.prototype), {

    constructor: Plane,

    volume: function () {

      return Number.MAX_VALUE;

    },

    calculateMassInfo: function (out) {

      out.mass = this.density;//0.0001;
      var inertia = 1;
      out.inertia.set(inertia, 0, 0, 0, inertia, 0, 0, 0, inertia);

    },

    updateProxy: function () {

      var p = AABB_PROX;

      var min = -_Math.INF;
      var max = _Math.INF;
      var n = this.normal;
      // The plane AABB is infinite, except if the normal is pointing along any axis
      this.aabb.set(
        n.x === -1 ? this.position.x - p : min, n.x === 1 ? this.position.x + p : max,
        n.y === -1 ? this.position.y - p : min, n.y === 1 ? this.position.y + p : max,
        n.z === -1 ? this.position.z - p : min, n.z === 1 ? this.position.z + p : max
      );

      if (this.proxy != null) this.proxy.update();

    }

  });

  /**
   * A Particule shape
   * @author lo-th
   */

  function Particle(config, normal) {

    Shape.call(this, config);

    this.type = SHAPE_PARTICLE;

  }
  Particle.prototype = Object.assign(Object.create(Shape.prototype), {

    constructor: Particle,

    volume: function () {

      return Number.MAX_VALUE;

    },

    calculateMassInfo: function (out) {

      var inertia = 0;
      out.inertia.set(inertia, 0, 0, 0, inertia, 0, 0, 0, inertia);

    },

    updateProxy: function () {

      var p = 0;//AABB_PROX;

      this.aabb.set(
        this.position.x - p, this.position.x + p,
        this.position.y - p, this.position.y + p,
        this.position.z - p, this.position.z + p
      );

      if (this.proxy != null) this.proxy.update();

    }

  });

  /**
   * A shape configuration holds common configuration data for constructing a shape.
   * These configurations can be reused safely.
   *
   * @author saharan
   * @author lo-th
   */

  function ShapeConfig() {

    // position of the shape in parent's coordinate system.
    this.relativePosition = new Vec3();
    // rotation matrix of the shape in parent's coordinate system.
    this.relativeRotation = new Mat33();
    // coefficient of friction of the shape.
    this.friction = 0.2; // 0.4
    // coefficient of restitution of the shape.
    this.restitution = 0.2;
    // density of the shape.
    this.density = 1;
    // bits of the collision groups to which the shape belongs.
    this.belongsTo = 1;
    // bits of the collision groups with which the shape collides.
    this.collidesWith = 0xffffffff;

  }

  /**
  * An information of limit and motor.
  *
  * @author saharan
  */

  function LimitMotor(axis, fixed) {

    fixed = fixed || false;
    // The axis of the constraint.
    this.axis = axis;
    // The current angle for rotational constraints.
    this.angle = 0;
    // The lower limit. Set lower > upper to disable
    this.lowerLimit = fixed ? 0 : 1;

    //  The upper limit. Set lower > upper to disable.
    this.upperLimit = 0;
    // The target motor speed.
    this.motorSpeed = 0;
    // The maximum motor force or torque. Set 0 to disable.
    this.maxMotorForce = 0;
    // The frequency of the spring. Set 0 to disable.
    this.frequency = 0;
    // The damping ratio of the spring. Set 0 for no damping, 1 for critical damping.
    this.dampingRatio = 0;

  }
  Object.assign(LimitMotor.prototype, {

    LimitMotor: true,

    // Set limit data into this constraint.
    setLimit: function (lowerLimit, upperLimit) {

      this.lowerLimit = lowerLimit;
      this.upperLimit = upperLimit;

    },

    // Set motor data into this constraint.
    setMotor: function (motorSpeed, maxMotorForce) {

      this.motorSpeed = motorSpeed;
      this.maxMotorForce = maxMotorForce;

    },

    // Set spring data into this constraint.
    setSpring: function (frequency, dampingRatio) {

      this.frequency = frequency;
      this.dampingRatio = dampingRatio;

    }

  });

  /**
   * The base class of all type of the constraints.
   *
   * @author saharan
   * @author lo-th
   */

  function Constraint() {

    // parent world of the constraint.
    this.parent = null;

    // first body of the constraint.
    this.body1 = null;

    // second body of the constraint.
    this.body2 = null;

    // Internal
    this.addedToIsland = false;

  }

  Object.assign(Constraint.prototype, {

    Constraint: true,

    // Prepare for solving the constraint
    preSolve: function (timeStep, invTimeStep) {

      printError("Constraint", "Inheritance error.");

    },

    // Solve the constraint. This is usually called iteratively.
    solve: function () {

      printError("Constraint", "Inheritance error.");

    },

    // Do the post-processing.
    postSolve: function () {

      printError("Constraint", "Inheritance error.");

    }

  });

  function JointLink(joint) {

    // The previous joint link.
    this.prev = null;
    // The next joint link.
    this.next = null;
    // The other rigid body connected to the joint.
    this.body = null;
    // The joint of the link.
    this.joint = joint;

  }

  /**
   * Joints are used to constrain the motion between two rigid bodies.
   *
   * @author saharan
   * @author lo-th
   */

  function Joint(config) {

    Constraint.call(this);

    this.scale = 1;
    this.invScale = 1;

    // joint name
    this.name = "";
    this.id = NaN;

    // The type of the joint.
    this.type = JOINT_NULL;
    //  The previous joint in the world.
    this.prev = null;
    // The next joint in the world.
    this.next = null;

    this.body1 = config.body1;
    this.body2 = config.body2;

    // anchor point on the first rigid body in local coordinate system.
    this.localAnchorPoint1 = new Vec3().copy(config.localAnchorPoint1);
    // anchor point on the second rigid body in local coordinate system.
    this.localAnchorPoint2 = new Vec3().copy(config.localAnchorPoint2);
    // anchor point on the first rigid body in world coordinate system relative to the body's origin.
    this.relativeAnchorPoint1 = new Vec3();
    // anchor point on the second rigid body in world coordinate system relative to the body's origin.
    this.relativeAnchorPoint2 = new Vec3();
    //  anchor point on the first rigid body in world coordinate system.
    this.anchorPoint1 = new Vec3();
    // anchor point on the second rigid body in world coordinate system.
    this.anchorPoint2 = new Vec3();
    // Whether allow collision between connected rigid bodies or not.
    this.allowCollision = config.allowCollision;

    this.b1Link = new JointLink(this);
    this.b2Link = new JointLink(this);

  }
  Joint.prototype = Object.assign(Object.create(Constraint.prototype), {

    constructor: Joint,

    setId: function (n) {

      this.id = i;

    },

    setParent: function (world) {

      this.parent = world;
      this.scale = this.parent.scale;
      this.invScale = this.parent.invScale;
      this.id = this.parent.numJoints;
      if (!this.name) this.name = 'J' + this.id;

    },

    // Update all the anchor points.

    updateAnchorPoints: function () {

      this.relativeAnchorPoint1.copy(this.localAnchorPoint1).applyMatrix3(this.body1.rotation, true);
      this.relativeAnchorPoint2.copy(this.localAnchorPoint2).applyMatrix3(this.body2.rotation, true);

      this.anchorPoint1.add(this.relativeAnchorPoint1, this.body1.position);
      this.anchorPoint2.add(this.relativeAnchorPoint2, this.body2.position);

    },

    // Attach the joint from the bodies.

    attach: function (isX) {

      this.b1Link.body = this.body2;
      this.b2Link.body = this.body1;

      if (isX) {

        this.body1.jointLink.push(this.b1Link);
        this.body2.jointLink.push(this.b2Link);
      } else {

        if (this.body1.jointLink != null) (this.b1Link.next = this.body1.jointLink).prev = this.b1Link;
        else this.b1Link.next = null;
        this.body1.jointLink = this.b1Link;
        this.body1.numJoints++;
        if (this.body2.jointLink != null) (this.b2Link.next = this.body2.jointLink).prev = this.b2Link;
        else this.b2Link.next = null;
        this.body2.jointLink = this.b2Link;
        this.body2.numJoints++;

      }

    },

    // Detach the joint from the bodies.

    detach: function (isX) {

      if (isX) {

        this.body1.jointLink.splice(this.body1.jointLink.indexOf(this.b1Link), 1);
        this.body2.jointLink.splice(this.body2.jointLink.indexOf(this.b2Link), 1);

      } else {

        var prev = this.b1Link.prev;
        var next = this.b1Link.next;
        if (prev != null) prev.next = next;
        if (next != null) next.prev = prev;
        if (this.body1.jointLink == this.b1Link) this.body1.jointLink = next;
        this.b1Link.prev = null;
        this.b1Link.next = null;
        this.b1Link.body = null;
        this.body1.numJoints--;

        prev = this.b2Link.prev;
        next = this.b2Link.next;
        if (prev != null) prev.next = next;
        if (next != null) next.prev = prev;
        if (this.body2.jointLink == this.b2Link) this.body2.jointLink = next;
        this.b2Link.prev = null;
        this.b2Link.next = null;
        this.b2Link.body = null;
        this.body2.numJoints--;

      }

      this.b1Link.body = null;
      this.b2Link.body = null;

    },


    // Awake the bodies.

    awake: function () {

      this.body1.awake();
      this.body2.awake();

    },

    // calculation function

    preSolve: function (timeStep, invTimeStep) {

    },

    solve: function () {

    },

    postSolve: function () {

    },

    // Delete process

    remove: function () {

      this.dispose();

    },

    dispose: function () {

      this.parent.removeJoint(this);

    },


    // Three js add

    getPosition: function () {

      var p1 = new Vec3().scale(this.anchorPoint1, this.scale);
      var p2 = new Vec3().scale(this.anchorPoint2, this.scale);
      return [p1, p2];

    }

  });

  /**
  * A linear constraint for all axes for various joints.
  * @author saharan
  */
  function LinearConstraint(joint) {

    this.m1 = NaN;
    this.m2 = NaN;

    this.ii1 = null;
    this.ii2 = null;
    this.dd = null;

    this.r1x = NaN;
    this.r1y = NaN;
    this.r1z = NaN;

    this.r2x = NaN;
    this.r2y = NaN;
    this.r2z = NaN;

    this.ax1x = NaN;
    this.ax1y = NaN;
    this.ax1z = NaN;
    this.ay1x = NaN;
    this.ay1y = NaN;
    this.ay1z = NaN;
    this.az1x = NaN;
    this.az1y = NaN;
    this.az1z = NaN;

    this.ax2x = NaN;
    this.ax2y = NaN;
    this.ax2z = NaN;
    this.ay2x = NaN;
    this.ay2y = NaN;
    this.ay2z = NaN;
    this.az2x = NaN;
    this.az2y = NaN;
    this.az2z = NaN;

    this.vel = NaN;
    this.velx = NaN;
    this.vely = NaN;
    this.velz = NaN;


    this.joint = joint;
    this.r1 = joint.relativeAnchorPoint1;
    this.r2 = joint.relativeAnchorPoint2;
    this.p1 = joint.anchorPoint1;
    this.p2 = joint.anchorPoint2;
    this.b1 = joint.body1;
    this.b2 = joint.body2;
    this.l1 = this.b1.linearVelocity;
    this.l2 = this.b2.linearVelocity;
    this.a1 = this.b1.angularVelocity;
    this.a2 = this.b2.angularVelocity;
    this.i1 = this.b1.inverseInertia;
    this.i2 = this.b2.inverseInertia;
    this.impx = 0;
    this.impy = 0;
    this.impz = 0;

  }

  Object.assign(LinearConstraint.prototype, {

    LinearConstraint: true,

    preSolve: function (timeStep, invTimeStep) {

      this.r1x = this.r1.x;
      this.r1y = this.r1.y;
      this.r1z = this.r1.z;

      this.r2x = this.r2.x;
      this.r2y = this.r2.y;
      this.r2z = this.r2.z;

      this.m1 = this.b1.inverseMass;
      this.m2 = this.b2.inverseMass;

      this.ii1 = this.i1.clone();
      this.ii2 = this.i2.clone();

      var ii1 = this.ii1.elements;
      var ii2 = this.ii2.elements;

      this.ax1x = this.r1z * ii1[1] + -this.r1y * ii1[2];
      this.ax1y = this.r1z * ii1[4] + -this.r1y * ii1[5];
      this.ax1z = this.r1z * ii1[7] + -this.r1y * ii1[8];
      this.ay1x = -this.r1z * ii1[0] + this.r1x * ii1[2];
      this.ay1y = -this.r1z * ii1[3] + this.r1x * ii1[5];
      this.ay1z = -this.r1z * ii1[6] + this.r1x * ii1[8];
      this.az1x = this.r1y * ii1[0] + -this.r1x * ii1[1];
      this.az1y = this.r1y * ii1[3] + -this.r1x * ii1[4];
      this.az1z = this.r1y * ii1[6] + -this.r1x * ii1[7];
      this.ax2x = this.r2z * ii2[1] + -this.r2y * ii2[2];
      this.ax2y = this.r2z * ii2[4] + -this.r2y * ii2[5];
      this.ax2z = this.r2z * ii2[7] + -this.r2y * ii2[8];
      this.ay2x = -this.r2z * ii2[0] + this.r2x * ii2[2];
      this.ay2y = -this.r2z * ii2[3] + this.r2x * ii2[5];
      this.ay2z = -this.r2z * ii2[6] + this.r2x * ii2[8];
      this.az2x = this.r2y * ii2[0] + -this.r2x * ii2[1];
      this.az2y = this.r2y * ii2[3] + -this.r2x * ii2[4];
      this.az2z = this.r2y * ii2[6] + -this.r2x * ii2[7];

      // calculate point-to-point mass matrix
      // from impulse equation
      // 
      // M = ([/m] - [r^][/I][r^]) ^ -1
      // 
      // where
      // 
      // [/m] = |1/m, 0, 0|
      //        |0, 1/m, 0|
      //        |0, 0, 1/m|
      // 
      // [r^] = |0, -rz, ry|
      //        |rz, 0, -rx|
      //        |-ry, rx, 0|
      // 
      // [/I] = Inverted moment inertia

      var rxx = this.m1 + this.m2;

      var kk = new Mat33().set(rxx, 0, 0, 0, rxx, 0, 0, 0, rxx);
      var k = kk.elements;

      k[0] += ii1[4] * this.r1z * this.r1z - (ii1[7] + ii1[5]) * this.r1y * this.r1z + ii1[8] * this.r1y * this.r1y;
      k[1] += (ii1[6] * this.r1y + ii1[5] * this.r1x) * this.r1z - ii1[3] * this.r1z * this.r1z - ii1[8] * this.r1x * this.r1y;
      k[2] += (ii1[3] * this.r1y - ii1[4] * this.r1x) * this.r1z - ii1[6] * this.r1y * this.r1y + ii1[7] * this.r1x * this.r1y;
      k[3] += (ii1[2] * this.r1y + ii1[7] * this.r1x) * this.r1z - ii1[1] * this.r1z * this.r1z - ii1[8] * this.r1x * this.r1y;
      k[4] += ii1[0] * this.r1z * this.r1z - (ii1[6] + ii1[2]) * this.r1x * this.r1z + ii1[8] * this.r1x * this.r1x;
      k[5] += (ii1[1] * this.r1x - ii1[0] * this.r1y) * this.r1z - ii1[7] * this.r1x * this.r1x + ii1[6] * this.r1x * this.r1y;
      k[6] += (ii1[1] * this.r1y - ii1[4] * this.r1x) * this.r1z - ii1[2] * this.r1y * this.r1y + ii1[5] * this.r1x * this.r1y;
      k[7] += (ii1[3] * this.r1x - ii1[0] * this.r1y) * this.r1z - ii1[5] * this.r1x * this.r1x + ii1[2] * this.r1x * this.r1y;
      k[8] += ii1[0] * this.r1y * this.r1y - (ii1[3] + ii1[1]) * this.r1x * this.r1y + ii1[4] * this.r1x * this.r1x;

      k[0] += ii2[4] * this.r2z * this.r2z - (ii2[7] + ii2[5]) * this.r2y * this.r2z + ii2[8] * this.r2y * this.r2y;
      k[1] += (ii2[6] * this.r2y + ii2[5] * this.r2x) * this.r2z - ii2[3] * this.r2z * this.r2z - ii2[8] * this.r2x * this.r2y;
      k[2] += (ii2[3] * this.r2y - ii2[4] * this.r2x) * this.r2z - ii2[6] * this.r2y * this.r2y + ii2[7] * this.r2x * this.r2y;
      k[3] += (ii2[2] * this.r2y + ii2[7] * this.r2x) * this.r2z - ii2[1] * this.r2z * this.r2z - ii2[8] * this.r2x * this.r2y;
      k[4] += ii2[0] * this.r2z * this.r2z - (ii2[6] + ii2[2]) * this.r2x * this.r2z + ii2[8] * this.r2x * this.r2x;
      k[5] += (ii2[1] * this.r2x - ii2[0] * this.r2y) * this.r2z - ii2[7] * this.r2x * this.r2x + ii2[6] * this.r2x * this.r2y;
      k[6] += (ii2[1] * this.r2y - ii2[4] * this.r2x) * this.r2z - ii2[2] * this.r2y * this.r2y + ii2[5] * this.r2x * this.r2y;
      k[7] += (ii2[3] * this.r2x - ii2[0] * this.r2y) * this.r2z - ii2[5] * this.r2x * this.r2x + ii2[2] * this.r2x * this.r2y;
      k[8] += ii2[0] * this.r2y * this.r2y - (ii2[3] + ii2[1]) * this.r2x * this.r2y + ii2[4] * this.r2x * this.r2x;

      var inv = 1 / (k[0] * (k[4] * k[8] - k[7] * k[5]) + k[3] * (k[7] * k[2] - k[1] * k[8]) + k[6] * (k[1] * k[5] - k[4] * k[2]));
      this.dd = new Mat33().set(
        k[4] * k[8] - k[5] * k[7], k[2] * k[7] - k[1] * k[8], k[1] * k[5] - k[2] * k[4],
        k[5] * k[6] - k[3] * k[8], k[0] * k[8] - k[2] * k[6], k[2] * k[3] - k[0] * k[5],
        k[3] * k[7] - k[4] * k[6], k[1] * k[6] - k[0] * k[7], k[0] * k[4] - k[1] * k[3]
      ).scaleEqual(inv);

      this.velx = this.p2.x - this.p1.x;
      this.vely = this.p2.y - this.p1.y;
      this.velz = this.p2.z - this.p1.z;
      var len = _Math.sqrt(this.velx * this.velx + this.vely * this.vely + this.velz * this.velz);
      if (len > 0.005) {
        len = (0.005 - len) / len * invTimeStep * 0.05;
        this.velx *= len;
        this.vely *= len;
        this.velz *= len;
      } else {
        this.velx = 0;
        this.vely = 0;
        this.velz = 0;
      }

      this.impx *= 0.95;
      this.impy *= 0.95;
      this.impz *= 0.95;

      this.l1.x += this.impx * this.m1;
      this.l1.y += this.impy * this.m1;
      this.l1.z += this.impz * this.m1;
      this.a1.x += this.impx * this.ax1x + this.impy * this.ay1x + this.impz * this.az1x;
      this.a1.y += this.impx * this.ax1y + this.impy * this.ay1y + this.impz * this.az1y;
      this.a1.z += this.impx * this.ax1z + this.impy * this.ay1z + this.impz * this.az1z;
      this.l2.x -= this.impx * this.m2;
      this.l2.y -= this.impy * this.m2;
      this.l2.z -= this.impz * this.m2;
      this.a2.x -= this.impx * this.ax2x + this.impy * this.ay2x + this.impz * this.az2x;
      this.a2.y -= this.impx * this.ax2y + this.impy * this.ay2y + this.impz * this.az2y;
      this.a2.z -= this.impx * this.ax2z + this.impy * this.ay2z + this.impz * this.az2z;
    },

    solve: function () {

      var d = this.dd.elements;
      var rvx = this.l2.x - this.l1.x + this.a2.y * this.r2z - this.a2.z * this.r2y - this.a1.y * this.r1z + this.a1.z * this.r1y - this.velx;
      var rvy = this.l2.y - this.l1.y + this.a2.z * this.r2x - this.a2.x * this.r2z - this.a1.z * this.r1x + this.a1.x * this.r1z - this.vely;
      var rvz = this.l2.z - this.l1.z + this.a2.x * this.r2y - this.a2.y * this.r2x - this.a1.x * this.r1y + this.a1.y * this.r1x - this.velz;
      var nimpx = rvx * d[0] + rvy * d[1] + rvz * d[2];
      var nimpy = rvx * d[3] + rvy * d[4] + rvz * d[5];
      var nimpz = rvx * d[6] + rvy * d[7] + rvz * d[8];
      this.impx += nimpx;
      this.impy += nimpy;
      this.impz += nimpz;
      this.l1.x += nimpx * this.m1;
      this.l1.y += nimpy * this.m1;
      this.l1.z += nimpz * this.m1;
      this.a1.x += nimpx * this.ax1x + nimpy * this.ay1x + nimpz * this.az1x;
      this.a1.y += nimpx * this.ax1y + nimpy * this.ay1y + nimpz * this.az1y;
      this.a1.z += nimpx * this.ax1z + nimpy * this.ay1z + nimpz * this.az1z;
      this.l2.x -= nimpx * this.m2;
      this.l2.y -= nimpy * this.m2;
      this.l2.z -= nimpz * this.m2;
      this.a2.x -= nimpx * this.ax2x + nimpy * this.ay2x + nimpz * this.az2x;
      this.a2.y -= nimpx * this.ax2y + nimpy * this.ay2y + nimpz * this.az2y;
      this.a2.z -= nimpx * this.ax2z + nimpy * this.ay2z + nimpz * this.az2z;

    }

  });

  /**
  * A three-axis rotational constraint for various joints.
  * @author saharan
  */

  function Rotational3Constraint(joint, limitMotor1, limitMotor2, limitMotor3) {

    this.cfm1 = NaN;
    this.cfm2 = NaN;
    this.cfm3 = NaN;
    this.i1e00 = NaN;
    this.i1e01 = NaN;
    this.i1e02 = NaN;
    this.i1e10 = NaN;
    this.i1e11 = NaN;
    this.i1e12 = NaN;
    this.i1e20 = NaN;
    this.i1e21 = NaN;
    this.i1e22 = NaN;
    this.i2e00 = NaN;
    this.i2e01 = NaN;
    this.i2e02 = NaN;
    this.i2e10 = NaN;
    this.i2e11 = NaN;
    this.i2e12 = NaN;
    this.i2e20 = NaN;
    this.i2e21 = NaN;
    this.i2e22 = NaN;
    this.ax1 = NaN;
    this.ay1 = NaN;
    this.az1 = NaN;
    this.ax2 = NaN;
    this.ay2 = NaN;
    this.az2 = NaN;
    this.ax3 = NaN;
    this.ay3 = NaN;
    this.az3 = NaN;

    this.a1x1 = NaN; // jacoians
    this.a1y1 = NaN;
    this.a1z1 = NaN;
    this.a2x1 = NaN;
    this.a2y1 = NaN;
    this.a2z1 = NaN;
    this.a1x2 = NaN;
    this.a1y2 = NaN;
    this.a1z2 = NaN;
    this.a2x2 = NaN;
    this.a2y2 = NaN;
    this.a2z2 = NaN;
    this.a1x3 = NaN;
    this.a1y3 = NaN;
    this.a1z3 = NaN;
    this.a2x3 = NaN;
    this.a2y3 = NaN;
    this.a2z3 = NaN;

    this.lowerLimit1 = NaN;
    this.upperLimit1 = NaN;
    this.limitVelocity1 = NaN;
    this.limitState1 = 0; // -1: at lower, 0: locked, 1: at upper, 2: free
    this.enableMotor1 = false;
    this.motorSpeed1 = NaN;
    this.maxMotorForce1 = NaN;
    this.maxMotorImpulse1 = NaN;
    this.lowerLimit2 = NaN;
    this.upperLimit2 = NaN;
    this.limitVelocity2 = NaN;
    this.limitState2 = 0; // -1: at lower, 0: locked, 1: at upper, 2: free
    this.enableMotor2 = false;
    this.motorSpeed2 = NaN;
    this.maxMotorForce2 = NaN;
    this.maxMotorImpulse2 = NaN;
    this.lowerLimit3 = NaN;
    this.upperLimit3 = NaN;
    this.limitVelocity3 = NaN;
    this.limitState3 = 0; // -1: at lower, 0: locked, 1: at upper, 2: free
    this.enableMotor3 = false;
    this.motorSpeed3 = NaN;
    this.maxMotorForce3 = NaN;
    this.maxMotorImpulse3 = NaN;

    this.k00 = NaN; // K = J*M*JT
    this.k01 = NaN;
    this.k02 = NaN;
    this.k10 = NaN;
    this.k11 = NaN;
    this.k12 = NaN;
    this.k20 = NaN;
    this.k21 = NaN;
    this.k22 = NaN;

    this.kv00 = NaN; // diagonals without CFMs
    this.kv11 = NaN;
    this.kv22 = NaN;

    this.dv00 = NaN; // ...inverted
    this.dv11 = NaN;
    this.dv22 = NaN;

    this.d00 = NaN;  // K^-1
    this.d01 = NaN;
    this.d02 = NaN;
    this.d10 = NaN;
    this.d11 = NaN;
    this.d12 = NaN;
    this.d20 = NaN;
    this.d21 = NaN;
    this.d22 = NaN;

    this.limitMotor1 = limitMotor1;
    this.limitMotor2 = limitMotor2;
    this.limitMotor3 = limitMotor3;
    this.b1 = joint.body1;
    this.b2 = joint.body2;
    this.a1 = this.b1.angularVelocity;
    this.a2 = this.b2.angularVelocity;
    this.i1 = this.b1.inverseInertia;
    this.i2 = this.b2.inverseInertia;
    this.limitImpulse1 = 0;
    this.motorImpulse1 = 0;
    this.limitImpulse2 = 0;
    this.motorImpulse2 = 0;
    this.limitImpulse3 = 0;
    this.motorImpulse3 = 0;

  }

  Object.assign(Rotational3Constraint.prototype, {

    Rotational3Constraint: true,

    preSolve: function (timeStep, invTimeStep) {

      this.ax1 = this.limitMotor1.axis.x;
      this.ay1 = this.limitMotor1.axis.y;
      this.az1 = this.limitMotor1.axis.z;
      this.ax2 = this.limitMotor2.axis.x;
      this.ay2 = this.limitMotor2.axis.y;
      this.az2 = this.limitMotor2.axis.z;
      this.ax3 = this.limitMotor3.axis.x;
      this.ay3 = this.limitMotor3.axis.y;
      this.az3 = this.limitMotor3.axis.z;
      this.lowerLimit1 = this.limitMotor1.lowerLimit;
      this.upperLimit1 = this.limitMotor1.upperLimit;
      this.motorSpeed1 = this.limitMotor1.motorSpeed;
      this.maxMotorForce1 = this.limitMotor1.maxMotorForce;
      this.enableMotor1 = this.maxMotorForce1 > 0;
      this.lowerLimit2 = this.limitMotor2.lowerLimit;
      this.upperLimit2 = this.limitMotor2.upperLimit;
      this.motorSpeed2 = this.limitMotor2.motorSpeed;
      this.maxMotorForce2 = this.limitMotor2.maxMotorForce;
      this.enableMotor2 = this.maxMotorForce2 > 0;
      this.lowerLimit3 = this.limitMotor3.lowerLimit;
      this.upperLimit3 = this.limitMotor3.upperLimit;
      this.motorSpeed3 = this.limitMotor3.motorSpeed;
      this.maxMotorForce3 = this.limitMotor3.maxMotorForce;
      this.enableMotor3 = this.maxMotorForce3 > 0;

      var ti1 = this.i1.elements;
      var ti2 = this.i2.elements;
      this.i1e00 = ti1[0];
      this.i1e01 = ti1[1];
      this.i1e02 = ti1[2];
      this.i1e10 = ti1[3];
      this.i1e11 = ti1[4];
      this.i1e12 = ti1[5];
      this.i1e20 = ti1[6];
      this.i1e21 = ti1[7];
      this.i1e22 = ti1[8];

      this.i2e00 = ti2[0];
      this.i2e01 = ti2[1];
      this.i2e02 = ti2[2];
      this.i2e10 = ti2[3];
      this.i2e11 = ti2[4];
      this.i2e12 = ti2[5];
      this.i2e20 = ti2[6];
      this.i2e21 = ti2[7];
      this.i2e22 = ti2[8];

      var frequency1 = this.limitMotor1.frequency;
      var frequency2 = this.limitMotor2.frequency;
      var frequency3 = this.limitMotor3.frequency;
      var enableSpring1 = frequency1 > 0;
      var enableSpring2 = frequency2 > 0;
      var enableSpring3 = frequency3 > 0;
      var enableLimit1 = this.lowerLimit1 <= this.upperLimit1;
      var enableLimit2 = this.lowerLimit2 <= this.upperLimit2;
      var enableLimit3 = this.lowerLimit3 <= this.upperLimit3;
      var angle1 = this.limitMotor1.angle;
      if (enableLimit1) {
        if (this.lowerLimit1 == this.upperLimit1) {
          if (this.limitState1 != 0) {
            this.limitState1 = 0;
            this.limitImpulse1 = 0;
          }
          this.limitVelocity1 = this.lowerLimit1 - angle1;
        } else if (angle1 < this.lowerLimit1) {
          if (this.limitState1 != -1) {
            this.limitState1 = -1;
            this.limitImpulse1 = 0;
          }
          this.limitVelocity1 = this.lowerLimit1 - angle1;
        } else if (angle1 > this.upperLimit1) {
          if (this.limitState1 != 1) {
            this.limitState1 = 1;
            this.limitImpulse1 = 0;
          }
          this.limitVelocity1 = this.upperLimit1 - angle1;
        } else {
          this.limitState1 = 2;
          this.limitImpulse1 = 0;
          this.limitVelocity1 = 0;
        }
        if (!enableSpring1) {
          if (this.limitVelocity1 > 0.02) this.limitVelocity1 -= 0.02;
          else if (this.limitVelocity1 < -0.02) this.limitVelocity1 += 0.02;
          else this.limitVelocity1 = 0;
        }
      } else {
        this.limitState1 = 2;
        this.limitImpulse1 = 0;
      }

      var angle2 = this.limitMotor2.angle;
      if (enableLimit2) {
        if (this.lowerLimit2 == this.upperLimit2) {
          if (this.limitState2 != 0) {
            this.limitState2 = 0;
            this.limitImpulse2 = 0;
          }
          this.limitVelocity2 = this.lowerLimit2 - angle2;
        } else if (angle2 < this.lowerLimit2) {
          if (this.limitState2 != -1) {
            this.limitState2 = -1;
            this.limitImpulse2 = 0;
          }
          this.limitVelocity2 = this.lowerLimit2 - angle2;
        } else if (angle2 > this.upperLimit2) {
          if (this.limitState2 != 1) {
            this.limitState2 = 1;
            this.limitImpulse2 = 0;
          }
          this.limitVelocity2 = this.upperLimit2 - angle2;
        } else {
          this.limitState2 = 2;
          this.limitImpulse2 = 0;
          this.limitVelocity2 = 0;
        }
        if (!enableSpring2) {
          if (this.limitVelocity2 > 0.02) this.limitVelocity2 -= 0.02;
          else if (this.limitVelocity2 < -0.02) this.limitVelocity2 += 0.02;
          else this.limitVelocity2 = 0;
        }
      } else {
        this.limitState2 = 2;
        this.limitImpulse2 = 0;
      }

      var angle3 = this.limitMotor3.angle;
      if (enableLimit3) {
        if (this.lowerLimit3 == this.upperLimit3) {
          if (this.limitState3 != 0) {
            this.limitState3 = 0;
            this.limitImpulse3 = 0;
          }
          this.limitVelocity3 = this.lowerLimit3 - angle3;
        } else if (angle3 < this.lowerLimit3) {
          if (this.limitState3 != -1) {
            this.limitState3 = -1;
            this.limitImpulse3 = 0;
          }
          this.limitVelocity3 = this.lowerLimit3 - angle3;
        } else if (angle3 > this.upperLimit3) {
          if (this.limitState3 != 1) {
            this.limitState3 = 1;
            this.limitImpulse3 = 0;
          }
          this.limitVelocity3 = this.upperLimit3 - angle3;
        } else {
          this.limitState3 = 2;
          this.limitImpulse3 = 0;
          this.limitVelocity3 = 0;
        }
        if (!enableSpring3) {
          if (this.limitVelocity3 > 0.02) this.limitVelocity3 -= 0.02;
          else if (this.limitVelocity3 < -0.02) this.limitVelocity3 += 0.02;
          else this.limitVelocity3 = 0;
        }
      } else {
        this.limitState3 = 2;
        this.limitImpulse3 = 0;
      }

      if (this.enableMotor1 && (this.limitState1 != 0 || enableSpring1)) {
        this.maxMotorImpulse1 = this.maxMotorForce1 * timeStep;
      } else {
        this.motorImpulse1 = 0;
        this.maxMotorImpulse1 = 0;
      }
      if (this.enableMotor2 && (this.limitState2 != 0 || enableSpring2)) {
        this.maxMotorImpulse2 = this.maxMotorForce2 * timeStep;
      } else {
        this.motorImpulse2 = 0;
        this.maxMotorImpulse2 = 0;
      }
      if (this.enableMotor3 && (this.limitState3 != 0 || enableSpring3)) {
        this.maxMotorImpulse3 = this.maxMotorForce3 * timeStep;
      } else {
        this.motorImpulse3 = 0;
        this.maxMotorImpulse3 = 0;
      }

      // build jacobians
      this.a1x1 = this.ax1 * this.i1e00 + this.ay1 * this.i1e01 + this.az1 * this.i1e02;
      this.a1y1 = this.ax1 * this.i1e10 + this.ay1 * this.i1e11 + this.az1 * this.i1e12;
      this.a1z1 = this.ax1 * this.i1e20 + this.ay1 * this.i1e21 + this.az1 * this.i1e22;
      this.a2x1 = this.ax1 * this.i2e00 + this.ay1 * this.i2e01 + this.az1 * this.i2e02;
      this.a2y1 = this.ax1 * this.i2e10 + this.ay1 * this.i2e11 + this.az1 * this.i2e12;
      this.a2z1 = this.ax1 * this.i2e20 + this.ay1 * this.i2e21 + this.az1 * this.i2e22;

      this.a1x2 = this.ax2 * this.i1e00 + this.ay2 * this.i1e01 + this.az2 * this.i1e02;
      this.a1y2 = this.ax2 * this.i1e10 + this.ay2 * this.i1e11 + this.az2 * this.i1e12;
      this.a1z2 = this.ax2 * this.i1e20 + this.ay2 * this.i1e21 + this.az2 * this.i1e22;
      this.a2x2 = this.ax2 * this.i2e00 + this.ay2 * this.i2e01 + this.az2 * this.i2e02;
      this.a2y2 = this.ax2 * this.i2e10 + this.ay2 * this.i2e11 + this.az2 * this.i2e12;
      this.a2z2 = this.ax2 * this.i2e20 + this.ay2 * this.i2e21 + this.az2 * this.i2e22;

      this.a1x3 = this.ax3 * this.i1e00 + this.ay3 * this.i1e01 + this.az3 * this.i1e02;
      this.a1y3 = this.ax3 * this.i1e10 + this.ay3 * this.i1e11 + this.az3 * this.i1e12;
      this.a1z3 = this.ax3 * this.i1e20 + this.ay3 * this.i1e21 + this.az3 * this.i1e22;
      this.a2x3 = this.ax3 * this.i2e00 + this.ay3 * this.i2e01 + this.az3 * this.i2e02;
      this.a2y3 = this.ax3 * this.i2e10 + this.ay3 * this.i2e11 + this.az3 * this.i2e12;
      this.a2z3 = this.ax3 * this.i2e20 + this.ay3 * this.i2e21 + this.az3 * this.i2e22;

      // build an impulse matrix
      this.k00 = this.ax1 * (this.a1x1 + this.a2x1) + this.ay1 * (this.a1y1 + this.a2y1) + this.az1 * (this.a1z1 + this.a2z1);
      this.k01 = this.ax1 * (this.a1x2 + this.a2x2) + this.ay1 * (this.a1y2 + this.a2y2) + this.az1 * (this.a1z2 + this.a2z2);
      this.k02 = this.ax1 * (this.a1x3 + this.a2x3) + this.ay1 * (this.a1y3 + this.a2y3) + this.az1 * (this.a1z3 + this.a2z3);
      this.k10 = this.ax2 * (this.a1x1 + this.a2x1) + this.ay2 * (this.a1y1 + this.a2y1) + this.az2 * (this.a1z1 + this.a2z1);
      this.k11 = this.ax2 * (this.a1x2 + this.a2x2) + this.ay2 * (this.a1y2 + this.a2y2) + this.az2 * (this.a1z2 + this.a2z2);
      this.k12 = this.ax2 * (this.a1x3 + this.a2x3) + this.ay2 * (this.a1y3 + this.a2y3) + this.az2 * (this.a1z3 + this.a2z3);
      this.k20 = this.ax3 * (this.a1x1 + this.a2x1) + this.ay3 * (this.a1y1 + this.a2y1) + this.az3 * (this.a1z1 + this.a2z1);
      this.k21 = this.ax3 * (this.a1x2 + this.a2x2) + this.ay3 * (this.a1y2 + this.a2y2) + this.az3 * (this.a1z2 + this.a2z2);
      this.k22 = this.ax3 * (this.a1x3 + this.a2x3) + this.ay3 * (this.a1y3 + this.a2y3) + this.az3 * (this.a1z3 + this.a2z3);

      this.kv00 = this.k00;
      this.kv11 = this.k11;
      this.kv22 = this.k22;
      this.dv00 = 1 / this.kv00;
      this.dv11 = 1 / this.kv11;
      this.dv22 = 1 / this.kv22;

      if (enableSpring1 && this.limitState1 != 2) {
        var omega = 6.2831853 * frequency1;
        var k = omega * omega * timeStep;
        var dmp = invTimeStep / (k + 2 * this.limitMotor1.dampingRatio * omega);
        this.cfm1 = this.kv00 * dmp;
        this.limitVelocity1 *= k * dmp;
      } else {
        this.cfm1 = 0;
        this.limitVelocity1 *= invTimeStep * 0.05;
      }

      if (enableSpring2 && this.limitState2 != 2) {
        omega = 6.2831853 * frequency2;
        k = omega * omega * timeStep;
        dmp = invTimeStep / (k + 2 * this.limitMotor2.dampingRatio * omega);
        this.cfm2 = this.kv11 * dmp;
        this.limitVelocity2 *= k * dmp;
      } else {
        this.cfm2 = 0;
        this.limitVelocity2 *= invTimeStep * 0.05;
      }

      if (enableSpring3 && this.limitState3 != 2) {
        omega = 6.2831853 * frequency3;
        k = omega * omega * timeStep;
        dmp = invTimeStep / (k + 2 * this.limitMotor3.dampingRatio * omega);
        this.cfm3 = this.kv22 * dmp;
        this.limitVelocity3 *= k * dmp;
      } else {
        this.cfm3 = 0;
        this.limitVelocity3 *= invTimeStep * 0.05;
      }

      this.k00 += this.cfm1;
      this.k11 += this.cfm2;
      this.k22 += this.cfm3;

      var inv = 1 / (
        this.k00 * (this.k11 * this.k22 - this.k21 * this.k12) +
        this.k10 * (this.k21 * this.k02 - this.k01 * this.k22) +
        this.k20 * (this.k01 * this.k12 - this.k11 * this.k02)
      );
      this.d00 = (this.k11 * this.k22 - this.k12 * this.k21) * inv;
      this.d01 = (this.k02 * this.k21 - this.k01 * this.k22) * inv;
      this.d02 = (this.k01 * this.k12 - this.k02 * this.k11) * inv;
      this.d10 = (this.k12 * this.k20 - this.k10 * this.k22) * inv;
      this.d11 = (this.k00 * this.k22 - this.k02 * this.k20) * inv;
      this.d12 = (this.k02 * this.k10 - this.k00 * this.k12) * inv;
      this.d20 = (this.k10 * this.k21 - this.k11 * this.k20) * inv;
      this.d21 = (this.k01 * this.k20 - this.k00 * this.k21) * inv;
      this.d22 = (this.k00 * this.k11 - this.k01 * this.k10) * inv;

      this.limitImpulse1 *= 0.95;
      this.motorImpulse1 *= 0.95;
      this.limitImpulse2 *= 0.95;
      this.motorImpulse2 *= 0.95;
      this.limitImpulse3 *= 0.95;
      this.motorImpulse3 *= 0.95;
      var totalImpulse1 = this.limitImpulse1 + this.motorImpulse1;
      var totalImpulse2 = this.limitImpulse2 + this.motorImpulse2;
      var totalImpulse3 = this.limitImpulse3 + this.motorImpulse3;
      this.a1.x += totalImpulse1 * this.a1x1 + totalImpulse2 * this.a1x2 + totalImpulse3 * this.a1x3;
      this.a1.y += totalImpulse1 * this.a1y1 + totalImpulse2 * this.a1y2 + totalImpulse3 * this.a1y3;
      this.a1.z += totalImpulse1 * this.a1z1 + totalImpulse2 * this.a1z2 + totalImpulse3 * this.a1z3;
      this.a2.x -= totalImpulse1 * this.a2x1 + totalImpulse2 * this.a2x2 + totalImpulse3 * this.a2x3;
      this.a2.y -= totalImpulse1 * this.a2y1 + totalImpulse2 * this.a2y2 + totalImpulse3 * this.a2y3;
      this.a2.z -= totalImpulse1 * this.a2z1 + totalImpulse2 * this.a2z2 + totalImpulse3 * this.a2z3;
    },
    solve_: function () {

      var rvx = this.a2.x - this.a1.x;
      var rvy = this.a2.y - this.a1.y;
      var rvz = this.a2.z - this.a1.z;

      this.limitVelocity3 = 30;
      var rvn1 = rvx * this.ax1 + rvy * this.ay1 + rvz * this.az1 - this.limitVelocity1;
      var rvn2 = rvx * this.ax2 + rvy * this.ay2 + rvz * this.az2 - this.limitVelocity2;
      var rvn3 = rvx * this.ax3 + rvy * this.ay3 + rvz * this.az3 - this.limitVelocity3;

      var dLimitImpulse1 = rvn1 * this.d00 + rvn2 * this.d01 + rvn3 * this.d02;
      var dLimitImpulse2 = rvn1 * this.d10 + rvn2 * this.d11 + rvn3 * this.d12;
      var dLimitImpulse3 = rvn1 * this.d20 + rvn2 * this.d21 + rvn3 * this.d22;

      this.limitImpulse1 += dLimitImpulse1;
      this.limitImpulse2 += dLimitImpulse2;
      this.limitImpulse3 += dLimitImpulse3;

      this.a1.x += dLimitImpulse1 * this.a1x1 + dLimitImpulse2 * this.a1x2 + dLimitImpulse3 * this.a1x3;
      this.a1.y += dLimitImpulse1 * this.a1y1 + dLimitImpulse2 * this.a1y2 + dLimitImpulse3 * this.a1y3;
      this.a1.z += dLimitImpulse1 * this.a1z1 + dLimitImpulse2 * this.a1z2 + dLimitImpulse3 * this.a1z3;
      this.a2.x -= dLimitImpulse1 * this.a2x1 + dLimitImpulse2 * this.a2x2 + dLimitImpulse3 * this.a2x3;
      this.a2.y -= dLimitImpulse1 * this.a2y1 + dLimitImpulse2 * this.a2y2 + dLimitImpulse3 * this.a2y3;
      this.a2.z -= dLimitImpulse1 * this.a2z1 + dLimitImpulse2 * this.a2z2 + dLimitImpulse3 * this.a2z3;
    },
    solve: function () {

      var rvx = this.a2.x - this.a1.x;
      var rvy = this.a2.y - this.a1.y;
      var rvz = this.a2.z - this.a1.z;

      var rvn1 = rvx * this.ax1 + rvy * this.ay1 + rvz * this.az1;
      var rvn2 = rvx * this.ax2 + rvy * this.ay2 + rvz * this.az2;
      var rvn3 = rvx * this.ax3 + rvy * this.ay3 + rvz * this.az3;

      var oldMotorImpulse1 = this.motorImpulse1;
      var oldMotorImpulse2 = this.motorImpulse2;
      var oldMotorImpulse3 = this.motorImpulse3;

      var dMotorImpulse1 = 0;
      var dMotorImpulse2 = 0;
      var dMotorImpulse3 = 0;

      if (this.enableMotor1) {
        dMotorImpulse1 = (rvn1 - this.motorSpeed1) * this.dv00;
        this.motorImpulse1 += dMotorImpulse1;
        if (this.motorImpulse1 > this.maxMotorImpulse1) { // clamp motor impulse
          this.motorImpulse1 = this.maxMotorImpulse1;
        } else if (this.motorImpulse1 < -this.maxMotorImpulse1) {
          this.motorImpulse1 = -this.maxMotorImpulse1;
        }
        dMotorImpulse1 = this.motorImpulse1 - oldMotorImpulse1;
      }
      if (this.enableMotor2) {
        dMotorImpulse2 = (rvn2 - this.motorSpeed2) * this.dv11;
        this.motorImpulse2 += dMotorImpulse2;
        if (this.motorImpulse2 > this.maxMotorImpulse2) { // clamp motor impulse
          this.motorImpulse2 = this.maxMotorImpulse2;
        } else if (this.motorImpulse2 < -this.maxMotorImpulse2) {
          this.motorImpulse2 = -this.maxMotorImpulse2;
        }
        dMotorImpulse2 = this.motorImpulse2 - oldMotorImpulse2;
      }
      if (this.enableMotor3) {
        dMotorImpulse3 = (rvn3 - this.motorSpeed3) * this.dv22;
        this.motorImpulse3 += dMotorImpulse3;
        if (this.motorImpulse3 > this.maxMotorImpulse3) { // clamp motor impulse
          this.motorImpulse3 = this.maxMotorImpulse3;
        } else if (this.motorImpulse3 < -this.maxMotorImpulse3) {
          this.motorImpulse3 = -this.maxMotorImpulse3;
        }
        dMotorImpulse3 = this.motorImpulse3 - oldMotorImpulse3;
      }

      // apply motor impulse to relative velocity
      rvn1 += dMotorImpulse1 * this.kv00 + dMotorImpulse2 * this.k01 + dMotorImpulse3 * this.k02;
      rvn2 += dMotorImpulse1 * this.k10 + dMotorImpulse2 * this.kv11 + dMotorImpulse3 * this.k12;
      rvn3 += dMotorImpulse1 * this.k20 + dMotorImpulse2 * this.k21 + dMotorImpulse3 * this.kv22;

      // subtract target velocity and applied impulse
      rvn1 -= this.limitVelocity1 + this.limitImpulse1 * this.cfm1;
      rvn2 -= this.limitVelocity2 + this.limitImpulse2 * this.cfm2;
      rvn3 -= this.limitVelocity3 + this.limitImpulse3 * this.cfm3;

      var oldLimitImpulse1 = this.limitImpulse1;
      var oldLimitImpulse2 = this.limitImpulse2;
      var oldLimitImpulse3 = this.limitImpulse3;

      var dLimitImpulse1 = rvn1 * this.d00 + rvn2 * this.d01 + rvn3 * this.d02;
      var dLimitImpulse2 = rvn1 * this.d10 + rvn2 * this.d11 + rvn3 * this.d12;
      var dLimitImpulse3 = rvn1 * this.d20 + rvn2 * this.d21 + rvn3 * this.d22;

      this.limitImpulse1 += dLimitImpulse1;
      this.limitImpulse2 += dLimitImpulse2;
      this.limitImpulse3 += dLimitImpulse3;

      // clamp
      var clampState = 0;
      if (this.limitState1 == 2 || this.limitImpulse1 * this.limitState1 < 0) {
        dLimitImpulse1 = -oldLimitImpulse1;
        rvn2 += dLimitImpulse1 * this.k10;
        rvn3 += dLimitImpulse1 * this.k20;
        clampState |= 1;
      }
      if (this.limitState2 == 2 || this.limitImpulse2 * this.limitState2 < 0) {
        dLimitImpulse2 = -oldLimitImpulse2;
        rvn1 += dLimitImpulse2 * this.k01;
        rvn3 += dLimitImpulse2 * this.k21;
        clampState |= 2;
      }
      if (this.limitState3 == 2 || this.limitImpulse3 * this.limitState3 < 0) {
        dLimitImpulse3 = -oldLimitImpulse3;
        rvn1 += dLimitImpulse3 * this.k02;
        rvn2 += dLimitImpulse3 * this.k12;
        clampState |= 4;
      }

      // update un-clamped impulse
      // TODO: isolate division
      var det;
      switch (clampState) {
        case 1: // update 2 3
          det = 1 / (this.k11 * this.k22 - this.k12 * this.k21);
          dLimitImpulse2 = (this.k22 * rvn2 + -this.k12 * rvn3) * det;
          dLimitImpulse3 = (-this.k21 * rvn2 + this.k11 * rvn3) * det;
          break;
        case 2: // update 1 3
          det = 1 / (this.k00 * this.k22 - this.k02 * this.k20);
          dLimitImpulse1 = (this.k22 * rvn1 + -this.k02 * rvn3) * det;
          dLimitImpulse3 = (-this.k20 * rvn1 + this.k00 * rvn3) * det;
          break;
        case 3: // update 3
          dLimitImpulse3 = rvn3 / this.k22;
          break;
        case 4: // update 1 2
          det = 1 / (this.k00 * this.k11 - this.k01 * this.k10);
          dLimitImpulse1 = (this.k11 * rvn1 + -this.k01 * rvn2) * det;
          dLimitImpulse2 = (-this.k10 * rvn1 + this.k00 * rvn2) * det;
          break;
        case 5: // update 2
          dLimitImpulse2 = rvn2 / this.k11;
          break;
        case 6: // update 1
          dLimitImpulse1 = rvn1 / this.k00;
          break;
      }

      this.limitImpulse1 = dLimitImpulse1 + oldLimitImpulse1;
      this.limitImpulse2 = dLimitImpulse2 + oldLimitImpulse2;
      this.limitImpulse3 = dLimitImpulse3 + oldLimitImpulse3;

      var dImpulse1 = dMotorImpulse1 + dLimitImpulse1;
      var dImpulse2 = dMotorImpulse2 + dLimitImpulse2;
      var dImpulse3 = dMotorImpulse3 + dLimitImpulse3;

      // apply impulse
      this.a1.x += dImpulse1 * this.a1x1 + dImpulse2 * this.a1x2 + dImpulse3 * this.a1x3;
      this.a1.y += dImpulse1 * this.a1y1 + dImpulse2 * this.a1y2 + dImpulse3 * this.a1y3;
      this.a1.z += dImpulse1 * this.a1z1 + dImpulse2 * this.a1z2 + dImpulse3 * this.a1z3;
      this.a2.x -= dImpulse1 * this.a2x1 + dImpulse2 * this.a2x2 + dImpulse3 * this.a2x3;
      this.a2.y -= dImpulse1 * this.a2y1 + dImpulse2 * this.a2y2 + dImpulse3 * this.a2y3;
      this.a2.z -= dImpulse1 * this.a2z1 + dImpulse2 * this.a2z2 + dImpulse3 * this.a2z3;
      rvx = this.a2.x - this.a1.x;
      rvy = this.a2.y - this.a1.y;
      rvz = this.a2.z - this.a1.z;

      rvn2 = rvx * this.ax2 + rvy * this.ay2 + rvz * this.az2;
    }

  });

  /**
   * A hinge joint allows only for relative rotation of rigid bodies along the axis.
   *
   * @author saharan
   * @author lo-th
   */

  function HingeJoint(config, lowerAngleLimit, upperAngleLimit) {

    Joint.call(this, config);

    this.type = JOINT_HINGE;

    // The axis in the first body's coordinate system.
    this.localAxis1 = config.localAxis1.clone().normalize();
    // The axis in the second body's coordinate system.
    this.localAxis2 = config.localAxis2.clone().normalize();

    // make angle axis
    var arc = new Mat33().setQuat(new Quat().setFromUnitVectors(this.localAxis1, this.localAxis2));
    this.localAngle1 = new Vec3().tangent(this.localAxis1).normalize();
    this.localAngle2 = this.localAngle1.clone().applyMatrix3(arc, true);

    this.ax1 = new Vec3();
    this.ax2 = new Vec3();
    this.an1 = new Vec3();
    this.an2 = new Vec3();

    this.tmp = new Vec3();

    this.nor = new Vec3();
    this.tan = new Vec3();
    this.bin = new Vec3();

    // The rotational limit and motor information of the joint.
    this.limitMotor = new LimitMotor(this.nor, false);
    this.limitMotor.lowerLimit = lowerAngleLimit;
    this.limitMotor.upperLimit = upperAngleLimit;

    this.lc = new LinearConstraint(this);
    this.r3 = new Rotational3Constraint(this, this.limitMotor, new LimitMotor(this.tan, true), new LimitMotor(this.bin, true));
  }
  HingeJoint.prototype = Object.assign(Object.create(Joint.prototype), {

    constructor: HingeJoint,


    preSolve: function (timeStep, invTimeStep) {

      this.updateAnchorPoints();

      this.ax1.copy(this.localAxis1).applyMatrix3(this.body1.rotation, true);
      this.ax2.copy(this.localAxis2).applyMatrix3(this.body2.rotation, true);

      this.an1.copy(this.localAngle1).applyMatrix3(this.body1.rotation, true);
      this.an2.copy(this.localAngle2).applyMatrix3(this.body2.rotation, true);

      // normal tangent binormal

      this.nor.set(
        this.ax1.x * this.body2.inverseMass + this.ax2.x * this.body1.inverseMass,
        this.ax1.y * this.body2.inverseMass + this.ax2.y * this.body1.inverseMass,
        this.ax1.z * this.body2.inverseMass + this.ax2.z * this.body1.inverseMass
      ).normalize();

      this.tan.tangent(this.nor).normalize();

      this.bin.crossVectors(this.nor, this.tan);

      // calculate hinge angle

      var limite = _Math.acosClamp(_Math.dotVectors(this.an1, this.an2));

      this.tmp.crossVectors(this.an1, this.an2);

      if (_Math.dotVectors(this.nor, this.tmp) < 0) this.limitMotor.angle = -limite;
      else this.limitMotor.angle = limite;

      this.tmp.crossVectors(this.ax1, this.ax2);

      this.r3.limitMotor2.angle = _Math.dotVectors(this.tan, this.tmp);
      this.r3.limitMotor3.angle = _Math.dotVectors(this.bin, this.tmp);

      // preSolve

      this.r3.preSolve(timeStep, invTimeStep);
      this.lc.preSolve(timeStep, invTimeStep);

    },

    solve: function () {

      this.r3.solve();
      this.lc.solve();

    },

    postSolve: function () {

    }

  });

  /**
   * A ball-and-socket joint limits relative translation on two anchor points on rigid bodies.
   *
   * @author saharan
   * @author lo-th
   */

  function BallAndSocketJoint(config) {

    Joint.call(this, config);

    this.type = JOINT_BALL_AND_SOCKET;

    this.lc = new LinearConstraint(this);

  }
  BallAndSocketJoint.prototype = Object.assign(Object.create(Joint.prototype), {

    constructor: BallAndSocketJoint,

    preSolve: function (timeStep, invTimeStep) {

      this.updateAnchorPoints();

      // preSolve

      this.lc.preSolve(timeStep, invTimeStep);

    },

    solve: function () {

      this.lc.solve();

    },

    postSolve: function () {

    }

  });

  /**
  * A translational constraint for various joints.
  * @author saharan
  */
  function TranslationalConstraint(joint, limitMotor) {
    this.cfm = NaN;
    this.m1 = NaN;
    this.m2 = NaN;
    this.i1e00 = NaN;
    this.i1e01 = NaN;
    this.i1e02 = NaN;
    this.i1e10 = NaN;
    this.i1e11 = NaN;
    this.i1e12 = NaN;
    this.i1e20 = NaN;
    this.i1e21 = NaN;
    this.i1e22 = NaN;
    this.i2e00 = NaN;
    this.i2e01 = NaN;
    this.i2e02 = NaN;
    this.i2e10 = NaN;
    this.i2e11 = NaN;
    this.i2e12 = NaN;
    this.i2e20 = NaN;
    this.i2e21 = NaN;
    this.i2e22 = NaN;
    this.motorDenom = NaN;
    this.invMotorDenom = NaN;
    this.invDenom = NaN;
    this.ax = NaN;
    this.ay = NaN;
    this.az = NaN;
    this.r1x = NaN;
    this.r1y = NaN;
    this.r1z = NaN;
    this.r2x = NaN;
    this.r2y = NaN;
    this.r2z = NaN;
    this.t1x = NaN;
    this.t1y = NaN;
    this.t1z = NaN;
    this.t2x = NaN;
    this.t2y = NaN;
    this.t2z = NaN;
    this.l1x = NaN;
    this.l1y = NaN;
    this.l1z = NaN;
    this.l2x = NaN;
    this.l2y = NaN;
    this.l2z = NaN;
    this.a1x = NaN;
    this.a1y = NaN;
    this.a1z = NaN;
    this.a2x = NaN;
    this.a2y = NaN;
    this.a2z = NaN;
    this.lowerLimit = NaN;
    this.upperLimit = NaN;
    this.limitVelocity = NaN;
    this.limitState = 0; // -1: at lower, 0: locked, 1: at upper, 2: free
    this.enableMotor = false;
    this.motorSpeed = NaN;
    this.maxMotorForce = NaN;
    this.maxMotorImpulse = NaN;

    this.limitMotor = limitMotor;
    this.b1 = joint.body1;
    this.b2 = joint.body2;
    this.p1 = joint.anchorPoint1;
    this.p2 = joint.anchorPoint2;
    this.r1 = joint.relativeAnchorPoint1;
    this.r2 = joint.relativeAnchorPoint2;
    this.l1 = this.b1.linearVelocity;
    this.l2 = this.b2.linearVelocity;
    this.a1 = this.b1.angularVelocity;
    this.a2 = this.b2.angularVelocity;
    this.i1 = this.b1.inverseInertia;
    this.i2 = this.b2.inverseInertia;
    this.limitImpulse = 0;
    this.motorImpulse = 0;
  }

  Object.assign(TranslationalConstraint.prototype, {

    TranslationalConstraint: true,

    preSolve: function (timeStep, invTimeStep) {
      this.ax = this.limitMotor.axis.x;
      this.ay = this.limitMotor.axis.y;
      this.az = this.limitMotor.axis.z;
      this.lowerLimit = this.limitMotor.lowerLimit;
      this.upperLimit = this.limitMotor.upperLimit;
      this.motorSpeed = this.limitMotor.motorSpeed;
      this.maxMotorForce = this.limitMotor.maxMotorForce;
      this.enableMotor = this.maxMotorForce > 0;
      this.m1 = this.b1.inverseMass;
      this.m2 = this.b2.inverseMass;

      var ti1 = this.i1.elements;
      var ti2 = this.i2.elements;
      this.i1e00 = ti1[0];
      this.i1e01 = ti1[1];
      this.i1e02 = ti1[2];
      this.i1e10 = ti1[3];
      this.i1e11 = ti1[4];
      this.i1e12 = ti1[5];
      this.i1e20 = ti1[6];
      this.i1e21 = ti1[7];
      this.i1e22 = ti1[8];

      this.i2e00 = ti2[0];
      this.i2e01 = ti2[1];
      this.i2e02 = ti2[2];
      this.i2e10 = ti2[3];
      this.i2e11 = ti2[4];
      this.i2e12 = ti2[5];
      this.i2e20 = ti2[6];
      this.i2e21 = ti2[7];
      this.i2e22 = ti2[8];

      var dx = this.p2.x - this.p1.x;
      var dy = this.p2.y - this.p1.y;
      var dz = this.p2.z - this.p1.z;
      var d = dx * this.ax + dy * this.ay + dz * this.az;
      var frequency = this.limitMotor.frequency;
      var enableSpring = frequency > 0;
      var enableLimit = this.lowerLimit <= this.upperLimit;
      if (enableSpring && d > 20 || d < -20) {
        enableSpring = false;
      }

      if (enableLimit) {
        if (this.lowerLimit == this.upperLimit) {
          if (this.limitState != 0) {
            this.limitState = 0;
            this.limitImpulse = 0;
          }
          this.limitVelocity = this.lowerLimit - d;
          if (!enableSpring) d = this.lowerLimit;
        } else if (d < this.lowerLimit) {
          if (this.limitState != -1) {
            this.limitState = -1;
            this.limitImpulse = 0;
          }
          this.limitVelocity = this.lowerLimit - d;
          if (!enableSpring) d = this.lowerLimit;
        } else if (d > this.upperLimit) {
          if (this.limitState != 1) {
            this.limitState = 1;
            this.limitImpulse = 0;
          }
          this.limitVelocity = this.upperLimit - d;
          if (!enableSpring) d = this.upperLimit;
        } else {
          this.limitState = 2;
          this.limitImpulse = 0;
          this.limitVelocity = 0;
        }
        if (!enableSpring) {
          if (this.limitVelocity > 0.005) this.limitVelocity -= 0.005;
          else if (this.limitVelocity < -0.005) this.limitVelocity += 0.005;
          else this.limitVelocity = 0;
        }
      } else {
        this.limitState = 2;
        this.limitImpulse = 0;
      }

      if (this.enableMotor && (this.limitState != 0 || enableSpring)) {
        this.maxMotorImpulse = this.maxMotorForce * timeStep;
      } else {
        this.motorImpulse = 0;
        this.maxMotorImpulse = 0;
      }

      var rdx = d * this.ax;
      var rdy = d * this.ay;
      var rdz = d * this.az;
      var w1 = this.m1 / (this.m1 + this.m2);
      var w2 = 1 - w1;
      this.r1x = this.r1.x + rdx * w1;
      this.r1y = this.r1.y + rdy * w1;
      this.r1z = this.r1.z + rdz * w1;
      this.r2x = this.r2.x - rdx * w2;
      this.r2y = this.r2.y - rdy * w2;
      this.r2z = this.r2.z - rdz * w2;

      this.t1x = this.r1y * this.az - this.r1z * this.ay;
      this.t1y = this.r1z * this.ax - this.r1x * this.az;
      this.t1z = this.r1x * this.ay - this.r1y * this.ax;
      this.t2x = this.r2y * this.az - this.r2z * this.ay;
      this.t2y = this.r2z * this.ax - this.r2x * this.az;
      this.t2z = this.r2x * this.ay - this.r2y * this.ax;
      this.l1x = this.ax * this.m1;
      this.l1y = this.ay * this.m1;
      this.l1z = this.az * this.m1;
      this.l2x = this.ax * this.m2;
      this.l2y = this.ay * this.m2;
      this.l2z = this.az * this.m2;
      this.a1x = this.t1x * this.i1e00 + this.t1y * this.i1e01 + this.t1z * this.i1e02;
      this.a1y = this.t1x * this.i1e10 + this.t1y * this.i1e11 + this.t1z * this.i1e12;
      this.a1z = this.t1x * this.i1e20 + this.t1y * this.i1e21 + this.t1z * this.i1e22;
      this.a2x = this.t2x * this.i2e00 + this.t2y * this.i2e01 + this.t2z * this.i2e02;
      this.a2y = this.t2x * this.i2e10 + this.t2y * this.i2e11 + this.t2z * this.i2e12;
      this.a2z = this.t2x * this.i2e20 + this.t2y * this.i2e21 + this.t2z * this.i2e22;
      this.motorDenom =
        this.m1 + this.m2 +
        this.ax * (this.a1y * this.r1z - this.a1z * this.r1y + this.a2y * this.r2z - this.a2z * this.r2y) +
        this.ay * (this.a1z * this.r1x - this.a1x * this.r1z + this.a2z * this.r2x - this.a2x * this.r2z) +
        this.az * (this.a1x * this.r1y - this.a1y * this.r1x + this.a2x * this.r2y - this.a2y * this.r2x);

      this.invMotorDenom = 1 / this.motorDenom;

      if (enableSpring && this.limitState != 2) {
        var omega = 6.2831853 * frequency;
        var k = omega * omega * timeStep;
        var dmp = invTimeStep / (k + 2 * this.limitMotor.dampingRatio * omega);
        this.cfm = this.motorDenom * dmp;
        this.limitVelocity *= k * dmp;
      } else {
        this.cfm = 0;
        this.limitVelocity *= invTimeStep * 0.05;
      }

      this.invDenom = 1 / (this.motorDenom + this.cfm);

      var totalImpulse = this.limitImpulse + this.motorImpulse;
      this.l1.x += totalImpulse * this.l1x;
      this.l1.y += totalImpulse * this.l1y;
      this.l1.z += totalImpulse * this.l1z;
      this.a1.x += totalImpulse * this.a1x;
      this.a1.y += totalImpulse * this.a1y;
      this.a1.z += totalImpulse * this.a1z;
      this.l2.x -= totalImpulse * this.l2x;
      this.l2.y -= totalImpulse * this.l2y;
      this.l2.z -= totalImpulse * this.l2z;
      this.a2.x -= totalImpulse * this.a2x;
      this.a2.y -= totalImpulse * this.a2y;
      this.a2.z -= totalImpulse * this.a2z;
    },
    solve: function () {
      var rvn =
        this.ax * (this.l2.x - this.l1.x) + this.ay * (this.l2.y - this.l1.y) + this.az * (this.l2.z - this.l1.z) +
        this.t2x * this.a2.x - this.t1x * this.a1.x + this.t2y * this.a2.y - this.t1y * this.a1.y + this.t2z * this.a2.z - this.t1z * this.a1.z;

      // motor part
      var newMotorImpulse;
      if (this.enableMotor) {
        newMotorImpulse = (rvn - this.motorSpeed) * this.invMotorDenom;
        var oldMotorImpulse = this.motorImpulse;
        this.motorImpulse += newMotorImpulse;
        if (this.motorImpulse > this.maxMotorImpulse) this.motorImpulse = this.maxMotorImpulse;
        else if (this.motorImpulse < -this.maxMotorImpulse) this.motorImpulse = -this.maxMotorImpulse;
        newMotorImpulse = this.motorImpulse - oldMotorImpulse;
        rvn -= newMotorImpulse * this.motorDenom;
      } else newMotorImpulse = 0;

      // limit part
      var newLimitImpulse;
      if (this.limitState != 2) {
        newLimitImpulse = (rvn - this.limitVelocity - this.limitImpulse * this.cfm) * this.invDenom;
        var oldLimitImpulse = this.limitImpulse;
        this.limitImpulse += newLimitImpulse;
        if (this.limitImpulse * this.limitState < 0) this.limitImpulse = 0;
        newLimitImpulse = this.limitImpulse - oldLimitImpulse;
      } else newLimitImpulse = 0;

      var totalImpulse = newLimitImpulse + newMotorImpulse;
      this.l1.x += totalImpulse * this.l1x;
      this.l1.y += totalImpulse * this.l1y;
      this.l1.z += totalImpulse * this.l1z;
      this.a1.x += totalImpulse * this.a1x;
      this.a1.y += totalImpulse * this.a1y;
      this.a1.z += totalImpulse * this.a1z;
      this.l2.x -= totalImpulse * this.l2x;
      this.l2.y -= totalImpulse * this.l2y;
      this.l2.z -= totalImpulse * this.l2z;
      this.a2.x -= totalImpulse * this.a2x;
      this.a2.y -= totalImpulse * this.a2y;
      this.a2.z -= totalImpulse * this.a2z;
    }
  });

  /**
   * A distance joint limits the distance between two anchor points on rigid bodies.
   *
   * @author saharan
   * @author lo-th
   */

  function DistanceJoint(config, minDistance, maxDistance) {

    Joint.call(this, config);

    this.type = JOINT_DISTANCE;

    this.nor = new Vec3();

    // The limit and motor information of the joint.
    this.limitMotor = new LimitMotor(this.nor, true);
    this.limitMotor.lowerLimit = minDistance;
    this.limitMotor.upperLimit = maxDistance;

    this.t = new TranslationalConstraint(this, this.limitMotor);

  }
  DistanceJoint.prototype = Object.assign(Object.create(Joint.prototype), {

    constructor: DistanceJoint,

    preSolve: function (timeStep, invTimeStep) {

      this.updateAnchorPoints();

      this.nor.sub(this.anchorPoint2, this.anchorPoint1).normalize();

      // preSolve

      this.t.preSolve(timeStep, invTimeStep);

    },

    solve: function () {

      this.t.solve();

    },

    postSolve: function () {

    }

  });

  /**
  * An angular constraint for all axes for various joints.
  * @author saharan
  */

  function AngularConstraint(joint, targetOrientation) {

    this.joint = joint;

    this.targetOrientation = new Quat().invert(targetOrientation);

    this.relativeOrientation = new Quat();

    this.ii1 = null;
    this.ii2 = null;
    this.dd = null;

    this.vel = new Vec3();
    this.imp = new Vec3();

    this.rn0 = new Vec3();
    this.rn1 = new Vec3();
    this.rn2 = new Vec3();

    this.b1 = joint.body1;
    this.b2 = joint.body2;
    this.a1 = this.b1.angularVelocity;
    this.a2 = this.b2.angularVelocity;
    this.i1 = this.b1.inverseInertia;
    this.i2 = this.b2.inverseInertia;

  }
  Object.assign(AngularConstraint.prototype, {

    AngularConstraint: true,

    preSolve: function (timeStep, invTimeStep) {

      var inv, len, v;

      this.ii1 = this.i1.clone();
      this.ii2 = this.i2.clone();

      v = new Mat33().add(this.ii1, this.ii2).elements;
      inv = 1 / (v[0] * (v[4] * v[8] - v[7] * v[5]) + v[3] * (v[7] * v[2] - v[1] * v[8]) + v[6] * (v[1] * v[5] - v[4] * v[2]));
      this.dd = new Mat33().set(
        v[4] * v[8] - v[5] * v[7], v[2] * v[7] - v[1] * v[8], v[1] * v[5] - v[2] * v[4],
        v[5] * v[6] - v[3] * v[8], v[0] * v[8] - v[2] * v[6], v[2] * v[3] - v[0] * v[5],
        v[3] * v[7] - v[4] * v[6], v[1] * v[6] - v[0] * v[7], v[0] * v[4] - v[1] * v[3]
      ).multiplyScalar(inv);

      this.relativeOrientation.invert(this.b1.orientation).multiply(this.targetOrientation).multiply(this.b2.orientation);

      inv = this.relativeOrientation.w * 2;

      this.vel.copy(this.relativeOrientation).multiplyScalar(inv);

      len = this.vel.length();

      if (len > 0.02) {
        len = (0.02 - len) / len * invTimeStep * 0.05;
        this.vel.multiplyScalar(len);
      } else {
        this.vel.set(0, 0, 0);
      }

      this.rn1.copy(this.imp).applyMatrix3(this.ii1, true);
      this.rn2.copy(this.imp).applyMatrix3(this.ii2, true);

      this.a1.add(this.rn1);
      this.a2.sub(this.rn2);

    },

    solve: function () {

      var r = this.a2.clone().sub(this.a1).sub(this.vel);

      this.rn0.copy(r).applyMatrix3(this.dd, true);
      this.rn1.copy(this.rn0).applyMatrix3(this.ii1, true);
      this.rn2.copy(this.rn0).applyMatrix3(this.ii2, true);

      this.imp.add(this.rn0);
      this.a1.add(this.rn1);
      this.a2.sub(this.rn2);

    }

  });

  /**
  * A three-axis translational constraint for various joints.
  * @author saharan
  */
  function Translational3Constraint(joint, limitMotor1, limitMotor2, limitMotor3) {

    this.m1 = NaN;
    this.m2 = NaN;
    this.i1e00 = NaN;
    this.i1e01 = NaN;
    this.i1e02 = NaN;
    this.i1e10 = NaN;
    this.i1e11 = NaN;
    this.i1e12 = NaN;
    this.i1e20 = NaN;
    this.i1e21 = NaN;
    this.i1e22 = NaN;
    this.i2e00 = NaN;
    this.i2e01 = NaN;
    this.i2e02 = NaN;
    this.i2e10 = NaN;
    this.i2e11 = NaN;
    this.i2e12 = NaN;
    this.i2e20 = NaN;
    this.i2e21 = NaN;
    this.i2e22 = NaN;
    this.ax1 = NaN;
    this.ay1 = NaN;
    this.az1 = NaN;
    this.ax2 = NaN;
    this.ay2 = NaN;
    this.az2 = NaN;
    this.ax3 = NaN;
    this.ay3 = NaN;
    this.az3 = NaN;
    this.r1x = NaN;
    this.r1y = NaN;
    this.r1z = NaN;
    this.r2x = NaN;
    this.r2y = NaN;
    this.r2z = NaN;
    this.t1x1 = NaN;// jacobians
    this.t1y1 = NaN;
    this.t1z1 = NaN;
    this.t2x1 = NaN;
    this.t2y1 = NaN;
    this.t2z1 = NaN;
    this.l1x1 = NaN;
    this.l1y1 = NaN;
    this.l1z1 = NaN;
    this.l2x1 = NaN;
    this.l2y1 = NaN;
    this.l2z1 = NaN;
    this.a1x1 = NaN;
    this.a1y1 = NaN;
    this.a1z1 = NaN;
    this.a2x1 = NaN;
    this.a2y1 = NaN;
    this.a2z1 = NaN;
    this.t1x2 = NaN;
    this.t1y2 = NaN;
    this.t1z2 = NaN;
    this.t2x2 = NaN;
    this.t2y2 = NaN;
    this.t2z2 = NaN;
    this.l1x2 = NaN;
    this.l1y2 = NaN;
    this.l1z2 = NaN;
    this.l2x2 = NaN;
    this.l2y2 = NaN;
    this.l2z2 = NaN;
    this.a1x2 = NaN;
    this.a1y2 = NaN;
    this.a1z2 = NaN;
    this.a2x2 = NaN;
    this.a2y2 = NaN;
    this.a2z2 = NaN;
    this.t1x3 = NaN;
    this.t1y3 = NaN;
    this.t1z3 = NaN;
    this.t2x3 = NaN;
    this.t2y3 = NaN;
    this.t2z3 = NaN;
    this.l1x3 = NaN;
    this.l1y3 = NaN;
    this.l1z3 = NaN;
    this.l2x3 = NaN;
    this.l2y3 = NaN;
    this.l2z3 = NaN;
    this.a1x3 = NaN;
    this.a1y3 = NaN;
    this.a1z3 = NaN;
    this.a2x3 = NaN;
    this.a2y3 = NaN;
    this.a2z3 = NaN;
    this.lowerLimit1 = NaN;
    this.upperLimit1 = NaN;
    this.limitVelocity1 = NaN;
    this.limitState1 = 0; // -1: at lower, 0: locked, 1: at upper, 2: unlimited
    this.enableMotor1 = false;
    this.motorSpeed1 = NaN;
    this.maxMotorForce1 = NaN;
    this.maxMotorImpulse1 = NaN;
    this.lowerLimit2 = NaN;
    this.upperLimit2 = NaN;
    this.limitVelocity2 = NaN;
    this.limitState2 = 0; // -1: at lower, 0: locked, 1: at upper, 2: unlimited
    this.enableMotor2 = false;
    this.motorSpeed2 = NaN;
    this.maxMotorForce2 = NaN;
    this.maxMotorImpulse2 = NaN;
    this.lowerLimit3 = NaN;
    this.upperLimit3 = NaN;
    this.limitVelocity3 = NaN;
    this.limitState3 = 0; // -1: at lower, 0: locked, 1: at upper, 2: unlimited
    this.enableMotor3 = false;
    this.motorSpeed3 = NaN;
    this.maxMotorForce3 = NaN;
    this.maxMotorImpulse3 = NaN;
    this.k00 = NaN; // K = J*M*JT
    this.k01 = NaN;
    this.k02 = NaN;
    this.k10 = NaN;
    this.k11 = NaN;
    this.k12 = NaN;
    this.k20 = NaN;
    this.k21 = NaN;
    this.k22 = NaN;
    this.kv00 = NaN; // diagonals without CFMs
    this.kv11 = NaN;
    this.kv22 = NaN;
    this.dv00 = NaN; // ...inverted
    this.dv11 = NaN;
    this.dv22 = NaN;
    this.d00 = NaN; // K^-1
    this.d01 = NaN;
    this.d02 = NaN;
    this.d10 = NaN;
    this.d11 = NaN;
    this.d12 = NaN;
    this.d20 = NaN;
    this.d21 = NaN;
    this.d22 = NaN;

    this.limitMotor1 = limitMotor1;
    this.limitMotor2 = limitMotor2;
    this.limitMotor3 = limitMotor3;
    this.b1 = joint.body1;
    this.b2 = joint.body2;
    this.p1 = joint.anchorPoint1;
    this.p2 = joint.anchorPoint2;
    this.r1 = joint.relativeAnchorPoint1;
    this.r2 = joint.relativeAnchorPoint2;
    this.l1 = this.b1.linearVelocity;
    this.l2 = this.b2.linearVelocity;
    this.a1 = this.b1.angularVelocity;
    this.a2 = this.b2.angularVelocity;
    this.i1 = this.b1.inverseInertia;
    this.i2 = this.b2.inverseInertia;
    this.limitImpulse1 = 0;
    this.motorImpulse1 = 0;
    this.limitImpulse2 = 0;
    this.motorImpulse2 = 0;
    this.limitImpulse3 = 0;
    this.motorImpulse3 = 0;
    this.cfm1 = 0;// Constraint Force Mixing
    this.cfm2 = 0;
    this.cfm3 = 0;
    this.weight = -1;
  }

  Object.assign(Translational3Constraint.prototype, {

    Translational3Constraint: true,

    preSolve: function (timeStep, invTimeStep) {
      this.ax1 = this.limitMotor1.axis.x;
      this.ay1 = this.limitMotor1.axis.y;
      this.az1 = this.limitMotor1.axis.z;
      this.ax2 = this.limitMotor2.axis.x;
      this.ay2 = this.limitMotor2.axis.y;
      this.az2 = this.limitMotor2.axis.z;
      this.ax3 = this.limitMotor3.axis.x;
      this.ay3 = this.limitMotor3.axis.y;
      this.az3 = this.limitMotor3.axis.z;
      this.lowerLimit1 = this.limitMotor1.lowerLimit;
      this.upperLimit1 = this.limitMotor1.upperLimit;
      this.motorSpeed1 = this.limitMotor1.motorSpeed;
      this.maxMotorForce1 = this.limitMotor1.maxMotorForce;
      this.enableMotor1 = this.maxMotorForce1 > 0;
      this.lowerLimit2 = this.limitMotor2.lowerLimit;
      this.upperLimit2 = this.limitMotor2.upperLimit;
      this.motorSpeed2 = this.limitMotor2.motorSpeed;
      this.maxMotorForce2 = this.limitMotor2.maxMotorForce;
      this.enableMotor2 = this.maxMotorForce2 > 0;
      this.lowerLimit3 = this.limitMotor3.lowerLimit;
      this.upperLimit3 = this.limitMotor3.upperLimit;
      this.motorSpeed3 = this.limitMotor3.motorSpeed;
      this.maxMotorForce3 = this.limitMotor3.maxMotorForce;
      this.enableMotor3 = this.maxMotorForce3 > 0;
      this.m1 = this.b1.inverseMass;
      this.m2 = this.b2.inverseMass;

      var ti1 = this.i1.elements;
      var ti2 = this.i2.elements;
      this.i1e00 = ti1[0];
      this.i1e01 = ti1[1];
      this.i1e02 = ti1[2];
      this.i1e10 = ti1[3];
      this.i1e11 = ti1[4];
      this.i1e12 = ti1[5];
      this.i1e20 = ti1[6];
      this.i1e21 = ti1[7];
      this.i1e22 = ti1[8];

      this.i2e00 = ti2[0];
      this.i2e01 = ti2[1];
      this.i2e02 = ti2[2];
      this.i2e10 = ti2[3];
      this.i2e11 = ti2[4];
      this.i2e12 = ti2[5];
      this.i2e20 = ti2[6];
      this.i2e21 = ti2[7];
      this.i2e22 = ti2[8];

      var dx = this.p2.x - this.p1.x;
      var dy = this.p2.y - this.p1.y;
      var dz = this.p2.z - this.p1.z;
      var d1 = dx * this.ax1 + dy * this.ay1 + dz * this.az1;
      var d2 = dx * this.ax2 + dy * this.ay2 + dz * this.az2;
      var d3 = dx * this.ax3 + dy * this.ay3 + dz * this.az3;
      var frequency1 = this.limitMotor1.frequency;
      var frequency2 = this.limitMotor2.frequency;
      var frequency3 = this.limitMotor3.frequency;
      var enableSpring1 = frequency1 > 0;
      var enableSpring2 = frequency2 > 0;
      var enableSpring3 = frequency3 > 0;
      var enableLimit1 = this.lowerLimit1 <= this.upperLimit1;
      var enableLimit2 = this.lowerLimit2 <= this.upperLimit2;
      var enableLimit3 = this.lowerLimit3 <= this.upperLimit3;

      // for stability
      if (enableSpring1 && d1 > 20 || d1 < -20) {
        enableSpring1 = false;
      }
      if (enableSpring2 && d2 > 20 || d2 < -20) {
        enableSpring2 = false;
      }
      if (enableSpring3 && d3 > 20 || d3 < -20) {
        enableSpring3 = false;
      }

      if (enableLimit1) {
        if (this.lowerLimit1 == this.upperLimit1) {
          if (this.limitState1 != 0) {
            this.limitState1 = 0;
            this.limitImpulse1 = 0;
          }
          this.limitVelocity1 = this.lowerLimit1 - d1;
          if (!enableSpring1) d1 = this.lowerLimit1;
        } else if (d1 < this.lowerLimit1) {
          if (this.limitState1 != -1) {
            this.limitState1 = -1;
            this.limitImpulse1 = 0;
          }
          this.limitVelocity1 = this.lowerLimit1 - d1;
          if (!enableSpring1) d1 = this.lowerLimit1;
        } else if (d1 > this.upperLimit1) {
          if (this.limitState1 != 1) {
            this.limitState1 = 1;
            this.limitImpulse1 = 0;
          }
          this.limitVelocity1 = this.upperLimit1 - d1;
          if (!enableSpring1) d1 = this.upperLimit1;
        } else {
          this.limitState1 = 2;
          this.limitImpulse1 = 0;
          this.limitVelocity1 = 0;
        }
        if (!enableSpring1) {
          if (this.limitVelocity1 > 0.005) this.limitVelocity1 -= 0.005;
          else if (this.limitVelocity1 < -0.005) this.limitVelocity1 += 0.005;
          else this.limitVelocity1 = 0;
        }
      } else {
        this.limitState1 = 2;
        this.limitImpulse1 = 0;
      }

      if (enableLimit2) {
        if (this.lowerLimit2 == this.upperLimit2) {
          if (this.limitState2 != 0) {
            this.limitState2 = 0;
            this.limitImpulse2 = 0;
          }
          this.limitVelocity2 = this.lowerLimit2 - d2;
          if (!enableSpring2) d2 = this.lowerLimit2;
        } else if (d2 < this.lowerLimit2) {
          if (this.limitState2 != -1) {
            this.limitState2 = -1;
            this.limitImpulse2 = 0;
          }
          this.limitVelocity2 = this.lowerLimit2 - d2;
          if (!enableSpring2) d2 = this.lowerLimit2;
        } else if (d2 > this.upperLimit2) {
          if (this.limitState2 != 1) {
            this.limitState2 = 1;
            this.limitImpulse2 = 0;
          }
          this.limitVelocity2 = this.upperLimit2 - d2;
          if (!enableSpring2) d2 = this.upperLimit2;
        } else {
          this.limitState2 = 2;
          this.limitImpulse2 = 0;
          this.limitVelocity2 = 0;
        }
        if (!enableSpring2) {
          if (this.limitVelocity2 > 0.005) this.limitVelocity2 -= 0.005;
          else if (this.limitVelocity2 < -0.005) this.limitVelocity2 += 0.005;
          else this.limitVelocity2 = 0;
        }
      } else {
        this.limitState2 = 2;
        this.limitImpulse2 = 0;
      }

      if (enableLimit3) {
        if (this.lowerLimit3 == this.upperLimit3) {
          if (this.limitState3 != 0) {
            this.limitState3 = 0;
            this.limitImpulse3 = 0;
          }
          this.limitVelocity3 = this.lowerLimit3 - d3;
          if (!enableSpring3) d3 = this.lowerLimit3;
        } else if (d3 < this.lowerLimit3) {
          if (this.limitState3 != -1) {
            this.limitState3 = -1;
            this.limitImpulse3 = 0;
          }
          this.limitVelocity3 = this.lowerLimit3 - d3;
          if (!enableSpring3) d3 = this.lowerLimit3;
        } else if (d3 > this.upperLimit3) {
          if (this.limitState3 != 1) {
            this.limitState3 = 1;
            this.limitImpulse3 = 0;
          }
          this.limitVelocity3 = this.upperLimit3 - d3;
          if (!enableSpring3) d3 = this.upperLimit3;
        } else {
          this.limitState3 = 2;
          this.limitImpulse3 = 0;
          this.limitVelocity3 = 0;
        }
        if (!enableSpring3) {
          if (this.limitVelocity3 > 0.005) this.limitVelocity3 -= 0.005;
          else if (this.limitVelocity3 < -0.005) this.limitVelocity3 += 0.005;
          else this.limitVelocity3 = 0;
        }
      } else {
        this.limitState3 = 2;
        this.limitImpulse3 = 0;
      }

      if (this.enableMotor1 && (this.limitState1 != 0 || enableSpring1)) {
        this.maxMotorImpulse1 = this.maxMotorForce1 * timeStep;
      } else {
        this.motorImpulse1 = 0;
        this.maxMotorImpulse1 = 0;
      }

      if (this.enableMotor2 && (this.limitState2 != 0 || enableSpring2)) {
        this.maxMotorImpulse2 = this.maxMotorForce2 * timeStep;
      } else {
        this.motorImpulse2 = 0;
        this.maxMotorImpulse2 = 0;
      }

      if (this.enableMotor3 && (this.limitState3 != 0 || enableSpring3)) {
        this.maxMotorImpulse3 = this.maxMotorForce3 * timeStep;
      } else {
        this.motorImpulse3 = 0;
        this.maxMotorImpulse3 = 0;
      }

      var rdx = d1 * this.ax1 + d2 * this.ax2 + d3 * this.ax2;
      var rdy = d1 * this.ay1 + d2 * this.ay2 + d3 * this.ay2;
      var rdz = d1 * this.az1 + d2 * this.az2 + d3 * this.az2;
      var w1 = this.m2 / (this.m1 + this.m2);
      if (this.weight >= 0) w1 = this.weight; // use given weight
      var w2 = 1 - w1;
      this.r1x = this.r1.x + rdx * w1;
      this.r1y = this.r1.y + rdy * w1;
      this.r1z = this.r1.z + rdz * w1;
      this.r2x = this.r2.x - rdx * w2;
      this.r2y = this.r2.y - rdy * w2;
      this.r2z = this.r2.z - rdz * w2;

      // build jacobians
      this.t1x1 = this.r1y * this.az1 - this.r1z * this.ay1;
      this.t1y1 = this.r1z * this.ax1 - this.r1x * this.az1;
      this.t1z1 = this.r1x * this.ay1 - this.r1y * this.ax1;
      this.t2x1 = this.r2y * this.az1 - this.r2z * this.ay1;
      this.t2y1 = this.r2z * this.ax1 - this.r2x * this.az1;
      this.t2z1 = this.r2x * this.ay1 - this.r2y * this.ax1;
      this.l1x1 = this.ax1 * this.m1;
      this.l1y1 = this.ay1 * this.m1;
      this.l1z1 = this.az1 * this.m1;
      this.l2x1 = this.ax1 * this.m2;
      this.l2y1 = this.ay1 * this.m2;
      this.l2z1 = this.az1 * this.m2;
      this.a1x1 = this.t1x1 * this.i1e00 + this.t1y1 * this.i1e01 + this.t1z1 * this.i1e02;
      this.a1y1 = this.t1x1 * this.i1e10 + this.t1y1 * this.i1e11 + this.t1z1 * this.i1e12;
      this.a1z1 = this.t1x1 * this.i1e20 + this.t1y1 * this.i1e21 + this.t1z1 * this.i1e22;
      this.a2x1 = this.t2x1 * this.i2e00 + this.t2y1 * this.i2e01 + this.t2z1 * this.i2e02;
      this.a2y1 = this.t2x1 * this.i2e10 + this.t2y1 * this.i2e11 + this.t2z1 * this.i2e12;
      this.a2z1 = this.t2x1 * this.i2e20 + this.t2y1 * this.i2e21 + this.t2z1 * this.i2e22;

      this.t1x2 = this.r1y * this.az2 - this.r1z * this.ay2;
      this.t1y2 = this.r1z * this.ax2 - this.r1x * this.az2;
      this.t1z2 = this.r1x * this.ay2 - this.r1y * this.ax2;
      this.t2x2 = this.r2y * this.az2 - this.r2z * this.ay2;
      this.t2y2 = this.r2z * this.ax2 - this.r2x * this.az2;
      this.t2z2 = this.r2x * this.ay2 - this.r2y * this.ax2;
      this.l1x2 = this.ax2 * this.m1;
      this.l1y2 = this.ay2 * this.m1;
      this.l1z2 = this.az2 * this.m1;
      this.l2x2 = this.ax2 * this.m2;
      this.l2y2 = this.ay2 * this.m2;
      this.l2z2 = this.az2 * this.m2;
      this.a1x2 = this.t1x2 * this.i1e00 + this.t1y2 * this.i1e01 + this.t1z2 * this.i1e02;
      this.a1y2 = this.t1x2 * this.i1e10 + this.t1y2 * this.i1e11 + this.t1z2 * this.i1e12;
      this.a1z2 = this.t1x2 * this.i1e20 + this.t1y2 * this.i1e21 + this.t1z2 * this.i1e22;
      this.a2x2 = this.t2x2 * this.i2e00 + this.t2y2 * this.i2e01 + this.t2z2 * this.i2e02;
      this.a2y2 = this.t2x2 * this.i2e10 + this.t2y2 * this.i2e11 + this.t2z2 * this.i2e12;
      this.a2z2 = this.t2x2 * this.i2e20 + this.t2y2 * this.i2e21 + this.t2z2 * this.i2e22;

      this.t1x3 = this.r1y * this.az3 - this.r1z * this.ay3;
      this.t1y3 = this.r1z * this.ax3 - this.r1x * this.az3;
      this.t1z3 = this.r1x * this.ay3 - this.r1y * this.ax3;
      this.t2x3 = this.r2y * this.az3 - this.r2z * this.ay3;
      this.t2y3 = this.r2z * this.ax3 - this.r2x * this.az3;
      this.t2z3 = this.r2x * this.ay3 - this.r2y * this.ax3;
      this.l1x3 = this.ax3 * this.m1;
      this.l1y3 = this.ay3 * this.m1;
      this.l1z3 = this.az3 * this.m1;
      this.l2x3 = this.ax3 * this.m2;
      this.l2y3 = this.ay3 * this.m2;
      this.l2z3 = this.az3 * this.m2;
      this.a1x3 = this.t1x3 * this.i1e00 + this.t1y3 * this.i1e01 + this.t1z3 * this.i1e02;
      this.a1y3 = this.t1x3 * this.i1e10 + this.t1y3 * this.i1e11 + this.t1z3 * this.i1e12;
      this.a1z3 = this.t1x3 * this.i1e20 + this.t1y3 * this.i1e21 + this.t1z3 * this.i1e22;
      this.a2x3 = this.t2x3 * this.i2e00 + this.t2y3 * this.i2e01 + this.t2z3 * this.i2e02;
      this.a2y3 = this.t2x3 * this.i2e10 + this.t2y3 * this.i2e11 + this.t2z3 * this.i2e12;
      this.a2z3 = this.t2x3 * this.i2e20 + this.t2y3 * this.i2e21 + this.t2z3 * this.i2e22;

      // build an impulse matrix
      var m12 = this.m1 + this.m2;
      this.k00 = (this.ax1 * this.ax1 + this.ay1 * this.ay1 + this.az1 * this.az1) * m12;
      this.k01 = (this.ax1 * this.ax2 + this.ay1 * this.ay2 + this.az1 * this.az2) * m12;
      this.k02 = (this.ax1 * this.ax3 + this.ay1 * this.ay3 + this.az1 * this.az3) * m12;
      this.k10 = (this.ax2 * this.ax1 + this.ay2 * this.ay1 + this.az2 * this.az1) * m12;
      this.k11 = (this.ax2 * this.ax2 + this.ay2 * this.ay2 + this.az2 * this.az2) * m12;
      this.k12 = (this.ax2 * this.ax3 + this.ay2 * this.ay3 + this.az2 * this.az3) * m12;
      this.k20 = (this.ax3 * this.ax1 + this.ay3 * this.ay1 + this.az3 * this.az1) * m12;
      this.k21 = (this.ax3 * this.ax2 + this.ay3 * this.ay2 + this.az3 * this.az2) * m12;
      this.k22 = (this.ax3 * this.ax3 + this.ay3 * this.ay3 + this.az3 * this.az3) * m12;

      this.k00 += this.t1x1 * this.a1x1 + this.t1y1 * this.a1y1 + this.t1z1 * this.a1z1;
      this.k01 += this.t1x1 * this.a1x2 + this.t1y1 * this.a1y2 + this.t1z1 * this.a1z2;
      this.k02 += this.t1x1 * this.a1x3 + this.t1y1 * this.a1y3 + this.t1z1 * this.a1z3;
      this.k10 += this.t1x2 * this.a1x1 + this.t1y2 * this.a1y1 + this.t1z2 * this.a1z1;
      this.k11 += this.t1x2 * this.a1x2 + this.t1y2 * this.a1y2 + this.t1z2 * this.a1z2;
      this.k12 += this.t1x2 * this.a1x3 + this.t1y2 * this.a1y3 + this.t1z2 * this.a1z3;
      this.k20 += this.t1x3 * this.a1x1 + this.t1y3 * this.a1y1 + this.t1z3 * this.a1z1;
      this.k21 += this.t1x3 * this.a1x2 + this.t1y3 * this.a1y2 + this.t1z3 * this.a1z2;
      this.k22 += this.t1x3 * this.a1x3 + this.t1y3 * this.a1y3 + this.t1z3 * this.a1z3;

      this.k00 += this.t2x1 * this.a2x1 + this.t2y1 * this.a2y1 + this.t2z1 * this.a2z1;
      this.k01 += this.t2x1 * this.a2x2 + this.t2y1 * this.a2y2 + this.t2z1 * this.a2z2;
      this.k02 += this.t2x1 * this.a2x3 + this.t2y1 * this.a2y3 + this.t2z1 * this.a2z3;
      this.k10 += this.t2x2 * this.a2x1 + this.t2y2 * this.a2y1 + this.t2z2 * this.a2z1;
      this.k11 += this.t2x2 * this.a2x2 + this.t2y2 * this.a2y2 + this.t2z2 * this.a2z2;
      this.k12 += this.t2x2 * this.a2x3 + this.t2y2 * this.a2y3 + this.t2z2 * this.a2z3;
      this.k20 += this.t2x3 * this.a2x1 + this.t2y3 * this.a2y1 + this.t2z3 * this.a2z1;
      this.k21 += this.t2x3 * this.a2x2 + this.t2y3 * this.a2y2 + this.t2z3 * this.a2z2;
      this.k22 += this.t2x3 * this.a2x3 + this.t2y3 * this.a2y3 + this.t2z3 * this.a2z3;

      this.kv00 = this.k00;
      this.kv11 = this.k11;
      this.kv22 = this.k22;

      this.dv00 = 1 / this.kv00;
      this.dv11 = 1 / this.kv11;
      this.dv22 = 1 / this.kv22;

      if (enableSpring1 && this.limitState1 != 2) {
        var omega = 6.2831853 * frequency1;
        var k = omega * omega * timeStep;
        var dmp = invTimeStep / (k + 2 * this.limitMotor1.dampingRatio * omega);
        this.cfm1 = this.kv00 * dmp;
        this.limitVelocity1 *= k * dmp;
      } else {
        this.cfm1 = 0;
        this.limitVelocity1 *= invTimeStep * 0.05;
      }
      if (enableSpring2 && this.limitState2 != 2) {
        omega = 6.2831853 * frequency2;
        k = omega * omega * timeStep;
        dmp = invTimeStep / (k + 2 * this.limitMotor2.dampingRatio * omega);
        this.cfm2 = this.kv11 * dmp;
        this.limitVelocity2 *= k * dmp;
      } else {
        this.cfm2 = 0;
        this.limitVelocity2 *= invTimeStep * 0.05;
      }
      if (enableSpring3 && this.limitState3 != 2) {
        omega = 6.2831853 * frequency3;
        k = omega * omega * timeStep;
        dmp = invTimeStep / (k + 2 * this.limitMotor3.dampingRatio * omega);
        this.cfm3 = this.kv22 * dmp;
        this.limitVelocity3 *= k * dmp;
      } else {
        this.cfm3 = 0;
        this.limitVelocity3 *= invTimeStep * 0.05;
      }
      this.k00 += this.cfm1;
      this.k11 += this.cfm2;
      this.k22 += this.cfm3;

      var inv = 1 / (
        this.k00 * (this.k11 * this.k22 - this.k21 * this.k12) +
        this.k10 * (this.k21 * this.k02 - this.k01 * this.k22) +
        this.k20 * (this.k01 * this.k12 - this.k11 * this.k02)
      );
      this.d00 = (this.k11 * this.k22 - this.k12 * this.k21) * inv;
      this.d01 = (this.k02 * this.k21 - this.k01 * this.k22) * inv;
      this.d02 = (this.k01 * this.k12 - this.k02 * this.k11) * inv;
      this.d10 = (this.k12 * this.k20 - this.k10 * this.k22) * inv;
      this.d11 = (this.k00 * this.k22 - this.k02 * this.k20) * inv;
      this.d12 = (this.k02 * this.k10 - this.k00 * this.k12) * inv;
      this.d20 = (this.k10 * this.k21 - this.k11 * this.k20) * inv;
      this.d21 = (this.k01 * this.k20 - this.k00 * this.k21) * inv;
      this.d22 = (this.k00 * this.k11 - this.k01 * this.k10) * inv;

      // warm starting
      var totalImpulse1 = this.limitImpulse1 + this.motorImpulse1;
      var totalImpulse2 = this.limitImpulse2 + this.motorImpulse2;
      var totalImpulse3 = this.limitImpulse3 + this.motorImpulse3;
      this.l1.x += totalImpulse1 * this.l1x1 + totalImpulse2 * this.l1x2 + totalImpulse3 * this.l1x3;
      this.l1.y += totalImpulse1 * this.l1y1 + totalImpulse2 * this.l1y2 + totalImpulse3 * this.l1y3;
      this.l1.z += totalImpulse1 * this.l1z1 + totalImpulse2 * this.l1z2 + totalImpulse3 * this.l1z3;
      this.a1.x += totalImpulse1 * this.a1x1 + totalImpulse2 * this.a1x2 + totalImpulse3 * this.a1x3;
      this.a1.y += totalImpulse1 * this.a1y1 + totalImpulse2 * this.a1y2 + totalImpulse3 * this.a1y3;
      this.a1.z += totalImpulse1 * this.a1z1 + totalImpulse2 * this.a1z2 + totalImpulse3 * this.a1z3;
      this.l2.x -= totalImpulse1 * this.l2x1 + totalImpulse2 * this.l2x2 + totalImpulse3 * this.l2x3;
      this.l2.y -= totalImpulse1 * this.l2y1 + totalImpulse2 * this.l2y2 + totalImpulse3 * this.l2y3;
      this.l2.z -= totalImpulse1 * this.l2z1 + totalImpulse2 * this.l2z2 + totalImpulse3 * this.l2z3;
      this.a2.x -= totalImpulse1 * this.a2x1 + totalImpulse2 * this.a2x2 + totalImpulse3 * this.a2x3;
      this.a2.y -= totalImpulse1 * this.a2y1 + totalImpulse2 * this.a2y2 + totalImpulse3 * this.a2y3;
      this.a2.z -= totalImpulse1 * this.a2z1 + totalImpulse2 * this.a2z2 + totalImpulse3 * this.a2z3;
    },

    solve: function () {
      var rvx = this.l2.x - this.l1.x + this.a2.y * this.r2z - this.a2.z * this.r2y - this.a1.y * this.r1z + this.a1.z * this.r1y;
      var rvy = this.l2.y - this.l1.y + this.a2.z * this.r2x - this.a2.x * this.r2z - this.a1.z * this.r1x + this.a1.x * this.r1z;
      var rvz = this.l2.z - this.l1.z + this.a2.x * this.r2y - this.a2.y * this.r2x - this.a1.x * this.r1y + this.a1.y * this.r1x;
      var rvn1 = rvx * this.ax1 + rvy * this.ay1 + rvz * this.az1;
      var rvn2 = rvx * this.ax2 + rvy * this.ay2 + rvz * this.az2;
      var rvn3 = rvx * this.ax3 + rvy * this.ay3 + rvz * this.az3;
      var oldMotorImpulse1 = this.motorImpulse1;
      var oldMotorImpulse2 = this.motorImpulse2;
      var oldMotorImpulse3 = this.motorImpulse3;
      var dMotorImpulse1 = 0;
      var dMotorImpulse2 = 0;
      var dMotorImpulse3 = 0;
      if (this.enableMotor1) {
        dMotorImpulse1 = (rvn1 - this.motorSpeed1) * this.dv00;
        this.motorImpulse1 += dMotorImpulse1;
        if (this.motorImpulse1 > this.maxMotorImpulse1) { // clamp motor impulse
          this.motorImpulse1 = this.maxMotorImpulse1;
        } else if (this.motorImpulse1 < -this.maxMotorImpulse1) {
          this.motorImpulse1 = -this.maxMotorImpulse1;
        }
        dMotorImpulse1 = this.motorImpulse1 - oldMotorImpulse1;
      }
      if (this.enableMotor2) {
        dMotorImpulse2 = (rvn2 - this.motorSpeed2) * this.dv11;
        this.motorImpulse2 += dMotorImpulse2;
        if (this.motorImpulse2 > this.maxMotorImpulse2) { // clamp motor impulse
          this.motorImpulse2 = this.maxMotorImpulse2;
        } else if (this.motorImpulse2 < -this.maxMotorImpulse2) {
          this.motorImpulse2 = -this.maxMotorImpulse2;
        }
        dMotorImpulse2 = this.motorImpulse2 - oldMotorImpulse2;
      }
      if (this.enableMotor3) {
        dMotorImpulse3 = (rvn3 - this.motorSpeed3) * this.dv22;
        this.motorImpulse3 += dMotorImpulse3;
        if (this.motorImpulse3 > this.maxMotorImpulse3) { // clamp motor impulse
          this.motorImpulse3 = this.maxMotorImpulse3;
        } else if (this.motorImpulse3 < -this.maxMotorImpulse3) {
          this.motorImpulse3 = -this.maxMotorImpulse3;
        }
        dMotorImpulse3 = this.motorImpulse3 - oldMotorImpulse3;
      }

      // apply motor impulse to relative velocity
      rvn1 += dMotorImpulse1 * this.kv00 + dMotorImpulse2 * this.k01 + dMotorImpulse3 * this.k02;
      rvn2 += dMotorImpulse1 * this.k10 + dMotorImpulse2 * this.kv11 + dMotorImpulse3 * this.k12;
      rvn3 += dMotorImpulse1 * this.k20 + dMotorImpulse2 * this.k21 + dMotorImpulse3 * this.kv22;

      // subtract target velocity and applied impulse
      rvn1 -= this.limitVelocity1 + this.limitImpulse1 * this.cfm1;
      rvn2 -= this.limitVelocity2 + this.limitImpulse2 * this.cfm2;
      rvn3 -= this.limitVelocity3 + this.limitImpulse3 * this.cfm3;

      var oldLimitImpulse1 = this.limitImpulse1;
      var oldLimitImpulse2 = this.limitImpulse2;
      var oldLimitImpulse3 = this.limitImpulse3;

      var dLimitImpulse1 = rvn1 * this.d00 + rvn2 * this.d01 + rvn3 * this.d02;
      var dLimitImpulse2 = rvn1 * this.d10 + rvn2 * this.d11 + rvn3 * this.d12;
      var dLimitImpulse3 = rvn1 * this.d20 + rvn2 * this.d21 + rvn3 * this.d22;

      this.limitImpulse1 += dLimitImpulse1;
      this.limitImpulse2 += dLimitImpulse2;
      this.limitImpulse3 += dLimitImpulse3;

      // clamp
      var clampState = 0;
      if (this.limitState1 == 2 || this.limitImpulse1 * this.limitState1 < 0) {
        dLimitImpulse1 = -oldLimitImpulse1;
        rvn2 += dLimitImpulse1 * this.k10;
        rvn3 += dLimitImpulse1 * this.k20;
        clampState |= 1;
      }
      if (this.limitState2 == 2 || this.limitImpulse2 * this.limitState2 < 0) {
        dLimitImpulse2 = -oldLimitImpulse2;
        rvn1 += dLimitImpulse2 * this.k01;
        rvn3 += dLimitImpulse2 * this.k21;
        clampState |= 2;
      }
      if (this.limitState3 == 2 || this.limitImpulse3 * this.limitState3 < 0) {
        dLimitImpulse3 = -oldLimitImpulse3;
        rvn1 += dLimitImpulse3 * this.k02;
        rvn2 += dLimitImpulse3 * this.k12;
        clampState |= 4;
      }

      // update un-clamped impulse
      // TODO: isolate division
      var det;
      switch (clampState) {
        case 1:// update 2 3
          det = 1 / (this.k11 * this.k22 - this.k12 * this.k21);
          dLimitImpulse2 = (this.k22 * rvn2 + -this.k12 * rvn3) * det;
          dLimitImpulse3 = (-this.k21 * rvn2 + this.k11 * rvn3) * det;
          break;
        case 2:// update 1 3
          det = 1 / (this.k00 * this.k22 - this.k02 * this.k20);
          dLimitImpulse1 = (this.k22 * rvn1 + -this.k02 * rvn3) * det;
          dLimitImpulse3 = (-this.k20 * rvn1 + this.k00 * rvn3) * det;
          break;
        case 3:// update 3
          dLimitImpulse3 = rvn3 / this.k22;
          break;
        case 4:// update 1 2
          det = 1 / (this.k00 * this.k11 - this.k01 * this.k10);
          dLimitImpulse1 = (this.k11 * rvn1 + -this.k01 * rvn2) * det;
          dLimitImpulse2 = (-this.k10 * rvn1 + this.k00 * rvn2) * det;
          break;
        case 5:// update 2
          dLimitImpulse2 = rvn2 / this.k11;
          break;
        case 6:// update 1
          dLimitImpulse1 = rvn1 / this.k00;
          break;
      }

      this.limitImpulse1 = oldLimitImpulse1 + dLimitImpulse1;
      this.limitImpulse2 = oldLimitImpulse2 + dLimitImpulse2;
      this.limitImpulse3 = oldLimitImpulse3 + dLimitImpulse3;

      var dImpulse1 = dMotorImpulse1 + dLimitImpulse1;
      var dImpulse2 = dMotorImpulse2 + dLimitImpulse2;
      var dImpulse3 = dMotorImpulse3 + dLimitImpulse3;

      // apply impulse
      this.l1.x += dImpulse1 * this.l1x1 + dImpulse2 * this.l1x2 + dImpulse3 * this.l1x3;
      this.l1.y += dImpulse1 * this.l1y1 + dImpulse2 * this.l1y2 + dImpulse3 * this.l1y3;
      this.l1.z += dImpulse1 * this.l1z1 + dImpulse2 * this.l1z2 + dImpulse3 * this.l1z3;
      this.a1.x += dImpulse1 * this.a1x1 + dImpulse2 * this.a1x2 + dImpulse3 * this.a1x3;
      this.a1.y += dImpulse1 * this.a1y1 + dImpulse2 * this.a1y2 + dImpulse3 * this.a1y3;
      this.a1.z += dImpulse1 * this.a1z1 + dImpulse2 * this.a1z2 + dImpulse3 * this.a1z3;
      this.l2.x -= dImpulse1 * this.l2x1 + dImpulse2 * this.l2x2 + dImpulse3 * this.l2x3;
      this.l2.y -= dImpulse1 * this.l2y1 + dImpulse2 * this.l2y2 + dImpulse3 * this.l2y3;
      this.l2.z -= dImpulse1 * this.l2z1 + dImpulse2 * this.l2z2 + dImpulse3 * this.l2z3;
      this.a2.x -= dImpulse1 * this.a2x1 + dImpulse2 * this.a2x2 + dImpulse3 * this.a2x3;
      this.a2.y -= dImpulse1 * this.a2y1 + dImpulse2 * this.a2y2 + dImpulse3 * this.a2y3;
      this.a2.z -= dImpulse1 * this.a2z1 + dImpulse2 * this.a2z2 + dImpulse3 * this.a2z3;
    }

  });

  /**
   * A prismatic joint allows only for relative translation of rigid bodies along the axis.
   *
   * @author saharan
   * @author lo-th
   */

  function PrismaticJoint(config, lowerTranslation, upperTranslation) {

    Joint.call(this, config);

    this.type = JOINT_PRISMATIC;

    // The axis in the first body's coordinate system.
    this.localAxis1 = config.localAxis1.clone().normalize();
    // The axis in the second body's coordinate system.
    this.localAxis2 = config.localAxis2.clone().normalize();

    this.ax1 = new Vec3();
    this.ax2 = new Vec3();

    this.nor = new Vec3();
    this.tan = new Vec3();
    this.bin = new Vec3();

    this.ac = new AngularConstraint(this, new Quat().setFromUnitVectors(this.localAxis1, this.localAxis2));

    // The translational limit and motor information of the joint.
    this.limitMotor = new LimitMotor(this.nor, true);
    this.limitMotor.lowerLimit = lowerTranslation;
    this.limitMotor.upperLimit = upperTranslation;
    this.t3 = new Translational3Constraint(this, this.limitMotor, new LimitMotor(this.tan, true), new LimitMotor(this.bin, true));

  }
  PrismaticJoint.prototype = Object.assign(Object.create(Joint.prototype), {

    constructor: PrismaticJoint,

    preSolve: function (timeStep, invTimeStep) {

      this.updateAnchorPoints();

      this.ax1.copy(this.localAxis1).applyMatrix3(this.body1.rotation, true);
      this.ax2.copy(this.localAxis2).applyMatrix3(this.body2.rotation, true);

      // normal tangent binormal

      this.nor.set(
        this.ax1.x * this.body2.inverseMass + this.ax2.x * this.body1.inverseMass,
        this.ax1.y * this.body2.inverseMass + this.ax2.y * this.body1.inverseMass,
        this.ax1.z * this.body2.inverseMass + this.ax2.z * this.body1.inverseMass
      ).normalize();
      this.tan.tangent(this.nor).normalize();
      this.bin.crossVectors(this.nor, this.tan);

      // preSolve

      this.ac.preSolve(timeStep, invTimeStep);
      this.t3.preSolve(timeStep, invTimeStep);

    },

    solve: function () {

      this.ac.solve();
      this.t3.solve();

    },

    postSolve: function () {

    }

  });

  /**
   * A slider joint allows for relative translation and relative rotation between two rigid bodies along the axis.
   *
   * @author saharan
   * @author lo-th
   */

  function SliderJoint(config, lowerTranslation, upperTranslation) {

    Joint.call(this, config);

    this.type = JOINT_SLIDER;

    // The axis in the first body's coordinate system.
    this.localAxis1 = config.localAxis1.clone().normalize();
    // The axis in the second body's coordinate system.
    this.localAxis2 = config.localAxis2.clone().normalize();

    // make angle axis
    var arc = new Mat33().setQuat(new Quat().setFromUnitVectors(this.localAxis1, this.localAxis2));
    this.localAngle1 = new Vec3().tangent(this.localAxis1).normalize();
    this.localAngle2 = this.localAngle1.clone().applyMatrix3(arc, true);

    this.ax1 = new Vec3();
    this.ax2 = new Vec3();
    this.an1 = new Vec3();
    this.an2 = new Vec3();

    this.tmp = new Vec3();

    this.nor = new Vec3();
    this.tan = new Vec3();
    this.bin = new Vec3();

    // The limit and motor for the rotation
    this.rotationalLimitMotor = new LimitMotor(this.nor, false);
    this.r3 = new Rotational3Constraint(this, this.rotationalLimitMotor, new LimitMotor(this.tan, true), new LimitMotor(this.bin, true));

    // The limit and motor for the translation.
    this.translationalLimitMotor = new LimitMotor(this.nor, true);
    this.translationalLimitMotor.lowerLimit = lowerTranslation;
    this.translationalLimitMotor.upperLimit = upperTranslation;
    this.t3 = new Translational3Constraint(this, this.translationalLimitMotor, new LimitMotor(this.tan, true), new LimitMotor(this.bin, true));

  }
  SliderJoint.prototype = Object.assign(Object.create(Joint.prototype), {

    constructor: SliderJoint,

    preSolve: function (timeStep, invTimeStep) {

      this.updateAnchorPoints();

      this.ax1.copy(this.localAxis1).applyMatrix3(this.body1.rotation, true);
      this.an1.copy(this.localAngle1).applyMatrix3(this.body1.rotation, true);

      this.ax2.copy(this.localAxis2).applyMatrix3(this.body2.rotation, true);
      this.an2.copy(this.localAngle2).applyMatrix3(this.body2.rotation, true);

      // normal tangent binormal

      this.nor.set(
        this.ax1.x * this.body2.inverseMass + this.ax2.x * this.body1.inverseMass,
        this.ax1.y * this.body2.inverseMass + this.ax2.y * this.body1.inverseMass,
        this.ax1.z * this.body2.inverseMass + this.ax2.z * this.body1.inverseMass
      ).normalize();
      this.tan.tangent(this.nor).normalize();
      this.bin.crossVectors(this.nor, this.tan);

      // calculate hinge angle

      this.tmp.crossVectors(this.an1, this.an2);

      var limite = _Math.acosClamp(_Math.dotVectors(this.an1, this.an2));

      if (_Math.dotVectors(this.nor, this.tmp) < 0) this.rotationalLimitMotor.angle = -limite;
      else this.rotationalLimitMotor.angle = limite;

      // angular error

      this.tmp.crossVectors(this.ax1, this.ax2);
      this.r3.limitMotor2.angle = _Math.dotVectors(this.tan, this.tmp);
      this.r3.limitMotor3.angle = _Math.dotVectors(this.bin, this.tmp);

      // preSolve

      this.r3.preSolve(timeStep, invTimeStep);
      this.t3.preSolve(timeStep, invTimeStep);

    },

    solve: function () {

      this.r3.solve();
      this.t3.solve();

    },

    postSolve: function () {

    }

  });

  /**
   * A wheel joint allows for relative rotation between two rigid bodies along two axes.
   * The wheel joint also allows for relative translation for the suspension.
   *
   * @author saharan
   * @author lo-th
   */

  function WheelJoint(config) {

    Joint.call(this, config);

    this.type = JOINT_WHEEL;

    // The axis in the first body's coordinate system.
    this.localAxis1 = config.localAxis1.clone().normalize();
    // The axis in the second body's coordinate system.
    this.localAxis2 = config.localAxis2.clone().normalize();

    this.localAngle1 = new Vec3();
    this.localAngle2 = new Vec3();

    var dot = _Math.dotVectors(this.localAxis1, this.localAxis2);

    if (dot > -1 && dot < 1) {

      this.localAngle1.set(
        this.localAxis2.x - dot * this.localAxis1.x,
        this.localAxis2.y - dot * this.localAxis1.y,
        this.localAxis2.z - dot * this.localAxis1.z
      ).normalize();

      this.localAngle2.set(
        this.localAxis1.x - dot * this.localAxis2.x,
        this.localAxis1.y - dot * this.localAxis2.y,
        this.localAxis1.z - dot * this.localAxis2.z
      ).normalize();

    } else {

      var arc = new Mat33().setQuat(new Quat().setFromUnitVectors(this.localAxis1, this.localAxis2));
      this.localAngle1.tangent(this.localAxis1).normalize();
      this.localAngle2 = this.localAngle1.clone().applyMatrix3(arc, true);

    }

    this.ax1 = new Vec3();
    this.ax2 = new Vec3();
    this.an1 = new Vec3();
    this.an2 = new Vec3();

    this.tmp = new Vec3();

    this.nor = new Vec3();
    this.tan = new Vec3();
    this.bin = new Vec3();

    // The translational limit and motor information of the joint.
    this.translationalLimitMotor = new LimitMotor(this.tan, true);
    this.translationalLimitMotor.frequency = 8;
    this.translationalLimitMotor.dampingRatio = 1;
    // The first rotational limit and motor information of the joint.
    this.rotationalLimitMotor1 = new LimitMotor(this.tan, false);
    // The second rotational limit and motor information of the joint.
    this.rotationalLimitMotor2 = new LimitMotor(this.bin, false);

    this.t3 = new Translational3Constraint(this, new LimitMotor(this.nor, true), this.translationalLimitMotor, new LimitMotor(this.bin, true));
    this.t3.weight = 1;
    this.r3 = new Rotational3Constraint(this, new LimitMotor(this.nor, true), this.rotationalLimitMotor1, this.rotationalLimitMotor2);

  }
  WheelJoint.prototype = Object.assign(Object.create(Joint.prototype), {

    constructor: WheelJoint,

    preSolve: function (timeStep, invTimeStep) {

      this.updateAnchorPoints();

      this.ax1.copy(this.localAxis1).applyMatrix3(this.body1.rotation, true);
      this.an1.copy(this.localAngle1).applyMatrix3(this.body1.rotation, true);

      this.ax2.copy(this.localAxis2).applyMatrix3(this.body2.rotation, true);
      this.an2.copy(this.localAngle2).applyMatrix3(this.body2.rotation, true);

      this.r3.limitMotor1.angle = _Math.dotVectors(this.ax1, this.ax2);

      var limite = _Math.dotVectors(this.an1, this.ax2);

      if (_Math.dotVectors(this.ax1, this.tmp.crossVectors(this.an1, this.ax2)) < 0) this.rotationalLimitMotor1.angle = -limite;
      else this.rotationalLimitMotor1.angle = limite;

      limite = _Math.dotVectors(this.an2, this.ax1);

      if (_Math.dotVectors(this.ax2, this.tmp.crossVectors(this.an2, this.ax1)) < 0) this.rotationalLimitMotor2.angle = -limite;
      else this.rotationalLimitMotor2.angle = limite;

      this.nor.crossVectors(this.ax1, this.ax2).normalize();
      this.tan.crossVectors(this.nor, this.ax2).normalize();
      this.bin.crossVectors(this.nor, this.ax1).normalize();

      this.r3.preSolve(timeStep, invTimeStep);
      this.t3.preSolve(timeStep, invTimeStep);

    },

    solve: function () {

      this.r3.solve();
      this.t3.solve();

    },

    postSolve: function () {

    }

  });

  function JointConfig() {

    this.scale = 1;
    this.invScale = 1;

    // The first rigid body of the joint.
    this.body1 = null;
    // The second rigid body of the joint.
    this.body2 = null;
    // The anchor point on the first rigid body in local coordinate system.
    this.localAnchorPoint1 = new Vec3();
    //  The anchor point on the second rigid body in local coordinate system.
    this.localAnchorPoint2 = new Vec3();
    // The axis in the first body's coordinate system.
    // his property is available in some joints.
    this.localAxis1 = new Vec3();
    // The axis in the second body's coordinate system.
    // This property is available in some joints.
    this.localAxis2 = new Vec3();
    //  Whether allow collision between connected rigid bodies or not.
    this.allowCollision = false;

  }

  /**
   * This class holds mass information of a shape.
   * @author lo-th
   * @author saharan
   */

  function MassInfo() {

    // Mass of the shape.
    this.mass = 0;

    // The moment inertia of the shape.
    this.inertia = new Mat33();

  }

  /**
  * A link list of contacts.
  * @author saharan
  */
  function ContactLink(contact) {

    // The previous contact link.
    this.prev = null;
    // The next contact link.
    this.next = null;
    // The shape of the contact.
    this.shape = null;
    // The other rigid body.
    this.body = null;
    // The contact of the link.
    this.contact = contact;

  }

  function ImpulseDataBuffer() {

    this.lp1X = NaN;
    this.lp1Y = NaN;
    this.lp1Z = NaN;
    this.lp2X = NaN;
    this.lp2Y = NaN;
    this.lp2Z = NaN;
    this.impulse = NaN;

  }

  /**
  * The class holds details of the contact point.
  * @author saharan
  */

  function ManifoldPoint() {

    // Whether this manifold point is persisting or not.
    this.warmStarted = false;
    //  The position of this manifold point.
    this.position = new Vec3();
    // The position in the first shape's coordinate.
    this.localPoint1 = new Vec3();
    //  The position in the second shape's coordinate.
    this.localPoint2 = new Vec3();
    // The normal vector of this manifold point.
    this.normal = new Vec3();
    // The tangent vector of this manifold point.
    this.tangent = new Vec3();
    // The binormal vector of this manifold point.
    this.binormal = new Vec3();
    // The impulse in normal direction.
    this.normalImpulse = 0;
    // The impulse in tangent direction.
    this.tangentImpulse = 0;
    // The impulse in binormal direction.
    this.binormalImpulse = 0;
    // The denominator in normal direction.
    this.normalDenominator = 0;
    // The denominator in tangent direction.
    this.tangentDenominator = 0;
    // The denominator in binormal direction.
    this.binormalDenominator = 0;
    // The depth of penetration.
    this.penetration = 0;

  }

  /**
  * A contact manifold between two shapes.
  * @author saharan
  * @author lo-th
  */

  function ContactManifold() {

    // The first rigid body.
    this.body1 = null;
    // The second rigid body.
    this.body2 = null;
    // The number of manifold points.
    this.numPoints = 0;
    // The manifold points.
    this.points = [
      new ManifoldPoint(),
      new ManifoldPoint(),
      new ManifoldPoint(),
      new ManifoldPoint()
    ];

  }

  ContactManifold.prototype = {

    constructor: ContactManifold,

    //Reset the manifold.
    reset: function (shape1, shape2) {

      this.body1 = shape1.parent;
      this.body2 = shape2.parent;
      this.numPoints = 0;

    },

    //  Add a point into this manifold.
    addPointVec: function (pos, norm, penetration, flip) {

      var p = this.points[this.numPoints++];

      p.position.copy(pos);
      p.localPoint1.sub(pos, this.body1.position).applyMatrix3(this.body1.rotation);
      p.localPoint2.sub(pos, this.body2.position).applyMatrix3(this.body2.rotation);

      p.normal.copy(norm);
      if (flip) p.normal.negate();

      p.normalImpulse = 0;
      p.penetration = penetration;
      p.warmStarted = false;

    },

    //  Add a point into this manifold.
    addPoint: function (x, y, z, nx, ny, nz, penetration, flip) {

      var p = this.points[this.numPoints++];

      p.position.set(x, y, z);
      p.localPoint1.sub(p.position, this.body1.position).applyMatrix3(this.body1.rotation);
      p.localPoint2.sub(p.position, this.body2.position).applyMatrix3(this.body2.rotation);

      p.normalImpulse = 0;

      p.normal.set(nx, ny, nz);
      if (flip) p.normal.negate();

      p.penetration = penetration;
      p.warmStarted = false;

    }
  };

  function ContactPointDataBuffer() {

    this.nor = new Vec3();
    this.tan = new Vec3();
    this.bin = new Vec3();

    this.norU1 = new Vec3();
    this.tanU1 = new Vec3();
    this.binU1 = new Vec3();

    this.norU2 = new Vec3();
    this.tanU2 = new Vec3();
    this.binU2 = new Vec3();

    this.norT1 = new Vec3();
    this.tanT1 = new Vec3();
    this.binT1 = new Vec3();

    this.norT2 = new Vec3();
    this.tanT2 = new Vec3();
    this.binT2 = new Vec3();

    this.norTU1 = new Vec3();
    this.tanTU1 = new Vec3();
    this.binTU1 = new Vec3();

    this.norTU2 = new Vec3();
    this.tanTU2 = new Vec3();
    this.binTU2 = new Vec3();

    this.norImp = 0;
    this.tanImp = 0;
    this.binImp = 0;

    this.norDen = 0;
    this.tanDen = 0;
    this.binDen = 0;

    this.norTar = 0;

    this.next = null;
    this.last = false;

  }

  /**
  * ...
  * @author saharan
  */
  function ContactConstraint(manifold) {

    Constraint.call(this);
    // The contact manifold of the constraint.
    this.manifold = manifold;
    // The coefficient of restitution of the constraint.
    this.restitution = NaN;
    // The coefficient of friction of the constraint.
    this.friction = NaN;
    this.p1 = null;
    this.p2 = null;
    this.lv1 = null;
    this.lv2 = null;
    this.av1 = null;
    this.av2 = null;
    this.i1 = null;
    this.i2 = null;

    //this.ii1 = null;
    //this.ii2 = null;

    this.tmp = new Vec3();
    this.tmpC1 = new Vec3();
    this.tmpC2 = new Vec3();

    this.tmpP1 = new Vec3();
    this.tmpP2 = new Vec3();

    this.tmplv1 = new Vec3();
    this.tmplv2 = new Vec3();
    this.tmpav1 = new Vec3();
    this.tmpav2 = new Vec3();

    this.m1 = NaN;
    this.m2 = NaN;
    this.num = 0;

    this.ps = manifold.points;
    this.cs = new ContactPointDataBuffer();
    this.cs.next = new ContactPointDataBuffer();
    this.cs.next.next = new ContactPointDataBuffer();
    this.cs.next.next.next = new ContactPointDataBuffer();
  }

  ContactConstraint.prototype = Object.assign(Object.create(Constraint.prototype), {

    constructor: ContactConstraint,

    // Attach the constraint to the bodies.
    attach: function () {

      this.p1 = this.body1.position;
      this.p2 = this.body2.position;
      this.lv1 = this.body1.linearVelocity;
      this.av1 = this.body1.angularVelocity;
      this.lv2 = this.body2.linearVelocity;
      this.av2 = this.body2.angularVelocity;
      this.i1 = this.body1.inverseInertia;
      this.i2 = this.body2.inverseInertia;

    },

    // Detach the constraint from the bodies.
    detach: function () {

      this.p1 = null;
      this.p2 = null;
      this.lv1 = null;
      this.lv2 = null;
      this.av1 = null;
      this.av2 = null;
      this.i1 = null;
      this.i2 = null;

    },

    preSolve: function (timeStep, invTimeStep) {

      this.m1 = this.body1.inverseMass;
      this.m2 = this.body2.inverseMass;

      var m1m2 = this.m1 + this.m2;

      this.num = this.manifold.numPoints;

      var c = this.cs;
      var p, rvn, len, norImp, norTar, sepV, i1, i2;
      for (var i = 0; i < this.num; i++) {

        p = this.ps[i];

        this.tmpP1.sub(p.position, this.p1);
        this.tmpP2.sub(p.position, this.p2);

        this.tmpC1.crossVectors(this.av1, this.tmpP1);
        this.tmpC2.crossVectors(this.av2, this.tmpP2);

        c.norImp = p.normalImpulse;
        c.tanImp = p.tangentImpulse;
        c.binImp = p.binormalImpulse;

        c.nor.copy(p.normal);

        this.tmp.set(

          (this.lv2.x + this.tmpC2.x) - (this.lv1.x + this.tmpC1.x),
          (this.lv2.y + this.tmpC2.y) - (this.lv1.y + this.tmpC1.y),
          (this.lv2.z + this.tmpC2.z) - (this.lv1.z + this.tmpC1.z)

        );

        rvn = _Math.dotVectors(c.nor, this.tmp);

        c.tan.set(
          this.tmp.x - rvn * c.nor.x,
          this.tmp.y - rvn * c.nor.y,
          this.tmp.z - rvn * c.nor.z
        );

        len = _Math.dotVectors(c.tan, c.tan);

        if (len <= 0.04) {
          c.tan.tangent(c.nor);
        }

        c.tan.normalize();

        c.bin.crossVectors(c.nor, c.tan);

        c.norU1.scale(c.nor, this.m1);
        c.norU2.scale(c.nor, this.m2);

        c.tanU1.scale(c.tan, this.m1);
        c.tanU2.scale(c.tan, this.m2);

        c.binU1.scale(c.bin, this.m1);
        c.binU2.scale(c.bin, this.m2);

        c.norT1.crossVectors(this.tmpP1, c.nor);
        c.tanT1.crossVectors(this.tmpP1, c.tan);
        c.binT1.crossVectors(this.tmpP1, c.bin);

        c.norT2.crossVectors(this.tmpP2, c.nor);
        c.tanT2.crossVectors(this.tmpP2, c.tan);
        c.binT2.crossVectors(this.tmpP2, c.bin);

        i1 = this.i1;
        i2 = this.i2;

        c.norTU1.copy(c.norT1).applyMatrix3(i1, true);
        c.tanTU1.copy(c.tanT1).applyMatrix3(i1, true);
        c.binTU1.copy(c.binT1).applyMatrix3(i1, true);

        c.norTU2.copy(c.norT2).applyMatrix3(i2, true);
        c.tanTU2.copy(c.tanT2).applyMatrix3(i2, true);
        c.binTU2.copy(c.binT2).applyMatrix3(i2, true);

        /*c.norTU1.mulMat( this.i1, c.norT1 );
        c.tanTU1.mulMat( this.i1, c.tanT1 );
        c.binTU1.mulMat( this.i1, c.binT1 );

        c.norTU2.mulMat( this.i2, c.norT2 );
        c.tanTU2.mulMat( this.i2, c.tanT2 );
        c.binTU2.mulMat( this.i2, c.binT2 );*/

        this.tmpC1.crossVectors(c.norTU1, this.tmpP1);
        this.tmpC2.crossVectors(c.norTU2, this.tmpP2);
        this.tmp.add(this.tmpC1, this.tmpC2);
        c.norDen = 1 / (m1m2 + _Math.dotVectors(c.nor, this.tmp));

        this.tmpC1.crossVectors(c.tanTU1, this.tmpP1);
        this.tmpC2.crossVectors(c.tanTU2, this.tmpP2);
        this.tmp.add(this.tmpC1, this.tmpC2);
        c.tanDen = 1 / (m1m2 + _Math.dotVectors(c.tan, this.tmp));

        this.tmpC1.crossVectors(c.binTU1, this.tmpP1);
        this.tmpC2.crossVectors(c.binTU2, this.tmpP2);
        this.tmp.add(this.tmpC1, this.tmpC2);
        c.binDen = 1 / (m1m2 + _Math.dotVectors(c.bin, this.tmp));

        if (p.warmStarted) {

          norImp = p.normalImpulse;

          this.lv1.addScaledVector(c.norU1, norImp);
          this.av1.addScaledVector(c.norTU1, norImp);

          this.lv2.subScaledVector(c.norU2, norImp);
          this.av2.subScaledVector(c.norTU2, norImp);

          c.norImp = norImp;
          c.tanImp = 0;
          c.binImp = 0;
          rvn = 0; // disable bouncing

        } else {

          c.norImp = 0;
          c.tanImp = 0;
          c.binImp = 0;

        }


        if (rvn > -1) rvn = 0; // disable bouncing

        norTar = this.restitution * -rvn;
        sepV = -(p.penetration + 0.005) * invTimeStep * 0.05; // allow 0.5cm error
        if (norTar < sepV) norTar = sepV;
        c.norTar = norTar;
        c.last = i == this.num - 1;
        c = c.next;
      }
    },

    solve: function () {

      this.tmplv1.copy(this.lv1);
      this.tmplv2.copy(this.lv2);
      this.tmpav1.copy(this.av1);
      this.tmpav2.copy(this.av2);

      var oldImp1, newImp1, oldImp2, newImp2, rvn, norImp, tanImp, binImp, max, len;

      var c = this.cs;

      while (true) {

        norImp = c.norImp;
        tanImp = c.tanImp;
        binImp = c.binImp;
        max = -norImp * this.friction;

        this.tmp.sub(this.tmplv2, this.tmplv1);

        rvn = _Math.dotVectors(this.tmp, c.tan) + _Math.dotVectors(this.tmpav2, c.tanT2) - _Math.dotVectors(this.tmpav1, c.tanT1);

        oldImp1 = tanImp;
        newImp1 = rvn * c.tanDen;
        tanImp += newImp1;

        rvn = _Math.dotVectors(this.tmp, c.bin) + _Math.dotVectors(this.tmpav2, c.binT2) - _Math.dotVectors(this.tmpav1, c.binT1);

        oldImp2 = binImp;
        newImp2 = rvn * c.binDen;
        binImp += newImp2;

        // cone friction clamp
        len = tanImp * tanImp + binImp * binImp;
        if (len > max * max) {
          len = max / _Math.sqrt(len);
          tanImp *= len;
          binImp *= len;
        }

        newImp1 = tanImp - oldImp1;
        newImp2 = binImp - oldImp2;

        //

        this.tmp.set(
          c.tanU1.x * newImp1 + c.binU1.x * newImp2,
          c.tanU1.y * newImp1 + c.binU1.y * newImp2,
          c.tanU1.z * newImp1 + c.binU1.z * newImp2
        );

        this.tmplv1.addEqual(this.tmp);

        this.tmp.set(
          c.tanTU1.x * newImp1 + c.binTU1.x * newImp2,
          c.tanTU1.y * newImp1 + c.binTU1.y * newImp2,
          c.tanTU1.z * newImp1 + c.binTU1.z * newImp2
        );

        this.tmpav1.addEqual(this.tmp);

        this.tmp.set(
          c.tanU2.x * newImp1 + c.binU2.x * newImp2,
          c.tanU2.y * newImp1 + c.binU2.y * newImp2,
          c.tanU2.z * newImp1 + c.binU2.z * newImp2
        );

        this.tmplv2.subEqual(this.tmp);

        this.tmp.set(
          c.tanTU2.x * newImp1 + c.binTU2.x * newImp2,
          c.tanTU2.y * newImp1 + c.binTU2.y * newImp2,
          c.tanTU2.z * newImp1 + c.binTU2.z * newImp2
        );

        this.tmpav2.subEqual(this.tmp);

        // restitution part

        this.tmp.sub(this.tmplv2, this.tmplv1);

        rvn = _Math.dotVectors(this.tmp, c.nor) + _Math.dotVectors(this.tmpav2, c.norT2) - _Math.dotVectors(this.tmpav1, c.norT1);

        oldImp1 = norImp;
        newImp1 = (rvn - c.norTar) * c.norDen;
        norImp += newImp1;
        if (norImp > 0) norImp = 0;

        newImp1 = norImp - oldImp1;

        this.tmplv1.addScaledVector(c.norU1, newImp1);
        this.tmpav1.addScaledVector(c.norTU1, newImp1);
        this.tmplv2.subScaledVector(c.norU2, newImp1);
        this.tmpav2.subScaledVector(c.norTU2, newImp1);

        c.norImp = norImp;
        c.tanImp = tanImp;
        c.binImp = binImp;

        if (c.last) break;
        c = c.next;
      }

      this.lv1.copy(this.tmplv1);
      this.lv2.copy(this.tmplv2);
      this.av1.copy(this.tmpav1);
      this.av2.copy(this.tmpav2);

    },

    postSolve: function () {

      var c = this.cs, p;
      var i = this.num;
      while (i--) {
        //for(var i=0;i<this.num;i++){
        p = this.ps[i];
        p.normal.copy(c.nor);
        p.tangent.copy(c.tan);
        p.binormal.copy(c.bin);

        p.normalImpulse = c.norImp;
        p.tangentImpulse = c.tanImp;
        p.binormalImpulse = c.binImp;
        p.normalDenominator = c.norDen;
        p.tangentDenominator = c.tanDen;
        p.binormalDenominator = c.binDen;
        c = c.next;
      }
    }

  });

  /**
  * A contact is a pair of shapes whose axis-aligned bounding boxes are overlapping.
  * @author saharan
  */

  function Contact() {

    // The first shape.
    this.shape1 = null;
    // The second shape.
    this.shape2 = null;
    // The first rigid body.
    this.body1 = null;
    // The second rigid body.
    this.body2 = null;
    // The previous contact in the world.
    this.prev = null;
    // The next contact in the world.
    this.next = null;
    // Internal
    this.persisting = false;
    // Whether both the rigid bodies are sleeping or not.
    this.sleeping = false;
    // The collision detector between two shapes.
    this.detector = null;
    // The contact constraint of the contact.
    this.constraint = null;
    // Whether the shapes are touching or not.
    this.touching = false;
    // shapes is very close and touching 
    this.close = false;

    this.dist = _Math.INF;

    this.b1Link = new ContactLink(this);
    this.b2Link = new ContactLink(this);
    this.s1Link = new ContactLink(this);
    this.s2Link = new ContactLink(this);

    // The contact manifold of the contact.
    this.manifold = new ContactManifold();

    this.buffer = [

      new ImpulseDataBuffer(),
      new ImpulseDataBuffer(),
      new ImpulseDataBuffer(),
      new ImpulseDataBuffer()

    ];

    this.points = this.manifold.points;
    this.constraint = new ContactConstraint(this.manifold);

  }

  Object.assign(Contact.prototype, {

    Contact: true,

    mixRestitution: function (restitution1, restitution2) {

      return _Math.sqrt(restitution1 * restitution2);

    },
    mixFriction: function (friction1, friction2) {

      return _Math.sqrt(friction1 * friction2);

    },

    /**
    * Update the contact manifold.
    */
    updateManifold: function () {

      this.constraint.restitution = this.mixRestitution(this.shape1.restitution, this.shape2.restitution);
      this.constraint.friction = this.mixFriction(this.shape1.friction, this.shape2.friction);
      var numBuffers = this.manifold.numPoints;
      var i = numBuffers;
      while (i--) {
        //for(var i=0;i<numBuffers;i++){
        var b = this.buffer[i];
        var p = this.points[i];
        b.lp1X = p.localPoint1.x;
        b.lp1Y = p.localPoint1.y;
        b.lp1Z = p.localPoint1.z;
        b.lp2X = p.localPoint2.x;
        b.lp2Y = p.localPoint2.y;
        b.lp2Z = p.localPoint2.z;
        b.impulse = p.normalImpulse;
      }
      this.manifold.numPoints = 0;
      this.detector.detectCollision(this.shape1, this.shape2, this.manifold);
      var num = this.manifold.numPoints;
      if (num == 0) {
        this.touching = false;
        this.close = false;
        this.dist = _Math.INF;
        return;
      }

      if (this.touching || this.dist < 0.001) this.close = true;
      this.touching = true;
      i = num;
      while (i--) {
        //for(i=0; i<num; i++){
        p = this.points[i];
        var lp1x = p.localPoint1.x;
        var lp1y = p.localPoint1.y;
        var lp1z = p.localPoint1.z;
        var lp2x = p.localPoint2.x;
        var lp2y = p.localPoint2.y;
        var lp2z = p.localPoint2.z;
        var index = -1;
        var minDistance = 0.0004;
        var j = numBuffers;
        while (j--) {
          //for(var j=0;j<numBuffers;j++){
          b = this.buffer[j];
          var dx = b.lp1X - lp1x;
          var dy = b.lp1Y - lp1y;
          var dz = b.lp1Z - lp1z;
          var distance1 = dx * dx + dy * dy + dz * dz;
          dx = b.lp2X - lp2x;
          dy = b.lp2Y - lp2y;
          dz = b.lp2Z - lp2z;
          var distance2 = dx * dx + dy * dy + dz * dz;
          if (distance1 < distance2) {
            if (distance1 < minDistance) {
              minDistance = distance1;
              index = j;
            }
          } else {
            if (distance2 < minDistance) {
              minDistance = distance2;
              index = j;
            }
          }

          if (minDistance < this.dist) this.dist = minDistance;

        }
        if (index != -1) {
          var tmp = this.buffer[index];
          this.buffer[index] = this.buffer[--numBuffers];
          this.buffer[numBuffers] = tmp;
          p.normalImpulse = tmp.impulse;
          p.warmStarted = true;
        } else {
          p.normalImpulse = 0;
          p.warmStarted = false;
        }
      }
    },
    /**
    * Attach the contact to the shapes.
    * @param   shape1
    * @param   shape2
    */
    attach: function (shape1, shape2) {
      this.shape1 = shape1;
      this.shape2 = shape2;
      this.body1 = shape1.parent;
      this.body2 = shape2.parent;

      this.manifold.body1 = this.body1;
      this.manifold.body2 = this.body2;
      this.constraint.body1 = this.body1;
      this.constraint.body2 = this.body2;
      this.constraint.attach();

      this.s1Link.shape = shape2;
      this.s1Link.body = this.body2;
      this.s2Link.shape = shape1;
      this.s2Link.body = this.body1;

      if (shape1.contactLink != null) (this.s1Link.next = shape1.contactLink).prev = this.s1Link;
      else this.s1Link.next = null;
      shape1.contactLink = this.s1Link;
      shape1.numContacts++;

      if (shape2.contactLink != null) (this.s2Link.next = shape2.contactLink).prev = this.s2Link;
      else this.s2Link.next = null;
      shape2.contactLink = this.s2Link;
      shape2.numContacts++;

      this.b1Link.shape = shape2;
      this.b1Link.body = this.body2;
      this.b2Link.shape = shape1;
      this.b2Link.body = this.body1;

      if (this.body1.contactLink != null) (this.b1Link.next = this.body1.contactLink).prev = this.b1Link;
      else this.b1Link.next = null;
      this.body1.contactLink = this.b1Link;
      this.body1.numContacts++;

      if (this.body2.contactLink != null) (this.b2Link.next = this.body2.contactLink).prev = this.b2Link;
      else this.b2Link.next = null;
      this.body2.contactLink = this.b2Link;
      this.body2.numContacts++;

      this.prev = null;
      this.next = null;

      this.persisting = true;
      this.sleeping = this.body1.sleeping && this.body2.sleeping;
      this.manifold.numPoints = 0;
    },
    /**
    * Detach the contact from the shapes.
    */
    detach: function () {
      var prev = this.s1Link.prev;
      var next = this.s1Link.next;
      if (prev !== null) prev.next = next;
      if (next !== null) next.prev = prev;
      if (this.shape1.contactLink == this.s1Link) this.shape1.contactLink = next;
      this.s1Link.prev = null;
      this.s1Link.next = null;
      this.s1Link.shape = null;
      this.s1Link.body = null;
      this.shape1.numContacts--;

      prev = this.s2Link.prev;
      next = this.s2Link.next;
      if (prev !== null) prev.next = next;
      if (next !== null) next.prev = prev;
      if (this.shape2.contactLink == this.s2Link) this.shape2.contactLink = next;
      this.s2Link.prev = null;
      this.s2Link.next = null;
      this.s2Link.shape = null;
      this.s2Link.body = null;
      this.shape2.numContacts--;

      prev = this.b1Link.prev;
      next = this.b1Link.next;
      if (prev !== null) prev.next = next;
      if (next !== null) next.prev = prev;
      if (this.body1.contactLink == this.b1Link) this.body1.contactLink = next;
      this.b1Link.prev = null;
      this.b1Link.next = null;
      this.b1Link.shape = null;
      this.b1Link.body = null;
      this.body1.numContacts--;

      prev = this.b2Link.prev;
      next = this.b2Link.next;
      if (prev !== null) prev.next = next;
      if (next !== null) next.prev = prev;
      if (this.body2.contactLink == this.b2Link) this.body2.contactLink = next;
      this.b2Link.prev = null;
      this.b2Link.next = null;
      this.b2Link.shape = null;
      this.b2Link.body = null;
      this.body2.numContacts--;

      this.manifold.body1 = null;
      this.manifold.body2 = null;
      this.constraint.body1 = null;
      this.constraint.body2 = null;
      this.constraint.detach();

      this.shape1 = null;
      this.shape2 = null;
      this.body1 = null;
      this.body2 = null;
    }

  });

  /**
  * The class of rigid body.
  * Rigid body has the shape of a single or multiple collision processing,
  * I can set the parameters individually.
  * @author saharan
  * @author lo-th
  */

  function RigidBody(Position, Rotation) {

    this.position = Position || new Vec3();
    this.orientation = Rotation || new Quat();

    this.scale = 1;
    this.invScale = 1;

    // possible link to three Mesh;
    this.mesh = null;

    this.id = NaN;
    this.name = "";
    // The maximum number of shapes that can be added to a one rigid.
    //this.MAX_SHAPES = 64;//64;

    this.prev = null;
    this.next = null;

    // I represent the kind of rigid body.
    // Please do not change from the outside this variable.
    // If you want to change the type of rigid body, always
    // Please specify the type you want to set the arguments of setupMass method.
    this.type = BODY_NULL;

    this.massInfo = new MassInfo();

    this.newPosition = new Vec3();
    this.controlPos = false;
    this.newOrientation = new Quat();
    this.newRotation = new Vec3();
    this.currentRotation = new Vec3();
    this.controlRot = false;
    this.controlRotInTime = false;

    this.quaternion = new Quat();
    this.pos = new Vec3();



    // Is the translational velocity.
    this.linearVelocity = new Vec3();
    // Is the angular velocity.
    this.angularVelocity = new Vec3();

    //--------------------------------------------
    //  Please do not change from the outside this variables.
    //--------------------------------------------

    // It is a world that rigid body has been added.
    this.parent = null;
    this.contactLink = null;
    this.numContacts = 0;

    // An array of shapes that are included in the rigid body.
    this.shapes = null;
    // The number of shapes that are included in the rigid body.
    this.numShapes = 0;

    // It is the link array of joint that is connected to the rigid body.
    this.jointLink = null;
    // The number of joints that are connected to the rigid body.
    this.numJoints = 0;

    // It is the world coordinate of the center of gravity in the sleep just before.
    this.sleepPosition = new Vec3();
    // It is a quaternion that represents the attitude of sleep just before.
    this.sleepOrientation = new Quat();
    // I will show this rigid body to determine whether it is a rigid body static.
    this.isStatic = false;
    // I indicates that this rigid body to determine whether it is a rigid body dynamic.
    this.isDynamic = false;

    this.isKinematic = false;

    // It is a rotation matrix representing the orientation.
    this.rotation = new Mat33();

    //--------------------------------------------
    // It will be recalculated automatically from the shape, which is included.
    //--------------------------------------------

    // This is the weight.
    this.mass = 0;
    // It is the reciprocal of the mass.
    this.inverseMass = 0;
    // It is the inverse of the inertia tensor in the world system.
    this.inverseInertia = new Mat33();
    // It is the inertia tensor in the initial state.
    this.localInertia = new Mat33();
    // It is the inverse of the inertia tensor in the initial state.
    this.inverseLocalInertia = new Mat33();

    this.tmpInertia = new Mat33();


    // I indicates rigid body whether it has been added to the simulation Island.
    this.addedToIsland = false;
    // It shows how to sleep rigid body.
    this.allowSleep = true;
    // This is the time from when the rigid body at rest.
    this.sleepTime = 0;
    // I shows rigid body to determine whether it is a sleep state.
    this.sleeping = false;

  }

  Object.assign(RigidBody.prototype, {

    setParent: function (world) {

      this.parent = world;
      this.scale = this.parent.scale;
      this.invScale = this.parent.invScale;
      this.id = this.parent.numRigidBodies;
      if (!this.name) this.name = this.id;

      this.updateMesh();

    },

    /**
     * I'll add a shape to rigid body.
     * If you add a shape, please call the setupMass method to step up to the start of the next.
     * @param   shape shape to Add
     */
    addShape: function (shape) {

      if (shape.parent) {
        printError("RigidBody", "It is not possible that you add a shape which already has an associated body.");
      }

      if (this.shapes != null) (this.shapes.prev = shape).next = this.shapes;
      this.shapes = shape;
      shape.parent = this;
      if (this.parent) this.parent.addShape(shape);
      this.numShapes++;

    },
    /**
     * I will delete the shape from the rigid body.
     * If you delete a shape, please call the setupMass method to step up to the start of the next.
     * @param shape {Shape} to delete
     * @return void
     */
    removeShape: function (shape) {

      var remove = shape;
      if (remove.parent != this) return;
      var prev = remove.prev;
      var next = remove.next;
      if (prev != null) prev.next = next;
      if (next != null) next.prev = prev;
      if (this.shapes == remove) this.shapes = next;
      remove.prev = null;
      remove.next = null;
      remove.parent = null;
      if (this.parent) this.parent.removeShape(remove);
      this.numShapes--;

    },

    remove: function () {

      this.dispose();

    },

    dispose: function () {

      this.parent.removeRigidBody(this);

    },

    checkContact: function (name) {

      this.parent.checkContact(this.name, name);

    },

    /**
     * Calulates mass datas(center of gravity, mass, moment inertia, etc...).
     * If the parameter type is set to BODY_STATIC, the rigid body will be fixed to the space.
     * If the parameter adjustPosition is set to true, the shapes' relative positions and
     * the rigid body's position will be adjusted to the center of gravity.
     * @param type
     * @param adjustPosition
     * @return void
     */
    setupMass: function (type, AdjustPosition) {

      var adjustPosition = (AdjustPosition !== undefined) ? AdjustPosition : true;

      this.type = type || BODY_STATIC;
      this.isDynamic = this.type === BODY_DYNAMIC;
      this.isStatic = this.type === BODY_STATIC;

      this.mass = 0;
      this.localInertia.set(0, 0, 0, 0, 0, 0, 0, 0, 0);


      var tmpM = new Mat33();
      var tmpV = new Vec3();

      for (var shape = this.shapes; shape !== null; shape = shape.next) {

        shape.calculateMassInfo(this.massInfo);
        var shapeMass = this.massInfo.mass;
        tmpV.addScaledVector(shape.relativePosition, shapeMass);
        this.mass += shapeMass;
        this.rotateInertia(shape.relativeRotation, this.massInfo.inertia, tmpM);
        this.localInertia.add(tmpM);

        // add offset inertia
        this.localInertia.addOffset(shapeMass, shape.relativePosition);

      }

      this.inverseMass = 1 / this.mass;
      tmpV.scaleEqual(this.inverseMass);

      if (adjustPosition) {
        this.position.add(tmpV);
        for (shape = this.shapes; shape !== null; shape = shape.next) {
          shape.relativePosition.subEqual(tmpV);
        }

        // subtract offset inertia
        this.localInertia.subOffset(this.mass, tmpV);

      }

      this.inverseLocalInertia.invert(this.localInertia);

      //}

      if (this.type === BODY_STATIC) {
        this.inverseMass = 0;
        this.inverseLocalInertia.set(0, 0, 0, 0, 0, 0, 0, 0, 0);
      }

      this.syncShapes();
      this.awake();

    },
    /**
     * Awake the rigid body.
     */
    awake: function () {

      if (!this.allowSleep || !this.sleeping) return;
      this.sleeping = false;
      this.sleepTime = 0;
      // awake connected constraints
      var cs = this.contactLink;
      while (cs != null) {
        cs.body.sleepTime = 0;
        cs.body.sleeping = false;
        cs = cs.next;
      }
      var js = this.jointLink;
      while (js != null) {
        js.body.sleepTime = 0;
        js.body.sleeping = false;
        js = js.next;
      }
      for (var shape = this.shapes; shape != null; shape = shape.next) {
        shape.updateProxy();
      }

    },
    /**
     * Sleep the rigid body.
     */
    sleep: function () {

      if (!this.allowSleep || this.sleeping) return;

      this.linearVelocity.set(0, 0, 0);
      this.angularVelocity.set(0, 0, 0);
      this.sleepPosition.copy(this.position);
      this.sleepOrientation.copy(this.orientation);

      this.sleepTime = 0;
      this.sleeping = true;
      for (var shape = this.shapes; shape != null; shape = shape.next) {
        shape.updateProxy();
      }
    },

    testWakeUp: function () {

      if (this.linearVelocity.testZero() || this.angularVelocity.testZero() || this.position.testDiff(this.sleepPosition) || this.orientation.testDiff(this.sleepOrientation)) this.awake(); // awake the body

    },

    /**
     * Get whether the rigid body has not any connection with others.
     * @return {void}
     */
    isLonely: function () {
      return this.numJoints == 0 && this.numContacts == 0;
    },

    /**
     * The time integration of the motion of a rigid body, you can update the information such as the shape.
     * This method is invoked automatically when calling the step of the World,
     * There is no need to call from outside usually.
     * @param  timeStep time
     * @return {void}
     */

    updatePosition: function (timeStep) {
      switch (this.type) {
        case BODY_STATIC:
          this.linearVelocity.set(0, 0, 0);
          this.angularVelocity.set(0, 0, 0);

          // ONLY FOR TEST
          if (this.controlPos) {
            this.position.copy(this.newPosition);
            this.controlPos = false;
          }
          if (this.controlRot) {
            this.orientation.copy(this.newOrientation);
            this.controlRot = false;
          }
          /*this.linearVelocity.x=0;
          this.linearVelocity.y=0;
          this.linearVelocity.z=0;
          this.angularVelocity.x=0;
          this.angularVelocity.y=0;
          this.angularVelocity.z=0;*/
          break;
        case BODY_DYNAMIC:

          if (this.isKinematic) {

            this.linearVelocity.set(0, 0, 0);
            this.angularVelocity.set(0, 0, 0);

          }

          if (this.controlPos) {

            this.linearVelocity.subVectors(this.newPosition, this.position).multiplyScalar(1 / timeStep);
            this.controlPos = false;

          }
          if (this.controlRot) {

            this.angularVelocity.copy(this.getAxis());
            this.orientation.copy(this.newOrientation);
            this.controlRot = false;

          }

          this.position.addScaledVector(this.linearVelocity, timeStep);
          this.orientation.addTime(this.angularVelocity, timeStep);

          this.updateMesh();

          break;
        default: printError("RigidBody", "Invalid type.");
      }

      this.syncShapes();
      this.updateMesh();

    },

    getAxis: function () {

      return new Vec3(0, 1, 0).applyMatrix3(this.inverseLocalInertia, true).normalize();

    },

    rotateInertia: function (rot, inertia, out) {

      this.tmpInertia.multiplyMatrices(rot, inertia);
      out.multiplyMatrices(this.tmpInertia, rot, true);

    },

    syncShapes: function () {

      this.rotation.setQuat(this.orientation);
      this.rotateInertia(this.rotation, this.inverseLocalInertia, this.inverseInertia);

      for (var shape = this.shapes; shape != null; shape = shape.next) {

        shape.position.copy(shape.relativePosition).applyMatrix3(this.rotation, true).add(this.position);
        // add by QuaziKb
        shape.rotation.multiplyMatrices(this.rotation, shape.relativeRotation);
        shape.updateProxy();
      }
    },


    //---------------------------------------------
    // APPLY IMPULSE FORCE
    //---------------------------------------------

    applyImpulse: function (position, force) {
      this.linearVelocity.addScaledVector(force, this.inverseMass);
      var rel = new Vec3().copy(position).sub(this.position).cross(force).applyMatrix3(this.inverseInertia, true);
      this.angularVelocity.add(rel);
    },


    //---------------------------------------------
    // SET DYNAMIQUE POSITION AND ROTATION
    //---------------------------------------------

    setPosition: function (pos) {
      this.newPosition.copy(pos).multiplyScalar(this.invScale);
      this.controlPos = true;
      if (!this.isKinematic) this.isKinematic = true;
    },

    setQuaternion: function (q) {
      this.newOrientation.set(q.x, q.y, q.z, q.w);
      this.controlRot = true;
      if (!this.isKinematic) this.isKinematic = true;
    },

    setRotation: function (rot) {

      this.newOrientation = new Quat().setFromEuler(rot.x * _Math.degtorad, rot.y * _Math.degtorad, rot.z * _Math.degtorad);//this.rotationVectToQuad( rot );
      this.controlRot = true;

    },

    //---------------------------------------------
    // RESET DYNAMIQUE POSITION AND ROTATION
    //---------------------------------------------

    resetPosition: function (x, y, z) {

      this.linearVelocity.set(0, 0, 0);
      this.angularVelocity.set(0, 0, 0);
      this.position.set(x, y, z).multiplyScalar(this.invScale);
      //this.position.set( x*OIMO.WorldScale.invScale, y*OIMO.WorldScale.invScale, z*OIMO.WorldScale.invScale );
      this.awake();
    },

    resetQuaternion: function (q) {

      this.angularVelocity.set(0, 0, 0);
      this.orientation = new Quat(q.x, q.y, q.z, q.w);
      this.awake();

    },

    resetRotation: function (x, y, z) {

      this.angularVelocity.set(0, 0, 0);
      this.orientation = new Quat().setFromEuler(x * _Math.degtorad, y * _Math.degtorad, z * _Math.degtorad);//this.rotationVectToQuad( new Vec3(x,y,z) );
      this.awake();

    },

    //---------------------------------------------
    // GET POSITION AND ROTATION
    //---------------------------------------------

    getPosition: function () {

      return this.pos;

    },

    getQuaternion: function () {

      return this.quaternion;

    },

    //---------------------------------------------
    // AUTO UPDATE THREE MESH
    //---------------------------------------------

    connectMesh: function (mesh) {

      this.mesh = mesh;
      this.updateMesh();

    },

    updateMesh: function () {

      this.pos.scale(this.position, this.scale);
      this.quaternion.copy(this.orientation);

      if (this.mesh === null) return;

      this.mesh.position.copy(this.getPosition());
      this.mesh.quaternion.copy(this.getQuaternion());

    },

  });

  /**
  * A pair of shapes that may collide.
  * @author saharan
  */
  function Pair(s1, s2) {

    // The first shape.
    this.shape1 = s1 || null;
    // The second shape.
    this.shape2 = s2 || null;

  }

  /**
  * The broad-phase is used for collecting all possible pairs for collision.
  */

  function BroadPhase() {

    this.types = BR_NULL;
    this.numPairChecks = 0;
    this.numPairs = 0;
    this.pairs = [];

  }
  Object.assign(BroadPhase.prototype, {

    BroadPhase: true,

    // Create a new proxy.
    createProxy: function (shape) {

      printError("BroadPhase", "Inheritance error.");

    },

    // Add the proxy into the broad-phase.
    addProxy: function (proxy) {

      printError("BroadPhase", "Inheritance error.");
    },

    // Remove the proxy from the broad-phase.
    removeProxy: function (proxy) {

      printError("BroadPhase", "Inheritance error.");

    },

    // Returns whether the pair is available or not.
    isAvailablePair: function (s1, s2) {

      var b1 = s1.parent;
      var b2 = s2.parent;
      if (b1 == b2 || // same parents
        (!b1.isDynamic && !b2.isDynamic) || // static or kinematic object
        (s1.belongsTo & s2.collidesWith) == 0 ||
        (s2.belongsTo & s1.collidesWith) == 0 // collision filtering
      ) { return false; }
      var js;
      if (b1.numJoints < b2.numJoints) js = b1.jointLink;
      else js = b2.jointLink;
      while (js !== null) {
        var joint = js.joint;
        if (!joint.allowCollision && ((joint.body1 == b1 && joint.body2 == b2) || (joint.body1 == b2 && joint.body2 == b1))) { return false; }
        js = js.next;
      }

      return true;

    },

    // Detect overlapping pairs.
    detectPairs: function () {

      // clear old
      this.pairs = [];
      this.numPairs = 0;
      this.numPairChecks = 0;
      this.collectPairs();

    },

    collectPairs: function () {

    },

    addPair: function (s1, s2) {

      var pair = new Pair(s1, s2);
      this.pairs.push(pair);
      this.numPairs++;

    }

  });

  var count$1 = 0;
  function ProxyIdCount() { return count$1++; }

  /**
   * A proxy is used for broad-phase collecting pairs that can be colliding.
   *
   * @author lo-th
   */

  function Proxy(shape) {

    //The parent shape.
    this.shape = shape;

    //The axis-aligned bounding box.
    this.aabb = shape.aabb;

  }
  Object.assign(Proxy.prototype, {

    Proxy: true,

    // Update the proxy. Must be inherited by a child.

    update: function () {

      printError("Proxy", "Inheritance error.");

    }

  });

  /**
  * A basic implementation of proxies.
  *
  * @author saharan
  */

  function BasicProxy(shape) {

    Proxy.call(this, shape);

    this.id = ProxyIdCount();

  }
  BasicProxy.prototype = Object.assign(Object.create(Proxy.prototype), {

    constructor: BasicProxy,

    update: function () {

    }

  });

  /**
  * A broad-phase algorithm with brute-force search.
  * This always checks for all possible pairs.
  */

  function BruteForceBroadPhase() {

    BroadPhase.call(this);
    this.types = BR_BRUTE_FORCE;
    //this.numProxies=0;
    ///this.maxProxies = 256;
    this.proxies = [];
    //this.proxies.length = 256;

  }

  BruteForceBroadPhase.prototype = Object.assign(Object.create(BroadPhase.prototype), {

    constructor: BruteForceBroadPhase,

    createProxy: function (shape) {

      return new BasicProxy(shape);

    },

    addProxy: function (proxy) {

      /*if(this.numProxies==this.maxProxies){
          //this.maxProxies<<=1;
          this.maxProxies*=2;
          var newProxies=[];
          newProxies.length = this.maxProxies;
          var i = this.numProxies;
          while(i--){
          //for(var i=0, l=this.numProxies;i<l;i++){
              newProxies[i]=this.proxies[i];
          }
          this.proxies=newProxies;
      }*/
      //this.proxies[this.numProxies++] = proxy;
      this.proxies.push(proxy);
      //this.numProxies++;

    },

    removeProxy: function (proxy) {

      var n = this.proxies.indexOf(proxy);
      if (n > -1) {
        this.proxies.splice(n, 1);
        //this.numProxies--;
      }

      /*var i = this.numProxies;
      while(i--){
      //for(var i=0, l=this.numProxies;i<l;i++){
          if(this.proxies[i] == proxy){
              this.proxies[i] = this.proxies[--this.numProxies];
              this.proxies[this.numProxies] = null;
              return;
          }
      }*/

    },

    collectPairs: function () {

      var i = 0, j, p1, p2;

      var px = this.proxies;
      var l = px.length;//this.numProxies;
      //var ar1 = [];
      //var ar2 = [];

      //for( i = px.length ; i-- ; ar1[ i ] = px[ i ] ){};
      //for( i = px.length ; i-- ; ar2[ i ] = px[ i ] ){};

      //var ar1 = JSON.parse(JSON.stringify(this.proxies))
      //var ar2 = JSON.parse(JSON.stringify(this.proxies))

      this.numPairChecks = l * (l - 1) >> 1;
      //this.numPairChecks=this.numProxies*(this.numProxies-1)*0.5;

      while (i < l) {
        p1 = px[i++];
        j = i + 1;
        while (j < l) {
          p2 = px[j++];
          if (p1.aabb.intersectTest(p2.aabb) || !this.isAvailablePair(p1.shape, p2.shape)) continue;
          this.addPair(p1.shape, p2.shape);
        }
      }

    }

  });

  /**
   * A projection axis for sweep and prune broad-phase.
   * @author saharan
   */

  function SAPAxis() {

    this.numElements = 0;
    this.bufferSize = 256;
    this.elements = [];
    this.elements.length = this.bufferSize;
    this.stack = new Float32Array(64);

  }

  Object.assign(SAPAxis.prototype, {

    SAPAxis: true,

    addElements: function (min, max) {

      if (this.numElements + 2 >= this.bufferSize) {
        //this.bufferSize<<=1;
        this.bufferSize *= 2;
        var newElements = [];
        var i = this.numElements;
        while (i--) {
          //for(var i=0, l=this.numElements; i<l; i++){
          newElements[i] = this.elements[i];
        }
      }
      this.elements[this.numElements++] = min;
      this.elements[this.numElements++] = max;

    },

    removeElements: function (min, max) {

      var minIndex = -1;
      var maxIndex = -1;
      for (var i = 0, l = this.numElements; i < l; i++) {
        var e = this.elements[i];
        if (e == min || e == max) {
          if (minIndex == -1) {
            minIndex = i;
          } else {
            maxIndex = i;
            break;
          }
        }
      }
      for (i = minIndex + 1, l = maxIndex; i < l; i++) {
        this.elements[i - 1] = this.elements[i];
      }
      for (i = maxIndex + 1, l = this.numElements; i < l; i++) {
        this.elements[i - 2] = this.elements[i];
      }

      this.elements[--this.numElements] = null;
      this.elements[--this.numElements] = null;

    },

    sort: function () {

      var count = 0;
      var threshold = 1;
      while ((this.numElements >> threshold) != 0) threshold++;
      threshold = threshold * this.numElements >> 2;
      count = 0;

      var giveup = false;
      var elements = this.elements;
      for (var i = 1, l = this.numElements; i < l; i++) { // try insertion sort
        var tmp = elements[i];
        var pivot = tmp.value;
        var tmp2 = elements[i - 1];
        if (tmp2.value > pivot) {
          var j = i;
          do {
            elements[j] = tmp2;
            if (--j == 0) break;
            tmp2 = elements[j - 1];
          } while (tmp2.value > pivot);
          elements[j] = tmp;
          count += i - j;
          if (count > threshold) {
            giveup = true; // stop and use quick sort
            break;
          }
        }
      }
      if (!giveup) return;
      count = 2; var stack = this.stack;
      stack[0] = 0;
      stack[1] = this.numElements - 1;
      while (count > 0) {
        var right = stack[--count];
        var left = stack[--count];
        var diff = right - left;
        if (diff > 16) {  // quick sort
          //var mid=left+(diff>>1);
          var mid = left + (_Math.floor(diff * 0.5));
          tmp = elements[mid];
          elements[mid] = elements[right];
          elements[right] = tmp;
          pivot = tmp.value;
          i = left - 1;
          j = right;
          while (true) {
            var ei;
            var ej;
            do { ei = elements[++i]; } while (ei.value < pivot);
            do { ej = elements[--j]; } while (pivot < ej.value && j != left);
            if (i >= j) break;
            elements[i] = ej;
            elements[j] = ei;
          }

          elements[right] = elements[i];
          elements[i] = tmp;
          if (i - left > right - i) {
            stack[count++] = left;
            stack[count++] = i - 1;
            stack[count++] = i + 1;
            stack[count++] = right;
          } else {
            stack[count++] = i + 1;
            stack[count++] = right;
            stack[count++] = left;
            stack[count++] = i - 1;
          }
        } else {
          for (i = left + 1; i <= right; i++) {
            tmp = elements[i];
            pivot = tmp.value;
            tmp2 = elements[i - 1];
            if (tmp2.value > pivot) {
              j = i;
              do {
                elements[j] = tmp2;
                if (--j == 0) break;
                tmp2 = elements[j - 1];
              } while (tmp2.value > pivot);
              elements[j] = tmp;
            }
          }
        }
      }

    },

    calculateTestCount: function () {

      var num = 1;
      var sum = 0;
      for (var i = 1, l = this.numElements; i < l; i++) {
        if (this.elements[i].max) {
          num--;
        } else {
          sum += num;
          num++;
        }
      }
      return sum;

    }

  });

  /**
   * An element of proxies.
   * @author saharan
   */

  function SAPElement(proxy, max) {

    // The parent proxy
    this.proxy = proxy;
    // The pair element.
    this.pair = null;
    // The minimum element on other axis.
    this.min1 = null;
    // The maximum element on other axis.
    this.max1 = null;
    // The minimum element on other axis.
    this.min2 = null;
    // The maximum element on other axis.
    this.max2 = null;
    // Whether the element has maximum value or not.
    this.max = max;
    // The value of the element.
    this.value = 0;

  }

  /**
   * A proxy for sweep and prune broad-phase.
   * @author saharan
   * @author lo-th
   */

  function SAPProxy(sap, shape) {

    Proxy.call(this, shape);
    // Type of the axis to which the proxy belongs to. [0:none, 1:dynamic, 2:static]
    this.belongsTo = 0;
    // The maximum elements on each axis.
    this.max = [];
    // The minimum elements on each axis.
    this.min = [];

    this.sap = sap;
    this.min[0] = new SAPElement(this, false);
    this.max[0] = new SAPElement(this, true);
    this.min[1] = new SAPElement(this, false);
    this.max[1] = new SAPElement(this, true);
    this.min[2] = new SAPElement(this, false);
    this.max[2] = new SAPElement(this, true);
    this.max[0].pair = this.min[0];
    this.max[1].pair = this.min[1];
    this.max[2].pair = this.min[2];
    this.min[0].min1 = this.min[1];
    this.min[0].max1 = this.max[1];
    this.min[0].min2 = this.min[2];
    this.min[0].max2 = this.max[2];
    this.min[1].min1 = this.min[0];
    this.min[1].max1 = this.max[0];
    this.min[1].min2 = this.min[2];
    this.min[1].max2 = this.max[2];
    this.min[2].min1 = this.min[0];
    this.min[2].max1 = this.max[0];
    this.min[2].min2 = this.min[1];
    this.min[2].max2 = this.max[1];

  }
  SAPProxy.prototype = Object.assign(Object.create(Proxy.prototype), {

    constructor: SAPProxy,


    // Returns whether the proxy is dynamic or not.
    isDynamic: function () {

      var body = this.shape.parent;
      return body.isDynamic && !body.sleeping;

    },

    update: function () {

      var te = this.aabb.elements;
      this.min[0].value = te[0];
      this.min[1].value = te[1];
      this.min[2].value = te[2];
      this.max[0].value = te[3];
      this.max[1].value = te[4];
      this.max[2].value = te[5];

      if (this.belongsTo == 1 && !this.isDynamic() || this.belongsTo == 2 && this.isDynamic()) {
        this.sap.removeProxy(this);
        this.sap.addProxy(this);
      }

    }

  });

  /**
   * A broad-phase collision detection algorithm using sweep and prune.
   * @author saharan
   * @author lo-th
   */

  function SAPBroadPhase() {

    BroadPhase.call(this);
    this.types = BR_SWEEP_AND_PRUNE;

    this.numElementsD = 0;
    this.numElementsS = 0;
    // dynamic proxies
    this.axesD = [
      new SAPAxis(),
      new SAPAxis(),
      new SAPAxis()
    ];
    // static or sleeping proxies
    this.axesS = [
      new SAPAxis(),
      new SAPAxis(),
      new SAPAxis()
    ];

    this.index1 = 0;
    this.index2 = 1;

  }
  SAPBroadPhase.prototype = Object.assign(Object.create(BroadPhase.prototype), {

    constructor: SAPBroadPhase,

    createProxy: function (shape) {

      return new SAPProxy(this, shape);

    },

    addProxy: function (proxy) {

      var p = proxy;
      if (p.isDynamic()) {
        this.axesD[0].addElements(p.min[0], p.max[0]);
        this.axesD[1].addElements(p.min[1], p.max[1]);
        this.axesD[2].addElements(p.min[2], p.max[2]);
        p.belongsTo = 1;
        this.numElementsD += 2;
      } else {
        this.axesS[0].addElements(p.min[0], p.max[0]);
        this.axesS[1].addElements(p.min[1], p.max[1]);
        this.axesS[2].addElements(p.min[2], p.max[2]);
        p.belongsTo = 2;
        this.numElementsS += 2;
      }

    },

    removeProxy: function (proxy) {

      var p = proxy;
      if (p.belongsTo == 0) return;

      /*else if ( p.belongsTo == 1 ) {
          this.axesD[0].removeElements( p.min[0], p.max[0] );
          this.axesD[1].removeElements( p.min[1], p.max[1] );
          this.axesD[2].removeElements( p.min[2], p.max[2] );
          this.numElementsD -= 2;
      } else if ( p.belongsTo == 2 ) {
          this.axesS[0].removeElements( p.min[0], p.max[0] );
          this.axesS[1].removeElements( p.min[1], p.max[1] );
          this.axesS[2].removeElements( p.min[2], p.max[2] );
          this.numElementsS -= 2;
      }*/

      switch (p.belongsTo) {
        case 1:
          this.axesD[0].removeElements(p.min[0], p.max[0]);
          this.axesD[1].removeElements(p.min[1], p.max[1]);
          this.axesD[2].removeElements(p.min[2], p.max[2]);
          this.numElementsD -= 2;
          break;
        case 2:
          this.axesS[0].removeElements(p.min[0], p.max[0]);
          this.axesS[1].removeElements(p.min[1], p.max[1]);
          this.axesS[2].removeElements(p.min[2], p.max[2]);
          this.numElementsS -= 2;
          break;
      }

      p.belongsTo = 0;

    },

    collectPairs: function () {

      if (this.numElementsD == 0) return;

      var axis1 = this.axesD[this.index1];
      var axis2 = this.axesD[this.index2];

      axis1.sort();
      axis2.sort();

      var count1 = axis1.calculateTestCount();
      var count2 = axis2.calculateTestCount();
      var elementsD;
      var elementsS;
      if (count1 <= count2) {// select the best axis
        axis2 = this.axesS[this.index1];
        axis2.sort();
        elementsD = axis1.elements;
        elementsS = axis2.elements;
      } else {
        axis1 = this.axesS[this.index2];
        axis1.sort();
        elementsD = axis2.elements;
        elementsS = axis1.elements;
        this.index1 ^= this.index2;
        this.index2 ^= this.index1;
        this.index1 ^= this.index2;
      }
      var activeD;
      var activeS;
      var p = 0;
      var q = 0;
      while (p < this.numElementsD) {
        var e1;
        var dyn;
        if (q == this.numElementsS) {
          e1 = elementsD[p];
          dyn = true;
          p++;
        } else {
          var d = elementsD[p];
          var s = elementsS[q];
          if (d.value < s.value) {
            e1 = d;
            dyn = true;
            p++;
          } else {
            e1 = s;
            dyn = false;
            q++;
          }
        }
        if (!e1.max) {
          var s1 = e1.proxy.shape;
          var min1 = e1.min1.value;
          var max1 = e1.max1.value;
          var min2 = e1.min2.value;
          var max2 = e1.max2.value;

          for (var e2 = activeD; e2 != null; e2 = e2.pair) {// test for dynamic
            var s2 = e2.proxy.shape;

            this.numPairChecks++;
            if (min1 > e2.max1.value || max1 < e2.min1.value || min2 > e2.max2.value || max2 < e2.min2.value || !this.isAvailablePair(s1, s2)) continue;
            this.addPair(s1, s2);
          }
          if (dyn) {
            for (e2 = activeS; e2 != null; e2 = e2.pair) {// test for static
              s2 = e2.proxy.shape;

              this.numPairChecks++;

              if (min1 > e2.max1.value || max1 < e2.min1.value || min2 > e2.max2.value || max2 < e2.min2.value || !this.isAvailablePair(s1, s2)) continue;
              this.addPair(s1, s2);
            }
            e1.pair = activeD;
            activeD = e1;
          } else {
            e1.pair = activeS;
            activeS = e1;
          }
        } else {
          var min = e1.pair;
          if (dyn) {
            if (min == activeD) {
              activeD = activeD.pair;
              continue;
            } else {
              e1 = activeD;
            }
          } else {
            if (min == activeS) {
              activeS = activeS.pair;
              continue;
            } else {
              e1 = activeS;
            }
          }
          while (e1) {
            e2 = e1.pair;
            if (e2 == min) {
              e1.pair = e2.pair;
              break;
            }
            e1 = e2;
          }
        }
      }
      this.index2 = (this.index1 | this.index2) ^ 3;

    }

  });

  /**
  * A node of the dynamic bounding volume tree.
  * @author saharan
  */

  function DBVTNode() {

    // The first child node of this node.
    this.child1 = null;
    // The second child node of this node.
    this.child2 = null;
    //  The parent node of this tree.
    this.parent = null;
    // The proxy of this node. This has no value if this node is not leaf.
    this.proxy = null;
    // The maximum distance from leaf nodes.
    this.height = 0;
    // The AABB of this node.
    this.aabb = new AABB();

  }

  /**
   * A dynamic bounding volume tree for the broad-phase algorithm.
   *
   * @author saharan
   * @author lo-th
   */

  function DBVT() {

    // The root of the tree.
    this.root = null;
    this.freeNodes = [];
    this.freeNodes.length = 16384;
    this.numFreeNodes = 0;
    this.aabb = new AABB();

  }
  Object.assign(DBVT.prototype, {

    DBVT: true,

    moveLeaf: function (leaf) {

      this.deleteLeaf(leaf);
      this.insertLeaf(leaf);

    },

    insertLeaf: function (leaf) {

      if (this.root == null) {
        this.root = leaf;
        return;
      }
      var lb = leaf.aabb;
      var sibling = this.root;
      var oldArea;
      var newArea;
      while (sibling.proxy == null) { // descend the node to search the best pair
        var c1 = sibling.child1;
        var c2 = sibling.child2;
        var b = sibling.aabb;
        var c1b = c1.aabb;
        var c2b = c2.aabb;
        oldArea = b.surfaceArea();
        this.aabb.combine(lb, b);
        newArea = this.aabb.surfaceArea();
        var creatingCost = newArea * 2;
        var incrementalCost = (newArea - oldArea) * 2; // cost of creating a new pair with the node
        var discendingCost1 = incrementalCost;
        this.aabb.combine(lb, c1b);
        if (c1.proxy != null) {
          // leaf cost = area(combined aabb)
          discendingCost1 += this.aabb.surfaceArea();
        } else {
          // node cost = area(combined aabb) - area(old aabb)
          discendingCost1 += this.aabb.surfaceArea() - c1b.surfaceArea();
        }
        var discendingCost2 = incrementalCost;
        this.aabb.combine(lb, c2b);
        if (c2.proxy != null) {
          // leaf cost = area(combined aabb)
          discendingCost2 += this.aabb.surfaceArea();
        } else {
          // node cost = area(combined aabb) - area(old aabb)
          discendingCost2 += this.aabb.surfaceArea() - c2b.surfaceArea();
        }
        if (discendingCost1 < discendingCost2) {
          if (creatingCost < discendingCost1) {
            break;// stop descending
          } else {
            sibling = c1;// descend into first child
          }
        } else {
          if (creatingCost < discendingCost2) {
            break;// stop descending
          } else {
            sibling = c2;// descend into second child
          }
        }
      }
      var oldParent = sibling.parent;
      var newParent;
      if (this.numFreeNodes > 0) {
        newParent = this.freeNodes[--this.numFreeNodes];
      } else {
        newParent = new DBVTNode();
      }

      newParent.parent = oldParent;
      newParent.child1 = leaf;
      newParent.child2 = sibling;
      newParent.aabb.combine(leaf.aabb, sibling.aabb);
      newParent.height = sibling.height + 1;
      sibling.parent = newParent;
      leaf.parent = newParent;
      if (sibling == this.root) {
        // replace root
        this.root = newParent;
      } else {
        // replace child
        if (oldParent.child1 == sibling) {
          oldParent.child1 = newParent;
        } else {
          oldParent.child2 = newParent;
        }
      }
      // update whole tree
      do {
        newParent = this.balance(newParent);
        this.fix(newParent);
        newParent = newParent.parent;
      } while (newParent != null);
    },

    getBalance: function (node) {

      if (node.proxy != null) return 0;
      return node.child1.height - node.child2.height;

    },

    deleteLeaf: function (leaf) {

      if (leaf == this.root) {
        this.root = null;
        return;
      }
      var parent = leaf.parent;
      var sibling;
      if (parent.child1 == leaf) {
        sibling = parent.child2;
      } else {
        sibling = parent.child1;
      }
      if (parent == this.root) {
        this.root = sibling;
        sibling.parent = null;
        return;
      }
      var grandParent = parent.parent;
      sibling.parent = grandParent;
      if (grandParent.child1 == parent) {
        grandParent.child1 = sibling;
      } else {
        grandParent.child2 = sibling;
      }
      if (this.numFreeNodes < 16384) {
        this.freeNodes[this.numFreeNodes++] = parent;
      }
      do {
        grandParent = this.balance(grandParent);
        this.fix(grandParent);
        grandParent = grandParent.parent;
      } while (grandParent != null);

    },

    balance: function (node) {

      var nh = node.height;
      if (nh < 2) {
        return node;
      }
      var p = node.parent;
      var l = node.child1;
      var r = node.child2;
      var lh = l.height;
      var rh = r.height;
      var balance = lh - rh;
      var t;// for bit operation

      //          [ N ]
      //         /     \
      //    [ L ]       [ R ]
      //     / \         / \
      // [L-L] [L-R] [R-L] [R-R]

      // Is the tree balanced?
      if (balance > 1) {
        var ll = l.child1;
        var lr = l.child2;
        var llh = ll.height;
        var lrh = lr.height;

        // Is L-L higher than L-R?
        if (llh > lrh) {
          // set N to L-R
          l.child2 = node;
          node.parent = l;

          //          [ L ]
          //         /     \
          //    [L-L]       [ N ]
          //     / \         / \
          // [...] [...] [ L ] [ R ]

          // set L-R
          node.child1 = lr;
          lr.parent = node;

          //          [ L ]
          //         /     \
          //    [L-L]       [ N ]
          //     / \         / \
          // [...] [...] [L-R] [ R ]

          // fix bounds and heights
          node.aabb.combine(lr.aabb, r.aabb);
          t = lrh - rh;
          node.height = lrh - (t & t >> 31) + 1;
          l.aabb.combine(ll.aabb, node.aabb);
          t = llh - nh;
          l.height = llh - (t & t >> 31) + 1;
        } else {
          // set N to L-L
          l.child1 = node;
          node.parent = l;

          //          [ L ]
          //         /     \
          //    [ N ]       [L-R]
          //     / \         / \
          // [ L ] [ R ] [...] [...]

          // set L-L
          node.child1 = ll;
          ll.parent = node;

          //          [ L ]
          //         /     \
          //    [ N ]       [L-R]
          //     / \         / \
          // [L-L] [ R ] [...] [...]

          // fix bounds and heights
          node.aabb.combine(ll.aabb, r.aabb);
          t = llh - rh;
          node.height = llh - (t & t >> 31) + 1;

          l.aabb.combine(node.aabb, lr.aabb);
          t = nh - lrh;
          l.height = nh - (t & t >> 31) + 1;
        }
        // set new parent of L
        if (p != null) {
          if (p.child1 == node) {
            p.child1 = l;
          } else {
            p.child2 = l;
          }
        } else {
          this.root = l;
        }
        l.parent = p;
        return l;
      } else if (balance < -1) {
        var rl = r.child1;
        var rr = r.child2;
        var rlh = rl.height;
        var rrh = rr.height;

        // Is R-L higher than R-R?
        if (rlh > rrh) {
          // set N to R-R
          r.child2 = node;
          node.parent = r;

          //          [ R ]
          //         /     \
          //    [R-L]       [ N ]
          //     / \         / \
          // [...] [...] [ L ] [ R ]

          // set R-R
          node.child2 = rr;
          rr.parent = node;

          //          [ R ]
          //         /     \
          //    [R-L]       [ N ]
          //     / \         / \
          // [...] [...] [ L ] [R-R]

          // fix bounds and heights
          node.aabb.combine(l.aabb, rr.aabb);
          t = lh - rrh;
          node.height = lh - (t & t >> 31) + 1;
          r.aabb.combine(rl.aabb, node.aabb);
          t = rlh - nh;
          r.height = rlh - (t & t >> 31) + 1;
        } else {
          // set N to R-L
          r.child1 = node;
          node.parent = r;
          //          [ R ]
          //         /     \
          //    [ N ]       [R-R]
          //     / \         / \
          // [ L ] [ R ] [...] [...]

          // set R-L
          node.child2 = rl;
          rl.parent = node;

          //          [ R ]
          //         /     \
          //    [ N ]       [R-R]
          //     / \         / \
          // [ L ] [R-L] [...] [...]

          // fix bounds and heights
          node.aabb.combine(l.aabb, rl.aabb);
          t = lh - rlh;
          node.height = lh - (t & t >> 31) + 1;
          r.aabb.combine(node.aabb, rr.aabb);
          t = nh - rrh;
          r.height = nh - (t & t >> 31) + 1;
        }
        // set new parent of R
        if (p != null) {
          if (p.child1 == node) {
            p.child1 = r;
          } else {
            p.child2 = r;
          }
        } else {
          this.root = r;
        }
        r.parent = p;
        return r;
      }
      return node;
    },

    fix: function (node) {

      var c1 = node.child1;
      var c2 = node.child2;
      node.aabb.combine(c1.aabb, c2.aabb);
      node.height = c1.height < c2.height ? c2.height + 1 : c1.height + 1;

    }

  });

  /**
  * A proxy for dynamic bounding volume tree broad-phase.
  * @author saharan
  */

  function DBVTProxy(shape) {

    Proxy.call(this, shape);
    // The leaf of the proxy.
    this.leaf = new DBVTNode();
    this.leaf.proxy = this;

  }
  DBVTProxy.prototype = Object.assign(Object.create(Proxy.prototype), {

    constructor: DBVTProxy,

    update: function () {

    }

  });

  /**
   * A broad-phase algorithm using dynamic bounding volume tree.
   *
   * @author saharan
   * @author lo-th
   */

  function DBVTBroadPhase() {

    BroadPhase.call(this);

    this.types = BR_BOUNDING_VOLUME_TREE;

    this.tree = new DBVT();
    this.stack = [];
    this.leaves = [];
    this.numLeaves = 0;

  }
  DBVTBroadPhase.prototype = Object.assign(Object.create(BroadPhase.prototype), {

    constructor: DBVTBroadPhase,

    createProxy: function (shape) {

      return new DBVTProxy(shape);

    },

    addProxy: function (proxy) {

      this.tree.insertLeaf(proxy.leaf);
      this.leaves.push(proxy.leaf);
      this.numLeaves++;

    },

    removeProxy: function (proxy) {

      this.tree.deleteLeaf(proxy.leaf);
      var n = this.leaves.indexOf(proxy.leaf);
      if (n > -1) {
        this.leaves.splice(n, 1);
        this.numLeaves--;
      }

    },

    collectPairs: function () {

      if (this.numLeaves < 2) return;

      var leaf, margin = 0.1, i = this.numLeaves;

      while (i--) {

        leaf = this.leaves[i];

        if (leaf.proxy.aabb.intersectTestTwo(leaf.aabb)) {

          leaf.aabb.copy(leaf.proxy.aabb, margin);
          this.tree.deleteLeaf(leaf);
          this.tree.insertLeaf(leaf);
          this.collide(leaf, this.tree.root);

        }
      }

    },

    collide: function (node1, node2) {

      var stackCount = 2;
      var s1, s2, n1, n2, l1, l2;
      this.stack[0] = node1;
      this.stack[1] = node2;

      while (stackCount > 0) {

        n1 = this.stack[--stackCount];
        n2 = this.stack[--stackCount];
        l1 = n1.proxy != null;
        l2 = n2.proxy != null;

        this.numPairChecks++;

        if (l1 && l2) {
          s1 = n1.proxy.shape;
          s2 = n2.proxy.shape;
          if (s1 == s2 || s1.aabb.intersectTest(s2.aabb) || !this.isAvailablePair(s1, s2)) continue;

          this.addPair(s1, s2);

        } else {

          if (n1.aabb.intersectTest(n2.aabb)) continue;

          /*if(stackCount+4>=this.maxStack){// expand the stack
              //this.maxStack<<=1;
              this.maxStack*=2;
              var newStack = [];// vector
              newStack.length = this.maxStack;
              for(var i=0;i<stackCount;i++){
                  newStack[i] = this.stack[i];
              }
              this.stack = newStack;
          }*/

          if (l2 || !l1 && (n1.aabb.surfaceArea() > n2.aabb.surfaceArea())) {
            this.stack[stackCount++] = n1.child1;
            this.stack[stackCount++] = n2;
            this.stack[stackCount++] = n1.child2;
            this.stack[stackCount++] = n2;
          } else {
            this.stack[stackCount++] = n1;
            this.stack[stackCount++] = n2.child1;
            this.stack[stackCount++] = n1;
            this.stack[stackCount++] = n2.child2;
          }
        }
      }

    }

  });

  function CollisionDetector() {

    this.flip = false;

  }
  Object.assign(CollisionDetector.prototype, {

    CollisionDetector: true,

    detectCollision: function (shape1, shape2, manifold) {

      printError("CollisionDetector", "Inheritance error.");

    }

  });

  /**
   * A collision detector which detects collisions between two boxes.
   * @author saharan
   */
  function BoxBoxCollisionDetector() {

    CollisionDetector.call(this);
    this.clipVertices1 = new Float32Array(24); // 8 vertices x,y,z
    this.clipVertices2 = new Float32Array(24);
    this.used = new Float32Array(8);

    this.INF = 1 / 0;

  }
  BoxBoxCollisionDetector.prototype = Object.assign(Object.create(CollisionDetector.prototype), {

    constructor: BoxBoxCollisionDetector,

    detectCollision: function (shape1, shape2, manifold) {
      // What you are doing 
      // · I to prepare a separate axis of the fifteen 
      //-Six in each of three normal vectors of the xyz direction of the box both 
      // · Remaining nine 3x3 a vector perpendicular to the side of the box 2 and the side of the box 1 
      // · Calculate the depth to the separation axis 

      // Calculates the distance using the inner product and put the amount of embedment 
      // · However a vertical separation axis and side to weight a little to avoid vibration 
      // And end when there is a separate axis that is remote even one 
      // · I look for separation axis with little to dent most 
      // Men and if separation axis of the first six - end collision 
      // Heng If it separate axis of nine other - side collision 
      // Heng - case of a side collision 
      // · Find points of two sides on which you made ​​the separation axis 

      // Calculates the point of closest approach of a straight line consisting of separate axis points obtained, and the collision point 
      //-Surface - the case of the plane crash 
      //-Box A, box B and the other a box of better made ​​a separate axis 
      // • The surface A and the plane that made the separation axis of the box A, and B to the surface the face of the box B close in the opposite direction to the most isolated axis 

      // When viewed from the front surface A, and the cut part exceeding the area of the surface A is a surface B 
      //-Plane B becomes the 3-8 triangle, I a candidate for the collision point the vertex of surface B 
      // • If more than one candidate 5 exists, scraping up to four 

      // For potential collision points of all, to examine the distance between the surface A 
      // • If you were on the inside surface of A, and the collision point

      var b1;
      var b2;
      if (shape1.id < shape2.id) {
        b1 = (shape1);
        b2 = (shape2);
      } else {
        b1 = (shape2);
        b2 = (shape1);
      }
      var V1 = b1.elements;
      var V2 = b2.elements;

      var D1 = b1.dimentions;
      var D2 = b2.dimentions;

      var p1 = b1.position;
      var p2 = b2.position;
      var p1x = p1.x;
      var p1y = p1.y;
      var p1z = p1.z;
      var p2x = p2.x;
      var p2y = p2.y;
      var p2z = p2.z;
      // diff
      var dx = p2x - p1x;
      var dy = p2y - p1y;
      var dz = p2z - p1z;
      // distance
      var w1 = b1.halfWidth;
      var h1 = b1.halfHeight;
      var d1 = b1.halfDepth;
      var w2 = b2.halfWidth;
      var h2 = b2.halfHeight;
      var d2 = b2.halfDepth;
      // direction

      // ----------------------------
      // 15 separating axes
      // 1~6: face
      // 7~f: edge
      // http://marupeke296.com/COL_3D_No13_OBBvsOBB.html
      // ----------------------------

      var a1x = D1[0];
      var a1y = D1[1];
      var a1z = D1[2];
      var a2x = D1[3];
      var a2y = D1[4];
      var a2z = D1[5];
      var a3x = D1[6];
      var a3y = D1[7];
      var a3z = D1[8];
      var d1x = D1[9];
      var d1y = D1[10];
      var d1z = D1[11];
      var d2x = D1[12];
      var d2y = D1[13];
      var d2z = D1[14];
      var d3x = D1[15];
      var d3y = D1[16];
      var d3z = D1[17];

      var a4x = D2[0];
      var a4y = D2[1];
      var a4z = D2[2];
      var a5x = D2[3];
      var a5y = D2[4];
      var a5z = D2[5];
      var a6x = D2[6];
      var a6y = D2[7];
      var a6z = D2[8];
      var d4x = D2[9];
      var d4y = D2[10];
      var d4z = D2[11];
      var d5x = D2[12];
      var d5y = D2[13];
      var d5z = D2[14];
      var d6x = D2[15];
      var d6y = D2[16];
      var d6z = D2[17];

      var a7x = a1y * a4z - a1z * a4y;
      var a7y = a1z * a4x - a1x * a4z;
      var a7z = a1x * a4y - a1y * a4x;
      var a8x = a1y * a5z - a1z * a5y;
      var a8y = a1z * a5x - a1x * a5z;
      var a8z = a1x * a5y - a1y * a5x;
      var a9x = a1y * a6z - a1z * a6y;
      var a9y = a1z * a6x - a1x * a6z;
      var a9z = a1x * a6y - a1y * a6x;
      var aax = a2y * a4z - a2z * a4y;
      var aay = a2z * a4x - a2x * a4z;
      var aaz = a2x * a4y - a2y * a4x;
      var abx = a2y * a5z - a2z * a5y;
      var aby = a2z * a5x - a2x * a5z;
      var abz = a2x * a5y - a2y * a5x;
      var acx = a2y * a6z - a2z * a6y;
      var acy = a2z * a6x - a2x * a6z;
      var acz = a2x * a6y - a2y * a6x;
      var adx = a3y * a4z - a3z * a4y;
      var ady = a3z * a4x - a3x * a4z;
      var adz = a3x * a4y - a3y * a4x;
      var aex = a3y * a5z - a3z * a5y;
      var aey = a3z * a5x - a3x * a5z;
      var aez = a3x * a5y - a3y * a5x;
      var afx = a3y * a6z - a3z * a6y;
      var afy = a3z * a6x - a3x * a6z;
      var afz = a3x * a6y - a3y * a6x;
      // right or left flags
      var right1;
      var right2;
      var right3;
      var right4;
      var right5;
      var right6;
      var right7;
      var right8;
      var right9;
      var righta;
      var rightb;
      var rightc;
      var rightd;
      var righte;
      var rightf;
      // overlapping distances
      var overlap1;
      var overlap2;
      var overlap3;
      var overlap4;
      var overlap5;
      var overlap6;
      var overlap7;
      var overlap8;
      var overlap9;
      var overlapa;
      var overlapb;
      var overlapc;
      var overlapd;
      var overlape;
      var overlapf;
      // invalid flags
      var invalid7 = false;
      var invalid8 = false;
      var invalid9 = false;
      var invalida = false;
      var invalidb = false;
      var invalidc = false;
      var invalidd = false;
      var invalide = false;
      var invalidf = false;
      // temporary variables
      var len;
      var len1;
      var len2;
      var dot1;
      var dot2;
      var dot3;
      // try axis 1
      len = a1x * dx + a1y * dy + a1z * dz;
      right1 = len > 0;
      if (!right1) len = -len;
      len1 = w1;
      dot1 = a1x * a4x + a1y * a4y + a1z * a4z;
      dot2 = a1x * a5x + a1y * a5y + a1z * a5z;
      dot3 = a1x * a6x + a1y * a6y + a1z * a6z;
      if (dot1 < 0) dot1 = -dot1;
      if (dot2 < 0) dot2 = -dot2;
      if (dot3 < 0) dot3 = -dot3;
      len2 = dot1 * w2 + dot2 * h2 + dot3 * d2;
      overlap1 = len - len1 - len2;
      if (overlap1 > 0) return;
      // try axis 2
      len = a2x * dx + a2y * dy + a2z * dz;
      right2 = len > 0;
      if (!right2) len = -len;
      len1 = h1;
      dot1 = a2x * a4x + a2y * a4y + a2z * a4z;
      dot2 = a2x * a5x + a2y * a5y + a2z * a5z;
      dot3 = a2x * a6x + a2y * a6y + a2z * a6z;
      if (dot1 < 0) dot1 = -dot1;
      if (dot2 < 0) dot2 = -dot2;
      if (dot3 < 0) dot3 = -dot3;
      len2 = dot1 * w2 + dot2 * h2 + dot3 * d2;
      overlap2 = len - len1 - len2;
      if (overlap2 > 0) return;
      // try axis 3
      len = a3x * dx + a3y * dy + a3z * dz;
      right3 = len > 0;
      if (!right3) len = -len;
      len1 = d1;
      dot1 = a3x * a4x + a3y * a4y + a3z * a4z;
      dot2 = a3x * a5x + a3y * a5y + a3z * a5z;
      dot3 = a3x * a6x + a3y * a6y + a3z * a6z;
      if (dot1 < 0) dot1 = -dot1;
      if (dot2 < 0) dot2 = -dot2;
      if (dot3 < 0) dot3 = -dot3;
      len2 = dot1 * w2 + dot2 * h2 + dot3 * d2;
      overlap3 = len - len1 - len2;
      if (overlap3 > 0) return;
      // try axis 4
      len = a4x * dx + a4y * dy + a4z * dz;
      right4 = len > 0;
      if (!right4) len = -len;
      dot1 = a4x * a1x + a4y * a1y + a4z * a1z;
      dot2 = a4x * a2x + a4y * a2y + a4z * a2z;
      dot3 = a4x * a3x + a4y * a3y + a4z * a3z;
      if (dot1 < 0) dot1 = -dot1;
      if (dot2 < 0) dot2 = -dot2;
      if (dot3 < 0) dot3 = -dot3;
      len1 = dot1 * w1 + dot2 * h1 + dot3 * d1;
      len2 = w2;
      overlap4 = (len - len1 - len2) * 1.0;
      if (overlap4 > 0) return;
      // try axis 5
      len = a5x * dx + a5y * dy + a5z * dz;
      right5 = len > 0;
      if (!right5) len = -len;
      dot1 = a5x * a1x + a5y * a1y + a5z * a1z;
      dot2 = a5x * a2x + a5y * a2y + a5z * a2z;
      dot3 = a5x * a3x + a5y * a3y + a5z * a3z;
      if (dot1 < 0) dot1 = -dot1;
      if (dot2 < 0) dot2 = -dot2;
      if (dot3 < 0) dot3 = -dot3;
      len1 = dot1 * w1 + dot2 * h1 + dot3 * d1;
      len2 = h2;
      overlap5 = (len - len1 - len2) * 1.0;
      if (overlap5 > 0) return;
      // try axis 6
      len = a6x * dx + a6y * dy + a6z * dz;
      right6 = len > 0;
      if (!right6) len = -len;
      dot1 = a6x * a1x + a6y * a1y + a6z * a1z;
      dot2 = a6x * a2x + a6y * a2y + a6z * a2z;
      dot3 = a6x * a3x + a6y * a3y + a6z * a3z;
      if (dot1 < 0) dot1 = -dot1;
      if (dot2 < 0) dot2 = -dot2;
      if (dot3 < 0) dot3 = -dot3;
      len1 = dot1 * w1 + dot2 * h1 + dot3 * d1;
      len2 = d2;
      overlap6 = (len - len1 - len2) * 1.0;
      if (overlap6 > 0) return;
      // try axis 7
      len = a7x * a7x + a7y * a7y + a7z * a7z;
      if (len > 1e-5) {
        len = 1 / _Math.sqrt(len);
        a7x *= len;
        a7y *= len;
        a7z *= len;
        len = a7x * dx + a7y * dy + a7z * dz;
        right7 = len > 0;
        if (!right7) len = -len;
        dot1 = a7x * a2x + a7y * a2y + a7z * a2z;
        dot2 = a7x * a3x + a7y * a3y + a7z * a3z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len1 = dot1 * h1 + dot2 * d1;
        dot1 = a7x * a5x + a7y * a5y + a7z * a5z;
        dot2 = a7x * a6x + a7y * a6y + a7z * a6z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len2 = dot1 * h2 + dot2 * d2;
        overlap7 = len - len1 - len2;
        if (overlap7 > 0) return;
      } else {
        right7 = false;
        overlap7 = 0;
        invalid7 = true;
      }
      // try axis 8
      len = a8x * a8x + a8y * a8y + a8z * a8z;
      if (len > 1e-5) {
        len = 1 / _Math.sqrt(len);
        a8x *= len;
        a8y *= len;
        a8z *= len;
        len = a8x * dx + a8y * dy + a8z * dz;
        right8 = len > 0;
        if (!right8) len = -len;
        dot1 = a8x * a2x + a8y * a2y + a8z * a2z;
        dot2 = a8x * a3x + a8y * a3y + a8z * a3z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len1 = dot1 * h1 + dot2 * d1;
        dot1 = a8x * a4x + a8y * a4y + a8z * a4z;
        dot2 = a8x * a6x + a8y * a6y + a8z * a6z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len2 = dot1 * w2 + dot2 * d2;
        overlap8 = len - len1 - len2;
        if (overlap8 > 0) return;
      } else {
        right8 = false;
        overlap8 = 0;
        invalid8 = true;
      }
      // try axis 9
      len = a9x * a9x + a9y * a9y + a9z * a9z;
      if (len > 1e-5) {
        len = 1 / _Math.sqrt(len);
        a9x *= len;
        a9y *= len;
        a9z *= len;
        len = a9x * dx + a9y * dy + a9z * dz;
        right9 = len > 0;
        if (!right9) len = -len;
        dot1 = a9x * a2x + a9y * a2y + a9z * a2z;
        dot2 = a9x * a3x + a9y * a3y + a9z * a3z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len1 = dot1 * h1 + dot2 * d1;
        dot1 = a9x * a4x + a9y * a4y + a9z * a4z;
        dot2 = a9x * a5x + a9y * a5y + a9z * a5z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len2 = dot1 * w2 + dot2 * h2;
        overlap9 = len - len1 - len2;
        if (overlap9 > 0) return;
      } else {
        right9 = false;
        overlap9 = 0;
        invalid9 = true;
      }
      // try axis 10
      len = aax * aax + aay * aay + aaz * aaz;
      if (len > 1e-5) {
        len = 1 / _Math.sqrt(len);
        aax *= len;
        aay *= len;
        aaz *= len;
        len = aax * dx + aay * dy + aaz * dz;
        righta = len > 0;
        if (!righta) len = -len;
        dot1 = aax * a1x + aay * a1y + aaz * a1z;
        dot2 = aax * a3x + aay * a3y + aaz * a3z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len1 = dot1 * w1 + dot2 * d1;
        dot1 = aax * a5x + aay * a5y + aaz * a5z;
        dot2 = aax * a6x + aay * a6y + aaz * a6z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len2 = dot1 * h2 + dot2 * d2;
        overlapa = len - len1 - len2;
        if (overlapa > 0) return;
      } else {
        righta = false;
        overlapa = 0;
        invalida = true;
      }
      // try axis 11
      len = abx * abx + aby * aby + abz * abz;
      if (len > 1e-5) {
        len = 1 / _Math.sqrt(len);
        abx *= len;
        aby *= len;
        abz *= len;
        len = abx * dx + aby * dy + abz * dz;
        rightb = len > 0;
        if (!rightb) len = -len;
        dot1 = abx * a1x + aby * a1y + abz * a1z;
        dot2 = abx * a3x + aby * a3y + abz * a3z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len1 = dot1 * w1 + dot2 * d1;
        dot1 = abx * a4x + aby * a4y + abz * a4z;
        dot2 = abx * a6x + aby * a6y + abz * a6z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len2 = dot1 * w2 + dot2 * d2;
        overlapb = len - len1 - len2;
        if (overlapb > 0) return;
      } else {
        rightb = false;
        overlapb = 0;
        invalidb = true;
      }
      // try axis 12
      len = acx * acx + acy * acy + acz * acz;
      if (len > 1e-5) {
        len = 1 / _Math.sqrt(len);
        acx *= len;
        acy *= len;
        acz *= len;
        len = acx * dx + acy * dy + acz * dz;
        rightc = len > 0;
        if (!rightc) len = -len;
        dot1 = acx * a1x + acy * a1y + acz * a1z;
        dot2 = acx * a3x + acy * a3y + acz * a3z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len1 = dot1 * w1 + dot2 * d1;
        dot1 = acx * a4x + acy * a4y + acz * a4z;
        dot2 = acx * a5x + acy * a5y + acz * a5z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len2 = dot1 * w2 + dot2 * h2;
        overlapc = len - len1 - len2;
        if (overlapc > 0) return;
      } else {
        rightc = false;
        overlapc = 0;
        invalidc = true;
      }
      // try axis 13
      len = adx * adx + ady * ady + adz * adz;
      if (len > 1e-5) {
        len = 1 / _Math.sqrt(len);
        adx *= len;
        ady *= len;
        adz *= len;
        len = adx * dx + ady * dy + adz * dz;
        rightd = len > 0;
        if (!rightd) len = -len;
        dot1 = adx * a1x + ady * a1y + adz * a1z;
        dot2 = adx * a2x + ady * a2y + adz * a2z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len1 = dot1 * w1 + dot2 * h1;
        dot1 = adx * a5x + ady * a5y + adz * a5z;
        dot2 = adx * a6x + ady * a6y + adz * a6z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len2 = dot1 * h2 + dot2 * d2;
        overlapd = len - len1 - len2;
        if (overlapd > 0) return;
      } else {
        rightd = false;
        overlapd = 0;
        invalidd = true;
      }
      // try axis 14
      len = aex * aex + aey * aey + aez * aez;
      if (len > 1e-5) {
        len = 1 / _Math.sqrt(len);
        aex *= len;
        aey *= len;
        aez *= len;
        len = aex * dx + aey * dy + aez * dz;
        righte = len > 0;
        if (!righte) len = -len;
        dot1 = aex * a1x + aey * a1y + aez * a1z;
        dot2 = aex * a2x + aey * a2y + aez * a2z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len1 = dot1 * w1 + dot2 * h1;
        dot1 = aex * a4x + aey * a4y + aez * a4z;
        dot2 = aex * a6x + aey * a6y + aez * a6z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len2 = dot1 * w2 + dot2 * d2;
        overlape = len - len1 - len2;
        if (overlape > 0) return;
      } else {
        righte = false;
        overlape = 0;
        invalide = true;
      }
      // try axis 15
      len = afx * afx + afy * afy + afz * afz;
      if (len > 1e-5) {
        len = 1 / _Math.sqrt(len);
        afx *= len;
        afy *= len;
        afz *= len;
        len = afx * dx + afy * dy + afz * dz;
        rightf = len > 0;
        if (!rightf) len = -len;
        dot1 = afx * a1x + afy * a1y + afz * a1z;
        dot2 = afx * a2x + afy * a2y + afz * a2z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len1 = dot1 * w1 + dot2 * h1;
        dot1 = afx * a4x + afy * a4y + afz * a4z;
        dot2 = afx * a5x + afy * a5y + afz * a5z;
        if (dot1 < 0) dot1 = -dot1;
        if (dot2 < 0) dot2 = -dot2;
        len2 = dot1 * w2 + dot2 * h2;
        overlapf = len - len1 - len2;
        if (overlapf > 0) return;
      } else {
        rightf = false;
        overlapf = 0;
        invalidf = true;
      }
      // boxes are overlapping
      var depth = overlap1;
      var depth2 = overlap1;
      var minIndex = 0;
      var right = right1;
      if (overlap2 > depth2) {
        depth = overlap2;
        depth2 = overlap2;
        minIndex = 1;
        right = right2;
      }
      if (overlap3 > depth2) {
        depth = overlap3;
        depth2 = overlap3;
        minIndex = 2;
        right = right3;
      }
      if (overlap4 > depth2) {
        depth = overlap4;
        depth2 = overlap4;
        minIndex = 3;
        right = right4;
      }
      if (overlap5 > depth2) {
        depth = overlap5;
        depth2 = overlap5;
        minIndex = 4;
        right = right5;
      }
      if (overlap6 > depth2) {
        depth = overlap6;
        depth2 = overlap6;
        minIndex = 5;
        right = right6;
      }
      if (overlap7 - 0.01 > depth2 && !invalid7) {
        depth = overlap7;
        depth2 = overlap7 - 0.01;
        minIndex = 6;
        right = right7;
      }
      if (overlap8 - 0.01 > depth2 && !invalid8) {
        depth = overlap8;
        depth2 = overlap8 - 0.01;
        minIndex = 7;
        right = right8;
      }
      if (overlap9 - 0.01 > depth2 && !invalid9) {
        depth = overlap9;
        depth2 = overlap9 - 0.01;
        minIndex = 8;
        right = right9;
      }
      if (overlapa - 0.01 > depth2 && !invalida) {
        depth = overlapa;
        depth2 = overlapa - 0.01;
        minIndex = 9;
        right = righta;
      }
      if (overlapb - 0.01 > depth2 && !invalidb) {
        depth = overlapb;
        depth2 = overlapb - 0.01;
        minIndex = 10;
        right = rightb;
      }
      if (overlapc - 0.01 > depth2 && !invalidc) {
        depth = overlapc;
        depth2 = overlapc - 0.01;
        minIndex = 11;
        right = rightc;
      }
      if (overlapd - 0.01 > depth2 && !invalidd) {
        depth = overlapd;
        depth2 = overlapd - 0.01;
        minIndex = 12;
        right = rightd;
      }
      if (overlape - 0.01 > depth2 && !invalide) {
        depth = overlape;
        depth2 = overlape - 0.01;
        minIndex = 13;
        right = righte;
      }
      if (overlapf - 0.01 > depth2 && !invalidf) {
        depth = overlapf;
        minIndex = 14;
        right = rightf;
      }
      // normal
      var nx = 0;
      var ny = 0;
      var nz = 0;
      // edge line or face side normal
      var n1x = 0;
      var n1y = 0;
      var n1z = 0;
      var n2x = 0;
      var n2y = 0;
      var n2z = 0;
      // center of current face
      var cx = 0;
      var cy = 0;
      var cz = 0;
      // face side
      var s1x = 0;
      var s1y = 0;
      var s1z = 0;
      var s2x = 0;
      var s2y = 0;
      var s2z = 0;
      // swap b1 b2
      var swap = false;

      //_______________________________________

      if (minIndex == 0) {// b1.x * b2
        if (right) {
          cx = p1x + d1x; cy = p1y + d1y; cz = p1z + d1z;
          nx = a1x; ny = a1y; nz = a1z;
        } else {
          cx = p1x - d1x; cy = p1y - d1y; cz = p1z - d1z;
          nx = -a1x; ny = -a1y; nz = -a1z;
        }
        s1x = d2x; s1y = d2y; s1z = d2z;
        n1x = -a2x; n1y = -a2y; n1z = -a2z;
        s2x = d3x; s2y = d3y; s2z = d3z;
        n2x = -a3x; n2y = -a3y; n2z = -a3z;
      }
      else if (minIndex == 1) {// b1.y * b2
        if (right) {
          cx = p1x + d2x; cy = p1y + d2y; cz = p1z + d2z;
          nx = a2x; ny = a2y; nz = a2z;
        } else {
          cx = p1x - d2x; cy = p1y - d2y; cz = p1z - d2z;
          nx = -a2x; ny = -a2y; nz = -a2z;
        }
        s1x = d1x; s1y = d1y; s1z = d1z;
        n1x = -a1x; n1y = -a1y; n1z = -a1z;
        s2x = d3x; s2y = d3y; s2z = d3z;
        n2x = -a3x; n2y = -a3y; n2z = -a3z;
      }
      else if (minIndex == 2) {// b1.z * b2
        if (right) {
          cx = p1x + d3x; cy = p1y + d3y; cz = p1z + d3z;
          nx = a3x; ny = a3y; nz = a3z;
        } else {
          cx = p1x - d3x; cy = p1y - d3y; cz = p1z - d3z;
          nx = -a3x; ny = -a3y; nz = -a3z;
        }
        s1x = d1x; s1y = d1y; s1z = d1z;
        n1x = -a1x; n1y = -a1y; n1z = -a1z;
        s2x = d2x; s2y = d2y; s2z = d2z;
        n2x = -a2x; n2y = -a2y; n2z = -a2z;
      }
      else if (minIndex == 3) {// b2.x * b1
        swap = true;
        if (!right) {
          cx = p2x + d4x; cy = p2y + d4y; cz = p2z + d4z;
          nx = a4x; ny = a4y; nz = a4z;
        } else {
          cx = p2x - d4x; cy = p2y - d4y; cz = p2z - d4z;
          nx = -a4x; ny = -a4y; nz = -a4z;
        }
        s1x = d5x; s1y = d5y; s1z = d5z;
        n1x = -a5x; n1y = -a5y; n1z = -a5z;
        s2x = d6x; s2y = d6y; s2z = d6z;
        n2x = -a6x; n2y = -a6y; n2z = -a6z;
      }
      else if (minIndex == 4) {// b2.y * b1
        swap = true;
        if (!right) {
          cx = p2x + d5x; cy = p2y + d5y; cz = p2z + d5z;
          nx = a5x; ny = a5y; nz = a5z;
        } else {
          cx = p2x - d5x; cy = p2y - d5y; cz = p2z - d5z;
          nx = -a5x; ny = -a5y; nz = -a5z;
        }
        s1x = d4x; s1y = d4y; s1z = d4z;
        n1x = -a4x; n1y = -a4y; n1z = -a4z;
        s2x = d6x; s2y = d6y; s2z = d6z;
        n2x = -a6x; n2y = -a6y; n2z = -a6z;
      }
      else if (minIndex == 5) {// b2.z * b1
        swap = true;
        if (!right) {
          cx = p2x + d6x; cy = p2y + d6y; cz = p2z + d6z;
          nx = a6x; ny = a6y; nz = a6z;
        } else {
          cx = p2x - d6x; cy = p2y - d6y; cz = p2z - d6z;
          nx = -a6x; ny = -a6y; nz = -a6z;
        }
        s1x = d4x; s1y = d4y; s1z = d4z;
        n1x = -a4x; n1y = -a4y; n1z = -a4z;
        s2x = d5x; s2y = d5y; s2z = d5z;
        n2x = -a5x; n2y = -a5y; n2z = -a5z;
      }
      else if (minIndex == 6) {// b1.x * b2.x
        nx = a7x; ny = a7y; nz = a7z;
        n1x = a1x; n1y = a1y; n1z = a1z;
        n2x = a4x; n2y = a4y; n2z = a4z;
      }
      else if (minIndex == 7) {// b1.x * b2.y
        nx = a8x; ny = a8y; nz = a8z;
        n1x = a1x; n1y = a1y; n1z = a1z;
        n2x = a5x; n2y = a5y; n2z = a5z;
      }
      else if (minIndex == 8) {// b1.x * b2.z
        nx = a9x; ny = a9y; nz = a9z;
        n1x = a1x; n1y = a1y; n1z = a1z;
        n2x = a6x; n2y = a6y; n2z = a6z;
      }
      else if (minIndex == 9) {// b1.y * b2.x
        nx = aax; ny = aay; nz = aaz;
        n1x = a2x; n1y = a2y; n1z = a2z;
        n2x = a4x; n2y = a4y; n2z = a4z;
      }
      else if (minIndex == 10) {// b1.y * b2.y
        nx = abx; ny = aby; nz = abz;
        n1x = a2x; n1y = a2y; n1z = a2z;
        n2x = a5x; n2y = a5y; n2z = a5z;
      }
      else if (minIndex == 11) {// b1.y * b2.z
        nx = acx; ny = acy; nz = acz;
        n1x = a2x; n1y = a2y; n1z = a2z;
        n2x = a6x; n2y = a6y; n2z = a6z;
      }
      else if (minIndex == 12) {// b1.z * b2.x
        nx = adx; ny = ady; nz = adz;
        n1x = a3x; n1y = a3y; n1z = a3z;
        n2x = a4x; n2y = a4y; n2z = a4z;
      }
      else if (minIndex == 13) {// b1.z * b2.y
        nx = aex; ny = aey; nz = aez;
        n1x = a3x; n1y = a3y; n1z = a3z;
        n2x = a5x; n2y = a5y; n2z = a5z;
      }
      else if (minIndex == 14) {// b1.z * b2.z
        nx = afx; ny = afy; nz = afz;
        n1x = a3x; n1y = a3y; n1z = a3z;
        n2x = a6x; n2y = a6y; n2z = a6z;
      }

      //__________________________________________

      //var v;
      if (minIndex > 5) {
        if (!right) {
          nx = -nx; ny = -ny; nz = -nz;
        }
        var distance;
        var maxDistance;
        var vx;
        var vy;
        var vz;
        var v1x;
        var v1y;
        var v1z;
        var v2x;
        var v2y;
        var v2z;
        //vertex1;
        v1x = V1[0]; v1y = V1[1]; v1z = V1[2];
        maxDistance = nx * v1x + ny * v1y + nz * v1z;
        //vertex2;
        vx = V1[3]; vy = V1[4]; vz = V1[5];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance > maxDistance) {
          maxDistance = distance;
          v1x = vx; v1y = vy; v1z = vz;
        }
        //vertex3;
        vx = V1[6]; vy = V1[7]; vz = V1[8];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance > maxDistance) {
          maxDistance = distance;
          v1x = vx; v1y = vy; v1z = vz;
        }
        //vertex4;
        vx = V1[9]; vy = V1[10]; vz = V1[11];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance > maxDistance) {
          maxDistance = distance;
          v1x = vx; v1y = vy; v1z = vz;
        }
        //vertex5;
        vx = V1[12]; vy = V1[13]; vz = V1[14];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance > maxDistance) {
          maxDistance = distance;
          v1x = vx; v1y = vy; v1z = vz;
        }
        //vertex6;
        vx = V1[15]; vy = V1[16]; vz = V1[17];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance > maxDistance) {
          maxDistance = distance;
          v1x = vx; v1y = vy; v1z = vz;
        }
        //vertex7;
        vx = V1[18]; vy = V1[19]; vz = V1[20];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance > maxDistance) {
          maxDistance = distance;
          v1x = vx; v1y = vy; v1z = vz;
        }
        //vertex8;
        vx = V1[21]; vy = V1[22]; vz = V1[23];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance > maxDistance) {
          maxDistance = distance;
          v1x = vx; v1y = vy; v1z = vz;
        }
        //vertex1;
        v2x = V2[0]; v2y = V2[1]; v2z = V2[2];
        maxDistance = nx * v2x + ny * v2y + nz * v2z;
        //vertex2;
        vx = V2[3]; vy = V2[4]; vz = V2[5];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance < maxDistance) {
          maxDistance = distance;
          v2x = vx; v2y = vy; v2z = vz;
        }
        //vertex3;
        vx = V2[6]; vy = V2[7]; vz = V2[8];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance < maxDistance) {
          maxDistance = distance;
          v2x = vx; v2y = vy; v2z = vz;
        }
        //vertex4;
        vx = V2[9]; vy = V2[10]; vz = V2[11];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance < maxDistance) {
          maxDistance = distance;
          v2x = vx; v2y = vy; v2z = vz;
        }
        //vertex5;
        vx = V2[12]; vy = V2[13]; vz = V2[14];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance < maxDistance) {
          maxDistance = distance;
          v2x = vx; v2y = vy; v2z = vz;
        }
        //vertex6;
        vx = V2[15]; vy = V2[16]; vz = V2[17];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance < maxDistance) {
          maxDistance = distance;
          v2x = vx; v2y = vy; v2z = vz;
        }
        //vertex7;
        vx = V2[18]; vy = V2[19]; vz = V2[20];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance < maxDistance) {
          maxDistance = distance;
          v2x = vx; v2y = vy; v2z = vz;
        }
        //vertex8;
        vx = V2[21]; vy = V2[22]; vz = V2[23];
        distance = nx * vx + ny * vy + nz * vz;
        if (distance < maxDistance) {
          maxDistance = distance;
          v2x = vx; v2y = vy; v2z = vz;
        }
        vx = v2x - v1x; vy = v2y - v1y; vz = v2z - v1z;
        dot1 = n1x * n2x + n1y * n2y + n1z * n2z;
        var t = (vx * (n1x - n2x * dot1) + vy * (n1y - n2y * dot1) + vz * (n1z - n2z * dot1)) / (1 - dot1 * dot1);
        manifold.addPoint(v1x + n1x * t + nx * depth * 0.5, v1y + n1y * t + ny * depth * 0.5, v1z + n1z * t + nz * depth * 0.5, nx, ny, nz, depth, false);
        return;
      }
      // now detect face-face collision...
      // target quad
      var q1x;
      var q1y;
      var q1z;
      var q2x;
      var q2y;
      var q2z;
      var q3x;
      var q3y;
      var q3z;
      var q4x;
      var q4y;
      var q4z;
      // search support face and vertex
      var minDot = 1;
      var dot = 0;
      var minDotIndex = 0;
      if (swap) {
        dot = a1x * nx + a1y * ny + a1z * nz;
        if (dot < minDot) {
          minDot = dot;
          minDotIndex = 0;
        }
        if (-dot < minDot) {
          minDot = -dot;
          minDotIndex = 1;
        }
        dot = a2x * nx + a2y * ny + a2z * nz;
        if (dot < minDot) {
          minDot = dot;
          minDotIndex = 2;
        }
        if (-dot < minDot) {
          minDot = -dot;
          minDotIndex = 3;
        }
        dot = a3x * nx + a3y * ny + a3z * nz;
        if (dot < minDot) {
          minDot = dot;
          minDotIndex = 4;
        }
        if (-dot < minDot) {
          minDot = -dot;
          minDotIndex = 5;
        }

        if (minDotIndex == 0) {// x+ face
          q1x = V1[0]; q1y = V1[1]; q1z = V1[2];//vertex1
          q2x = V1[6]; q2y = V1[7]; q2z = V1[8];//vertex3
          q3x = V1[9]; q3y = V1[10]; q3z = V1[11];//vertex4
          q4x = V1[3]; q4y = V1[4]; q4z = V1[5];//vertex2
        }
        else if (minDotIndex == 1) {// x- face
          q1x = V1[15]; q1y = V1[16]; q1z = V1[17];//vertex6
          q2x = V1[21]; q2y = V1[22]; q2z = V1[23];//vertex8
          q3x = V1[18]; q3y = V1[19]; q3z = V1[20];//vertex7
          q4x = V1[12]; q4y = V1[13]; q4z = V1[14];//vertex5
        }
        else if (minDotIndex == 2) {// y+ face
          q1x = V1[12]; q1y = V1[13]; q1z = V1[14];//vertex5
          q2x = V1[0]; q2y = V1[1]; q2z = V1[2];//vertex1
          q3x = V1[3]; q3y = V1[4]; q3z = V1[5];//vertex2
          q4x = V1[15]; q4y = V1[16]; q4z = V1[17];//vertex6
        }
        else if (minDotIndex == 3) {// y- face
          q1x = V1[21]; q1y = V1[22]; q1z = V1[23];//vertex8
          q2x = V1[9]; q2y = V1[10]; q2z = V1[11];//vertex4
          q3x = V1[6]; q3y = V1[7]; q3z = V1[8];//vertex3
          q4x = V1[18]; q4y = V1[19]; q4z = V1[20];//vertex7
        }
        else if (minDotIndex == 4) {// z+ face
          q1x = V1[12]; q1y = V1[13]; q1z = V1[14];//vertex5
          q2x = V1[18]; q2y = V1[19]; q2z = V1[20];//vertex7
          q3x = V1[6]; q3y = V1[7]; q3z = V1[8];//vertex3
          q4x = V1[0]; q4y = V1[1]; q4z = V1[2];//vertex1
        }
        else if (minDotIndex == 5) {// z- face
          q1x = V1[3]; q1y = V1[4]; q1z = V1[5];//vertex2
          //2x=V1[6]; q2y=V1[7]; q2z=V1[8];//vertex4 !!!
          q2x = V2[9]; q2y = V2[10]; q2z = V2[11];//vertex4
          q3x = V1[21]; q3y = V1[22]; q3z = V1[23];//vertex8
          q4x = V1[15]; q4y = V1[16]; q4z = V1[17];//vertex6
        }

      } else {
        dot = a4x * nx + a4y * ny + a4z * nz;
        if (dot < minDot) {
          minDot = dot;
          minDotIndex = 0;
        }
        if (-dot < minDot) {
          minDot = -dot;
          minDotIndex = 1;
        }
        dot = a5x * nx + a5y * ny + a5z * nz;
        if (dot < minDot) {
          minDot = dot;
          minDotIndex = 2;
        }
        if (-dot < minDot) {
          minDot = -dot;
          minDotIndex = 3;
        }
        dot = a6x * nx + a6y * ny + a6z * nz;
        if (dot < minDot) {
          minDot = dot;
          minDotIndex = 4;
        }
        if (-dot < minDot) {
          minDot = -dot;
          minDotIndex = 5;
        }

        //______________________________________________________

        if (minDotIndex == 0) {// x+ face
          q1x = V2[0]; q1y = V2[1]; q1z = V2[2];//vertex1
          q2x = V2[6]; q2y = V2[7]; q2z = V2[8];//vertex3
          q3x = V2[9]; q3y = V2[10]; q3z = V2[11];//vertex4
          q4x = V2[3]; q4y = V2[4]; q4z = V2[5];//vertex2
        }
        else if (minDotIndex == 1) {// x- face
          q1x = V2[15]; q1y = V2[16]; q1z = V2[17];//vertex6
          q2x = V2[21]; q2y = V2[22]; q2z = V2[23]; //vertex8
          q3x = V2[18]; q3y = V2[19]; q3z = V2[20];//vertex7
          q4x = V2[12]; q4y = V2[13]; q4z = V2[14];//vertex5
        }
        else if (minDotIndex == 2) {// y+ face
          q1x = V2[12]; q1y = V2[13]; q1z = V2[14];//vertex5
          q2x = V2[0]; q2y = V2[1]; q2z = V2[2];//vertex1
          q3x = V2[3]; q3y = V2[4]; q3z = V2[5];//vertex2
          q4x = V2[15]; q4y = V2[16]; q4z = V2[17];//vertex6
        }
        else if (minDotIndex == 3) {// y- face
          q1x = V2[21]; q1y = V2[22]; q1z = V2[23];//vertex8
          q2x = V2[9]; q2y = V2[10]; q2z = V2[11];//vertex4
          q3x = V2[6]; q3y = V2[7]; q3z = V2[8];//vertex3
          q4x = V2[18]; q4y = V2[19]; q4z = V2[20];//vertex7
        }
        else if (minDotIndex == 4) {// z+ face
          q1x = V2[12]; q1y = V2[13]; q1z = V2[14];//vertex5
          q2x = V2[18]; q2y = V2[19]; q2z = V2[20];//vertex7
          q3x = V2[6]; q3y = V2[7]; q3z = V2[8];//vertex3
          q4x = V2[0]; q4y = V2[1]; q4z = V2[2];//vertex1
        }
        else if (minDotIndex == 5) {// z- face
          q1x = V2[3]; q1y = V2[4]; q1z = V2[5];//vertex2
          q2x = V2[9]; q2y = V2[10]; q2z = V2[11];//vertex4
          q3x = V2[21]; q3y = V2[22]; q3z = V2[23];//vertex8
          q4x = V2[15]; q4y = V2[16]; q4z = V2[17];//vertex6
        }

      }
      // clip vertices
      var numClipVertices;
      var numAddedClipVertices;
      var index;
      var x1;
      var y1;
      var z1;
      var x2;
      var y2;
      var z2;
      this.clipVertices1[0] = q1x;
      this.clipVertices1[1] = q1y;
      this.clipVertices1[2] = q1z;
      this.clipVertices1[3] = q2x;
      this.clipVertices1[4] = q2y;
      this.clipVertices1[5] = q2z;
      this.clipVertices1[6] = q3x;
      this.clipVertices1[7] = q3y;
      this.clipVertices1[8] = q3z;
      this.clipVertices1[9] = q4x;
      this.clipVertices1[10] = q4y;
      this.clipVertices1[11] = q4z;
      numAddedClipVertices = 0;
      x1 = this.clipVertices1[9];
      y1 = this.clipVertices1[10];
      z1 = this.clipVertices1[11];
      dot1 = (x1 - cx - s1x) * n1x + (y1 - cy - s1y) * n1y + (z1 - cz - s1z) * n1z;

      //var i = 4;
      //while(i--){
      for (var i = 0; i < 4; i++) {
        index = i * 3;
        x2 = this.clipVertices1[index];
        y2 = this.clipVertices1[index + 1];
        z2 = this.clipVertices1[index + 2];
        dot2 = (x2 - cx - s1x) * n1x + (y2 - cy - s1y) * n1y + (z2 - cz - s1z) * n1z;
        if (dot1 > 0) {
          if (dot2 > 0) {
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            this.clipVertices2[index] = x2;
            this.clipVertices2[index + 1] = y2;
            this.clipVertices2[index + 2] = z2;
          } else {
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            t = dot1 / (dot1 - dot2);
            this.clipVertices2[index] = x1 + (x2 - x1) * t;
            this.clipVertices2[index + 1] = y1 + (y2 - y1) * t;
            this.clipVertices2[index + 2] = z1 + (z2 - z1) * t;
          }
        } else {
          if (dot2 > 0) {
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            t = dot1 / (dot1 - dot2);
            this.clipVertices2[index] = x1 + (x2 - x1) * t;
            this.clipVertices2[index + 1] = y1 + (y2 - y1) * t;
            this.clipVertices2[index + 2] = z1 + (z2 - z1) * t;
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            this.clipVertices2[index] = x2;
            this.clipVertices2[index + 1] = y2;
            this.clipVertices2[index + 2] = z2;
          }
        }
        x1 = x2;
        y1 = y2;
        z1 = z2;
        dot1 = dot2;
      }

      numClipVertices = numAddedClipVertices;
      if (numClipVertices == 0) return;
      numAddedClipVertices = 0;
      index = (numClipVertices - 1) * 3;
      x1 = this.clipVertices2[index];
      y1 = this.clipVertices2[index + 1];
      z1 = this.clipVertices2[index + 2];
      dot1 = (x1 - cx - s2x) * n2x + (y1 - cy - s2y) * n2y + (z1 - cz - s2z) * n2z;

      //i = numClipVertices;
      //while(i--){
      for (i = 0; i < numClipVertices; i++) {
        index = i * 3;
        x2 = this.clipVertices2[index];
        y2 = this.clipVertices2[index + 1];
        z2 = this.clipVertices2[index + 2];
        dot2 = (x2 - cx - s2x) * n2x + (y2 - cy - s2y) * n2y + (z2 - cz - s2z) * n2z;
        if (dot1 > 0) {
          if (dot2 > 0) {
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            this.clipVertices1[index] = x2;
            this.clipVertices1[index + 1] = y2;
            this.clipVertices1[index + 2] = z2;
          } else {
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            t = dot1 / (dot1 - dot2);
            this.clipVertices1[index] = x1 + (x2 - x1) * t;
            this.clipVertices1[index + 1] = y1 + (y2 - y1) * t;
            this.clipVertices1[index + 2] = z1 + (z2 - z1) * t;
          }
        } else {
          if (dot2 > 0) {
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            t = dot1 / (dot1 - dot2);
            this.clipVertices1[index] = x1 + (x2 - x1) * t;
            this.clipVertices1[index + 1] = y1 + (y2 - y1) * t;
            this.clipVertices1[index + 2] = z1 + (z2 - z1) * t;
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            this.clipVertices1[index] = x2;
            this.clipVertices1[index + 1] = y2;
            this.clipVertices1[index + 2] = z2;
          }
        }
        x1 = x2;
        y1 = y2;
        z1 = z2;
        dot1 = dot2;
      }

      numClipVertices = numAddedClipVertices;
      if (numClipVertices == 0) return;
      numAddedClipVertices = 0;
      index = (numClipVertices - 1) * 3;
      x1 = this.clipVertices1[index];
      y1 = this.clipVertices1[index + 1];
      z1 = this.clipVertices1[index + 2];
      dot1 = (x1 - cx + s1x) * -n1x + (y1 - cy + s1y) * -n1y + (z1 - cz + s1z) * -n1z;

      //i = numClipVertices;
      //while(i--){
      for (i = 0; i < numClipVertices; i++) {
        index = i * 3;
        x2 = this.clipVertices1[index];
        y2 = this.clipVertices1[index + 1];
        z2 = this.clipVertices1[index + 2];
        dot2 = (x2 - cx + s1x) * -n1x + (y2 - cy + s1y) * -n1y + (z2 - cz + s1z) * -n1z;
        if (dot1 > 0) {
          if (dot2 > 0) {
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            this.clipVertices2[index] = x2;
            this.clipVertices2[index + 1] = y2;
            this.clipVertices2[index + 2] = z2;
          } else {
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            t = dot1 / (dot1 - dot2);
            this.clipVertices2[index] = x1 + (x2 - x1) * t;
            this.clipVertices2[index + 1] = y1 + (y2 - y1) * t;
            this.clipVertices2[index + 2] = z1 + (z2 - z1) * t;
          }
        } else {
          if (dot2 > 0) {
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            t = dot1 / (dot1 - dot2);
            this.clipVertices2[index] = x1 + (x2 - x1) * t;
            this.clipVertices2[index + 1] = y1 + (y2 - y1) * t;
            this.clipVertices2[index + 2] = z1 + (z2 - z1) * t;
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            this.clipVertices2[index] = x2;
            this.clipVertices2[index + 1] = y2;
            this.clipVertices2[index + 2] = z2;
          }
        }
        x1 = x2;
        y1 = y2;
        z1 = z2;
        dot1 = dot2;
      }

      numClipVertices = numAddedClipVertices;
      if (numClipVertices == 0) return;
      numAddedClipVertices = 0;
      index = (numClipVertices - 1) * 3;
      x1 = this.clipVertices2[index];
      y1 = this.clipVertices2[index + 1];
      z1 = this.clipVertices2[index + 2];
      dot1 = (x1 - cx + s2x) * -n2x + (y1 - cy + s2y) * -n2y + (z1 - cz + s2z) * -n2z;

      //i = numClipVertices;
      //while(i--){
      for (i = 0; i < numClipVertices; i++) {
        index = i * 3;
        x2 = this.clipVertices2[index];
        y2 = this.clipVertices2[index + 1];
        z2 = this.clipVertices2[index + 2];
        dot2 = (x2 - cx + s2x) * -n2x + (y2 - cy + s2y) * -n2y + (z2 - cz + s2z) * -n2z;
        if (dot1 > 0) {
          if (dot2 > 0) {
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            this.clipVertices1[index] = x2;
            this.clipVertices1[index + 1] = y2;
            this.clipVertices1[index + 2] = z2;
          } else {
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            t = dot1 / (dot1 - dot2);
            this.clipVertices1[index] = x1 + (x2 - x1) * t;
            this.clipVertices1[index + 1] = y1 + (y2 - y1) * t;
            this.clipVertices1[index + 2] = z1 + (z2 - z1) * t;
          }
        } else {
          if (dot2 > 0) {
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            t = dot1 / (dot1 - dot2);
            this.clipVertices1[index] = x1 + (x2 - x1) * t;
            this.clipVertices1[index + 1] = y1 + (y2 - y1) * t;
            this.clipVertices1[index + 2] = z1 + (z2 - z1) * t;
            index = numAddedClipVertices * 3;
            numAddedClipVertices++;
            this.clipVertices1[index] = x2;
            this.clipVertices1[index + 1] = y2;
            this.clipVertices1[index + 2] = z2;
          }
        }
        x1 = x2;
        y1 = y2;
        z1 = z2;
        dot1 = dot2;
      }

      numClipVertices = numAddedClipVertices;
      if (swap) {
        var tb = b1;
        b1 = b2;
        b2 = tb;
      }
      if (numClipVertices == 0) return;
      var flipped = b1 != shape1;
      if (numClipVertices > 4) {
        x1 = (q1x + q2x + q3x + q4x) * 0.25;
        y1 = (q1y + q2y + q3y + q4y) * 0.25;
        z1 = (q1z + q2z + q3z + q4z) * 0.25;
        n1x = q1x - x1;
        n1y = q1y - y1;
        n1z = q1z - z1;
        n2x = q2x - x1;
        n2y = q2y - y1;
        n2z = q2z - z1;
        var index1 = 0;
        var index2 = 0;
        var index3 = 0;
        var index4 = 0;
        var maxDot = -this.INF;
        minDot = this.INF;

        //i = numClipVertices;
        //while(i--){
        for (i = 0; i < numClipVertices; i++) {
          this.used[i] = false;
          index = i * 3;
          x1 = this.clipVertices1[index];
          y1 = this.clipVertices1[index + 1];
          z1 = this.clipVertices1[index + 2];
          dot = x1 * n1x + y1 * n1y + z1 * n1z;
          if (dot < minDot) {
            minDot = dot;
            index1 = i;
          }
          if (dot > maxDot) {
            maxDot = dot;
            index3 = i;
          }
        }

        this.used[index1] = true;
        this.used[index3] = true;
        maxDot = -this.INF;
        minDot = this.INF;

        //i = numClipVertices;
        //while(i--){
        for (i = 0; i < numClipVertices; i++) {
          if (this.used[i]) continue;
          index = i * 3;
          x1 = this.clipVertices1[index];
          y1 = this.clipVertices1[index + 1];
          z1 = this.clipVertices1[index + 2];
          dot = x1 * n2x + y1 * n2y + z1 * n2z;
          if (dot < minDot) {
            minDot = dot;
            index2 = i;
          }
          if (dot > maxDot) {
            maxDot = dot;
            index4 = i;
          }
        }

        index = index1 * 3;
        x1 = this.clipVertices1[index];
        y1 = this.clipVertices1[index + 1];
        z1 = this.clipVertices1[index + 2];
        dot = (x1 - cx) * nx + (y1 - cy) * ny + (z1 - cz) * nz;
        if (dot < 0) manifold.addPoint(x1, y1, z1, nx, ny, nz, dot, flipped);

        index = index2 * 3;
        x1 = this.clipVertices1[index];
        y1 = this.clipVertices1[index + 1];
        z1 = this.clipVertices1[index + 2];
        dot = (x1 - cx) * nx + (y1 - cy) * ny + (z1 - cz) * nz;
        if (dot < 0) manifold.addPoint(x1, y1, z1, nx, ny, nz, dot, flipped);

        index = index3 * 3;
        x1 = this.clipVertices1[index];
        y1 = this.clipVertices1[index + 1];
        z1 = this.clipVertices1[index + 2];
        dot = (x1 - cx) * nx + (y1 - cy) * ny + (z1 - cz) * nz;
        if (dot < 0) manifold.addPoint(x1, y1, z1, nx, ny, nz, dot, flipped);

        index = index4 * 3;
        x1 = this.clipVertices1[index];
        y1 = this.clipVertices1[index + 1];
        z1 = this.clipVertices1[index + 2];
        dot = (x1 - cx) * nx + (y1 - cy) * ny + (z1 - cz) * nz;
        if (dot < 0) manifold.addPoint(x1, y1, z1, nx, ny, nz, dot, flipped);

      } else {
        //i = numClipVertices;
        //while(i--){
        for (i = 0; i < numClipVertices; i++) {
          index = i * 3;
          x1 = this.clipVertices1[index];
          y1 = this.clipVertices1[index + 1];
          z1 = this.clipVertices1[index + 2];
          dot = (x1 - cx) * nx + (y1 - cy) * ny + (z1 - cz) * nz;
          if (dot < 0) manifold.addPoint(x1, y1, z1, nx, ny, nz, dot, flipped);
        }
      }

    }

  });

  function BoxCylinderCollisionDetector(flip) {

    CollisionDetector.call(this);
    this.flip = flip;

  }
  BoxCylinderCollisionDetector.prototype = Object.assign(Object.create(CollisionDetector.prototype), {

    constructor: BoxCylinderCollisionDetector,

    getSep: function (c1, c2, sep, pos, dep) {

      var t1x;
      var t1y;
      var t1z;
      var t2x;
      var t2y;
      var t2z;
      var sup = new Vec3();
      var len;
      var p1x;
      var p1y;
      var p1z;
      var p2x;
      var p2y;
      var p2z;
      var v01x = c1.position.x;
      var v01y = c1.position.y;
      var v01z = c1.position.z;
      var v02x = c2.position.x;
      var v02y = c2.position.y;
      var v02z = c2.position.z;
      var v0x = v02x - v01x;
      var v0y = v02y - v01y;
      var v0z = v02z - v01z;
      if (v0x * v0x + v0y * v0y + v0z * v0z == 0) v0y = 0.001;
      var nx = -v0x;
      var ny = -v0y;
      var nz = -v0z;
      this.supportPointB(c1, -nx, -ny, -nz, sup);
      var v11x = sup.x;
      var v11y = sup.y;
      var v11z = sup.z;
      this.supportPointC(c2, nx, ny, nz, sup);
      var v12x = sup.x;
      var v12y = sup.y;
      var v12z = sup.z;
      var v1x = v12x - v11x;
      var v1y = v12y - v11y;
      var v1z = v12z - v11z;
      if (v1x * nx + v1y * ny + v1z * nz <= 0) {
        return false;
      }
      nx = v1y * v0z - v1z * v0y;
      ny = v1z * v0x - v1x * v0z;
      nz = v1x * v0y - v1y * v0x;
      if (nx * nx + ny * ny + nz * nz == 0) {
        sep.set(v1x - v0x, v1y - v0y, v1z - v0z).normalize();
        pos.set((v11x + v12x) * 0.5, (v11y + v12y) * 0.5, (v11z + v12z) * 0.5);
        return true;
      }
      this.supportPointB(c1, -nx, -ny, -nz, sup);
      var v21x = sup.x;
      var v21y = sup.y;
      var v21z = sup.z;
      this.supportPointC(c2, nx, ny, nz, sup);
      var v22x = sup.x;
      var v22y = sup.y;
      var v22z = sup.z;
      var v2x = v22x - v21x;
      var v2y = v22y - v21y;
      var v2z = v22z - v21z;
      if (v2x * nx + v2y * ny + v2z * nz <= 0) {
        return false;
      }
      t1x = v1x - v0x;
      t1y = v1y - v0y;
      t1z = v1z - v0z;
      t2x = v2x - v0x;
      t2y = v2y - v0y;
      t2z = v2z - v0z;
      nx = t1y * t2z - t1z * t2y;
      ny = t1z * t2x - t1x * t2z;
      nz = t1x * t2y - t1y * t2x;
      if (nx * v0x + ny * v0y + nz * v0z > 0) {
        t1x = v1x;
        t1y = v1y;
        t1z = v1z;
        v1x = v2x;
        v1y = v2y;
        v1z = v2z;
        v2x = t1x;
        v2y = t1y;
        v2z = t1z;
        t1x = v11x;
        t1y = v11y;
        t1z = v11z;
        v11x = v21x;
        v11y = v21y;
        v11z = v21z;
        v21x = t1x;
        v21y = t1y;
        v21z = t1z;
        t1x = v12x;
        t1y = v12y;
        t1z = v12z;
        v12x = v22x;
        v12y = v22y;
        v12z = v22z;
        v22x = t1x;
        v22y = t1y;
        v22z = t1z;
        nx = -nx;
        ny = -ny;
        nz = -nz;
      }
      var iterations = 0;
      while (true) {
        if (++iterations > 100) {
          return false;
        }
        this.supportPointB(c1, -nx, -ny, -nz, sup);
        var v31x = sup.x;
        var v31y = sup.y;
        var v31z = sup.z;
        this.supportPointC(c2, nx, ny, nz, sup);
        var v32x = sup.x;
        var v32y = sup.y;
        var v32z = sup.z;
        var v3x = v32x - v31x;
        var v3y = v32y - v31y;
        var v3z = v32z - v31z;
        if (v3x * nx + v3y * ny + v3z * nz <= 0) {
          return false;
        }
        if ((v1y * v3z - v1z * v3y) * v0x + (v1z * v3x - v1x * v3z) * v0y + (v1x * v3y - v1y * v3x) * v0z < 0) {
          v2x = v3x;
          v2y = v3y;
          v2z = v3z;
          v21x = v31x;
          v21y = v31y;
          v21z = v31z;
          v22x = v32x;
          v22y = v32y;
          v22z = v32z;
          t1x = v1x - v0x;
          t1y = v1y - v0y;
          t1z = v1z - v0z;
          t2x = v3x - v0x;
          t2y = v3y - v0y;
          t2z = v3z - v0z;
          nx = t1y * t2z - t1z * t2y;
          ny = t1z * t2x - t1x * t2z;
          nz = t1x * t2y - t1y * t2x;
          continue;
        }
        if ((v3y * v2z - v3z * v2y) * v0x + (v3z * v2x - v3x * v2z) * v0y + (v3x * v2y - v3y * v2x) * v0z < 0) {
          v1x = v3x;
          v1y = v3y;
          v1z = v3z;
          v11x = v31x;
          v11y = v31y;
          v11z = v31z;
          v12x = v32x;
          v12y = v32y;
          v12z = v32z;
          t1x = v3x - v0x;
          t1y = v3y - v0y;
          t1z = v3z - v0z;
          t2x = v2x - v0x;
          t2y = v2y - v0y;
          t2z = v2z - v0z;
          nx = t1y * t2z - t1z * t2y;
          ny = t1z * t2x - t1x * t2z;
          nz = t1x * t2y - t1y * t2x;
          continue;
        }
        var hit = false;
        while (true) {
          t1x = v2x - v1x;
          t1y = v2y - v1y;
          t1z = v2z - v1z;
          t2x = v3x - v1x;
          t2y = v3y - v1y;
          t2z = v3z - v1z;
          nx = t1y * t2z - t1z * t2y;
          ny = t1z * t2x - t1x * t2z;
          nz = t1x * t2y - t1y * t2x;
          len = 1 / _Math.sqrt(nx * nx + ny * ny + nz * nz);
          nx *= len;
          ny *= len;
          nz *= len;
          if (nx * v1x + ny * v1y + nz * v1z >= 0 && !hit) {
            var b0 = (v1y * v2z - v1z * v2y) * v3x + (v1z * v2x - v1x * v2z) * v3y + (v1x * v2y - v1y * v2x) * v3z;
            var b1 = (v3y * v2z - v3z * v2y) * v0x + (v3z * v2x - v3x * v2z) * v0y + (v3x * v2y - v3y * v2x) * v0z;
            var b2 = (v0y * v1z - v0z * v1y) * v3x + (v0z * v1x - v0x * v1z) * v3y + (v0x * v1y - v0y * v1x) * v3z;
            var b3 = (v2y * v1z - v2z * v1y) * v0x + (v2z * v1x - v2x * v1z) * v0y + (v2x * v1y - v2y * v1x) * v0z;
            var sum = b0 + b1 + b2 + b3;
            if (sum <= 0) {
              b0 = 0;
              b1 = (v2y * v3z - v2z * v3y) * nx + (v2z * v3x - v2x * v3z) * ny + (v2x * v3y - v2y * v3x) * nz;
              b2 = (v3y * v2z - v3z * v2y) * nx + (v3z * v2x - v3x * v2z) * ny + (v3x * v2y - v3y * v2x) * nz;
              b3 = (v1y * v2z - v1z * v2y) * nx + (v1z * v2x - v1x * v2z) * ny + (v1x * v2y - v1y * v2x) * nz;
              sum = b1 + b2 + b3;
            }
            var inv = 1 / sum;
            p1x = (v01x * b0 + v11x * b1 + v21x * b2 + v31x * b3) * inv;
            p1y = (v01y * b0 + v11y * b1 + v21y * b2 + v31y * b3) * inv;
            p1z = (v01z * b0 + v11z * b1 + v21z * b2 + v31z * b3) * inv;
            p2x = (v02x * b0 + v12x * b1 + v22x * b2 + v32x * b3) * inv;
            p2y = (v02y * b0 + v12y * b1 + v22y * b2 + v32y * b3) * inv;
            p2z = (v02z * b0 + v12z * b1 + v22z * b2 + v32z * b3) * inv;
            hit = true;
          }
          this.supportPointB(c1, -nx, -ny, -nz, sup);
          var v41x = sup.x;
          var v41y = sup.y;
          var v41z = sup.z;
          this.supportPointC(c2, nx, ny, nz, sup);
          var v42x = sup.x;
          var v42y = sup.y;
          var v42z = sup.z;
          var v4x = v42x - v41x;
          var v4y = v42y - v41y;
          var v4z = v42z - v41z;
          var separation = -(v4x * nx + v4y * ny + v4z * nz);
          if ((v4x - v3x) * nx + (v4y - v3y) * ny + (v4z - v3z) * nz <= 0.01 || separation >= 0) {
            if (hit) {
              sep.set(-nx, -ny, -nz);
              pos.set((p1x + p2x) * 0.5, (p1y + p2y) * 0.5, (p1z + p2z) * 0.5);
              dep.x = separation;
              return true;
            }
            return false;
          }
          if (
            (v4y * v1z - v4z * v1y) * v0x +
            (v4z * v1x - v4x * v1z) * v0y +
            (v4x * v1y - v4y * v1x) * v0z < 0
          ) {
            if (
              (v4y * v2z - v4z * v2y) * v0x +
              (v4z * v2x - v4x * v2z) * v0y +
              (v4x * v2y - v4y * v2x) * v0z < 0
            ) {
              v1x = v4x;
              v1y = v4y;
              v1z = v4z;
              v11x = v41x;
              v11y = v41y;
              v11z = v41z;
              v12x = v42x;
              v12y = v42y;
              v12z = v42z;
            } else {
              v3x = v4x;
              v3y = v4y;
              v3z = v4z;
              v31x = v41x;
              v31y = v41y;
              v31z = v41z;
              v32x = v42x;
              v32y = v42y;
              v32z = v42z;
            }
          } else {
            if (
              (v4y * v3z - v4z * v3y) * v0x +
              (v4z * v3x - v4x * v3z) * v0y +
              (v4x * v3y - v4y * v3x) * v0z < 0
            ) {
              v2x = v4x;
              v2y = v4y;
              v2z = v4z;
              v21x = v41x;
              v21y = v41y;
              v21z = v41z;
              v22x = v42x;
              v22y = v42y;
              v22z = v42z;
            } else {
              v1x = v4x;
              v1y = v4y;
              v1z = v4z;
              v11x = v41x;
              v11y = v41y;
              v11z = v41z;
              v12x = v42x;
              v12y = v42y;
              v12z = v42z;
            }
          }
        }
      }
      //return false;
    },

    supportPointB: function (c, dx, dy, dz, out) {

      var rot = c.rotation.elements;
      var ldx = rot[0] * dx + rot[3] * dy + rot[6] * dz;
      var ldy = rot[1] * dx + rot[4] * dy + rot[7] * dz;
      var ldz = rot[2] * dx + rot[5] * dy + rot[8] * dz;
      var w = c.halfWidth;
      var h = c.halfHeight;
      var d = c.halfDepth;
      var ox;
      var oy;
      var oz;
      if (ldx < 0) ox = -w;
      else ox = w;
      if (ldy < 0) oy = -h;
      else oy = h;
      if (ldz < 0) oz = -d;
      else oz = d;
      ldx = rot[0] * ox + rot[1] * oy + rot[2] * oz + c.position.x;
      ldy = rot[3] * ox + rot[4] * oy + rot[5] * oz + c.position.y;
      ldz = rot[6] * ox + rot[7] * oy + rot[8] * oz + c.position.z;
      out.set(ldx, ldy, ldz);

    },

    supportPointC: function (c, dx, dy, dz, out) {

      var rot = c.rotation.elements;
      var ldx = rot[0] * dx + rot[3] * dy + rot[6] * dz;
      var ldy = rot[1] * dx + rot[4] * dy + rot[7] * dz;
      var ldz = rot[2] * dx + rot[5] * dy + rot[8] * dz;
      var radx = ldx;
      var radz = ldz;
      var len = radx * radx + radz * radz;
      var rad = c.radius;
      var hh = c.halfHeight;
      var ox;
      var oy;
      var oz;
      if (len == 0) {
        if (ldy < 0) {
          ox = rad;
          oy = -hh;
          oz = 0;
        } else {
          ox = rad;
          oy = hh;
          oz = 0;
        }
      } else {
        len = c.radius / _Math.sqrt(len);
        if (ldy < 0) {
          ox = radx * len;
          oy = -hh;
          oz = radz * len;
        } else {
          ox = radx * len;
          oy = hh;
          oz = radz * len;
        }
      }
      ldx = rot[0] * ox + rot[1] * oy + rot[2] * oz + c.position.x;
      ldy = rot[3] * ox + rot[4] * oy + rot[5] * oz + c.position.y;
      ldz = rot[6] * ox + rot[7] * oy + rot[8] * oz + c.position.z;
      out.set(ldx, ldy, ldz);

    },

    detectCollision: function (shape1, shape2, manifold) {

      var b;
      var c;
      if (this.flip) {
        b = shape2;
        c = shape1;
      } else {
        b = shape1;
        c = shape2;
      }
      var sep = new Vec3();
      var pos = new Vec3();
      var dep = new Vec3();

      if (!this.getSep(b, c, sep, pos, dep)) return;
      var pbx = b.position.x;
      var pby = b.position.y;
      var pbz = b.position.z;
      var pcx = c.position.x;
      var pcy = c.position.y;
      var pcz = c.position.z;
      var bw = b.halfWidth;
      var bh = b.halfHeight;
      var bd = b.halfDepth;
      var ch = c.halfHeight;
      var r = c.radius;

      var D = b.dimentions;

      var nwx = D[0];//b.normalDirectionWidth.x;
      var nwy = D[1];//b.normalDirectionWidth.y;
      var nwz = D[2];//b.normalDirectionWidth.z;
      var nhx = D[3];//b.normalDirectionHeight.x;
      var nhy = D[4];//b.normalDirectionHeight.y;
      var nhz = D[5];//b.normalDirectionHeight.z;
      var ndx = D[6];//b.normalDirectionDepth.x;
      var ndy = D[7];//b.normalDirectionDepth.y;
      var ndz = D[8];//b.normalDirectionDepth.z;

      var dwx = D[9];//b.halfDirectionWidth.x;
      var dwy = D[10];//b.halfDirectionWidth.y;
      var dwz = D[11];//b.halfDirectionWidth.z;
      var dhx = D[12];//b.halfDirectionHeight.x;
      var dhy = D[13];//b.halfDirectionHeight.y;
      var dhz = D[14];//b.halfDirectionHeight.z;
      var ddx = D[15];//b.halfDirectionDepth.x;
      var ddy = D[16];//b.halfDirectionDepth.y;
      var ddz = D[17];//b.halfDirectionDepth.z;

      var ncx = c.normalDirection.x;
      var ncy = c.normalDirection.y;
      var ncz = c.normalDirection.z;
      var dcx = c.halfDirection.x;
      var dcy = c.halfDirection.y;
      var dcz = c.halfDirection.z;
      var nx = sep.x;
      var ny = sep.y;
      var nz = sep.z;
      var dotw = nx * nwx + ny * nwy + nz * nwz;
      var doth = nx * nhx + ny * nhy + nz * nhz;
      var dotd = nx * ndx + ny * ndy + nz * ndz;
      var dotc = nx * ncx + ny * ncy + nz * ncz;
      var right1 = dotw > 0;
      var right2 = doth > 0;
      var right3 = dotd > 0;
      var right4 = dotc > 0;
      if (!right1) dotw = -dotw;
      if (!right2) doth = -doth;
      if (!right3) dotd = -dotd;
      if (!right4) dotc = -dotc;
      var state = 0;
      if (dotc > 0.999) {
        if (dotw > 0.999) {
          if (dotw > dotc) state = 1;
          else state = 4;
        } else if (doth > 0.999) {
          if (doth > dotc) state = 2;
          else state = 4;
        } else if (dotd > 0.999) {
          if (dotd > dotc) state = 3;
          else state = 4;
        } else state = 4;
      } else {
        if (dotw > 0.999) state = 1;
        else if (doth > 0.999) state = 2;
        else if (dotd > 0.999) state = 3;
      }
      var cbx;
      var cby;
      var cbz;
      var ccx;
      var ccy;
      var ccz;
      var r00;
      var r01;
      var r02;
      var r10;
      var r11;
      var r12;
      var r20;
      var r21;
      var r22;
      var px;
      var py;
      var pz;
      var pd;
      var dot;
      var len;
      var tx;
      var ty;
      var tz;
      var td;
      var dx;
      var dy;
      var dz;
      var d1x;
      var d1y;
      var d1z;
      var d2x;
      var d2y;
      var d2z;
      var sx;
      var sy;
      var sz;
      var sd;
      var ex;
      var ey;
      var ez;
      var ed;
      var dot1;
      var dot2;
      var t1;
      var dir1x;
      var dir1y;
      var dir1z;
      var dir2x;
      var dir2y;
      var dir2z;
      var dir1l;
      var dir2l;
      if (state == 0) {
        //manifold.addPoint(pos.x,pos.y,pos.z,nx,ny,nz,dep.x,b,c,0,0,false);
        manifold.addPoint(pos.x, pos.y, pos.z, nx, ny, nz, dep.x, this.flip);
      } else if (state == 4) {
        if (right4) {
          ccx = pcx - dcx;
          ccy = pcy - dcy;
          ccz = pcz - dcz;
          nx = -ncx;
          ny = -ncy;
          nz = -ncz;
        } else {
          ccx = pcx + dcx;
          ccy = pcy + dcy;
          ccz = pcz + dcz;
          nx = ncx;
          ny = ncy;
          nz = ncz;
        }
        var v1x;
        var v1y;
        var v1z;
        var v2x;
        var v2y;
        var v2z;
        var v3x;
        var v3y;
        var v3z;
        var v4x;
        var v4y;
        var v4z;

        dot = 1;
        state = 0;
        dot1 = nwx * nx + nwy * ny + nwz * nz;
        if (dot1 < dot) {
          dot = dot1;
          state = 0;
        }
        if (-dot1 < dot) {
          dot = -dot1;
          state = 1;
        }
        dot1 = nhx * nx + nhy * ny + nhz * nz;
        if (dot1 < dot) {
          dot = dot1;
          state = 2;
        }
        if (-dot1 < dot) {
          dot = -dot1;
          state = 3;
        }
        dot1 = ndx * nx + ndy * ny + ndz * nz;
        if (dot1 < dot) {
          dot = dot1;
          state = 4;
        }
        if (-dot1 < dot) {
          dot = -dot1;
          state = 5;
        }
        var v = b.elements;
        switch (state) {
          case 0:
            //v=b.vertex1;
            v1x = v[0];//v.x;
            v1y = v[1];//v.y;
            v1z = v[2];//v.z;
            //v=b.vertex3;
            v2x = v[6];//v.x;
            v2y = v[7];//v.y;
            v2z = v[8];//v.z;
            //v=b.vertex4;
            v3x = v[9];//v.x;
            v3y = v[10];//v.y;
            v3z = v[11];//v.z;
            //v=b.vertex2;
            v4x = v[3];//v.x;
            v4y = v[4];//v.y;
            v4z = v[5];//v.z;
            break;
          case 1:
            //v=b.vertex6;
            v1x = v[15];//v.x;
            v1y = v[16];//v.y;
            v1z = v[17];//v.z;
            //v=b.vertex8;
            v2x = v[21];//v.x;
            v2y = v[22];//v.y;
            v2z = v[23];//v.z;
            //v=b.vertex7;
            v3x = v[18];//v.x;
            v3y = v[19];//v.y;
            v3z = v[20];//v.z;
            //v=b.vertex5;
            v4x = v[12];//v.x;
            v4y = v[13];//v.y;
            v4z = v[14];//v.z;
            break;
          case 2:
            //v=b.vertex5;
            v1x = v[12];//v.x;
            v1y = v[13];//v.y;
            v1z = v[14];//v.z;
            //v=b.vertex1;
            v2x = v[0];//v.x;
            v2y = v[1];//v.y;
            v2z = v[2];//v.z;
            //v=b.vertex2;
            v3x = v[3];//v.x;
            v3y = v[4];//v.y;
            v3z = v[5];//v.z;
            //v=b.vertex6;
            v4x = v[15];//v.x;
            v4y = v[16];//v.y;
            v4z = v[17];//v.z;
            break;
          case 3:
            //v=b.vertex8;
            v1x = v[21];//v.x;
            v1y = v[22];//v.y;
            v1z = v[23];//v.z;
            //v=b.vertex4;
            v2x = v[9];//v.x;
            v2y = v[10];//v.y;
            v2z = v[11];//v.z;
            //v=b.vertex3;
            v3x = v[6];//v.x;
            v3y = v[7];//v.y;
            v3z = v[8];//v.z;
            //v=b.vertex7;
            v4x = v[18];//v.x;
            v4y = v[19];//v.y;
            v4z = v[20];//v.z;
            break;
          case 4:
            //v=b.vertex5;
            v1x = v[12];//v.x;
            v1y = v[13];//v.y;
            v1z = v[14];//v.z;
            //v=b.vertex7;
            v2x = v[18];//v.x;
            v2y = v[19];//v.y;
            v2z = v[20];//v.z;
            //v=b.vertex3;
            v3x = v[6];//v.x;
            v3y = v[7];//v.y;
            v3z = v[8];//v.z;
            //v=b.vertex1;
            v4x = v[0];//v.x;
            v4y = v[1];//v.y;
            v4z = v[2];//v.z;
            break;
          case 5:
            //v=b.vertex2;
            v1x = v[3];//v.x;
            v1y = v[4];//v.y;
            v1z = v[5];//v.z;
            //v=b.vertex4;
            v2x = v[9];//v.x;
            v2y = v[10];//v.y;
            v2z = v[11];//v.z;
            //v=b.vertex8;
            v3x = v[21];//v.x;
            v3y = v[22];//v.y;
            v3z = v[23];//v.z;
            //v=b.vertex6;
            v4x = v[15];//v.x;
            v4y = v[16];//v.y;
            v4z = v[17];//v.z;
            break;
        }
        pd = nx * (v1x - ccx) + ny * (v1y - ccy) + nz * (v1z - ccz);
        if (pd <= 0) manifold.addPoint(v1x, v1y, v1z, -nx, -ny, -nz, pd, this.flip);
        pd = nx * (v2x - ccx) + ny * (v2y - ccy) + nz * (v2z - ccz);
        if (pd <= 0) manifold.addPoint(v2x, v2y, v2z, -nx, -ny, -nz, pd, this.flip);
        pd = nx * (v3x - ccx) + ny * (v3y - ccy) + nz * (v3z - ccz);
        if (pd <= 0) manifold.addPoint(v3x, v3y, v3z, -nx, -ny, -nz, pd, this.flip);
        pd = nx * (v4x - ccx) + ny * (v4y - ccy) + nz * (v4z - ccz);
        if (pd <= 0) manifold.addPoint(v4x, v4y, v4z, -nx, -ny, -nz, pd, this.flip);
      } else {
        switch (state) {
          case 1:
            if (right1) {
              cbx = pbx + dwx;
              cby = pby + dwy;
              cbz = pbz + dwz;
              nx = nwx;
              ny = nwy;
              nz = nwz;
            } else {
              cbx = pbx - dwx;
              cby = pby - dwy;
              cbz = pbz - dwz;
              nx = -nwx;
              ny = -nwy;
              nz = -nwz;
            }
            dir1x = nhx;
            dir1y = nhy;
            dir1z = nhz;
            dir1l = bh;
            dir2x = ndx;
            dir2y = ndy;
            dir2z = ndz;
            dir2l = bd;
            break;
          case 2:
            if (right2) {
              cbx = pbx + dhx;
              cby = pby + dhy;
              cbz = pbz + dhz;
              nx = nhx;
              ny = nhy;
              nz = nhz;
            } else {
              cbx = pbx - dhx;
              cby = pby - dhy;
              cbz = pbz - dhz;
              nx = -nhx;
              ny = -nhy;
              nz = -nhz;
            }
            dir1x = nwx;
            dir1y = nwy;
            dir1z = nwz;
            dir1l = bw;
            dir2x = ndx;
            dir2y = ndy;
            dir2z = ndz;
            dir2l = bd;
            break;
          case 3:
            if (right3) {
              cbx = pbx + ddx;
              cby = pby + ddy;
              cbz = pbz + ddz;
              nx = ndx;
              ny = ndy;
              nz = ndz;
            } else {
              cbx = pbx - ddx;
              cby = pby - ddy;
              cbz = pbz - ddz;
              nx = -ndx;
              ny = -ndy;
              nz = -ndz;
            }
            dir1x = nwx;
            dir1y = nwy;
            dir1z = nwz;
            dir1l = bw;
            dir2x = nhx;
            dir2y = nhy;
            dir2z = nhz;
            dir2l = bh;
            break;
        }
        dot = nx * ncx + ny * ncy + nz * ncz;
        if (dot < 0) len = ch;
        else len = -ch;
        ccx = pcx + len * ncx;
        ccy = pcy + len * ncy;
        ccz = pcz + len * ncz;
        if (dotc >= 0.999999) {
          tx = -ny;
          ty = nz;
          tz = nx;
        } else {
          tx = nx;
          ty = ny;
          tz = nz;
        }
        len = tx * ncx + ty * ncy + tz * ncz;
        dx = len * ncx - tx;
        dy = len * ncy - ty;
        dz = len * ncz - tz;
        len = _Math.sqrt(dx * dx + dy * dy + dz * dz);
        if (len == 0) return;
        len = r / len;
        dx *= len;
        dy *= len;
        dz *= len;
        tx = ccx + dx;
        ty = ccy + dy;
        tz = ccz + dz;
        if (dot < -0.96 || dot > 0.96) {
          r00 = ncx * ncx * 1.5 - 0.5;
          r01 = ncx * ncy * 1.5 - ncz * 0.866025403;
          r02 = ncx * ncz * 1.5 + ncy * 0.866025403;
          r10 = ncy * ncx * 1.5 + ncz * 0.866025403;
          r11 = ncy * ncy * 1.5 - 0.5;
          r12 = ncy * ncz * 1.5 - ncx * 0.866025403;
          r20 = ncz * ncx * 1.5 - ncy * 0.866025403;
          r21 = ncz * ncy * 1.5 + ncx * 0.866025403;
          r22 = ncz * ncz * 1.5 - 0.5;
          px = tx;
          py = ty;
          pz = tz;
          pd = nx * (px - cbx) + ny * (py - cby) + nz * (pz - cbz);
          tx = px - pd * nx - cbx;
          ty = py - pd * ny - cby;
          tz = pz - pd * nz - cbz;
          sd = dir1x * tx + dir1y * ty + dir1z * tz;
          ed = dir2x * tx + dir2y * ty + dir2z * tz;
          if (sd < -dir1l) sd = -dir1l;
          else if (sd > dir1l) sd = dir1l;
          if (ed < -dir2l) ed = -dir2l;
          else if (ed > dir2l) ed = dir2l;
          tx = sd * dir1x + ed * dir2x;
          ty = sd * dir1y + ed * dir2y;
          tz = sd * dir1z + ed * dir2z;
          px = cbx + tx;
          py = cby + ty;
          pz = cbz + tz;
          manifold.addPoint(px, py, pz, nx, ny, nz, pd, this.flip);
          px = dx * r00 + dy * r01 + dz * r02;
          py = dx * r10 + dy * r11 + dz * r12;
          pz = dx * r20 + dy * r21 + dz * r22;
          px = (dx = px) + ccx;
          py = (dy = py) + ccy;
          pz = (dz = pz) + ccz;
          pd = nx * (px - cbx) + ny * (py - cby) + nz * (pz - cbz);
          if (pd <= 0) {
            tx = px - pd * nx - cbx;
            ty = py - pd * ny - cby;
            tz = pz - pd * nz - cbz;
            sd = dir1x * tx + dir1y * ty + dir1z * tz;
            ed = dir2x * tx + dir2y * ty + dir2z * tz;
            if (sd < -dir1l) sd = -dir1l;
            else if (sd > dir1l) sd = dir1l;
            if (ed < -dir2l) ed = -dir2l;
            else if (ed > dir2l) ed = dir2l;
            tx = sd * dir1x + ed * dir2x;
            ty = sd * dir1y + ed * dir2y;
            tz = sd * dir1z + ed * dir2z;
            px = cbx + tx;
            py = cby + ty;
            pz = cbz + tz;
            //manifold.addPoint(px,py,pz,nx,ny,nz,pd,b,c,2,0,false);
            manifold.addPoint(px, py, pz, nx, ny, nz, pd, this.flip);
          }
          px = dx * r00 + dy * r01 + dz * r02;
          py = dx * r10 + dy * r11 + dz * r12;
          pz = dx * r20 + dy * r21 + dz * r22;
          px = (dx = px) + ccx;
          py = (dy = py) + ccy;
          pz = (dz = pz) + ccz;
          pd = nx * (px - cbx) + ny * (py - cby) + nz * (pz - cbz);
          if (pd <= 0) {
            tx = px - pd * nx - cbx;
            ty = py - pd * ny - cby;
            tz = pz - pd * nz - cbz;
            sd = dir1x * tx + dir1y * ty + dir1z * tz;
            ed = dir2x * tx + dir2y * ty + dir2z * tz;
            if (sd < -dir1l) sd = -dir1l;
            else if (sd > dir1l) sd = dir1l;
            if (ed < -dir2l) ed = -dir2l;
            else if (ed > dir2l) ed = dir2l;
            tx = sd * dir1x + ed * dir2x;
            ty = sd * dir1y + ed * dir2y;
            tz = sd * dir1z + ed * dir2z;
            px = cbx + tx;
            py = cby + ty;
            pz = cbz + tz;
            //manifold.addPoint(px,py,pz,nx,ny,nz,pd,b,c,3,0,false);
            manifold.addPoint(px, py, pz, nx, ny, nz, pd, this.flip);
          }
        } else {
          sx = tx;
          sy = ty;
          sz = tz;
          sd = nx * (sx - cbx) + ny * (sy - cby) + nz * (sz - cbz);
          sx -= sd * nx;
          sy -= sd * ny;
          sz -= sd * nz;
          if (dot > 0) {
            ex = tx + dcx * 2;
            ey = ty + dcy * 2;
            ez = tz + dcz * 2;
          } else {
            ex = tx - dcx * 2;
            ey = ty - dcy * 2;
            ez = tz - dcz * 2;
          }
          ed = nx * (ex - cbx) + ny * (ey - cby) + nz * (ez - cbz);
          ex -= ed * nx;
          ey -= ed * ny;
          ez -= ed * nz;
          d1x = sx - cbx;
          d1y = sy - cby;
          d1z = sz - cbz;
          d2x = ex - cbx;
          d2y = ey - cby;
          d2z = ez - cbz;
          tx = ex - sx;
          ty = ey - sy;
          tz = ez - sz;
          td = ed - sd;
          dotw = d1x * dir1x + d1y * dir1y + d1z * dir1z;
          doth = d2x * dir1x + d2y * dir1y + d2z * dir1z;
          dot1 = dotw - dir1l;
          dot2 = doth - dir1l;
          if (dot1 > 0) {
            if (dot2 > 0) return;
            t1 = dot1 / (dot1 - dot2);
            sx = sx + tx * t1;
            sy = sy + ty * t1;
            sz = sz + tz * t1;
            sd = sd + td * t1;
            d1x = sx - cbx;
            d1y = sy - cby;
            d1z = sz - cbz;
            dotw = d1x * dir1x + d1y * dir1y + d1z * dir1z;
            tx = ex - sx;
            ty = ey - sy;
            tz = ez - sz;
            td = ed - sd;
          } else if (dot2 > 0) {
            t1 = dot1 / (dot1 - dot2);
            ex = sx + tx * t1;
            ey = sy + ty * t1;
            ez = sz + tz * t1;
            ed = sd + td * t1;
            d2x = ex - cbx;
            d2y = ey - cby;
            d2z = ez - cbz;
            doth = d2x * dir1x + d2y * dir1y + d2z * dir1z;
            tx = ex - sx;
            ty = ey - sy;
            tz = ez - sz;
            td = ed - sd;
          }
          dot1 = dotw + dir1l;
          dot2 = doth + dir1l;
          if (dot1 < 0) {
            if (dot2 < 0) return;
            t1 = dot1 / (dot1 - dot2);
            sx = sx + tx * t1;
            sy = sy + ty * t1;
            sz = sz + tz * t1;
            sd = sd + td * t1;
            d1x = sx - cbx;
            d1y = sy - cby;
            d1z = sz - cbz;
            tx = ex - sx;
            ty = ey - sy;
            tz = ez - sz;
            td = ed - sd;
          } else if (dot2 < 0) {
            t1 = dot1 / (dot1 - dot2);
            ex = sx + tx * t1;
            ey = sy + ty * t1;
            ez = sz + tz * t1;
            ed = sd + td * t1;
            d2x = ex - cbx;
            d2y = ey - cby;
            d2z = ez - cbz;
            tx = ex - sx;
            ty = ey - sy;
            tz = ez - sz;
            td = ed - sd;
          }
          dotw = d1x * dir2x + d1y * dir2y + d1z * dir2z;
          doth = d2x * dir2x + d2y * dir2y + d2z * dir2z;
          dot1 = dotw - dir2l;
          dot2 = doth - dir2l;
          if (dot1 > 0) {
            if (dot2 > 0) return;
            t1 = dot1 / (dot1 - dot2);
            sx = sx + tx * t1;
            sy = sy + ty * t1;
            sz = sz + tz * t1;
            sd = sd + td * t1;
            d1x = sx - cbx;
            d1y = sy - cby;
            d1z = sz - cbz;
            dotw = d1x * dir2x + d1y * dir2y + d1z * dir2z;
            tx = ex - sx;
            ty = ey - sy;
            tz = ez - sz;
            td = ed - sd;
          } else if (dot2 > 0) {
            t1 = dot1 / (dot1 - dot2);
            ex = sx + tx * t1;
            ey = sy + ty * t1;
            ez = sz + tz * t1;
            ed = sd + td * t1;
            d2x = ex - cbx;
            d2y = ey - cby;
            d2z = ez - cbz;
            doth = d2x * dir2x + d2y * dir2y + d2z * dir2z;
            tx = ex - sx;
            ty = ey - sy;
            tz = ez - sz;
            td = ed - sd;
          }
          dot1 = dotw + dir2l;
          dot2 = doth + dir2l;
          if (dot1 < 0) {
            if (dot2 < 0) return;
            t1 = dot1 / (dot1 - dot2);
            sx = sx + tx * t1;
            sy = sy + ty * t1;
            sz = sz + tz * t1;
            sd = sd + td * t1;
          } else if (dot2 < 0) {
            t1 = dot1 / (dot1 - dot2);
            ex = sx + tx * t1;
            ey = sy + ty * t1;
            ez = sz + tz * t1;
            ed = sd + td * t1;
          }
          if (sd < 0) {
            //manifold.addPoint(sx,sy,sz,nx,ny,nz,sd,b,c,1,0,false);
            manifold.addPoint(sx, sy, sz, nx, ny, nz, sd, this.flip);
          }
          if (ed < 0) {
            //manifold.addPoint(ex,ey,ez,nx,ny,nz,ed,b,c,4,0,false);
            manifold.addPoint(ex, ey, ez, nx, ny, nz, ed, this.flip);
          }
        }
      }

    }

  });

  function CylinderCylinderCollisionDetector() {

    CollisionDetector.call(this);

  }
  CylinderCylinderCollisionDetector.prototype = Object.assign(Object.create(CollisionDetector.prototype), {

    constructor: CylinderCylinderCollisionDetector,


    getSep: function (c1, c2, sep, pos, dep) {

      var t1x;
      var t1y;
      var t1z;
      var t2x;
      var t2y;
      var t2z;
      var sup = new Vec3();
      var len;
      var p1x;
      var p1y;
      var p1z;
      var p2x;
      var p2y;
      var p2z;
      var v01x = c1.position.x;
      var v01y = c1.position.y;
      var v01z = c1.position.z;
      var v02x = c2.position.x;
      var v02y = c2.position.y;
      var v02z = c2.position.z;
      var v0x = v02x - v01x;
      var v0y = v02y - v01y;
      var v0z = v02z - v01z;
      if (v0x * v0x + v0y * v0y + v0z * v0z == 0) v0y = 0.001;
      var nx = -v0x;
      var ny = -v0y;
      var nz = -v0z;
      this.supportPoint(c1, -nx, -ny, -nz, sup);
      var v11x = sup.x;
      var v11y = sup.y;
      var v11z = sup.z;
      this.supportPoint(c2, nx, ny, nz, sup);
      var v12x = sup.x;
      var v12y = sup.y;
      var v12z = sup.z;
      var v1x = v12x - v11x;
      var v1y = v12y - v11y;
      var v1z = v12z - v11z;
      if (v1x * nx + v1y * ny + v1z * nz <= 0) {
        return false;
      }
      nx = v1y * v0z - v1z * v0y;
      ny = v1z * v0x - v1x * v0z;
      nz = v1x * v0y - v1y * v0x;
      if (nx * nx + ny * ny + nz * nz == 0) {
        sep.set(v1x - v0x, v1y - v0y, v1z - v0z).normalize();
        pos.set((v11x + v12x) * 0.5, (v11y + v12y) * 0.5, (v11z + v12z) * 0.5);
        return true;
      }
      this.supportPoint(c1, -nx, -ny, -nz, sup);
      var v21x = sup.x;
      var v21y = sup.y;
      var v21z = sup.z;
      this.supportPoint(c2, nx, ny, nz, sup);
      var v22x = sup.x;
      var v22y = sup.y;
      var v22z = sup.z;
      var v2x = v22x - v21x;
      var v2y = v22y - v21y;
      var v2z = v22z - v21z;
      if (v2x * nx + v2y * ny + v2z * nz <= 0) {
        return false;
      }
      t1x = v1x - v0x;
      t1y = v1y - v0y;
      t1z = v1z - v0z;
      t2x = v2x - v0x;
      t2y = v2y - v0y;
      t2z = v2z - v0z;
      nx = t1y * t2z - t1z * t2y;
      ny = t1z * t2x - t1x * t2z;
      nz = t1x * t2y - t1y * t2x;
      if (nx * v0x + ny * v0y + nz * v0z > 0) {
        t1x = v1x;
        t1y = v1y;
        t1z = v1z;
        v1x = v2x;
        v1y = v2y;
        v1z = v2z;
        v2x = t1x;
        v2y = t1y;
        v2z = t1z;
        t1x = v11x;
        t1y = v11y;
        t1z = v11z;
        v11x = v21x;
        v11y = v21y;
        v11z = v21z;
        v21x = t1x;
        v21y = t1y;
        v21z = t1z;
        t1x = v12x;
        t1y = v12y;
        t1z = v12z;
        v12x = v22x;
        v12y = v22y;
        v12z = v22z;
        v22x = t1x;
        v22y = t1y;
        v22z = t1z;
        nx = -nx;
        ny = -ny;
        nz = -nz;
      }
      var iterations = 0;
      while (true) {
        if (++iterations > 100) {
          return false;
        }
        this.supportPoint(c1, -nx, -ny, -nz, sup);
        var v31x = sup.x;
        var v31y = sup.y;
        var v31z = sup.z;
        this.supportPoint(c2, nx, ny, nz, sup);
        var v32x = sup.x;
        var v32y = sup.y;
        var v32z = sup.z;
        var v3x = v32x - v31x;
        var v3y = v32y - v31y;
        var v3z = v32z - v31z;
        if (v3x * nx + v3y * ny + v3z * nz <= 0) {
          return false;
        }
        if ((v1y * v3z - v1z * v3y) * v0x + (v1z * v3x - v1x * v3z) * v0y + (v1x * v3y - v1y * v3x) * v0z < 0) {
          v2x = v3x;
          v2y = v3y;
          v2z = v3z;
          v21x = v31x;
          v21y = v31y;
          v21z = v31z;
          v22x = v32x;
          v22y = v32y;
          v22z = v32z;
          t1x = v1x - v0x;
          t1y = v1y - v0y;
          t1z = v1z - v0z;
          t2x = v3x - v0x;
          t2y = v3y - v0y;
          t2z = v3z - v0z;
          nx = t1y * t2z - t1z * t2y;
          ny = t1z * t2x - t1x * t2z;
          nz = t1x * t2y - t1y * t2x;
          continue;
        }
        if ((v3y * v2z - v3z * v2y) * v0x + (v3z * v2x - v3x * v2z) * v0y + (v3x * v2y - v3y * v2x) * v0z < 0) {
          v1x = v3x;
          v1y = v3y;
          v1z = v3z;
          v11x = v31x;
          v11y = v31y;
          v11z = v31z;
          v12x = v32x;
          v12y = v32y;
          v12z = v32z;
          t1x = v3x - v0x;
          t1y = v3y - v0y;
          t1z = v3z - v0z;
          t2x = v2x - v0x;
          t2y = v2y - v0y;
          t2z = v2z - v0z;
          nx = t1y * t2z - t1z * t2y;
          ny = t1z * t2x - t1x * t2z;
          nz = t1x * t2y - t1y * t2x;
          continue;
        }
        var hit = false;
        while (true) {
          t1x = v2x - v1x;
          t1y = v2y - v1y;
          t1z = v2z - v1z;
          t2x = v3x - v1x;
          t2y = v3y - v1y;
          t2z = v3z - v1z;
          nx = t1y * t2z - t1z * t2y;
          ny = t1z * t2x - t1x * t2z;
          nz = t1x * t2y - t1y * t2x;
          len = 1 / _Math.sqrt(nx * nx + ny * ny + nz * nz);
          nx *= len;
          ny *= len;
          nz *= len;
          if (nx * v1x + ny * v1y + nz * v1z >= 0 && !hit) {
            var b0 = (v1y * v2z - v1z * v2y) * v3x + (v1z * v2x - v1x * v2z) * v3y + (v1x * v2y - v1y * v2x) * v3z;
            var b1 = (v3y * v2z - v3z * v2y) * v0x + (v3z * v2x - v3x * v2z) * v0y + (v3x * v2y - v3y * v2x) * v0z;
            var b2 = (v0y * v1z - v0z * v1y) * v3x + (v0z * v1x - v0x * v1z) * v3y + (v0x * v1y - v0y * v1x) * v3z;
            var b3 = (v2y * v1z - v2z * v1y) * v0x + (v2z * v1x - v2x * v1z) * v0y + (v2x * v1y - v2y * v1x) * v0z;
            var sum = b0 + b1 + b2 + b3;
            if (sum <= 0) {
              b0 = 0;
              b1 = (v2y * v3z - v2z * v3y) * nx + (v2z * v3x - v2x * v3z) * ny + (v2x * v3y - v2y * v3x) * nz;
              b2 = (v3y * v2z - v3z * v2y) * nx + (v3z * v2x - v3x * v2z) * ny + (v3x * v2y - v3y * v2x) * nz;
              b3 = (v1y * v2z - v1z * v2y) * nx + (v1z * v2x - v1x * v2z) * ny + (v1x * v2y - v1y * v2x) * nz;
              sum = b1 + b2 + b3;
            }
            var inv = 1 / sum;
            p1x = (v01x * b0 + v11x * b1 + v21x * b2 + v31x * b3) * inv;
            p1y = (v01y * b0 + v11y * b1 + v21y * b2 + v31y * b3) * inv;
            p1z = (v01z * b0 + v11z * b1 + v21z * b2 + v31z * b3) * inv;
            p2x = (v02x * b0 + v12x * b1 + v22x * b2 + v32x * b3) * inv;
            p2y = (v02y * b0 + v12y * b1 + v22y * b2 + v32y * b3) * inv;
            p2z = (v02z * b0 + v12z * b1 + v22z * b2 + v32z * b3) * inv;
            hit = true;
          }
          this.supportPoint(c1, -nx, -ny, -nz, sup);
          var v41x = sup.x;
          var v41y = sup.y;
          var v41z = sup.z;
          this.supportPoint(c2, nx, ny, nz, sup);
          var v42x = sup.x;
          var v42y = sup.y;
          var v42z = sup.z;
          var v4x = v42x - v41x;
          var v4y = v42y - v41y;
          var v4z = v42z - v41z;
          var separation = -(v4x * nx + v4y * ny + v4z * nz);
          if ((v4x - v3x) * nx + (v4y - v3y) * ny + (v4z - v3z) * nz <= 0.01 || separation >= 0) {
            if (hit) {
              sep.set(-nx, -ny, -nz);
              pos.set((p1x + p2x) * 0.5, (p1y + p2y) * 0.5, (p1z + p2z) * 0.5);
              dep.x = separation;
              return true;
            }
            return false;
          }
          if (
            (v4y * v1z - v4z * v1y) * v0x +
            (v4z * v1x - v4x * v1z) * v0y +
            (v4x * v1y - v4y * v1x) * v0z < 0
          ) {
            if (
              (v4y * v2z - v4z * v2y) * v0x +
              (v4z * v2x - v4x * v2z) * v0y +
              (v4x * v2y - v4y * v2x) * v0z < 0
            ) {
              v1x = v4x;
              v1y = v4y;
              v1z = v4z;
              v11x = v41x;
              v11y = v41y;
              v11z = v41z;
              v12x = v42x;
              v12y = v42y;
              v12z = v42z;
            } else {
              v3x = v4x;
              v3y = v4y;
              v3z = v4z;
              v31x = v41x;
              v31y = v41y;
              v31z = v41z;
              v32x = v42x;
              v32y = v42y;
              v32z = v42z;
            }
          } else {
            if (
              (v4y * v3z - v4z * v3y) * v0x +
              (v4z * v3x - v4x * v3z) * v0y +
              (v4x * v3y - v4y * v3x) * v0z < 0
            ) {
              v2x = v4x;
              v2y = v4y;
              v2z = v4z;
              v21x = v41x;
              v21y = v41y;
              v21z = v41z;
              v22x = v42x;
              v22y = v42y;
              v22z = v42z;
            } else {
              v1x = v4x;
              v1y = v4y;
              v1z = v4z;
              v11x = v41x;
              v11y = v41y;
              v11z = v41z;
              v12x = v42x;
              v12y = v42y;
              v12z = v42z;
            }
          }
        }
      }
      //return false;
    },

    supportPoint: function (c, dx, dy, dz, out) {

      var rot = c.rotation.elements;
      var ldx = rot[0] * dx + rot[3] * dy + rot[6] * dz;
      var ldy = rot[1] * dx + rot[4] * dy + rot[7] * dz;
      var ldz = rot[2] * dx + rot[5] * dy + rot[8] * dz;
      var radx = ldx;
      var radz = ldz;
      var len = radx * radx + radz * radz;
      var rad = c.radius;
      var hh = c.halfHeight;
      var ox;
      var oy;
      var oz;
      if (len == 0) {
        if (ldy < 0) {
          ox = rad;
          oy = -hh;
          oz = 0;
        } else {
          ox = rad;
          oy = hh;
          oz = 0;
        }
      } else {
        len = c.radius / _Math.sqrt(len);
        if (ldy < 0) {
          ox = radx * len;
          oy = -hh;
          oz = radz * len;
        } else {
          ox = radx * len;
          oy = hh;
          oz = radz * len;
        }
      }
      ldx = rot[0] * ox + rot[1] * oy + rot[2] * oz + c.position.x;
      ldy = rot[3] * ox + rot[4] * oy + rot[5] * oz + c.position.y;
      ldz = rot[6] * ox + rot[7] * oy + rot[8] * oz + c.position.z;
      out.set(ldx, ldy, ldz);

    },

    detectCollision: function (shape1, shape2, manifold) {

      var c1;
      var c2;
      if (shape1.id < shape2.id) {
        c1 = shape1;
        c2 = shape2;
      } else {
        c1 = shape2;
        c2 = shape1;
      }
      var p1 = c1.position;
      var p2 = c2.position;
      var p1x = p1.x;
      var p1y = p1.y;
      var p1z = p1.z;
      var p2x = p2.x;
      var p2y = p2.y;
      var p2z = p2.z;
      var h1 = c1.halfHeight;
      var h2 = c2.halfHeight;
      var n1 = c1.normalDirection;
      var n2 = c2.normalDirection;
      var d1 = c1.halfDirection;
      var d2 = c2.halfDirection;
      var r1 = c1.radius;
      var r2 = c2.radius;
      var n1x = n1.x;
      var n1y = n1.y;
      var n1z = n1.z;
      var n2x = n2.x;
      var n2y = n2.y;
      var n2z = n2.z;
      var d1x = d1.x;
      var d1y = d1.y;
      var d1z = d1.z;
      var d2x = d2.x;
      var d2y = d2.y;
      var d2z = d2.z;
      var dx = p1x - p2x;
      var dy = p1y - p2y;
      var dz = p1z - p2z;
      var len;
      var c1x;
      var c1y;
      var c1z;
      var c2x;
      var c2y;
      var c2z;
      var tx;
      var ty;
      var tz;
      var sx;
      var sy;
      var sz;
      var ex;
      var ey;
      var ez;
      var depth1;
      var depth2;
      var dot;
      var t1;
      var t2;
      var sep = new Vec3();
      var pos = new Vec3();
      var dep = new Vec3();
      if (!this.getSep(c1, c2, sep, pos, dep)) return;
      var dot1 = sep.x * n1x + sep.y * n1y + sep.z * n1z;
      var dot2 = sep.x * n2x + sep.y * n2y + sep.z * n2z;
      var right1 = dot1 > 0;
      var right2 = dot2 > 0;
      if (!right1) dot1 = -dot1;
      if (!right2) dot2 = -dot2;
      var state = 0;
      if (dot1 > 0.999 || dot2 > 0.999) {
        if (dot1 > dot2) state = 1;
        else state = 2;
      }
      var nx;
      var ny;
      var nz;
      var depth = dep.x;
      var r00;
      var r01;
      var r02;
      var r10;
      var r11;
      var r12;
      var r20;
      var r21;
      var r22;
      var px;
      var py;
      var pz;
      var pd;
      var a;
      var b;
      var e;
      var f;
      nx = sep.x;
      ny = sep.y;
      nz = sep.z;
      switch (state) {
        case 0:
          manifold.addPoint(pos.x, pos.y, pos.z, nx, ny, nz, depth, false);
          break;
        case 1:
          if (right1) {
            c1x = p1x + d1x;
            c1y = p1y + d1y;
            c1z = p1z + d1z;
            nx = n1x;
            ny = n1y;
            nz = n1z;
          } else {
            c1x = p1x - d1x;
            c1y = p1y - d1y;
            c1z = p1z - d1z;
            nx = -n1x;
            ny = -n1y;
            nz = -n1z;
          }
          dot = nx * n2x + ny * n2y + nz * n2z;
          if (dot < 0) len = h2;
          else len = -h2;
          c2x = p2x + len * n2x;
          c2y = p2y + len * n2y;
          c2z = p2z + len * n2z;
          if (dot2 >= 0.999999) {
            tx = -ny;
            ty = nz;
            tz = nx;
          } else {
            tx = nx;
            ty = ny;
            tz = nz;
          }
          len = tx * n2x + ty * n2y + tz * n2z;
          dx = len * n2x - tx;
          dy = len * n2y - ty;
          dz = len * n2z - tz;
          len = _Math.sqrt(dx * dx + dy * dy + dz * dz);
          if (len == 0) break;
          len = r2 / len;
          dx *= len;
          dy *= len;
          dz *= len;
          tx = c2x + dx;
          ty = c2y + dy;
          tz = c2z + dz;
          if (dot < -0.96 || dot > 0.96) {
            r00 = n2x * n2x * 1.5 - 0.5;
            r01 = n2x * n2y * 1.5 - n2z * 0.866025403;
            r02 = n2x * n2z * 1.5 + n2y * 0.866025403;
            r10 = n2y * n2x * 1.5 + n2z * 0.866025403;
            r11 = n2y * n2y * 1.5 - 0.5;
            r12 = n2y * n2z * 1.5 - n2x * 0.866025403;
            r20 = n2z * n2x * 1.5 - n2y * 0.866025403;
            r21 = n2z * n2y * 1.5 + n2x * 0.866025403;
            r22 = n2z * n2z * 1.5 - 0.5;
            px = tx;
            py = ty;
            pz = tz;
            pd = nx * (px - c1x) + ny * (py - c1y) + nz * (pz - c1z);
            tx = px - pd * nx - c1x;
            ty = py - pd * ny - c1y;
            tz = pz - pd * nz - c1z;
            len = tx * tx + ty * ty + tz * tz;
            if (len > r1 * r1) {
              len = r1 / _Math.sqrt(len);
              tx *= len;
              ty *= len;
              tz *= len;
            }
            px = c1x + tx;
            py = c1y + ty;
            pz = c1z + tz;
            manifold.addPoint(px, py, pz, nx, ny, nz, pd, false);
            px = dx * r00 + dy * r01 + dz * r02;
            py = dx * r10 + dy * r11 + dz * r12;
            pz = dx * r20 + dy * r21 + dz * r22;
            px = (dx = px) + c2x;
            py = (dy = py) + c2y;
            pz = (dz = pz) + c2z;
            pd = nx * (px - c1x) + ny * (py - c1y) + nz * (pz - c1z);
            if (pd <= 0) {
              tx = px - pd * nx - c1x;
              ty = py - pd * ny - c1y;
              tz = pz - pd * nz - c1z;
              len = tx * tx + ty * ty + tz * tz;
              if (len > r1 * r1) {
                len = r1 / _Math.sqrt(len);
                tx *= len;
                ty *= len;
                tz *= len;
              }
              px = c1x + tx;
              py = c1y + ty;
              pz = c1z + tz;
              manifold.addPoint(px, py, pz, nx, ny, nz, pd, false);
            }
            px = dx * r00 + dy * r01 + dz * r02;
            py = dx * r10 + dy * r11 + dz * r12;
            pz = dx * r20 + dy * r21 + dz * r22;
            px = (dx = px) + c2x;
            py = (dy = py) + c2y;
            pz = (dz = pz) + c2z;
            pd = nx * (px - c1x) + ny * (py - c1y) + nz * (pz - c1z);
            if (pd <= 0) {
              tx = px - pd * nx - c1x;
              ty = py - pd * ny - c1y;
              tz = pz - pd * nz - c1z;
              len = tx * tx + ty * ty + tz * tz;
              if (len > r1 * r1) {
                len = r1 / _Math.sqrt(len);
                tx *= len;
                ty *= len;
                tz *= len;
              }
              px = c1x + tx;
              py = c1y + ty;
              pz = c1z + tz;
              manifold.addPoint(px, py, pz, nx, ny, nz, pd, false);
            }
          } else {
            sx = tx;
            sy = ty;
            sz = tz;
            depth1 = nx * (sx - c1x) + ny * (sy - c1y) + nz * (sz - c1z);
            sx -= depth1 * nx;
            sy -= depth1 * ny;
            sz -= depth1 * nz;
            if (dot > 0) {
              ex = tx + n2x * h2 * 2;
              ey = ty + n2y * h2 * 2;
              ez = tz + n2z * h2 * 2;
            } else {
              ex = tx - n2x * h2 * 2;
              ey = ty - n2y * h2 * 2;
              ez = tz - n2z * h2 * 2;
            }
            depth2 = nx * (ex - c1x) + ny * (ey - c1y) + nz * (ez - c1z);
            ex -= depth2 * nx;
            ey -= depth2 * ny;
            ez -= depth2 * nz;
            dx = c1x - sx;
            dy = c1y - sy;
            dz = c1z - sz;
            tx = ex - sx;
            ty = ey - sy;
            tz = ez - sz;
            a = dx * dx + dy * dy + dz * dz;
            b = dx * tx + dy * ty + dz * tz;
            e = tx * tx + ty * ty + tz * tz;
            f = b * b - e * (a - r1 * r1);
            if (f < 0) break;
            f = _Math.sqrt(f);
            t1 = (b + f) / e;
            t2 = (b - f) / e;
            if (t2 < t1) {
              len = t1;
              t1 = t2;
              t2 = len;
            }
            if (t2 > 1) t2 = 1;
            if (t1 < 0) t1 = 0;
            tx = sx + (ex - sx) * t1;
            ty = sy + (ey - sy) * t1;
            tz = sz + (ez - sz) * t1;
            ex = sx + (ex - sx) * t2;
            ey = sy + (ey - sy) * t2;
            ez = sz + (ez - sz) * t2;
            sx = tx;
            sy = ty;
            sz = tz;
            len = depth1 + (depth2 - depth1) * t1;
            depth2 = depth1 + (depth2 - depth1) * t2;
            depth1 = len;
            if (depth1 < 0) manifold.addPoint(sx, sy, sz, nx, ny, nz, pd, false);
            if (depth2 < 0) manifold.addPoint(ex, ey, ez, nx, ny, nz, pd, false);

          }
          break;
        case 2:
          if (right2) {
            c2x = p2x - d2x;
            c2y = p2y - d2y;
            c2z = p2z - d2z;
            nx = -n2x;
            ny = -n2y;
            nz = -n2z;
          } else {
            c2x = p2x + d2x;
            c2y = p2y + d2y;
            c2z = p2z + d2z;
            nx = n2x;
            ny = n2y;
            nz = n2z;
          }
          dot = nx * n1x + ny * n1y + nz * n1z;
          if (dot < 0) len = h1;
          else len = -h1;
          c1x = p1x + len * n1x;
          c1y = p1y + len * n1y;
          c1z = p1z + len * n1z;
          if (dot1 >= 0.999999) {
            tx = -ny;
            ty = nz;
            tz = nx;
          } else {
            tx = nx;
            ty = ny;
            tz = nz;
          }
          len = tx * n1x + ty * n1y + tz * n1z;
          dx = len * n1x - tx;
          dy = len * n1y - ty;
          dz = len * n1z - tz;
          len = _Math.sqrt(dx * dx + dy * dy + dz * dz);
          if (len == 0) break;
          len = r1 / len;
          dx *= len;
          dy *= len;
          dz *= len;
          tx = c1x + dx;
          ty = c1y + dy;
          tz = c1z + dz;
          if (dot < -0.96 || dot > 0.96) {
            r00 = n1x * n1x * 1.5 - 0.5;
            r01 = n1x * n1y * 1.5 - n1z * 0.866025403;
            r02 = n1x * n1z * 1.5 + n1y * 0.866025403;
            r10 = n1y * n1x * 1.5 + n1z * 0.866025403;
            r11 = n1y * n1y * 1.5 - 0.5;
            r12 = n1y * n1z * 1.5 - n1x * 0.866025403;
            r20 = n1z * n1x * 1.5 - n1y * 0.866025403;
            r21 = n1z * n1y * 1.5 + n1x * 0.866025403;
            r22 = n1z * n1z * 1.5 - 0.5;
            px = tx;
            py = ty;
            pz = tz;
            pd = nx * (px - c2x) + ny * (py - c2y) + nz * (pz - c2z);
            tx = px - pd * nx - c2x;
            ty = py - pd * ny - c2y;
            tz = pz - pd * nz - c2z;
            len = tx * tx + ty * ty + tz * tz;
            if (len > r2 * r2) {
              len = r2 / _Math.sqrt(len);
              tx *= len;
              ty *= len;
              tz *= len;
            }
            px = c2x + tx;
            py = c2y + ty;
            pz = c2z + tz;
            manifold.addPoint(px, py, pz, -nx, -ny, -nz, pd, false);
            px = dx * r00 + dy * r01 + dz * r02;
            py = dx * r10 + dy * r11 + dz * r12;
            pz = dx * r20 + dy * r21 + dz * r22;
            px = (dx = px) + c1x;
            py = (dy = py) + c1y;
            pz = (dz = pz) + c1z;
            pd = nx * (px - c2x) + ny * (py - c2y) + nz * (pz - c2z);
            if (pd <= 0) {
              tx = px - pd * nx - c2x;
              ty = py - pd * ny - c2y;
              tz = pz - pd * nz - c2z;
              len = tx * tx + ty * ty + tz * tz;
              if (len > r2 * r2) {
                len = r2 / _Math.sqrt(len);
                tx *= len;
                ty *= len;
                tz *= len;
              }
              px = c2x + tx;
              py = c2y + ty;
              pz = c2z + tz;
              manifold.addPoint(px, py, pz, -nx, -ny, -nz, pd, false);
            }
            px = dx * r00 + dy * r01 + dz * r02;
            py = dx * r10 + dy * r11 + dz * r12;
            pz = dx * r20 + dy * r21 + dz * r22;
            px = (dx = px) + c1x;
            py = (dy = py) + c1y;
            pz = (dz = pz) + c1z;
            pd = nx * (px - c2x) + ny * (py - c2y) + nz * (pz - c2z);
            if (pd <= 0) {
              tx = px - pd * nx - c2x;
              ty = py - pd * ny - c2y;
              tz = pz - pd * nz - c2z;
              len = tx * tx + ty * ty + tz * tz;
              if (len > r2 * r2) {
                len = r2 / _Math.sqrt(len);
                tx *= len;
                ty *= len;
                tz *= len;
              }
              px = c2x + tx;
              py = c2y + ty;
              pz = c2z + tz;
              manifold.addPoint(px, py, pz, -nx, -ny, -nz, pd, false);
            }
          } else {
            sx = tx;
            sy = ty;
            sz = tz;
            depth1 = nx * (sx - c2x) + ny * (sy - c2y) + nz * (sz - c2z);
            sx -= depth1 * nx;
            sy -= depth1 * ny;
            sz -= depth1 * nz;
            if (dot > 0) {
              ex = tx + n1x * h1 * 2;
              ey = ty + n1y * h1 * 2;
              ez = tz + n1z * h1 * 2;
            } else {
              ex = tx - n1x * h1 * 2;
              ey = ty - n1y * h1 * 2;
              ez = tz - n1z * h1 * 2;
            }
            depth2 = nx * (ex - c2x) + ny * (ey - c2y) + nz * (ez - c2z);
            ex -= depth2 * nx;
            ey -= depth2 * ny;
            ez -= depth2 * nz;
            dx = c2x - sx;
            dy = c2y - sy;
            dz = c2z - sz;
            tx = ex - sx;
            ty = ey - sy;
            tz = ez - sz;
            a = dx * dx + dy * dy + dz * dz;
            b = dx * tx + dy * ty + dz * tz;
            e = tx * tx + ty * ty + tz * tz;
            f = b * b - e * (a - r2 * r2);
            if (f < 0) break;
            f = _Math.sqrt(f);
            t1 = (b + f) / e;
            t2 = (b - f) / e;
            if (t2 < t1) {
              len = t1;
              t1 = t2;
              t2 = len;
            }
            if (t2 > 1) t2 = 1;
            if (t1 < 0) t1 = 0;
            tx = sx + (ex - sx) * t1;
            ty = sy + (ey - sy) * t1;
            tz = sz + (ez - sz) * t1;
            ex = sx + (ex - sx) * t2;
            ey = sy + (ey - sy) * t2;
            ez = sz + (ez - sz) * t2;
            sx = tx;
            sy = ty;
            sz = tz;
            len = depth1 + (depth2 - depth1) * t1;
            depth2 = depth1 + (depth2 - depth1) * t2;
            depth1 = len;
            if (depth1 < 0) {
              manifold.addPoint(sx, sy, sz, -nx, -ny, -nz, depth1, false);
            }
            if (depth2 < 0) {
              manifold.addPoint(ex, ey, ez, -nx, -ny, -nz, depth2, false);
            }
          }
          break;
      }

    }

  });

  /**
   * A collision detector which detects collisions between sphere and box.
   * @author saharan
   */
  function SphereBoxCollisionDetector(flip) {

    CollisionDetector.call(this);
    this.flip = flip;

  }
  SphereBoxCollisionDetector.prototype = Object.assign(Object.create(CollisionDetector.prototype), {

    constructor: SphereBoxCollisionDetector,

    detectCollision: function (shape1, shape2, manifold) {

      var s;
      var b;
      if (this.flip) {
        s = (shape2);
        b = (shape1);
      } else {
        s = (shape1);
        b = (shape2);
      }

      var D = b.dimentions;

      var ps = s.position;
      var psx = ps.x;
      var psy = ps.y;
      var psz = ps.z;
      var pb = b.position;
      var pbx = pb.x;
      var pby = pb.y;
      var pbz = pb.z;
      var rad = s.radius;

      var hw = b.halfWidth;
      var hh = b.halfHeight;
      var hd = b.halfDepth;

      var dx = psx - pbx;
      var dy = psy - pby;
      var dz = psz - pbz;
      var sx = D[0] * dx + D[1] * dy + D[2] * dz;
      var sy = D[3] * dx + D[4] * dy + D[5] * dz;
      var sz = D[6] * dx + D[7] * dy + D[8] * dz;
      var cx;
      var cy;
      var cz;
      var len;
      var invLen;
      var overlap = 0;
      if (sx > hw) {
        sx = hw;
      } else if (sx < -hw) {
        sx = -hw;
      } else {
        overlap = 1;
      }
      if (sy > hh) {
        sy = hh;
      } else if (sy < -hh) {
        sy = -hh;
      } else {
        overlap |= 2;
      }
      if (sz > hd) {
        sz = hd;
      } else if (sz < -hd) {
        sz = -hd;
      } else {
        overlap |= 4;
      }
      if (overlap == 7) {
        // center of sphere is in the box
        if (sx < 0) {
          dx = hw + sx;
        } else {
          dx = hw - sx;
        }
        if (sy < 0) {
          dy = hh + sy;
        } else {
          dy = hh - sy;
        }
        if (sz < 0) {
          dz = hd + sz;
        } else {
          dz = hd - sz;
        }
        if (dx < dy) {
          if (dx < dz) {
            len = dx - hw;
            if (sx < 0) {
              sx = -hw;
              dx = D[0];
              dy = D[1];
              dz = D[2];
            } else {
              sx = hw;
              dx = -D[0];
              dy = -D[1];
              dz = -D[2];
            }
          } else {
            len = dz - hd;
            if (sz < 0) {
              sz = -hd;
              dx = D[6];
              dy = D[7];
              dz = D[8];
            } else {
              sz = hd;
              dx = -D[6];
              dy = -D[7];
              dz = -D[8];
            }
          }
        } else {
          if (dy < dz) {
            len = dy - hh;
            if (sy < 0) {
              sy = -hh;
              dx = D[3];
              dy = D[4];
              dz = D[5];
            } else {
              sy = hh;
              dx = -D[3];
              dy = -D[4];
              dz = -D[5];
            }
          } else {
            len = dz - hd;
            if (sz < 0) {
              sz = -hd;
              dx = D[6];
              dy = D[7];
              dz = D[8];
            } else {
              sz = hd;
              dx = -D[6];
              dy = -D[7];
              dz = -D[8];
            }
          }
        }
        cx = pbx + sx * D[0] + sy * D[3] + sz * D[6];
        cy = pby + sx * D[1] + sy * D[4] + sz * D[7];
        cz = pbz + sx * D[2] + sy * D[5] + sz * D[8];
        manifold.addPoint(psx + rad * dx, psy + rad * dy, psz + rad * dz, dx, dy, dz, len - rad, this.flip);
      } else {
        cx = pbx + sx * D[0] + sy * D[3] + sz * D[6];
        cy = pby + sx * D[1] + sy * D[4] + sz * D[7];
        cz = pbz + sx * D[2] + sy * D[5] + sz * D[8];
        dx = cx - ps.x;
        dy = cy - ps.y;
        dz = cz - ps.z;
        len = dx * dx + dy * dy + dz * dz;
        if (len > 0 && len < rad * rad) {
          len = _Math.sqrt(len);
          invLen = 1 / len;
          dx *= invLen;
          dy *= invLen;
          dz *= invLen;
          manifold.addPoint(psx + rad * dx, psy + rad * dy, psz + rad * dz, dx, dy, dz, len - rad, this.flip);
        }
      }

    }

  });

  function SphereCylinderCollisionDetector(flip) {

    CollisionDetector.call(this);
    this.flip = flip;

  }
  SphereCylinderCollisionDetector.prototype = Object.assign(Object.create(CollisionDetector.prototype), {

    constructor: SphereCylinderCollisionDetector,

    detectCollision: function (shape1, shape2, manifold) {

      var s;
      var c;
      if (this.flip) {
        s = shape2;
        c = shape1;
      } else {
        s = shape1;
        c = shape2;
      }
      var ps = s.position;
      var psx = ps.x;
      var psy = ps.y;
      var psz = ps.z;
      var pc = c.position;
      var pcx = pc.x;
      var pcy = pc.y;
      var pcz = pc.z;
      var dirx = c.normalDirection.x;
      var diry = c.normalDirection.y;
      var dirz = c.normalDirection.z;
      var rads = s.radius;
      var radc = c.radius;
      var rad2 = rads + radc;
      var halfh = c.halfHeight;
      var dx = psx - pcx;
      var dy = psy - pcy;
      var dz = psz - pcz;
      var dot = dx * dirx + dy * diry + dz * dirz;
      if (dot < -halfh - rads || dot > halfh + rads) return;
      var cx = pcx + dot * dirx;
      var cy = pcy + dot * diry;
      var cz = pcz + dot * dirz;
      var d2x = psx - cx;
      var d2y = psy - cy;
      var d2z = psz - cz;
      var len = d2x * d2x + d2y * d2y + d2z * d2z;
      if (len > rad2 * rad2) return;
      if (len > radc * radc) {
        len = radc / _Math.sqrt(len);
        d2x *= len;
        d2y *= len;
        d2z *= len;
      }
      if (dot < -halfh) dot = -halfh;
      else if (dot > halfh) dot = halfh;
      cx = pcx + dot * dirx + d2x;
      cy = pcy + dot * diry + d2y;
      cz = pcz + dot * dirz + d2z;
      dx = cx - psx;
      dy = cy - psy;
      dz = cz - psz;
      len = dx * dx + dy * dy + dz * dz;
      var invLen;
      if (len > 0 && len < rads * rads) {
        len = _Math.sqrt(len);
        invLen = 1 / len;
        dx *= invLen;
        dy *= invLen;
        dz *= invLen;
        ///result.addContactInfo(psx+dx*rads,psy+dy*rads,psz+dz*rads,dx,dy,dz,len-rads,s,c,0,0,false);
        manifold.addPoint(psx + dx * rads, psy + dy * rads, psz + dz * rads, dx, dy, dz, len - rads, this.flip);
      }

    }


  });

  /**
   * A collision detector which detects collisions between two spheres.
   * @author saharan
   */

  function SphereSphereCollisionDetector() {

    CollisionDetector.call(this);

  }
  SphereSphereCollisionDetector.prototype = Object.assign(Object.create(CollisionDetector.prototype), {

    constructor: SphereSphereCollisionDetector,

    detectCollision: function (shape1, shape2, manifold) {

      var s1 = shape1;
      var s2 = shape2;
      var p1 = s1.position;
      var p2 = s2.position;
      var dx = p2.x - p1.x;
      var dy = p2.y - p1.y;
      var dz = p2.z - p1.z;
      var len = dx * dx + dy * dy + dz * dz;
      var r1 = s1.radius;
      var r2 = s2.radius;
      var rad = r1 + r2;
      if (len > 0 && len < rad * rad) {
        len = _Math.sqrt(len);
        var invLen = 1 / len;
        dx *= invLen;
        dy *= invLen;
        dz *= invLen;
        manifold.addPoint(p1.x + dx * r1, p1.y + dy * r1, p1.z + dz * r1, dx, dy, dz, len - rad, false);
      }

    }

  });

  /**
   * A collision detector which detects collisions between two spheres.
   * @author saharan 
   * @author lo-th
   */

  function SpherePlaneCollisionDetector(flip) {

    CollisionDetector.call(this);

    this.flip = flip;

    this.n = new Vec3();
    this.p = new Vec3();

  }
  SpherePlaneCollisionDetector.prototype = Object.assign(Object.create(CollisionDetector.prototype), {

    constructor: SpherePlaneCollisionDetector,

    detectCollision: function (shape1, shape2, manifold) {

      var n = this.n;
      var p = this.p;

      var s = this.flip ? shape2 : shape1;
      var pn = this.flip ? shape1 : shape2;
      var rad = s.radius;
      var len;

      n.sub(s.position, pn.position);
      //var h = _Math.dotVectors( pn.normal, n );

      n.x *= pn.normal.x;//+ rad;
      n.y *= pn.normal.y;
      n.z *= pn.normal.z;//+ rad;


      var len = n.lengthSq();

      if (len > 0 && len < rad * rad) {//&& h > rad*rad ){


        len = _Math.sqrt(len);
        //len = _Math.sqrt( h );
        n.copy(pn.normal).negate();
        //n.scaleEqual( 1/len );

        //(0, -1, 0)

        //n.normalize();
        p.copy(s.position).addScaledVector(n, rad);
        manifold.addPointVec(p, n, len - rad, this.flip);

      }

    }

  });

  /**
   * A collision detector which detects collisions between two spheres.
   * @author saharan 
   * @author lo-th
   */

  function BoxPlaneCollisionDetector(flip) {

    CollisionDetector.call(this);

    this.flip = flip;

    this.n = new Vec3();
    this.p = new Vec3();

    this.dix = new Vec3();
    this.diy = new Vec3();
    this.diz = new Vec3();

    this.cc = new Vec3();
    this.cc2 = new Vec3();

  }
  BoxPlaneCollisionDetector.prototype = Object.assign(Object.create(CollisionDetector.prototype), {

    constructor: BoxPlaneCollisionDetector,

    detectCollision: function (shape1, shape2, manifold) {

      var n = this.n;
      var p = this.p;
      var cc = this.cc;

      var b = this.flip ? shape2 : shape1;
      var pn = this.flip ? shape1 : shape2;

      var D = b.dimentions;
      var hw = b.halfWidth;
      var hh = b.halfHeight;
      var hd = b.halfDepth;
      var len;
      var overlap = 0;

      this.dix.set(D[0], D[1], D[2]);
      this.diy.set(D[3], D[4], D[5]);
      this.diz.set(D[6], D[7], D[8]);

      n.sub(b.position, pn.position);

      n.x *= pn.normal.x;//+ rad;
      n.y *= pn.normal.y;
      n.z *= pn.normal.z;//+ rad;

      cc.set(
        _Math.dotVectors(this.dix, n),
        _Math.dotVectors(this.diy, n),
        _Math.dotVectors(this.diz, n)
      );


      if (cc.x > hw) cc.x = hw;
      else if (cc.x < -hw) cc.x = -hw;
      else overlap = 1;

      if (cc.y > hh) cc.y = hh;
      else if (cc.y < -hh) cc.y = -hh;
      else overlap |= 2;

      if (cc.z > hd) cc.z = hd;
      else if (cc.z < -hd) cc.z = -hd;
      else overlap |= 4;



      if (overlap === 7) {

        // center of sphere is in the box

        n.set(
          cc.x < 0 ? hw + cc.x : hw - cc.x,
          cc.y < 0 ? hh + cc.y : hh - cc.y,
          cc.z < 0 ? hd + cc.z : hd - cc.z
        );

        if (n.x < n.y) {
          if (n.x < n.z) {
            len = n.x - hw;
            if (cc.x < 0) {
              cc.x = -hw;
              n.copy(this.dix);
            } else {
              cc.x = hw;
              n.subEqual(this.dix);
            }
          } else {
            len = n.z - hd;
            if (cc.z < 0) {
              cc.z = -hd;
              n.copy(this.diz);
            } else {
              cc.z = hd;
              n.subEqual(this.diz);
            }
          }
        } else {
          if (n.y < n.z) {
            len = n.y - hh;
            if (cc.y < 0) {
              cc.y = -hh;
              n.copy(this.diy);
            } else {
              cc.y = hh;
              n.subEqual(this.diy);
            }
          } else {
            len = n.z - hd;
            if (cc.z < 0) {
              cc.z = -hd;
              n.copy(this.diz);
            } else {
              cc.z = hd;
              n.subEqual(this.diz);
            }
          }
        }

        p.copy(pn.position).addScaledVector(n, 1);
        manifold.addPointVec(p, n, len, this.flip);

      }

    }

  });

  /**
   * The class of physical computing world.
   * You must be added to the world physical all computing objects
   *
   * @author saharan
   * @author lo-th
   */

  // timestep, broadphase, iterations, worldscale, random, stat

  function World(o) {

    if (!(o instanceof Object)) o = {};

    // this world scale defaut is 0.1 to 10 meters max for dynamique body
    this.scale = o.worldscale || 1;
    this.invScale = 1 / this.scale;

    // The time between each step
    this.timeStep = o.timestep || 0.01666; // 1/60;
    this.timerate = this.timeStep * 1000;
    this.timer = null;

    this.preLoop = null;//function(){};
    this.postLoop = null;//function(){};

    // The number of iterations for constraint solvers.
    this.numIterations = o.iterations || 8;

    // It is a wide-area collision judgment that is used in order to reduce as much as possible a detailed collision judgment.
    switch (o.broadphase || 2) {
      case 1: this.broadPhase = new BruteForceBroadPhase(); break;
      case 2: default: this.broadPhase = new SAPBroadPhase(); break;
      case 3: this.broadPhase = new DBVTBroadPhase(); break;
    }

    this.Btypes = ['None', 'BruteForce', 'Sweep & Prune', 'Bounding Volume Tree'];
    this.broadPhaseType = this.Btypes[o.broadphase || 2];

    // This is the detailed information of the performance.
    this.performance = null;
    this.isStat = o.info === undefined ? false : o.info;
    if (this.isStat) this.performance = new InfoDisplay(this);

    /**
     * Whether the constraints randomizer is enabled or not.
     *
     * @property enableRandomizer
     * @type {Boolean}
     */
    this.enableRandomizer = o.random !== undefined ? o.random : true;

    // The rigid body list
    this.rigidBodies = null;
    // number of rigid body
    this.numRigidBodies = 0;
    // The contact list
    this.contacts = null;
    this.unusedContacts = null;
    // The number of contact
    this.numContacts = 0;
    // The number of contact points
    this.numContactPoints = 0;
    //  The joint list
    this.joints = null;
    // The number of joints.
    this.numJoints = 0;
    // The number of simulation islands.
    this.numIslands = 0;


    // The gravity in the world.
    this.gravity = new Vec3(0, -9.8, 0);
    if (o.gravity !== undefined) this.gravity.fromArray(o.gravity);



    var numShapeTypes = 5;//4;//3;
    this.detectors = [];
    this.detectors.length = numShapeTypes;
    var i = numShapeTypes;
    while (i--) {
      this.detectors[i] = [];
      this.detectors[i].length = numShapeTypes;
    }

    this.detectors[SHAPE_SPHERE][SHAPE_SPHERE] = new SphereSphereCollisionDetector();
    this.detectors[SHAPE_SPHERE][SHAPE_BOX] = new SphereBoxCollisionDetector(false);
    this.detectors[SHAPE_BOX][SHAPE_SPHERE] = new SphereBoxCollisionDetector(true);
    this.detectors[SHAPE_BOX][SHAPE_BOX] = new BoxBoxCollisionDetector();

    // CYLINDER add
    this.detectors[SHAPE_CYLINDER][SHAPE_CYLINDER] = new CylinderCylinderCollisionDetector();

    this.detectors[SHAPE_CYLINDER][SHAPE_BOX] = new BoxCylinderCollisionDetector(true);
    this.detectors[SHAPE_BOX][SHAPE_CYLINDER] = new BoxCylinderCollisionDetector(false);

    this.detectors[SHAPE_CYLINDER][SHAPE_SPHERE] = new SphereCylinderCollisionDetector(true);
    this.detectors[SHAPE_SPHERE][SHAPE_CYLINDER] = new SphereCylinderCollisionDetector(false);

    // PLANE add

    this.detectors[SHAPE_PLANE][SHAPE_SPHERE] = new SpherePlaneCollisionDetector(true);
    this.detectors[SHAPE_SPHERE][SHAPE_PLANE] = new SpherePlaneCollisionDetector(false);

    this.detectors[SHAPE_PLANE][SHAPE_BOX] = new BoxPlaneCollisionDetector(true);
    this.detectors[SHAPE_BOX][SHAPE_PLANE] = new BoxPlaneCollisionDetector(false);

    // TETRA add
    //this.detectors[SHAPE_TETRA][SHAPE_TETRA] = new TetraTetraCollisionDetector();


    this.randX = 65535;
    this.randA = 98765;
    this.randB = 123456789;

    this.islandRigidBodies = [];
    this.islandStack = [];
    this.islandConstraints = [];

  }

  Object.assign(World.prototype, {

    World: true,

    play: function () {

      if (this.timer !== null) return;

      var _this = this;
      this.timer = setInterval(function () { _this.step(); }, this.timerate);
      //this.timer = setInterval( this.loop.bind(this) , this.timerate );

    },

    stop: function () {

      if (this.timer === null) return;

      clearInterval(this.timer);
      this.timer = null;

    },

    setGravity: function (ar) {

      this.gravity.fromArray(ar);

    },

    getInfo: function () {

      return this.isStat ? this.performance.show() : '';

    },

    // Reset the world and remove all rigid bodies, shapes, joints and any object from the world.
    clear: function () {

      this.stop();
      this.preLoop = null;
      this.postLoop = null;

      this.randX = 65535;

      while (this.joints !== null) {
        this.removeJoint(this.joints);
      }
      while (this.contacts !== null) {
        this.removeContact(this.contacts);
      }
      while (this.rigidBodies !== null) {
        this.removeRigidBody(this.rigidBodies);
      }

    },
    /**
    * I'll add a rigid body to the world.
    * Rigid body that has been added will be the operands of each step.
    * @param  rigidBody  Rigid body that you want to add
    */
    addRigidBody: function (rigidBody) {

      if (rigidBody.parent) {
        printError("World", "It is not possible to be added to more than one world one of the rigid body");
      }

      rigidBody.setParent(this);
      //rigidBody.awake();

      for (var shape = rigidBody.shapes; shape !== null; shape = shape.next) {
        this.addShape(shape);
      }
      if (this.rigidBodies !== null) (this.rigidBodies.prev = rigidBody).next = this.rigidBodies;
      this.rigidBodies = rigidBody;
      this.numRigidBodies++;

    },
    /**
    * I will remove the rigid body from the world.
    * Rigid body that has been deleted is excluded from the calculation on a step-by-step basis.
    * @param  rigidBody  Rigid body to be removed
    */
    removeRigidBody: function (rigidBody) {

      var remove = rigidBody;
      if (remove.parent !== this) return;
      remove.awake();
      var js = remove.jointLink;
      while (js != null) {
        var joint = js.joint;
        js = js.next;
        this.removeJoint(joint);
      }
      for (var shape = rigidBody.shapes; shape !== null; shape = shape.next) {
        this.removeShape(shape);
      }
      var prev = remove.prev;
      var next = remove.next;
      if (prev !== null) prev.next = next;
      if (next !== null) next.prev = prev;
      if (this.rigidBodies == remove) this.rigidBodies = next;
      remove.prev = null;
      remove.next = null;
      remove.parent = null;
      this.numRigidBodies--;

    },

    getByName: function (name) {

      var body = this.rigidBodies;
      while (body !== null) {
        if (body.name === name) return body;
        body = body.next;
      }

      var joint = this.joints;
      while (joint !== null) {
        if (joint.name === name) return joint;
        joint = joint.next;
      }

      return null;

    },

    /**
    * I'll add a shape to the world..
    * Add to the rigid world, and if you add a shape to a rigid body that has been added to the world,
    * Shape will be added to the world automatically, please do not call from outside this method.
    * @param  shape  Shape you want to add
    */
    addShape: function (shape) {

      if (!shape.parent || !shape.parent.parent) {
        printError("World", "It is not possible to be added alone to shape world");
      }

      shape.proxy = this.broadPhase.createProxy(shape);
      shape.updateProxy();
      this.broadPhase.addProxy(shape.proxy);

    },

    /**
    * I will remove the shape from the world.
    * Add to the rigid world, and if you add a shape to a rigid body that has been added to the world,
    * Shape will be added to the world automatically, please do not call from outside this method.
    * @param  shape  Shape you want to delete
    */
    removeShape: function (shape) {

      this.broadPhase.removeProxy(shape.proxy);
      shape.proxy = null;

    },

    /**
    * I'll add a joint to the world.
    * Joint that has been added will be the operands of each step.
    * @param  shape Joint to be added
    */
    addJoint: function (joint) {

      if (joint.parent) {
        printError("World", "It is not possible to be added to more than one world one of the joint");
      }
      if (this.joints != null) (this.joints.prev = joint).next = this.joints;
      this.joints = joint;
      joint.setParent(this);
      this.numJoints++;
      joint.awake();
      joint.attach();

    },

    /**
    * I will remove the joint from the world.
    * Joint that has been added will be the operands of each step.
    * @param  shape Joint to be deleted
    */
    removeJoint: function (joint) {

      var remove = joint;
      var prev = remove.prev;
      var next = remove.next;
      if (prev !== null) prev.next = next;
      if (next !== null) next.prev = prev;
      if (this.joints == remove) this.joints = next;
      remove.prev = null;
      remove.next = null;
      this.numJoints--;
      remove.awake();
      remove.detach();
      remove.parent = null;

    },

    addContact: function (s1, s2) {

      var newContact;
      if (this.unusedContacts !== null) {
        newContact = this.unusedContacts;
        this.unusedContacts = this.unusedContacts.next;
      } else {
        newContact = new Contact();
      }
      newContact.attach(s1, s2);
      newContact.detector = this.detectors[s1.type][s2.type];
      if (this.contacts) (this.contacts.prev = newContact).next = this.contacts;
      this.contacts = newContact;
      this.numContacts++;

    },

    removeContact: function (contact) {

      var prev = contact.prev;
      var next = contact.next;
      if (next) next.prev = prev;
      if (prev) prev.next = next;
      if (this.contacts == contact) this.contacts = next;
      contact.prev = null;
      contact.next = null;
      contact.detach();
      contact.next = this.unusedContacts;
      this.unusedContacts = contact;
      this.numContacts--;

    },

    getContact: function (b1, b2) {

      b1 = b1.constructor === RigidBody ? b1.name : b1;
      b2 = b2.constructor === RigidBody ? b2.name : b2;

      var n1, n2;
      var contact = this.contacts;
      while (contact !== null) {
        n1 = contact.body1.name;
        n2 = contact.body2.name;
        if ((n1 === b1 && n2 === b2) || (n2 === b1 && n1 === b2)) { if (contact.touching) return contact; else return null; }
        else contact = contact.next;
      }
      return null;

    },

    checkContact: function (name1, name2) {

      var n1, n2;
      var contact = this.contacts;
      while (contact !== null) {
        n1 = contact.body1.name || ' ';
        n2 = contact.body2.name || ' ';
        if ((n1 == name1 && n2 == name2) || (n2 == name1 && n1 == name2)) { if (contact.touching) return true; else return false; }
        else contact = contact.next;
      }
      //return false;

    },

    callSleep: function (body) {

      if (!body.allowSleep) return false;
      if (body.linearVelocity.lengthSq() > 0.04) return false;
      if (body.angularVelocity.lengthSq() > 0.25) return false;
      return true;

    },

    /**
    * I will proceed only time step seconds time of World.
    */
    step: function () {

      var stat = this.isStat;

      if (stat) this.performance.setTime(0);

      var body = this.rigidBodies;

      while (body !== null) {

        body.addedToIsland = false;

        if (body.sleeping) body.testWakeUp();

        body = body.next;

      }



      //------------------------------------------------------
      //   UPDATE BROADPHASE CONTACT
      //------------------------------------------------------

      if (stat) this.performance.setTime(1);

      this.broadPhase.detectPairs();

      var pairs = this.broadPhase.pairs;

      var i = this.broadPhase.numPairs;
      //do{
      while (i--) {
        //for(var i=0, l=numPairs; i<l; i++){
        var pair = pairs[i];
        var s1;
        var s2;
        if (pair.shape1.id < pair.shape2.id) {
          s1 = pair.shape1;
          s2 = pair.shape2;
        } else {
          s1 = pair.shape2;
          s2 = pair.shape1;
        }

        var link;
        if (s1.numContacts < s2.numContacts) link = s1.contactLink;
        else link = s2.contactLink;

        var exists = false;
        while (link) {
          var contact = link.contact;
          if (contact.shape1 == s1 && contact.shape2 == s2) {
            contact.persisting = true;
            exists = true;// contact already exists
            break;
          }
          link = link.next;
        }
        if (!exists) {
          this.addContact(s1, s2);
        }
      }// while(i-- >0);

      if (stat) this.performance.calcBroadPhase();

      //------------------------------------------------------
      //   UPDATE NARROWPHASE CONTACT
      //------------------------------------------------------

      // update & narrow phase
      this.numContactPoints = 0;
      contact = this.contacts;
      while (contact !== null) {
        if (!contact.persisting) {
          if (contact.shape1.aabb.intersectTest(contact.shape2.aabb)) {
            /*var aabb1=contact.shape1.aabb;
            var aabb2=contact.shape2.aabb;
            if(
              aabb1.minX>aabb2.maxX || aabb1.maxX<aabb2.minX ||
              aabb1.minY>aabb2.maxY || aabb1.maxY<aabb2.minY ||
              aabb1.minZ>aabb2.maxZ || aabb1.maxZ<aabb2.minZ
            ){*/
            var next = contact.next;
            this.removeContact(contact);
            contact = next;
            continue;
          }
        }
        var b1 = contact.body1;
        var b2 = contact.body2;

        if (b1.isDynamic && !b1.sleeping || b2.isDynamic && !b2.sleeping) contact.updateManifold();

        this.numContactPoints += contact.manifold.numPoints;
        contact.persisting = false;
        contact.constraint.addedToIsland = false;
        contact = contact.next;

      }

      if (stat) this.performance.calcNarrowPhase();

      //------------------------------------------------------
      //   SOLVE ISLANDS
      //------------------------------------------------------

      var invTimeStep = 1 / this.timeStep;
      var joint;
      var constraint;

      for (joint = this.joints; joint !== null; joint = joint.next) {
        joint.addedToIsland = false;
      }


      // clear old island array
      this.islandRigidBodies = [];
      this.islandConstraints = [];
      this.islandStack = [];

      if (stat) this.performance.setTime(1);

      this.numIslands = 0;

      // build and solve simulation islands

      for (var base = this.rigidBodies; base !== null; base = base.next) {

        if (base.addedToIsland || base.isStatic || base.sleeping) continue;// ignore

        if (base.isLonely()) {// update single body
          if (base.isDynamic) {
            base.linearVelocity.addScaledVector(this.gravity, this.timeStep);
            /*base.linearVelocity.x+=this.gravity.x*this.timeStep;
            base.linearVelocity.y+=this.gravity.y*this.timeStep;
            base.linearVelocity.z+=this.gravity.z*this.timeStep;*/
          }
          if (this.callSleep(base)) {
            base.sleepTime += this.timeStep;
            if (base.sleepTime > 0.5) base.sleep();
            else base.updatePosition(this.timeStep);
          } else {
            base.sleepTime = 0;
            base.updatePosition(this.timeStep);
          }
          this.numIslands++;
          continue;
        }

        var islandNumRigidBodies = 0;
        var islandNumConstraints = 0;
        var stackCount = 1;
        // add rigid body to stack
        this.islandStack[0] = base;
        base.addedToIsland = true;

        // build an island
        do {
          // get rigid body from stack
          body = this.islandStack[--stackCount];
          this.islandStack[stackCount] = null;
          body.sleeping = false;
          // add rigid body to the island
          this.islandRigidBodies[islandNumRigidBodies++] = body;
          if (body.isStatic) continue;

          // search connections
          for (var cs = body.contactLink; cs !== null; cs = cs.next) {
            var contact = cs.contact;
            constraint = contact.constraint;
            if (constraint.addedToIsland || !contact.touching) continue;// ignore

            // add constraint to the island
            this.islandConstraints[islandNumConstraints++] = constraint;
            constraint.addedToIsland = true;
            var next = cs.body;

            if (next.addedToIsland) continue;

            // add rigid body to stack
            this.islandStack[stackCount++] = next;
            next.addedToIsland = true;
          }
          for (var js = body.jointLink; js !== null; js = js.next) {
            constraint = js.joint;

            if (constraint.addedToIsland) continue;// ignore

            // add constraint to the island
            this.islandConstraints[islandNumConstraints++] = constraint;
            constraint.addedToIsland = true;
            next = js.body;
            if (next.addedToIsland || !next.isDynamic) continue;

            // add rigid body to stack
            this.islandStack[stackCount++] = next;
            next.addedToIsland = true;
          }
        } while (stackCount != 0);

        // update velocities
        var gVel = new Vec3().addScaledVector(this.gravity, this.timeStep);
        /*var gx=this.gravity.x*this.timeStep;
        var gy=this.gravity.y*this.timeStep;
        var gz=this.gravity.z*this.timeStep;*/
        var j = islandNumRigidBodies;
        while (j--) {
          //or(var j=0, l=islandNumRigidBodies; j<l; j++){
          body = this.islandRigidBodies[j];
          if (body.isDynamic) {
            body.linearVelocity.addEqual(gVel);
            /*body.linearVelocity.x+=gx;
            body.linearVelocity.y+=gy;
            body.linearVelocity.z+=gz;*/
          }
        }

        // randomizing order
        if (this.enableRandomizer) {
          //for(var j=1, l=islandNumConstraints; j<l; j++){
          j = islandNumConstraints;
          while (j--) {
            if (j !== 0) {
              var swap = (this.randX = (this.randX * this.randA + this.randB & 0x7fffffff)) / 2147483648.0 * j | 0;
              constraint = this.islandConstraints[j];
              this.islandConstraints[j] = this.islandConstraints[swap];
              this.islandConstraints[swap] = constraint;
            }
          }
        }

        // solve contraints

        j = islandNumConstraints;
        while (j--) {
          //for(j=0, l=islandNumConstraints; j<l; j++){
          this.islandConstraints[j].preSolve(this.timeStep, invTimeStep);// pre-solve
        }
        var k = this.numIterations;
        while (k--) {
          //for(var k=0, l=this.numIterations; k<l; k++){
          j = islandNumConstraints;
          while (j--) {
            //for(j=0, m=islandNumConstraints; j<m; j++){
            this.islandConstraints[j].solve();// main-solve
          }
        }
        j = islandNumConstraints;
        while (j--) {
          //for(j=0, l=islandNumConstraints; j<l; j++){
          this.islandConstraints[j].postSolve();// post-solve
          this.islandConstraints[j] = null;// gc
        }

        // sleeping check

        var sleepTime = 10;
        j = islandNumRigidBodies;
        while (j--) {
          //for(j=0, l=islandNumRigidBodies;j<l;j++){
          body = this.islandRigidBodies[j];
          if (this.callSleep(body)) {
            body.sleepTime += this.timeStep;
            if (body.sleepTime < sleepTime) sleepTime = body.sleepTime;
          } else {
            body.sleepTime = 0;
            sleepTime = 0;
            continue;
          }
        }
        if (sleepTime > 0.5) {
          // sleep the island
          j = islandNumRigidBodies;
          while (j--) {
            //for(j=0, l=islandNumRigidBodies;j<l;j++){
            this.islandRigidBodies[j].sleep();
            this.islandRigidBodies[j] = null;// gc
          }
        } else {
          // update positions
          j = islandNumRigidBodies;
          while (j--) {
            //for(j=0, l=islandNumRigidBodies;j<l;j++){
            this.islandRigidBodies[j].updatePosition(this.timeStep);
            this.islandRigidBodies[j] = null;// gc
          }
        }
        this.numIslands++;
      }

      //------------------------------------------------------
      //   END SIMULATION
      //------------------------------------------------------

      if (stat) this.performance.calcEnd();

      if (this.postLoop !== null) this.postLoop();

    },

    // remove someting to world

    remove: function (obj) {

    },

    // add someting to world

    add: function (o) {

      o = o || {};

      var type = o.type || "box";
      if (type.constructor === String) type = [type];
      var isJoint = type[0].substring(0, 5) === 'joint' ? true : false;

      if (isJoint) return this.initJoint(type[0], o);
      else return this.initBody(type, o);

    },

    initBody: function (type, o) {

      var invScale = this.invScale;

      // body dynamic or static
      var move = o.move || false;
      var kinematic = o.kinematic || false;

      // POSITION

      // body position
      var p = o.pos || [0, 0, 0];
      p = p.map(function (x) { return x * invScale; });

      // shape position
      var p2 = o.posShape || [0, 0, 0];
      p2 = p2.map(function (x) { return x * invScale; });

      // ROTATION

      // body rotation in degree
      var r = o.rot || [0, 0, 0];
      r = r.map(function (x) { return x * _Math.degtorad; });

      // shape rotation in degree
      var r2 = o.rotShape || [0, 0, 0];
      r2 = r.map(function (x) { return x * _Math.degtorad; });

      // SIZE

      // shape size
      var s = o.size === undefined ? [1, 1, 1] : o.size;
      if (s.length === 1) { s[1] = s[0]; }
      if (s.length === 2) { s[2] = s[0]; }
      s = s.map(function (x) { return x * invScale; });



      // body physics settings
      var sc = new ShapeConfig();
      // The density of the shape.
      if (o.density !== undefined) sc.density = o.density;
      // The coefficient of friction of the shape.
      if (o.friction !== undefined) sc.friction = o.friction;
      // The coefficient of restitution of the shape.
      if (o.restitution !== undefined) sc.restitution = o.restitution;
      // The bits of the collision groups to which the shape belongs.
      if (o.belongsTo !== undefined) sc.belongsTo = o.belongsTo;
      // The bits of the collision groups with which the shape collides.
      if (o.collidesWith !== undefined) sc.collidesWith = o.collidesWith;

      if (o.config !== undefined) {
        if (o.config[0] !== undefined) sc.density = o.config[0];
        if (o.config[1] !== undefined) sc.friction = o.config[1];
        if (o.config[2] !== undefined) sc.restitution = o.config[2];
        if (o.config[3] !== undefined) sc.belongsTo = o.config[3];
        if (o.config[4] !== undefined) sc.collidesWith = o.config[4];
      }


      /* if(o.massPos){
           o.massPos = o.massPos.map(function(x) { return x * invScale; });
           sc.relativePosition.set( o.massPos[0], o.massPos[1], o.massPos[2] );
       }
       if(o.massRot){
           o.massRot = o.massRot.map(function(x) { return x * _Math.degtorad; });
           var q = new Quat().setFromEuler( o.massRot[0], o.massRot[1], o.massRot[2] );
           sc.relativeRotation = new Mat33().setQuat( q );//_Math.EulerToMatrix( o.massRot[0], o.massRot[1], o.massRot[2] );
       }*/

      var position = new Vec3(p[0], p[1], p[2]);
      var rotation = new Quat().setFromEuler(r[0], r[1], r[2]);

      // rigidbody
      var body = new RigidBody(position, rotation);
      //var body = new RigidBody( p[0], p[1], p[2], r[0], r[1], r[2], r[3], this.scale, this.invScale );

      // SHAPES

      var shape, n;

      for (var i = 0; i < type.length; i++) {

        n = i * 3;

        if (p2[n] !== undefined) sc.relativePosition.set(p2[n], p2[n + 1], p2[n + 2]);
        if (r2[n] !== undefined) sc.relativeRotation.setQuat(new Quat().setFromEuler(r2[n], r2[n + 1], r2[n + 2]));

        switch (type[i]) {
          case "sphere": shape = new Sphere(sc, s[n]); break;
          case "cylinder": shape = new Cylinder(sc, s[n], s[n + 1]); break;
          case "box": shape = new Box(sc, s[n], s[n + 1], s[n + 2]); break;
          case "plane": shape = new Plane(sc); break
        }

        body.addShape(shape);

      }

      // body can sleep or not
      if (o.neverSleep || kinematic) body.allowSleep = false;
      else body.allowSleep = true;

      body.isKinematic = kinematic;

      // body static or dynamic
      if (move) {

        if (o.massPos || o.massRot) body.setupMass(BODY_DYNAMIC, false);
        else body.setupMass(BODY_DYNAMIC, true);

        // body can sleep or not
        //if( o.neverSleep ) body.allowSleep = false;
        //else body.allowSleep = true;

      } else {

        body.setupMass(BODY_STATIC);

      }

      if (o.name !== undefined) body.name = o.name;
      //else if( move ) body.name = this.numRigidBodies;

      // finaly add to physics world
      this.addRigidBody(body);

      // force sleep on not
      if (move) {
        if (o.sleep) body.sleep();
        else body.awake();
      }

      return body;


    },

    initJoint: function (type, o) {

      //var type = type;
      var invScale = this.invScale;

      var axe1 = o.axe1 || [1, 0, 0];
      var axe2 = o.axe2 || [1, 0, 0];
      var pos1 = o.pos1 || [0, 0, 0];
      var pos2 = o.pos2 || [0, 0, 0];

      pos1 = pos1.map(function (x) { return x * invScale; });
      pos2 = pos2.map(function (x) { return x * invScale; });

      var min, max;
      if (type === "jointDistance") {
        min = o.min || 0;
        max = o.max || 10;
        min = min * invScale;
        max = max * invScale;
      } else {
        min = o.min || 57.29578;
        max = o.max || 0;
        min = min * _Math.degtorad;
        max = max * _Math.degtorad;
      }

      var limit = o.limit || null;
      var spring = o.spring || null;
      var motor = o.motor || null;

      // joint setting
      var jc = new JointConfig();
      jc.scale = this.scale;
      jc.invScale = this.invScale;
      jc.allowCollision = o.collision || false;
      jc.localAxis1.set(axe1[0], axe1[1], axe1[2]);
      jc.localAxis2.set(axe2[0], axe2[1], axe2[2]);
      jc.localAnchorPoint1.set(pos1[0], pos1[1], pos1[2]);
      jc.localAnchorPoint2.set(pos2[0], pos2[1], pos2[2]);

      var b1 = null;
      var b2 = null;

      if (o.body1 === undefined || o.body2 === undefined) return printError('World', "Can't add joint if attach rigidbodys not define !");

      if (o.body1.constructor === String) { b1 = this.getByName(o.body1); }
      else if (o.body1.constructor === Number) { b1 = this.getByName(o.body1); }
      else if (o.body1.constructor === RigidBody) { b1 = o.body1; }

      if (o.body2.constructor === String) { b2 = this.getByName(o.body2); }
      else if (o.body2.constructor === Number) { b2 = this.getByName(o.body2); }
      else if (o.body2.constructor === RigidBody) { b2 = o.body2; }

      if (b1 === null || b2 === null) return printError('World', "Can't add joint attach rigidbodys not find !");

      jc.body1 = b1;
      jc.body2 = b2;

      var joint;
      switch (type) {
        case "jointDistance": joint = new DistanceJoint(jc, min, max);
          if (spring !== null) joint.limitMotor.setSpring(spring[0], spring[1]);
          if (motor !== null) joint.limitMotor.setMotor(motor[0], motor[1]);
          break;
        case "jointHinge": case "joint": joint = new HingeJoint(jc, min, max);
          if (spring !== null) joint.limitMotor.setSpring(spring[0], spring[1]);// soften the joint ex: 100, 0.2
          if (motor !== null) joint.limitMotor.setMotor(motor[0], motor[1]);
          break;
        case "jointPrisme": joint = new PrismaticJoint(jc, min, max); break;
        case "jointSlide": joint = new SliderJoint(jc, min, max); break;
        case "jointBall": joint = new BallAndSocketJoint(jc); break;
        case "jointWheel": joint = new WheelJoint(jc);
          if (limit !== null) joint.rotationalLimitMotor1.setLimit(limit[0], limit[1]);
          if (spring !== null) joint.rotationalLimitMotor1.setSpring(spring[0], spring[1]);
          if (motor !== null) joint.rotationalLimitMotor1.setMotor(motor[0], motor[1]);
          break;
      }

      joint.name = o.name || '';
      // finaly add to physics world
      this.addJoint(joint);

      return joint;

    },


  });

  // test version

  //export { RigidBody } from './core/RigidBody_X.js';
  //export { World } from './core/World_X.js';

  exports.Math = _Math;
  exports.Vec3 = Vec3;
  exports.Quat = Quat;
  exports.Mat33 = Mat33;
  exports.Shape = Shape;
  exports.Box = Box;
  exports.Sphere = Sphere;
  exports.Cylinder = Cylinder;
  exports.Plane = Plane;
  exports.Particle = Particle;
  exports.ShapeConfig = ShapeConfig;
  exports.LimitMotor = LimitMotor;
  exports.HingeJoint = HingeJoint;
  exports.BallAndSocketJoint = BallAndSocketJoint;
  exports.DistanceJoint = DistanceJoint;
  exports.PrismaticJoint = PrismaticJoint;
  exports.SliderJoint = SliderJoint;
  exports.WheelJoint = WheelJoint;
  exports.JointConfig = JointConfig;
  exports.RigidBody = RigidBody;
  exports.World = World;
  exports.REVISION = REVISION;
  exports.BR_NULL = BR_NULL;
  exports.BR_BRUTE_FORCE = BR_BRUTE_FORCE;
  exports.BR_SWEEP_AND_PRUNE = BR_SWEEP_AND_PRUNE;
  exports.BR_BOUNDING_VOLUME_TREE = BR_BOUNDING_VOLUME_TREE;
  exports.BODY_NULL = BODY_NULL;
  exports.BODY_DYNAMIC = BODY_DYNAMIC;
  exports.BODY_STATIC = BODY_STATIC;
  exports.BODY_KINEMATIC = BODY_KINEMATIC;
  exports.BODY_GHOST = BODY_GHOST;
  exports.SHAPE_NULL = SHAPE_NULL;
  exports.SHAPE_SPHERE = SHAPE_SPHERE;
  exports.SHAPE_BOX = SHAPE_BOX;
  exports.SHAPE_CYLINDER = SHAPE_CYLINDER;
  exports.SHAPE_PLANE = SHAPE_PLANE;
  exports.SHAPE_PARTICLE = SHAPE_PARTICLE;
  exports.SHAPE_TETRA = SHAPE_TETRA;
  exports.JOINT_NULL = JOINT_NULL;
  exports.JOINT_DISTANCE = JOINT_DISTANCE;
  exports.JOINT_BALL_AND_SOCKET = JOINT_BALL_AND_SOCKET;
  exports.JOINT_HINGE = JOINT_HINGE;
  exports.JOINT_WHEEL = JOINT_WHEEL;
  exports.JOINT_SLIDER = JOINT_SLIDER;
  exports.JOINT_PRISMATIC = JOINT_PRISMATIC;
  exports.AABB_PROX = AABB_PROX;
  exports.printError = printError;
  exports.InfoDisplay = InfoDisplay;

  Object.defineProperty(exports, '__esModule', { value: true });

}));
},{}],6:[function(require,module,exports){
/* global AFRAME, THREE */

function makePool(Class) {
  Class._pool = []
  Class._inUse = []
  Class.temp = function () {
    let v = Class._pool.pop() || new Class()
    Class._inUse.push(v)
    if (!Class._gc)
      Class._gc = setTimeout(Class._recycle)
    return v
  }
  Class._recycle = function () {
    while (Class._inUse.length)
      Class._pool.push(Class._inUse.pop())
    Class._gc = false
  }
}

makePool(THREE.Vector2)
makePool(THREE.Vector3)
makePool(THREE.Quaternion)
makePool(THREE.Matrix3)
makePool(THREE.Matrix4)

},{}],7:[function(require,module,exports){
(function (global){(function (){
/* global AFRAME, THREE, OIMO */

global.OIMO = require("./libs/oimo")
global.world = new OIMO.World()
global.bodies = []
global.movingBodies = []

let vec = new OIMO.Vec3()
let quat = new OIMO.Quat()

function init() {
  addEventListener("message", onMessage)
}

function onMessage(e) {
  if (typeof e.data === "string") {
    let command = parseCommand(e.data)
    switch (command.shift()) {
      case "world":
        worldCommand(command)
        break
    }
  }
  else if (e.data instanceof Float64Array) {
    let buffer = e.data
    world.step()
    for (let mid = 0; mid < movingBodies.length; mid++) {
      let body = movingBodies[mid]
      if (!body) continue
      if (body.isKinematic) {
        vec.set(buffer[mid * 8 + 0], buffer[mid * 8 + 1], buffer[mid * 8 + 2])
        body.setPosition(vec)
        quat.set(buffer[mid * 8 + 4], buffer[mid * 8 + 5], buffer[mid * 8 + 6], buffer[mid * 8 + 7])
        body.setQuaternion(quat)
      } else {
        buffer[mid * 8 + 0] = body.position.x
        buffer[mid * 8 + 1] = body.position.y
        buffer[mid * 8 + 2] = body.position.z
        buffer[mid * 8 + 4] = body.quaternion.x
        buffer[mid * 8 + 5] = body.quaternion.y
        buffer[mid * 8 + 6] = body.quaternion.z
        buffer[mid * 8 + 7] = body.quaternion.w
      }
    }
    postMessage(buffer, [buffer.buffer])
  }
}

function worldCommand(params) {
  if (typeof params[0] === "number") {
    params.shift()
  }
  switch (params.shift()) {
    case "body":
      bodyCommand(params)
      break
    case "gravity":
      world.gravity.copy(params[0])
      break
  }
}

function bodyCommand(params) {
  let id = params.shift()
  let body = bodies[id]
  switch (params.shift()) {
    case "create":
      bodies[id] = body = world.add(params[0])
      body._mid_ = params[0].mid
      if (body._mid_ !== null)
        movingBodies[body._mid_] = body
      break
    case "remove":
      world.removeRigidBody(body)
      bodies[id] = null
      if (body._mid_ !== null)
        movingBodies[body._mid_] = null
      break
    case "position":
      body.position.copy(params[0])
      break
  }
}

function parseCommand(cmd) {
  let words = cmd.split(" ")
  let args = []
  for (let word of words) {
    if (word) {
      try {
        args.push(JSON.parse(word))
      } catch (error) {
        if (word !== "=")
          args.push(word)
      }
    }
  }
  return args
}

init()
}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{"./libs/oimo":5}]},{},[3])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvY29tcG9uZW50cy9pbmNsdWRlLmpzIiwic3JjL2NvbXBvbmVudHMvcGh5c2ljcy5qcyIsInNyYy9nYW1lZnJhbWUuanMiLCJzcmMvbGlicy9jb3B5V29ybGRQb3NSb3QuanMiLCJzcmMvbGlicy9vaW1vLmpzIiwic3JjL2xpYnMvcG9vbHMuanMiLCJzcmMvb2ltb1dvcmtlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN1ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMStYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDeEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIvKiBnbG9iYWwgQUZSQU1FLCBUSFJFRSAqL1xuXG5sZXQgbG9hZGluZyA9IGZhbHNlXG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudChcImluY2x1ZGVcIiwge1xuICBzY2hlbWE6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuXG4gIHVwZGF0ZTogYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLmRhdGEgJiYgIWxvYWRpbmcpIHtcbiAgICAgIGxvYWRpbmcgPSB0cnVlXG4gICAgICBjb25zb2xlLmxvZyhcIkluY2x1ZGluZ1wiLCB0aGlzLmRhdGEpXG4gICAgICB0aGlzLmVsLm91dGVySFRNTCA9IGF3YWl0IChhd2FpdCBmZXRjaCh0aGlzLmRhdGEpKS50ZXh0KClcbiAgICAgIGxvYWRpbmcgPSBmYWxzZVxuICAgICAgbGV0IG5leHQgPSB0aGlzLmVsLnNjZW5lRWwucXVlcnlTZWxlY3RvcihcIltpbmNsdWRlXVwiKVxuICAgICAgaWYgKG5leHQpXG4gICAgICAgIG5leHQuY29tcG9uZW50cy5pbmNsdWRlLnVwZGF0ZSgpXG4gICAgfVxuICB9XG59KVxuIiwiLyogZ2xvYmFsIEFGUkFNRSwgVEhSRUUsIE9JTU8gKi9cblxubGV0IHNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKVxuY29uc3Qgd29ya2VyVXJsID0gc2NyaXB0c1tzY3JpcHRzLmxlbmd0aCAtIDFdLnNyY1xuXG5mdW5jdGlvbiBzdHJpbmdpZnkodmFsKSB7XG4gIHJldHVybiBKU09OLnN0cmluZ2lmeSh2YWwpLnJlcGxhY2VBbGwoXCIgXCIsIFwiXFxcXHUwMDIwXCIpXG59XG5cbkFGUkFNRS5yZWdpc3RlclN5c3RlbShcInBoeXNpY3NcIiwge1xuICBzY2hlbWE6IHtcbiAgICBlbmFibGVkOiB7IHR5cGU6IFwiYm9vbGVhblwiLCBkZWZhdWx0OiBmYWxzZSB9LFxuICAgIGdyYXZpdHk6IHsgdHlwZTogXCJ2ZWMzXCIsIGRlZmF1bHQ6IHsgeDogMCwgeTogLTkuOCwgejogMCB9IH0sXG4gICAgZGVidWc6IHsgdHlwZTogXCJib29sZWFuXCIsIGRlZmF1bHQ6IGZhbHNlIH1cbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy5kYXRhLmVuYWJsZWQpIHtcbiAgICAgIGlmICghdGhpcy53b3JrZXIpIHtcbiAgICAgICAgdGhpcy53b3JrZXIgPSBuZXcgV29ya2VyKHdvcmtlclVybClcbiAgICAgICAgdGhpcy53b3JrZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgdGhpcy5vbk1lc3NhZ2UuYmluZCh0aGlzKSlcbiAgICAgIH1cbiAgICAgIHRoaXMuYm9kaWVzID0gdGhpcy5ib2RpZXMgfHwgW11cbiAgICAgIHRoaXMubW92aW5nQm9kaWVzID0gdGhpcy5tb3ZpbmdCb2RpZXMgfHwgW11cbiAgICAgIHRoaXMuYnVmZmVycyA9IFtuZXcgRmxvYXQ2NEFycmF5KDgpLCBuZXcgRmxvYXQ2NEFycmF5KDgpXVxuICAgICAgdGhpcy53b3JrZXIucG9zdE1lc3NhZ2UoXCJ3b3JsZCBncmF2aXR5ID0gXCIgKyBzdHJpbmdpZnkodGhpcy5kYXRhLmdyYXZpdHkpKVxuICAgICAgdGhpcy5fZGVidWcgPSB0aGlzLmRhdGEuZGVidWdcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZW1vdmUoKVxuICAgIH1cbiAgfSxcblxuICByZW1vdmU6IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLndvcmtlciAmJiB0aGlzLndvcmtlci50ZXJtaW5hdGUoKVxuICAgIHRoaXMud29ya2VyID0gbnVsbFxuICAgIHRoaXMuYm9kaWVzID0gW11cbiAgICB0aGlzLm1vdmluZ0JvZGllcyA9IFtdXG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKHRpbWUsIHRpbWVEZWx0YSkge1xuICAgIGlmICghdGhpcy53b3JrZXIpIHJldHVyblxuICAgIGlmICh0aGlzLmJ1ZmZlcnMubGVuZ3RoIDwgMikgcmV0dXJuXG4gICAgbGV0IGJ1ZmZlciA9IHRoaXMuYnVmZmVycy5zaGlmdCgpXG4gICAgaWYgKGJ1ZmZlci5sZW5ndGggPCA4ICogdGhpcy5tb3ZpbmdCb2RpZXMubGVuZ3RoKSB7XG4gICAgICBsZXQgbGVuID0gYnVmZmVyLmxlbmd0aFxuICAgICAgd2hpbGUgKGxlbiA8IDggKiB0aGlzLm1vdmluZ0JvZGllcy5sZW5ndGgpIHtcbiAgICAgICAgbGVuICo9IDJcbiAgICAgIH1cbiAgICAgIGxldCBib2RzID0gdGhpcy5tb3ZpbmdCb2RpZXNcbiAgICAgIGxldCBiID0gbmV3IEZsb2F0NjRBcnJheShsZW4pXG4gICAgICBsZXQgdmVjID0gVEhSRUUuVmVjdG9yMy50ZW1wKClcbiAgICAgIGxldCBxdWF0ID0gVEhSRUUuUXVhdGVybmlvbi50ZW1wKClcbiAgICAgIGIuc2V0KGJ1ZmZlcilcbiAgICAgIGZvciAobGV0IGkgPSBidWZmZXIubGVuZ3RoIC8gODsgaSA8IGJvZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGJvZHNbaV0pIHtcbiAgICAgICAgICBib2RzW2ldLm9iamVjdDNELmdldFdvcmxkUG9zaXRpb24odmVjKVxuICAgICAgICAgIGJbaSAqIDggKyAwXSA9IHZlYy54XG4gICAgICAgICAgYltpICogOCArIDFdID0gdmVjLnlcbiAgICAgICAgICBiW2kgKiA4ICsgMl0gPSB2ZWMuelxuICAgICAgICAgIGJvZHNbaV0ub2JqZWN0M0QuZ2V0V29ybGRRdWF0ZXJuaW9uKHF1YXQpXG4gICAgICAgICAgYltpICogOCArIDRdID0gcXVhdC54XG4gICAgICAgICAgYltpICogOCArIDVdID0gcXVhdC55XG4gICAgICAgICAgYltpICogOCArIDZdID0gcXVhdC56XG4gICAgICAgICAgYltpICogOCArIDddID0gcXVhdC53XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGJ1ZmZlciA9IGJcbiAgICB9XG4gICAgdGhpcy53b3JrZXIucG9zdE1lc3NhZ2UoYnVmZmVyLCBbYnVmZmVyLmJ1ZmZlcl0pXG4gIH0sXG5cbiAgb25NZXNzYWdlOiBmdW5jdGlvbiAoZSkge1xuICAgIGlmIChlLmRhdGEgaW5zdGFuY2VvZiBGbG9hdDY0QXJyYXkpIHtcbiAgICAgIHRoaXMuYnVmZmVycy5wdXNoKGUuZGF0YSlcbiAgICAgIHdoaWxlICh0aGlzLmJ1ZmZlcnMubGVuZ3RoID4gMilcbiAgICAgICAgdGhpcy5idWZmZXJzLnNoaWZ0KClcbiAgICB9XG4gIH1cbn0pXG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudChcImJvZHlcIiwge1xuICBkZXBlbmRlbmNpZXM6IFtcInBvc2l0aW9uXCIsIFwicm90YXRpb25cIiwgXCJzY2FsZVwiXSxcblxuICBzY2hlbWE6IHtcbiAgICB0eXBlOiB7IHR5cGU6IFwic3RyaW5nXCIsIGRlZmF1bHQ6IFwic3RhdGljXCIgfVxuICB9LFxuXG4gIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgd29ya2VyID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMucGh5c2ljcy53b3JrZXJcbiAgICBsZXQgYm9kaWVzID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMucGh5c2ljcy5ib2RpZXNcbiAgICBsZXQgbW92aW5nQm9kaWVzID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMucGh5c2ljcy5tb3ZpbmdCb2RpZXNcbiAgICBsZXQgYnVmZmVyID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMucGh5c2ljcy5idWZmZXJzWzBdXG4gICAgaWYgKCF3b3JrZXIpIHJldHVyblxuICAgIHRoaXMuaWQgPSBib2RpZXMuaW5kZXhPZihudWxsKVxuICAgIGlmICh0aGlzLmlkIDwgMCkgdGhpcy5pZCA9IGJvZGllcy5sZW5ndGhcbiAgICBib2RpZXNbdGhpcy5pZF0gPSB0aGlzLmVsXG4gICAgaWYgKHRoaXMuZGF0YS50eXBlICE9PSBcInN0YXRpY1wiKSB7XG4gICAgICB0aGlzLm1pZCA9IG1vdmluZ0JvZGllcy5pbmRleE9mKG51bGwpXG4gICAgICBpZiAodGhpcy5taWQgPCAwKSB0aGlzLm1pZCA9IG1vdmluZ0JvZGllcy5sZW5ndGhcbiAgICAgIG1vdmluZ0JvZGllc1t0aGlzLm1pZF0gPSB0aGlzLmVsXG5cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5taWQgPSBudWxsXG4gICAgfVxuICAgIGxldCBib2R5ID0geyBtaWQ6IHRoaXMubWlkIH1cbiAgICBib2R5LnR5cGUgPSB0aGlzLmRhdGEudHlwZVxuICAgIGJvZHkucG9zaXRpb24gPSB0aGlzLmVsLm9iamVjdDNELmdldFdvcmxkUG9zaXRpb24oVEhSRUUuVmVjdG9yMy50ZW1wKCkpXG4gICAgYm9keS5xdWF0ZXJuaW9uID0gdGhpcy5lbC5vYmplY3QzRC5nZXRXb3JsZFF1YXRlcm5pb24oVEhSRUUuUXVhdGVybmlvbi50ZW1wKCkpXG4gICAgaWYgKHRoaXMubWlkICE9PSBudWxsKSB7XG4gICAgICBidWZmZXJbdGhpcy5taWQgKiA4ICsgMF0gPSBib2R5LnBvc2l0aW9uLnhcbiAgICAgIGJ1ZmZlclt0aGlzLm1pZCAqIDggKyAxXSA9IGJvZHkucG9zaXRpb24ueVxuICAgICAgYnVmZmVyW3RoaXMubWlkICogOCArIDJdID0gYm9keS5wb3NpdGlvbi56XG4gICAgICBidWZmZXJbdGhpcy5taWQgKiA4ICsgNF0gPSBib2R5LnF1YXRlcm5pb24ueFxuICAgICAgYnVmZmVyW3RoaXMubWlkICogOCArIDVdID0gYm9keS5xdWF0ZXJuaW9uLnlcbiAgICAgIGJ1ZmZlclt0aGlzLm1pZCAqIDggKyA2XSA9IGJvZHkucXVhdGVybmlvbi56XG4gICAgICBidWZmZXJbdGhpcy5taWQgKiA4ICsgN10gPSBib2R5LnF1YXRlcm5pb24ud1xuICAgIH1cbiAgICB3b3JrZXIucG9zdE1lc3NhZ2UoXCJ3b3JsZCBib2R5IFwiICsgdGhpcy5pZCArIFwiIGNyZWF0ZSBcIiArIHN0cmluZ2lmeShib2R5KSlcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgd29ya2VyID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMucGh5c2ljcy53b3JrZXJcbiAgICBpZiAoIXdvcmtlcikgcmV0dXJuXG4gICAgd29ya2VyLnBvc3RNZXNzYWdlKFwid29ybGQgYm9keSBcIiArIHRoaXMuaWQgKyBcIiB0eXBlID0gXCIgKyBzdHJpbmdpZnkodGhpcy5kYXRhLnR5cGUpKVxuICB9LFxuXG4gIHBsYXk6IGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgd29ya2VyID0gdGhpcy5lbC5zY2VuZUVsLnN5c3RlbXMucGh5c2ljcy53b3JrZXJcbiAgICBpZiAoIXdvcmtlcikgcmV0dXJuXG4gICAgd29ya2VyLnBvc3RNZXNzYWdlKFwid29ybGQgYm9keSBcIiArIHRoaXMuaWQgKyBcIiBzbGVlcGluZyA9IGZhbHNlXCIpXG4gIH0sXG4gIHBhdXNlOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IHdvcmtlciA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnBoeXNpY3Mud29ya2VyXG4gICAgaWYgKCF3b3JrZXIpIHJldHVyblxuICAgIHdvcmtlci5wb3N0TWVzc2FnZShcIndvcmxkIGJvZHkgXCIgKyB0aGlzLmlkICsgXCIgc2xlZXBpbmcgPSB0cnVlXCIpXG4gIH0sXG5cbiAgcmVtb3ZlOiBmdW5jdGlvbiAoKSB7XG4gICAgbGV0IHdvcmtlciA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnBoeXNpY3Mud29ya2VyXG4gICAgbGV0IGJvZGllcyA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnBoeXNpY3MuYm9kaWVzXG4gICAgbGV0IG1vdmluZ0JvZGllcyA9IHRoaXMuZWwuc2NlbmVFbC5zeXN0ZW1zLnBoeXNpY3MubW92aW5nQm9kaWVzXG4gICAgaWYgKCF3b3JrZXIpIHJldHVyblxuICAgIGJvZGllc1t0aGlzLmlkXSA9IG51bGxcbiAgICBpZiAodGhpcy5taWQgIT09IG51bGwpXG4gICAgICBtb3ZpbmdCb2RpZXNbdGhpcy5taWRdID0gbnVsbFxuICAgIHdvcmtlci5wb3N0TWVzc2FnZShcIndvcmxkIGJvZHkgXCIgKyB0aGlzLmlkICsgXCIgcmVtb3ZlXCIpXG4gIH0sXG5cbiAgdGljazogZnVuY3Rpb24gKCkge1xuICAgIGxldCB3b3JrZXIgPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5waHlzaWNzLndvcmtlclxuICAgIGxldCBidWZmZXIgPSB0aGlzLmVsLnNjZW5lRWwuc3lzdGVtcy5waHlzaWNzLmJ1ZmZlcnNbMF1cbiAgICBpZiAoIXdvcmtlcikgcmV0dXJuXG4gICAgaWYgKHRoaXMubWlkICE9PSBudWxsKSB7XG4gICAgICBpZiAodGhpcy5kYXRhLnR5cGUgPT09IFwia2luZW1hdGljXCIpIHtcbiAgICAgICAgbGV0IHZlYyA9IHRoaXMuZWwub2JqZWN0M0QuZ2V0V29ybGRQb3NpdGlvbihUSFJFRS5WZWN0b3IzLnRlbXAoKSlcbiAgICAgICAgYnVmZmVyW3RoaXMubWlkICogOCArIDBdID0gdmVjLnhcbiAgICAgICAgYnVmZmVyW3RoaXMubWlkICogOCArIDFdID0gdmVjLnlcbiAgICAgICAgYnVmZmVyW3RoaXMubWlkICogOCArIDJdID0gdmVjLnpcbiAgICAgICAgbGV0IHF1YXQgPSB0aGlzLmVsLm9iamVjdDNELmdldFdvcmxkUXVhdGVybmlvbihUSFJFRS5RdWF0ZXJuaW9uLnRlbXAoKSlcbiAgICAgICAgYnVmZmVyW3RoaXMubWlkICogOCArIDRdID0gcXVhdC54XG4gICAgICAgIGJ1ZmZlclt0aGlzLm1pZCAqIDggKyA1XSA9IHF1YXQueVxuICAgICAgICBidWZmZXJbdGhpcy5taWQgKiA4ICsgNl0gPSBxdWF0LnpcbiAgICAgICAgYnVmZmVyW3RoaXMubWlkICogOCArIDddID0gcXVhdC53XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsZXQgcXVhdCA9IFRIUkVFLlF1YXRlcm5pb24udGVtcCgpXG5cbiAgICAgICAgdGhpcy5lbC5vYmplY3QzRC5wb3NpdGlvbi54ID0gYnVmZmVyW3RoaXMubWlkICogOCArIDBdXG4gICAgICAgIHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb24ueSA9IGJ1ZmZlclt0aGlzLm1pZCAqIDggKyAxXVxuICAgICAgICB0aGlzLmVsLm9iamVjdDNELnBvc2l0aW9uLnogPSBidWZmZXJbdGhpcy5taWQgKiA4ICsgMl1cbiAgICAgICAgdGhpcy5lbC5vYmplY3QzRC5wYXJlbnQud29ybGRUb0xvY2FsKHRoaXMuZWwub2JqZWN0M0QucG9zaXRpb24pXG5cbiAgICAgICAgdGhpcy5lbC5vYmplY3QzRC5nZXRXb3JsZFF1YXRlcm5pb24ocXVhdClcbiAgICAgICAgdGhpcy5lbC5vYmplY3QzRC5xdWF0ZXJuaW9uLm11bHRpcGx5KHF1YXQuY29uanVnYXRlKCkubm9ybWFsaXplKCkpXG4gICAgICAgIHF1YXQueCA9IGJ1ZmZlclt0aGlzLm1pZCAqIDggKyA0XVxuICAgICAgICBxdWF0LnkgPSBidWZmZXJbdGhpcy5taWQgKiA4ICsgNV1cbiAgICAgICAgcXVhdC56ID0gYnVmZmVyW3RoaXMubWlkICogOCArIDZdXG4gICAgICAgIHF1YXQudyA9IGJ1ZmZlclt0aGlzLm1pZCAqIDggKyA3XVxuICAgICAgICB0aGlzLmVsLm9iamVjdDNELnF1YXRlcm5pb24ubXVsdGlwbHkocXVhdC5ub3JtYWxpemUoKSlcbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pXG5cbkFGUkFNRS5yZWdpc3RlckNvbXBvbmVudChcInNoYXBlXCIsIHtcbiAgZGVwZW5kZW5jaWVzOiBbXCJib2R5XCJdLFxuICBtdWx0aXBsZTogdHJ1ZSxcbiAgc2NoZW1hOiB7XG4gICAgdHlwZTogeyB0eXBlOiBcInN0cmluZ1wiLCBkZWZhdWx0OiBcImJveFwiIH0sXG4gICAgc2l6ZTogeyB0eXBlOiBcInZlYzNcIiwgZGVmYXVsdDogeyB4OiAtMSwgeTogLTEsIHo6IC0xIH0gfSxcbiAgICBwb3NPZmZzZXQ6IHsgdHlwZTogXCJ2ZWMzXCIsIGRlZmF1bHQ6IHsgeDogMCwgeTogMCwgejogMCB9IH0sXG4gICAgcm90T2Zmc2V0OiB7IHR5cGU6IFwidmVjM1wiLCBkZWZhdWx0OiB7IHg6IDAsIHk6IDAsIHo6IDAgfSB9LFxuICAgIGRlbnNpdHk6IHsgdHlwZTogXCJudW1iZXJcIiwgZGVmYXVsdDogMSB9LFxuICAgIGZyaWN0aW9uOiB7IHR5cGU6IFwibnVtYmVyXCIsIGRlZmF1bHQ6IDAuMiB9LFxuICAgIHJlc3RpdHV0aW9uOiB7IHR5cGU6IFwibnVtYmVyXCIsIGRlZmF1bHQ6IDAuMiB9LFxuICAgIGJlbG9uZ3NUbzogeyB0eXBlOiBcImludFwiLCBkZWZhdWx0OiAxIH0sXG4gICAgY29sbGlkZXNXaXRoOiB7IHR5cGU6IFwiaW50XCIsIGRlZmF1bHQ6IDB4ZmZmZmZmZmYgfSxcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuZWwuYm9keSkgcmV0dXJuIHNldFRpbWVvdXQoKCkgPT4gdGhpcy51cGRhdGUoKSwgMjU2KVxuICAgIGlmICghdGhpcy5zaGFwZSkge1xuICAgICAgbGV0IHNjID0gbmV3IE9JTU8uU2hhcGVDb25maWcoKVxuICAgICAgc3dpdGNoICh0aGlzLmRhdGEudHlwZSkge1xuICAgICAgICBjYXNlIFwiYm94XCI6XG4gICAgICAgICAgdGhpcy5zaGFwZSA9IG5ldyBPSU1PLkJveChzYywgMSwgMSwgMSlcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIFwiY3lsaW5kZXJcIjpcbiAgICAgICAgICB0aGlzLnNoYXBlID0gbmV3IE9JTU8uQ3lsaW5kZXIoc2MsIDEsIDEpXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSBcInNwaGVyZVwiOlxuICAgICAgICAgIHRoaXMuc2hhcGUgPSBuZXcgT0lNTy5TcGhlcmUoc2MsIDEpXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSBcInBsYW5lXCI6XG4gICAgICAgICAgdGhpcy5zaGFwZSA9IG5ldyBPSU1PLlBsYW5lKHNjKVxuICAgICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgICB0aGlzLmVsLmJvZHkuYWRkU2hhcGUodGhpcy5zaGFwZSlcbiAgICB9XG4gICAgdGhpcy5zaGFwZS5kZW5zaXR5ID0gdGhpcy5kYXRhLmRlbnNpdHlcbiAgICB0aGlzLnNoYXBlLmZyaWN0aW9uID0gdGhpcy5kYXRhLmZyaWN0aW9uXG4gICAgdGhpcy5zaGFwZS5yZXN0aXR1dGlvbiA9IHRoaXMuZGF0YS5yZXN0aXR1dGlvblxuICAgIHRoaXMuc2hhcGUuYmVsb25nc1RvID0gdGhpcy5kYXRhLmJlbG9uZ3NUb1xuICAgIHRoaXMuc2hhcGUuY29sbGlkZXNXaXRoID0gdGhpcy5kYXRhLmNvbGxpZGVzV2l0aFxuICAgIHRoaXMuc2hhcGUucmVsYXRpdmVQb3NpdGlvbi5jb3B5KHRoaXMuZGF0YS5wb3NPZmZzZXQpXG4gICAgaWYgKHRoaXMuZGF0YS5yb3RPZmZzZXQueCB8fCB0aGlzLmRhdGEucm90T2Zmc2V0LnkgfHwgdGhpcy5kYXRhLnJvdE9mZnNldC56KSBjb25zb2xlLndhcm4oXCJyb3RPZmZzZXQgcHJvcGVydHkgbm90IHlldCBpbXBlbWVudGVkIVwiKVxuICAgIC8vIHRoaXMuc2hhcGUucmVsYXRpdmVSb3RhdGlvbi5jb3B5KHRoaXMuZGF0YS5yb3RPZmZzZXQpXG5cbiAgICBsZXQgc2NhbGUgPSBUSFJFRS5WZWN0b3IzLnJldXNlKClcbiAgICBsZXQgc2l6ZSA9IFRIUkVFLlZlY3RvcjMucmV1c2UoKS5jb3B5KHRoaXMuZGF0YS5zaXplKVxuICAgIGlmIChzaXplLnggPCAwKSB7XG4gICAgICBzaXplLnNldCgxLCAxLCAxKVxuICAgICAgbGV0IG1lc2ggPSB0aGlzLmVsLmdldE9iamVjdDNEKFwibWVzaFwiKVxuICAgICAgaWYgKG1lc2ggJiYgbWVzaC5nZW9tZXRyeSkge1xuICAgICAgICBtZXNoLmdlb21ldHJ5LmNvbXB1dGVCb3VuZGluZ0JveCgpXG4gICAgICAgIGxldCBib3ggPSBtZXNoLmdlb21ldHJ5LmJvdW5kaW5nQm94XG4gICAgICAgIHNpemUuY29weShib3gubWF4KS5zdWIoYm94Lm1pbilcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcihcIm1vZGVsLWxvYWRlZFwiLCB0aGlzLnVwZGF0ZS5iaW5kKHRoaXMpKVxuICAgICAgfVxuICAgIH1cbiAgICBzaXplLm11bHRpcGx5KHRoaXMuZWwub2JqZWN0M0QuZ2V0V29ybGRTY2FsZShzY2FsZSkpXG4gICAgc3dpdGNoICh0aGlzLmRhdGEudHlwZSkge1xuICAgICAgY2FzZSBcImJveFwiOlxuICAgICAgICB0aGlzLnNoYXBlLndpZHRoID0gc2l6ZS54XG4gICAgICAgIHRoaXMuc2hhcGUuaGVpZ2h0ID0gc2l6ZS55XG4gICAgICAgIHRoaXMuc2hhcGUuZGVwdGggPSBzaXplLnpcbiAgICAgICAgdGhpcy5zaGFwZS5oYWxmV2lkdGggPSBzaXplLnggLyAyXG4gICAgICAgIHRoaXMuc2hhcGUuaGFsZkhlaWdodCA9IHNpemUueSAvIDJcbiAgICAgICAgdGhpcy5zaGFwZS5oYWxmRGVwdGggPSBzaXplLnogLyAyXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlIFwiY3lsaW5kZXJcIjpcbiAgICAgICAgc2l6ZS54ID0gKHNpemUueCArIHNpemUueikgLyA0XG4gICAgICAgIHRoaXMuc2hhcGUucmFkaXVzID0gc2l6ZS54XG4gICAgICAgIHRoaXMuc2hhcGUuaGVpZ2h0ID0gc2l6ZS55XG4gICAgICAgIHRoaXMuc2hhcGUuaGFsZkhlaWdodCA9IHNpemUueSAvIDJcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgXCJzcGhlcmVcIjpcbiAgICAgICAgc2l6ZS54ID0gKHNpemUueCArIHNpemUueSArIHNpemUueikgLyA2XG4gICAgICAgIHRoaXMuc2hhcGUucmFkaXVzID0gc2l6ZS54XG4gICAgICAgIGJyZWFrXG4gICAgfVxuICAgIHRoaXMuZWwuYm9keS5zZXR1cE1hc3ModGhpcy5lbC5ib2R5LnR5cGUpXG5cbiAgICBzaXplLnJlY3ljbGUoKVxuICAgIHNjYWxlLnJlY3ljbGUoKVxuICB9LFxuXG4gIHJlbW92ZTogZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLnNoYXBlKSB0aGlzLmVsLmJvZHkucmVtb3ZlU2hhcGUodGhpcy5zaGFwZSlcbiAgICB0aGlzLnNoYXBlID0gbnVsbFxuICB9XG59KVxuXG5BRlJBTUUucmVnaXN0ZXJDb21wb25lbnQoXCJqb2ludFwiLCB7XG4gIGRlcGVuZGVuY2llczogW1wiYm9keVwiLCBcInNoYXBlXCJdLFxuXG4gIHNjaGVtYToge1xuICAgIHR5cGU6IHsgdHlwZTogXCJzdHJpbmdcIiwgZGVmYXVsdDogXCJwcmlzbWVcIiB9LFxuICAgIHdpdGg6IHsgdHlwZTogXCJzZWxlY3RvclwiLCBkZWZhdWx0OiBcIltib2R5XVwiIH0sXG4gICAgbWluOiB7IHR5cGU6IFwibnVtYmVyXCIsIGRlZmF1bHQ6IDAgfSxcbiAgICBtYXg6IHsgdHlwZTogXCJudW1iZXJcIiwgZGVmYXVsdDogMCB9LFxuICAgIHBvczE6IHsgdHlwZTogXCJ2ZWMzXCIsIGRlZmF1bHQ6IHsgeDogMCwgeTogMCwgejogMCB9IH0sXG4gICAgcG9zMjogeyB0eXBlOiBcInZlYzNcIiwgZGVmYXVsdDogeyB4OiAwLCB5OiAwLCB6OiAwIH0gfSxcbiAgICBheGUxOiB7IHR5cGU6IFwidmVjM1wiLCBkZWZhdWx0OiB7IHg6IDEsIHk6IDAsIHo6IDAgfSB9LFxuICAgIGF4ZTI6IHsgdHlwZTogXCJ2ZWMzXCIsIGRlZmF1bHQ6IHsgeDogMSwgeTogMCwgejogMCB9IH0sXG4gICAgY29sbGlzaW9uOiB7IHR5cGU6IFwiYm9vbGVhblwiLCBkZWZhdWx0OiBmYWxzZSB9LFxuICAgIGxpbWl0OiB7IHR5cGU6IFwiYXJyYXlcIiB9LFxuICAgIG1vdG9yOiB7IHR5cGU6IFwiYXJyYXlcIiB9LFxuICAgIHNwcmluZzogeyB0eXBlOiBcImFycmF5XCIgfSxcbiAgfSxcblxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXRoaXMuZWwuYm9keSkgcmV0dXJuIHNldFRpbWVvdXQoKCkgPT4gdGhpcy51cGRhdGUoKSwgMjU2KVxuICAgIGlmICghdGhpcy5kYXRhLndpdGguYm9keSkgcmV0dXJuIHNldFRpbWVvdXQoKCkgPT4gdGhpcy51cGRhdGUoKSwgMjU2KVxuICAgIGlmICghdGhpcy5qb2ludCkge1xuICAgICAgbGV0IGpjID0gbmV3IE9JTU8uSm9pbnRDb25maWcoKVxuICAgICAgamMuYm9keTEgPSB0aGlzLmVsLmJvZHlcbiAgICAgIGpjLmJvZHkyID0gdGhpcy5kYXRhLndpdGguYm9keVxuICAgICAgbGV0IGRlZzJyYWQgPSBNYXRoLlBJIC8gMTgwXG4gICAgICBzd2l0Y2ggKHRoaXMuZGF0YS50eXBlKSB7XG4gICAgICAgIGNhc2UgXCJkaXN0YW5jZVwiOlxuICAgICAgICAgIHRoaXMuam9pbnQgPSBuZXcgT0lNTy5EaXN0YW5jZUpvaW50KGpjLCB0aGlzLmRhdGEubWluLCB0aGlzLmRhdGEubWF4KVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgXCJoaW5nZVwiOlxuICAgICAgICAgIHRoaXMuam9pbnQgPSBuZXcgT0lNTy5IaW5nZUpvaW50KGpjLCB0aGlzLmRhdGEubWluICogZGVnMnJhZCwgdGhpcy5kYXRhLm1heCAqIGRlZzJyYWQpXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSBcInByaXNtZVwiOlxuICAgICAgICAgIHRoaXMuam9pbnQgPSBuZXcgT0lNTy5QcmlzbWF0aWNKb2ludChqYywgdGhpcy5kYXRhLm1pbiAqIGRlZzJyYWQsIHRoaXMuZGF0YS5tYXggKiBkZWcycmFkKVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgXCJzbGlkZVwiOlxuICAgICAgICAgIHRoaXMuam9pbnQgPSBuZXcgT0lNTy5TbGlkZXJKb2ludChqYywgdGhpcy5kYXRhLm1pbiwgdGhpcy5kYXRhLm1heClcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIFwiYmFsbFwiOlxuICAgICAgICAgIHRoaXMuam9pbnQgPSBuZXcgT0lNTy5CYWxsQW5kU29ja2V0Sm9pbnQoamMpXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSBcIndoZWVsXCI6XG4gICAgICAgICAgdGhpcy5qb2ludCA9IG5ldyBPSU1PLldoZWVsSm9pbnQoamMpXG4gICAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIHRoaXMuZWwuc2NlbmVFbC5waHlzaWNzV29ybGQuYWRkSm9pbnQodGhpcy5qb2ludClcbiAgICB9XG4gICAgdGhpcy5qb2ludC5sb2NhbEFuY2hvclBvaW50MS5jb3B5KHRoaXMuZGF0YS5wb3MxKVxuICAgIHRoaXMuam9pbnQubG9jYWxBbmNob3JQb2ludDIuY29weSh0aGlzLmRhdGEucG9zMilcbiAgICBpZiAodGhpcy5qb2ludC5sb2NhbEF4aXMxKSB7XG4gICAgICB0aGlzLmpvaW50LmxvY2FsQXhpczEuY29weSh0aGlzLmRhdGEuYXhlMSlcbiAgICAgIHRoaXMuam9pbnQubG9jYWxBeGlzMi5jb3B5KHRoaXMuZGF0YS5heGUyKVxuICAgIH1cbiAgICB0aGlzLmpvaW50LmFsbG93Q29sbGlzaW9uID0gdGhpcy5kYXRhLmNvbGxpc2lvblxuXG4gICAgbGV0IGxtID0gdGhpcy5qb2ludC5yb3RhdGlvbmFsTGltaXRNb3RvcjEgfHwgdGhpcy5qb2ludC5saW1pdE1vdG9yXG4gICAgLy8gaWYgKHRoaXMuZGF0YS5saW1pdC5sZW5ndGggPT0gMilcbiAgICBsbS5zZXRMaW1pdChwYXJzZUZsb2F0KHRoaXMuZGF0YS5saW1pdFswXSkgfHwgMCwgcGFyc2VGbG9hdCh0aGlzLmRhdGEubGltaXRbMV0pIHx8IDApXG4gICAgLy8gaWYgKHRoaXMuZGF0YS5tb3Rvci5sZW5ndGggPT0gMilcbiAgICBsbS5zZXRNb3RvcihwYXJzZUZsb2F0KHRoaXMuZGF0YS5tb3RvclswXSkgfHwgMCwgcGFyc2VGbG9hdCh0aGlzLmRhdGEubW90b3JbMV0pIHx8IDApXG4gICAgLy8gaWYgKHRoaXMuZGF0YS5zcHJpbmcubGVuZ3RoID09IDIpXG4gICAgbG0uc2V0U3ByaW5nKHBhcnNlRmxvYXQodGhpcy5kYXRhLnNwcmluZ1swXSkgfHwgMCwgcGFyc2VGbG9hdCh0aGlzLmRhdGEuc3ByaW5nWzFdKSB8fCAwKVxuICB9LFxuXG4gIHJlbW92ZTogZnVuY3Rpb24gKCkge1xuICAgIGlmICh0aGlzLmpvaW50KSB7XG4gICAgICB0aGlzLmpvaW50LmJvZHkxLmF3YWtlKClcbiAgICAgIHRoaXMuam9pbnQuYm9keTIuYXdha2UoKVxuICAgICAgdGhpcy5qb2ludC5yZW1vdmUoKVxuICAgIH1cbiAgICB0aGlzLmpvaW50ID0gbnVsbFxuICB9LFxuXG59KVxuXG4iLCJpZiAodHlwZW9mIHdpbmRvdyA9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgcmVxdWlyZShcIi4vb2ltb1dvcmtlclwiKVxyXG59IGVsc2Uge1xyXG4gIHJlcXVpcmUoXCIuL2xpYnMvcG9vbHNcIilcclxuICByZXF1aXJlKFwiLi9saWJzL2NvcHlXb3JsZFBvc1JvdFwiKVxyXG5cclxuICByZXF1aXJlKFwiLi9jb21wb25lbnRzL2luY2x1ZGVcIilcclxuICByZXF1aXJlKFwiLi9jb21wb25lbnRzL3BoeXNpY3NcIilcclxufSIsIi8qIGdsb2JhbCBBRlJBTUUsIFRIUkVFICovXHJcblxyXG5BRlJBTUUuQUVudGl0eS5wcm90b3R5cGUuY29weVdvcmxkUG9zUm90ID0gZnVuY3Rpb24gKHNyY0VsKSB7XHJcbiAgbGV0IHF1YXQgPSBUSFJFRS5RdWF0ZXJuaW9uLnRlbXAoKVxyXG4gIGxldCBzcmMgPSBzcmNFbC5vYmplY3QzRFxyXG4gIGxldCBkZXN0ID0gdGhpcy5vYmplY3QzRFxyXG4gIGlmICghc3JjKSByZXR1cm5cclxuICBpZiAoIWRlc3QpIHJldHVyblxyXG4gIGlmICghZGVzdC5wYXJlbnQpIHJldHVyblxyXG4gIHNyYy5nZXRXb3JsZFBvc2l0aW9uKGRlc3QucG9zaXRpb24pXHJcbiAgZGVzdC5wYXJlbnQud29ybGRUb0xvY2FsKGRlc3QucG9zaXRpb24pXHJcblxyXG4gIGRlc3QuZ2V0V29ybGRRdWF0ZXJuaW9uKHF1YXQpXHJcbiAgZGVzdC5xdWF0ZXJuaW9uLm11bHRpcGx5KHF1YXQuY29uanVnYXRlKCkubm9ybWFsaXplKCkpXHJcbiAgc3JjLmdldFdvcmxkUXVhdGVybmlvbihxdWF0KVxyXG4gIGRlc3QucXVhdGVybmlvbi5tdWx0aXBseShxdWF0Lm5vcm1hbGl6ZSgpKVxyXG59IiwiKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcclxuICB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBmYWN0b3J5KGV4cG9ydHMpIDpcclxuICAgIHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShbJ2V4cG9ydHMnXSwgZmFjdG9yeSkgOlxyXG4gICAgICAoZ2xvYmFsID0gZ2xvYmFsIHx8IHNlbGYsIGZhY3RvcnkoZ2xvYmFsLk9JTU8gPSB7fSkpO1xyXG59KHRoaXMsIGZ1bmN0aW9uIChleHBvcnRzKSB7XHJcbiAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAvLyBQb2x5ZmlsbHNcclxuXHJcbiAgaWYgKE51bWJlci5FUFNJTE9OID09PSB1bmRlZmluZWQpIHtcclxuXHJcbiAgICBOdW1iZXIuRVBTSUxPTiA9IE1hdGgucG93KDIsIC0gNTIpO1xyXG5cclxuICB9XHJcblxyXG4gIC8vXHJcblxyXG4gIGlmIChNYXRoLnNpZ24gPT09IHVuZGVmaW5lZCkge1xyXG5cclxuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL01hdGgvc2lnblxyXG5cclxuICAgIE1hdGguc2lnbiA9IGZ1bmN0aW9uICh4KSB7XHJcblxyXG4gICAgICByZXR1cm4gKHggPCAwKSA/IC0gMSA6ICh4ID4gMCkgPyAxIDogKyB4O1xyXG5cclxuICAgIH07XHJcblxyXG4gIH1cclxuXHJcbiAgaWYgKEZ1bmN0aW9uLnByb3RvdHlwZS5uYW1lID09PSB1bmRlZmluZWQpIHtcclxuXHJcbiAgICAvLyBNaXNzaW5nIGluIElFOS0xMS5cclxuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0Z1bmN0aW9uL25hbWVcclxuXHJcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRnVuY3Rpb24ucHJvdG90eXBlLCAnbmFtZScsIHtcclxuXHJcbiAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy50b1N0cmluZygpLm1hdGNoKC9eXFxzKmZ1bmN0aW9uXFxzKihbXlxcKFxcc10qKS8pWzFdO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxuICB9XHJcblxyXG4gIGlmIChPYmplY3QuYXNzaWduID09PSB1bmRlZmluZWQpIHtcclxuXHJcbiAgICAvLyBNaXNzaW5nIGluIElFLlxyXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvT2JqZWN0L2Fzc2lnblxyXG5cclxuICAgIChmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICBPYmplY3QuYXNzaWduID0gZnVuY3Rpb24gKHRhcmdldCkge1xyXG5cclxuICAgICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQgfHwgdGFyZ2V0ID09PSBudWxsKSB7XHJcblxyXG4gICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnZlcnQgdW5kZWZpbmVkIG9yIG51bGwgdG8gb2JqZWN0Jyk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIG91dHB1dCA9IE9iamVjdCh0YXJnZXQpO1xyXG5cclxuICAgICAgICBmb3IgKHZhciBpbmRleCA9IDE7IGluZGV4IDwgYXJndW1lbnRzLmxlbmd0aDsgaW5kZXgrKykge1xyXG5cclxuICAgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaW5kZXhdO1xyXG5cclxuICAgICAgICAgIGlmIChzb3VyY2UgIT09IHVuZGVmaW5lZCAmJiBzb3VyY2UgIT09IG51bGwpIHtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIG5leHRLZXkgaW4gc291cmNlKSB7XHJcblxyXG4gICAgICAgICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoc291cmNlLCBuZXh0S2V5KSkge1xyXG5cclxuICAgICAgICAgICAgICAgIG91dHB1dFtuZXh0S2V5XSA9IHNvdXJjZVtuZXh0S2V5XTtcclxuXHJcbiAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gb3V0cHV0O1xyXG5cclxuICAgICAgfTtcclxuXHJcbiAgICB9KSgpO1xyXG5cclxuICB9XHJcblxyXG4gIC8qXHJcbiAgICogQSBsaXN0IG9mIGNvbnN0YW50cyBidWlsdC1pbiBmb3JcclxuICAgKiB0aGUgcGh5c2ljcyBlbmdpbmUuXHJcbiAgICovXHJcblxyXG4gIHZhciBSRVZJU0lPTiA9ICcxLjAuOSc7XHJcblxyXG4gIC8vIEJyb2FkUGhhc2VcclxuICB2YXIgQlJfTlVMTCA9IDA7XHJcbiAgdmFyIEJSX0JSVVRFX0ZPUkNFID0gMTtcclxuICB2YXIgQlJfU1dFRVBfQU5EX1BSVU5FID0gMjtcclxuICB2YXIgQlJfQk9VTkRJTkdfVk9MVU1FX1RSRUUgPSAzO1xyXG5cclxuICAvLyBCb2R5IHR5cGVcclxuICB2YXIgQk9EWV9OVUxMID0gMDtcclxuICB2YXIgQk9EWV9EWU5BTUlDID0gMTtcclxuICB2YXIgQk9EWV9TVEFUSUMgPSAyO1xyXG4gIHZhciBCT0RZX0tJTkVNQVRJQyA9IDM7XHJcbiAgdmFyIEJPRFlfR0hPU1QgPSA0O1xyXG5cclxuICAvLyBTaGFwZSB0eXBlXHJcbiAgdmFyIFNIQVBFX05VTEwgPSAwO1xyXG4gIHZhciBTSEFQRV9TUEhFUkUgPSAxO1xyXG4gIHZhciBTSEFQRV9CT1ggPSAyO1xyXG4gIHZhciBTSEFQRV9DWUxJTkRFUiA9IDM7XHJcbiAgdmFyIFNIQVBFX1BMQU5FID0gNDtcclxuICB2YXIgU0hBUEVfUEFSVElDTEUgPSA1O1xyXG4gIHZhciBTSEFQRV9URVRSQSA9IDY7XHJcblxyXG4gIC8vIEpvaW50IHR5cGVcclxuICB2YXIgSk9JTlRfTlVMTCA9IDA7XHJcbiAgdmFyIEpPSU5UX0RJU1RBTkNFID0gMTtcclxuICB2YXIgSk9JTlRfQkFMTF9BTkRfU09DS0VUID0gMjtcclxuICB2YXIgSk9JTlRfSElOR0UgPSAzO1xyXG4gIHZhciBKT0lOVF9XSEVFTCA9IDQ7XHJcbiAgdmFyIEpPSU5UX1NMSURFUiA9IDU7XHJcbiAgdmFyIEpPSU5UX1BSSVNNQVRJQyA9IDY7XHJcblxyXG4gIC8vIEFBQkIgYXByb3hpbWF0aW9uXHJcbiAgdmFyIEFBQkJfUFJPWCA9IDAuMDA1O1xyXG5cclxuICB2YXIgX01hdGggPSB7XHJcblxyXG4gICAgc3FydDogTWF0aC5zcXJ0LFxyXG4gICAgYWJzOiBNYXRoLmFicyxcclxuICAgIGZsb29yOiBNYXRoLmZsb29yLFxyXG4gICAgY29zOiBNYXRoLmNvcyxcclxuICAgIHNpbjogTWF0aC5zaW4sXHJcbiAgICBhY29zOiBNYXRoLmFjb3MsXHJcbiAgICBhc2luOiBNYXRoLmFzaW4sXHJcbiAgICBhdGFuMjogTWF0aC5hdGFuMixcclxuICAgIHJvdW5kOiBNYXRoLnJvdW5kLFxyXG4gICAgcG93OiBNYXRoLnBvdyxcclxuICAgIG1heDogTWF0aC5tYXgsXHJcbiAgICBtaW46IE1hdGgubWluLFxyXG4gICAgcmFuZG9tOiBNYXRoLnJhbmRvbSxcclxuXHJcbiAgICBkZWd0b3JhZDogMC4wMTc0NTMyOTI1MTk5NDMyOTU3LFxyXG4gICAgcmFkdG9kZWc6IDU3LjI5NTc3OTUxMzA4MjMyMDg3NixcclxuICAgIFBJOiAzLjE0MTU5MjY1MzU4OTc5MyxcclxuICAgIFR3b1BJOiA2LjI4MzE4NTMwNzE3OTU4NixcclxuICAgIFBJOTA6IDEuNTcwNzk2MzI2Nzk0ODk2LFxyXG4gICAgUEkyNzA6IDQuNzEyMzg4OTgwMzg0Njg5LFxyXG5cclxuICAgIElORjogSW5maW5pdHksXHJcbiAgICBFUFo6IDAuMDAwMDEsXHJcbiAgICBFUFoyOiAwLjAwMDAwMSxcclxuXHJcbiAgICBsZXJwOiBmdW5jdGlvbiAoeCwgeSwgdCkge1xyXG5cclxuICAgICAgcmV0dXJuICgxIC0gdCkgKiB4ICsgdCAqIHk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICByYW5kSW50OiBmdW5jdGlvbiAobG93LCBoaWdoKSB7XHJcblxyXG4gICAgICByZXR1cm4gbG93ICsgX01hdGguZmxvb3IoX01hdGgucmFuZG9tKCkgKiAoaGlnaCAtIGxvdyArIDEpKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHJhbmQ6IGZ1bmN0aW9uIChsb3csIGhpZ2gpIHtcclxuXHJcbiAgICAgIHJldHVybiBsb3cgKyBfTWF0aC5yYW5kb20oKSAqIChoaWdoIC0gbG93KTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGdlbmVyYXRlVVVJRDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgLy8gaHR0cDovL3d3dy5icm9vZmEuY29tL1Rvb2xzL01hdGgudXVpZC5odG1cclxuXHJcbiAgICAgIHZhciBjaGFycyA9ICcwMTIzNDU2Nzg5QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicuc3BsaXQoJycpO1xyXG4gICAgICB2YXIgdXVpZCA9IG5ldyBBcnJheSgzNik7XHJcbiAgICAgIHZhciBybmQgPSAwLCByO1xyXG5cclxuICAgICAgcmV0dXJuIGZ1bmN0aW9uIGdlbmVyYXRlVVVJRCgpIHtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzNjsgaSsrKSB7XHJcblxyXG4gICAgICAgICAgaWYgKGkgPT09IDggfHwgaSA9PT0gMTMgfHwgaSA9PT0gMTggfHwgaSA9PT0gMjMpIHtcclxuXHJcbiAgICAgICAgICAgIHV1aWRbaV0gPSAnLSc7XHJcblxyXG4gICAgICAgICAgfSBlbHNlIGlmIChpID09PSAxNCkge1xyXG5cclxuICAgICAgICAgICAgdXVpZFtpXSA9ICc0JztcclxuXHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgaWYgKHJuZCA8PSAweDAyKSBybmQgPSAweDIwMDAwMDAgKyAoTWF0aC5yYW5kb20oKSAqIDB4MTAwMDAwMCkgfCAwO1xyXG4gICAgICAgICAgICByID0gcm5kICYgMHhmO1xyXG4gICAgICAgICAgICBybmQgPSBybmQgPj4gNDtcclxuICAgICAgICAgICAgdXVpZFtpXSA9IGNoYXJzWyhpID09PSAxOSkgPyAociAmIDB4MykgfCAweDggOiByXTtcclxuXHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHV1aWQuam9pbignJyk7XHJcblxyXG4gICAgICB9O1xyXG5cclxuICAgIH0oKSxcclxuXHJcbiAgICBpbnQ6IGZ1bmN0aW9uICh4KSB7XHJcblxyXG4gICAgICByZXR1cm4gX01hdGguZmxvb3IoeCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBmaXg6IGZ1bmN0aW9uICh4LCBuKSB7XHJcblxyXG4gICAgICByZXR1cm4geC50b0ZpeGVkKG4gfHwgMywgMTApO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2xhbXA6IGZ1bmN0aW9uICh2YWx1ZSwgbWluLCBtYXgpIHtcclxuXHJcbiAgICAgIHJldHVybiBfTWF0aC5tYXgobWluLCBfTWF0aC5taW4obWF4LCB2YWx1ZSkpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy9jbGFtcDogZnVuY3Rpb24gKCB4LCBhLCBiICkgeyByZXR1cm4gKCB4IDwgYSApID8gYSA6ICggKCB4ID4gYiApID8gYiA6IHggKTsgfSxcclxuXHJcblxyXG5cclxuICAgIGRpc3RhbmNlOiBmdW5jdGlvbiAocDEsIHAyKSB7XHJcblxyXG4gICAgICB2YXIgeGQgPSBwMlswXSAtIHAxWzBdO1xyXG4gICAgICB2YXIgeWQgPSBwMlsxXSAtIHAxWzFdO1xyXG4gICAgICB2YXIgemQgPSBwMlsyXSAtIHAxWzJdO1xyXG4gICAgICByZXR1cm4gX01hdGguc3FydCh4ZCAqIHhkICsgeWQgKiB5ZCArIHpkICogemQpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLyp1bndyYXBEZWdyZWVzOiBmdW5jdGlvbiAoIHIgKSB7XHJcblxyXG4gICAgICAgIHIgPSByICUgMzYwO1xyXG4gICAgICAgIGlmIChyID4gMTgwKSByIC09IDM2MDtcclxuICAgICAgICBpZiAociA8IC0xODApIHIgKz0gMzYwO1xyXG4gICAgICAgIHJldHVybiByO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdW53cmFwUmFkaWFuOiBmdW5jdGlvbiggciApe1xyXG5cclxuICAgICAgICByID0gciAlIF9NYXRoLlR3b1BJO1xyXG4gICAgICAgIGlmIChyID4gX01hdGguUEkpIHIgLT0gX01hdGguVHdvUEk7XHJcbiAgICAgICAgaWYgKHIgPCAtX01hdGguUEkpIHIgKz0gX01hdGguVHdvUEk7XHJcbiAgICAgICAgcmV0dXJuIHI7XHJcblxyXG4gICAgfSwqL1xyXG5cclxuICAgIGFjb3NDbGFtcDogZnVuY3Rpb24gKGNvcykge1xyXG5cclxuICAgICAgaWYgKGNvcyA+IDEpIHJldHVybiAwO1xyXG4gICAgICBlbHNlIGlmIChjb3MgPCAtMSkgcmV0dXJuIF9NYXRoLlBJO1xyXG4gICAgICBlbHNlIHJldHVybiBfTWF0aC5hY29zKGNvcyk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBkaXN0YW5jZVZlY3RvcjogZnVuY3Rpb24gKHYxLCB2Mikge1xyXG5cclxuICAgICAgdmFyIHhkID0gdjEueCAtIHYyLng7XHJcbiAgICAgIHZhciB5ZCA9IHYxLnkgLSB2Mi55O1xyXG4gICAgICB2YXIgemQgPSB2MS56IC0gdjIuejtcclxuICAgICAgcmV0dXJuIHhkICogeGQgKyB5ZCAqIHlkICsgemQgKiB6ZDtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGRvdFZlY3RvcnM6IGZ1bmN0aW9uIChhLCBiKSB7XHJcblxyXG4gICAgICByZXR1cm4gYS54ICogYi54ICsgYS55ICogYi55ICsgYS56ICogYi56O1xyXG5cclxuICAgIH0sXHJcblxyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIHByaW50RXJyb3IoY2xhenosIG1zZykge1xyXG4gICAgY29uc29sZS5lcnJvcihcIltPSU1PXSBcIiArIGNsYXp6ICsgXCI6IFwiICsgbXNnKTtcclxuICB9XHJcblxyXG4gIC8vIEEgcGVyZm9ybWFuY2UgZXZhbHVhdG9yXHJcblxyXG4gIGZ1bmN0aW9uIEluZm9EaXNwbGF5KHdvcmxkKSB7XHJcblxyXG4gICAgdGhpcy5wYXJlbnQgPSB3b3JsZDtcclxuXHJcbiAgICB0aGlzLmluZm9zID0gbmV3IEZsb2F0MzJBcnJheSgxMyk7XHJcbiAgICB0aGlzLmYgPSBbMCwgMCwgMF07XHJcblxyXG4gICAgdGhpcy50aW1lcyA9IFswLCAwLCAwLCAwXTtcclxuXHJcbiAgICB0aGlzLmJyb2FkUGhhc2UgPSB0aGlzLnBhcmVudC5icm9hZFBoYXNlVHlwZTtcclxuXHJcbiAgICB0aGlzLnZlcnNpb24gPSBSRVZJU0lPTjtcclxuXHJcbiAgICB0aGlzLmZwcyA9IDA7XHJcblxyXG4gICAgdGhpcy50dCA9IDA7XHJcblxyXG4gICAgdGhpcy5icm9hZFBoYXNlVGltZSA9IDA7XHJcbiAgICB0aGlzLm5hcnJvd1BoYXNlVGltZSA9IDA7XHJcbiAgICB0aGlzLnNvbHZpbmdUaW1lID0gMDtcclxuICAgIHRoaXMudG90YWxUaW1lID0gMDtcclxuICAgIHRoaXMudXBkYXRlVGltZSA9IDA7XHJcblxyXG4gICAgdGhpcy5NYXhCcm9hZFBoYXNlVGltZSA9IDA7XHJcbiAgICB0aGlzLk1heE5hcnJvd1BoYXNlVGltZSA9IDA7XHJcbiAgICB0aGlzLk1heFNvbHZpbmdUaW1lID0gMDtcclxuICAgIHRoaXMuTWF4VG90YWxUaW1lID0gMDtcclxuICAgIHRoaXMuTWF4VXBkYXRlVGltZSA9IDA7XHJcbiAgfVxyXG4gIE9iamVjdC5hc3NpZ24oSW5mb0Rpc3BsYXkucHJvdG90eXBlLCB7XHJcblxyXG4gICAgc2V0VGltZTogZnVuY3Rpb24gKG4pIHtcclxuICAgICAgdGhpcy50aW1lc1tuIHx8IDBdID0gcGVyZm9ybWFuY2Uubm93KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHJlc2V0TWF4OiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB0aGlzLk1heEJyb2FkUGhhc2VUaW1lID0gMDtcclxuICAgICAgdGhpcy5NYXhOYXJyb3dQaGFzZVRpbWUgPSAwO1xyXG4gICAgICB0aGlzLk1heFNvbHZpbmdUaW1lID0gMDtcclxuICAgICAgdGhpcy5NYXhUb3RhbFRpbWUgPSAwO1xyXG4gICAgICB0aGlzLk1heFVwZGF0ZVRpbWUgPSAwO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2FsY0Jyb2FkUGhhc2U6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHRoaXMuc2V0VGltZSgyKTtcclxuICAgICAgdGhpcy5icm9hZFBoYXNlVGltZSA9IHRoaXMudGltZXNbMl0gLSB0aGlzLnRpbWVzWzFdO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2FsY05hcnJvd1BoYXNlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB0aGlzLnNldFRpbWUoMyk7XHJcbiAgICAgIHRoaXMubmFycm93UGhhc2VUaW1lID0gdGhpcy50aW1lc1szXSAtIHRoaXMudGltZXNbMl07XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBjYWxjRW5kOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB0aGlzLnNldFRpbWUoMik7XHJcbiAgICAgIHRoaXMuc29sdmluZ1RpbWUgPSB0aGlzLnRpbWVzWzJdIC0gdGhpcy50aW1lc1sxXTtcclxuICAgICAgdGhpcy50b3RhbFRpbWUgPSB0aGlzLnRpbWVzWzJdIC0gdGhpcy50aW1lc1swXTtcclxuICAgICAgdGhpcy51cGRhdGVUaW1lID0gdGhpcy50b3RhbFRpbWUgLSAodGhpcy5icm9hZFBoYXNlVGltZSArIHRoaXMubmFycm93UGhhc2VUaW1lICsgdGhpcy5zb2x2aW5nVGltZSk7XHJcblxyXG4gICAgICBpZiAodGhpcy50dCA9PT0gMTAwKSB0aGlzLnJlc2V0TWF4KCk7XHJcblxyXG4gICAgICBpZiAodGhpcy50dCA+IDEwMCkge1xyXG4gICAgICAgIGlmICh0aGlzLmJyb2FkUGhhc2VUaW1lID4gdGhpcy5NYXhCcm9hZFBoYXNlVGltZSkgdGhpcy5NYXhCcm9hZFBoYXNlVGltZSA9IHRoaXMuYnJvYWRQaGFzZVRpbWU7XHJcbiAgICAgICAgaWYgKHRoaXMubmFycm93UGhhc2VUaW1lID4gdGhpcy5NYXhOYXJyb3dQaGFzZVRpbWUpIHRoaXMuTWF4TmFycm93UGhhc2VUaW1lID0gdGhpcy5uYXJyb3dQaGFzZVRpbWU7XHJcbiAgICAgICAgaWYgKHRoaXMuc29sdmluZ1RpbWUgPiB0aGlzLk1heFNvbHZpbmdUaW1lKSB0aGlzLk1heFNvbHZpbmdUaW1lID0gdGhpcy5zb2x2aW5nVGltZTtcclxuICAgICAgICBpZiAodGhpcy50b3RhbFRpbWUgPiB0aGlzLk1heFRvdGFsVGltZSkgdGhpcy5NYXhUb3RhbFRpbWUgPSB0aGlzLnRvdGFsVGltZTtcclxuICAgICAgICBpZiAodGhpcy51cGRhdGVUaW1lID4gdGhpcy5NYXhVcGRhdGVUaW1lKSB0aGlzLk1heFVwZGF0ZVRpbWUgPSB0aGlzLnVwZGF0ZVRpbWU7XHJcbiAgICAgIH1cclxuXHJcblxyXG4gICAgICB0aGlzLnVwZnBzKCk7XHJcblxyXG4gICAgICB0aGlzLnR0Kys7XHJcbiAgICAgIGlmICh0aGlzLnR0ID4gNTAwKSB0aGlzLnR0ID0gMDtcclxuXHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICB1cGZwczogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmZbMV0gPSBEYXRlLm5vdygpO1xyXG4gICAgICBpZiAodGhpcy5mWzFdIC0gMTAwMCA+IHRoaXMuZlswXSkgeyB0aGlzLmZbMF0gPSB0aGlzLmZbMV07IHRoaXMuZnBzID0gdGhpcy5mWzJdOyB0aGlzLmZbMl0gPSAwOyB9IHRoaXMuZlsyXSsrO1xyXG4gICAgfSxcclxuXHJcbiAgICBzaG93OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBpbmZvID0gW1xyXG4gICAgICAgIFwiT2ltby5qcyBcIiArIHRoaXMudmVyc2lvbiArIFwiPGJyPlwiLFxyXG4gICAgICAgIHRoaXMuYnJvYWRQaGFzZSArIFwiPGJyPjxicj5cIixcclxuICAgICAgICBcIkZQUzogXCIgKyB0aGlzLmZwcyArIFwiIGZwczxicj48YnI+XCIsXHJcbiAgICAgICAgXCJyaWdpZGJvZHkgXCIgKyB0aGlzLnBhcmVudC5udW1SaWdpZEJvZGllcyArIFwiPGJyPlwiLFxyXG4gICAgICAgIFwiY29udGFjdCAmbmJzcDsmbmJzcDtcIiArIHRoaXMucGFyZW50Lm51bUNvbnRhY3RzICsgXCI8YnI+XCIsXHJcbiAgICAgICAgXCJjdC1wb2ludCAmbmJzcDtcIiArIHRoaXMucGFyZW50Lm51bUNvbnRhY3RQb2ludHMgKyBcIjxicj5cIixcclxuICAgICAgICBcInBhaXJjaGVjayBcIiArIHRoaXMucGFyZW50LmJyb2FkUGhhc2UubnVtUGFpckNoZWNrcyArIFwiPGJyPlwiLFxyXG4gICAgICAgIFwiaXNsYW5kICZuYnNwOyZuYnNwOyZuYnNwO1wiICsgdGhpcy5wYXJlbnQubnVtSXNsYW5kcyArIFwiPGJyPjxicj5cIixcclxuICAgICAgICBcIlRpbWUgaW4gbWlsbGlzZWNvbmRzPGJyPjxicj5cIixcclxuICAgICAgICBcImJyb2FkcGhhc2UgJm5ic3A7XCIgKyBfTWF0aC5maXgodGhpcy5icm9hZFBoYXNlVGltZSkgKyBcIiB8IFwiICsgX01hdGguZml4KHRoaXMuTWF4QnJvYWRQaGFzZVRpbWUpICsgXCI8YnI+XCIsXHJcbiAgICAgICAgXCJuYXJyb3dwaGFzZSBcIiArIF9NYXRoLmZpeCh0aGlzLm5hcnJvd1BoYXNlVGltZSkgKyBcIiB8IFwiICsgX01hdGguZml4KHRoaXMuTWF4TmFycm93UGhhc2VUaW1lKSArIFwiPGJyPlwiLFxyXG4gICAgICAgIFwic29sdmluZyAmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDtcIiArIF9NYXRoLmZpeCh0aGlzLnNvbHZpbmdUaW1lKSArIFwiIHwgXCIgKyBfTWF0aC5maXgodGhpcy5NYXhTb2x2aW5nVGltZSkgKyBcIjxicj5cIixcclxuICAgICAgICBcInRvdGFsICZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwO1wiICsgX01hdGguZml4KHRoaXMudG90YWxUaW1lKSArIFwiIHwgXCIgKyBfTWF0aC5maXgodGhpcy5NYXhUb3RhbFRpbWUpICsgXCI8YnI+XCIsXHJcbiAgICAgICAgXCJ1cGRhdGluZyAmbmJzcDsmbmJzcDsmbmJzcDtcIiArIF9NYXRoLmZpeCh0aGlzLnVwZGF0ZVRpbWUpICsgXCIgfCBcIiArIF9NYXRoLmZpeCh0aGlzLk1heFVwZGF0ZVRpbWUpICsgXCI8YnI+XCJcclxuICAgICAgXS5qb2luKFwiXFxuXCIpO1xyXG4gICAgICByZXR1cm4gaW5mbztcclxuICAgIH0sXHJcblxyXG4gICAgdG9BcnJheTogZnVuY3Rpb24gKCkge1xyXG4gICAgICB0aGlzLmluZm9zWzBdID0gdGhpcy5wYXJlbnQuYnJvYWRQaGFzZS50eXBlcztcclxuICAgICAgdGhpcy5pbmZvc1sxXSA9IHRoaXMucGFyZW50Lm51bVJpZ2lkQm9kaWVzO1xyXG4gICAgICB0aGlzLmluZm9zWzJdID0gdGhpcy5wYXJlbnQubnVtQ29udGFjdHM7XHJcbiAgICAgIHRoaXMuaW5mb3NbM10gPSB0aGlzLnBhcmVudC5icm9hZFBoYXNlLm51bVBhaXJDaGVja3M7XHJcbiAgICAgIHRoaXMuaW5mb3NbNF0gPSB0aGlzLnBhcmVudC5udW1Db250YWN0UG9pbnRzO1xyXG4gICAgICB0aGlzLmluZm9zWzVdID0gdGhpcy5wYXJlbnQubnVtSXNsYW5kcztcclxuICAgICAgdGhpcy5pbmZvc1s2XSA9IHRoaXMuYnJvYWRQaGFzZVRpbWU7XHJcbiAgICAgIHRoaXMuaW5mb3NbN10gPSB0aGlzLm5hcnJvd1BoYXNlVGltZTtcclxuICAgICAgdGhpcy5pbmZvc1s4XSA9IHRoaXMuc29sdmluZ1RpbWU7XHJcbiAgICAgIHRoaXMuaW5mb3NbOV0gPSB0aGlzLnVwZGF0ZVRpbWU7XHJcbiAgICAgIHRoaXMuaW5mb3NbMTBdID0gdGhpcy50b3RhbFRpbWU7XHJcbiAgICAgIHRoaXMuaW5mb3NbMTFdID0gdGhpcy5mcHM7XHJcbiAgICAgIHJldHVybiB0aGlzLmluZm9zO1xyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gVmVjMyh4LCB5LCB6KSB7XHJcblxyXG4gICAgdGhpcy54ID0geCB8fCAwO1xyXG4gICAgdGhpcy55ID0geSB8fCAwO1xyXG4gICAgdGhpcy56ID0geiB8fCAwO1xyXG5cclxuICB9XHJcblxyXG4gIE9iamVjdC5hc3NpZ24oVmVjMy5wcm90b3R5cGUsIHtcclxuXHJcbiAgICBWZWMzOiB0cnVlLFxyXG5cclxuICAgIHNldDogZnVuY3Rpb24gKHgsIHksIHopIHtcclxuXHJcbiAgICAgIHRoaXMueCA9IHg7XHJcbiAgICAgIHRoaXMueSA9IHk7XHJcbiAgICAgIHRoaXMueiA9IHo7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgYWRkOiBmdW5jdGlvbiAoYSwgYikge1xyXG5cclxuICAgICAgaWYgKGIgIT09IHVuZGVmaW5lZCkgcmV0dXJuIHRoaXMuYWRkVmVjdG9ycyhhLCBiKTtcclxuXHJcbiAgICAgIHRoaXMueCArPSBhLng7XHJcbiAgICAgIHRoaXMueSArPSBhLnk7XHJcbiAgICAgIHRoaXMueiArPSBhLno7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgYWRkVmVjdG9yczogZnVuY3Rpb24gKGEsIGIpIHtcclxuXHJcbiAgICAgIHRoaXMueCA9IGEueCArIGIueDtcclxuICAgICAgdGhpcy55ID0gYS55ICsgYi55O1xyXG4gICAgICB0aGlzLnogPSBhLnogKyBiLno7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgYWRkRXF1YWw6IGZ1bmN0aW9uICh2KSB7XHJcblxyXG4gICAgICB0aGlzLnggKz0gdi54O1xyXG4gICAgICB0aGlzLnkgKz0gdi55O1xyXG4gICAgICB0aGlzLnogKz0gdi56O1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHN1YjogZnVuY3Rpb24gKGEsIGIpIHtcclxuXHJcbiAgICAgIGlmIChiICE9PSB1bmRlZmluZWQpIHJldHVybiB0aGlzLnN1YlZlY3RvcnMoYSwgYik7XHJcblxyXG4gICAgICB0aGlzLnggLT0gYS54O1xyXG4gICAgICB0aGlzLnkgLT0gYS55O1xyXG4gICAgICB0aGlzLnogLT0gYS56O1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHN1YlZlY3RvcnM6IGZ1bmN0aW9uIChhLCBiKSB7XHJcblxyXG4gICAgICB0aGlzLnggPSBhLnggLSBiLng7XHJcbiAgICAgIHRoaXMueSA9IGEueSAtIGIueTtcclxuICAgICAgdGhpcy56ID0gYS56IC0gYi56O1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHN1YkVxdWFsOiBmdW5jdGlvbiAodikge1xyXG5cclxuICAgICAgdGhpcy54IC09IHYueDtcclxuICAgICAgdGhpcy55IC09IHYueTtcclxuICAgICAgdGhpcy56IC09IHYuejtcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzY2FsZTogZnVuY3Rpb24gKHYsIHMpIHtcclxuXHJcbiAgICAgIHRoaXMueCA9IHYueCAqIHM7XHJcbiAgICAgIHRoaXMueSA9IHYueSAqIHM7XHJcbiAgICAgIHRoaXMueiA9IHYueiAqIHM7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc2NhbGVFcXVhbDogZnVuY3Rpb24gKHMpIHtcclxuXHJcbiAgICAgIHRoaXMueCAqPSBzO1xyXG4gICAgICB0aGlzLnkgKj0gcztcclxuICAgICAgdGhpcy56ICo9IHM7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgbXVsdGlwbHk6IGZ1bmN0aW9uICh2KSB7XHJcblxyXG4gICAgICB0aGlzLnggKj0gdi54O1xyXG4gICAgICB0aGlzLnkgKj0gdi55O1xyXG4gICAgICB0aGlzLnogKj0gdi56O1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8qc2NhbGVWOiBmdW5jdGlvbiggdiApe1xyXG5cclxuICAgICAgICB0aGlzLnggKj0gdi54O1xyXG4gICAgICAgIHRoaXMueSAqPSB2Lnk7XHJcbiAgICAgICAgdGhpcy56ICo9IHYuejtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNjYWxlVmVjdG9yRXF1YWw6IGZ1bmN0aW9uKCB2ICl7XHJcblxyXG4gICAgICAgIHRoaXMueCAqPSB2Lng7XHJcbiAgICAgICAgdGhpcy55ICo9IHYueTtcclxuICAgICAgICB0aGlzLnogKj0gdi56O1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sKi9cclxuXHJcbiAgICBhZGRTY2FsZWRWZWN0b3I6IGZ1bmN0aW9uICh2LCBzKSB7XHJcblxyXG4gICAgICB0aGlzLnggKz0gdi54ICogcztcclxuICAgICAgdGhpcy55ICs9IHYueSAqIHM7XHJcbiAgICAgIHRoaXMueiArPSB2LnogKiBzO1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzdWJTY2FsZWRWZWN0b3I6IGZ1bmN0aW9uICh2LCBzKSB7XHJcblxyXG4gICAgICB0aGlzLnggLT0gdi54ICogcztcclxuICAgICAgdGhpcy55IC09IHYueSAqIHM7XHJcbiAgICAgIHRoaXMueiAtPSB2LnogKiBzO1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvKmFkZFRpbWU6IGZ1bmN0aW9uICggdiwgdCApIHtcclxuXHJcbiAgICAgICAgdGhpcy54ICs9IHYueCAqIHQ7XHJcbiAgICAgICAgdGhpcy55ICs9IHYueSAqIHQ7XHJcbiAgICAgICAgdGhpcy56ICs9IHYueiAqIHQ7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuICAgIFxyXG4gICAgYWRkU2NhbGU6IGZ1bmN0aW9uICggdiwgcyApIHtcclxuXHJcbiAgICAgICAgdGhpcy54ICs9IHYueCAqIHM7XHJcbiAgICAgICAgdGhpcy55ICs9IHYueSAqIHM7XHJcbiAgICAgICAgdGhpcy56ICs9IHYueiAqIHM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzdWJTY2FsZTogZnVuY3Rpb24gKCB2LCBzICkge1xyXG5cclxuICAgICAgICB0aGlzLnggLT0gdi54ICogcztcclxuICAgICAgICB0aGlzLnkgLT0gdi55ICogcztcclxuICAgICAgICB0aGlzLnogLT0gdi56ICogcztcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LCovXHJcblxyXG4gICAgY3Jvc3M6IGZ1bmN0aW9uIChhLCBiKSB7XHJcblxyXG4gICAgICBpZiAoYiAhPT0gdW5kZWZpbmVkKSByZXR1cm4gdGhpcy5jcm9zc1ZlY3RvcnMoYSwgYik7XHJcblxyXG4gICAgICB2YXIgeCA9IHRoaXMueCwgeSA9IHRoaXMueSwgeiA9IHRoaXMuejtcclxuXHJcbiAgICAgIHRoaXMueCA9IHkgKiBhLnogLSB6ICogYS55O1xyXG4gICAgICB0aGlzLnkgPSB6ICogYS54IC0geCAqIGEuejtcclxuICAgICAgdGhpcy56ID0geCAqIGEueSAtIHkgKiBhLng7XHJcblxyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGNyb3NzVmVjdG9yczogZnVuY3Rpb24gKGEsIGIpIHtcclxuXHJcbiAgICAgIHZhciBheCA9IGEueCwgYXkgPSBhLnksIGF6ID0gYS56O1xyXG4gICAgICB2YXIgYnggPSBiLngsIGJ5ID0gYi55LCBieiA9IGIuejtcclxuXHJcbiAgICAgIHRoaXMueCA9IGF5ICogYnogLSBheiAqIGJ5O1xyXG4gICAgICB0aGlzLnkgPSBheiAqIGJ4IC0gYXggKiBiejtcclxuICAgICAgdGhpcy56ID0gYXggKiBieSAtIGF5ICogYng7XHJcblxyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHRhbmdlbnQ6IGZ1bmN0aW9uIChhKSB7XHJcblxyXG4gICAgICB2YXIgYXggPSBhLngsIGF5ID0gYS55LCBheiA9IGEuejtcclxuXHJcbiAgICAgIHRoaXMueCA9IGF5ICogYXggLSBheiAqIGF6O1xyXG4gICAgICB0aGlzLnkgPSAtIGF6ICogYXkgLSBheCAqIGF4O1xyXG4gICAgICB0aGlzLnogPSBheCAqIGF6ICsgYXkgKiBheTtcclxuXHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG5cclxuXHJcblxyXG5cclxuICAgIGludmVydDogZnVuY3Rpb24gKHYpIHtcclxuXHJcbiAgICAgIHRoaXMueCA9IC12Lng7XHJcbiAgICAgIHRoaXMueSA9IC12Lnk7XHJcbiAgICAgIHRoaXMueiA9IC12Lno7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgbmVnYXRlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB0aGlzLnggPSAtIHRoaXMueDtcclxuICAgICAgdGhpcy55ID0gLSB0aGlzLnk7XHJcbiAgICAgIHRoaXMueiA9IC0gdGhpcy56O1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBkb3Q6IGZ1bmN0aW9uICh2KSB7XHJcblxyXG4gICAgICByZXR1cm4gdGhpcy54ICogdi54ICsgdGhpcy55ICogdi55ICsgdGhpcy56ICogdi56O1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgYWRkaXRpb246IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHJldHVybiB0aGlzLnggKyB0aGlzLnkgKyB0aGlzLno7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBsZW5ndGhTcTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXMueCAqIHRoaXMueCArIHRoaXMueSAqIHRoaXMueSArIHRoaXMueiAqIHRoaXMuejtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGxlbmd0aDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgcmV0dXJuIF9NYXRoLnNxcnQodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55ICsgdGhpcy56ICogdGhpcy56KTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGNvcHk6IGZ1bmN0aW9uICh2KSB7XHJcblxyXG4gICAgICB0aGlzLnggPSB2Lng7XHJcbiAgICAgIHRoaXMueSA9IHYueTtcclxuICAgICAgdGhpcy56ID0gdi56O1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8qbXVsOiBmdW5jdGlvbiggYiwgYSwgbSApe1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5tdWxNYXQoIG0sIGEgKS5hZGQoIGIgKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIG11bE1hdDogZnVuY3Rpb24oIG0sIGEgKXtcclxuXHJcbiAgICAgICAgdmFyIGUgPSBtLmVsZW1lbnRzO1xyXG4gICAgICAgIHZhciB4ID0gYS54LCB5ID0gYS55LCB6ID0gYS56O1xyXG5cclxuICAgICAgICB0aGlzLnggPSBlWyAwIF0gKiB4ICsgZVsgMSBdICogeSArIGVbIDIgXSAqIHo7XHJcbiAgICAgICAgdGhpcy55ID0gZVsgMyBdICogeCArIGVbIDQgXSAqIHkgKyBlWyA1IF0gKiB6O1xyXG4gICAgICAgIHRoaXMueiA9IGVbIDYgXSAqIHggKyBlWyA3IF0gKiB5ICsgZVsgOCBdICogejtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LCovXHJcblxyXG4gICAgYXBwbHlNYXRyaXgzOiBmdW5jdGlvbiAobSwgdHJhbnNwb3NlKSB7XHJcblxyXG4gICAgICAvL2lmKCB0cmFuc3Bvc2UgKSBtID0gbS5jbG9uZSgpLnRyYW5zcG9zZSgpO1xyXG4gICAgICB2YXIgeCA9IHRoaXMueCwgeSA9IHRoaXMueSwgeiA9IHRoaXMuejtcclxuICAgICAgdmFyIGUgPSBtLmVsZW1lbnRzO1xyXG5cclxuICAgICAgaWYgKHRyYW5zcG9zZSkge1xyXG5cclxuICAgICAgICB0aGlzLnggPSBlWzBdICogeCArIGVbMV0gKiB5ICsgZVsyXSAqIHo7XHJcbiAgICAgICAgdGhpcy55ID0gZVszXSAqIHggKyBlWzRdICogeSArIGVbNV0gKiB6O1xyXG4gICAgICAgIHRoaXMueiA9IGVbNl0gKiB4ICsgZVs3XSAqIHkgKyBlWzhdICogejtcclxuXHJcbiAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgIHRoaXMueCA9IGVbMF0gKiB4ICsgZVszXSAqIHkgKyBlWzZdICogejtcclxuICAgICAgICB0aGlzLnkgPSBlWzFdICogeCArIGVbNF0gKiB5ICsgZVs3XSAqIHo7XHJcbiAgICAgICAgdGhpcy56ID0gZVsyXSAqIHggKyBlWzVdICogeSArIGVbOF0gKiB6O1xyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGFwcGx5UXVhdGVybmlvbjogZnVuY3Rpb24gKHEpIHtcclxuXHJcbiAgICAgIHZhciB4ID0gdGhpcy54O1xyXG4gICAgICB2YXIgeSA9IHRoaXMueTtcclxuICAgICAgdmFyIHogPSB0aGlzLno7XHJcblxyXG4gICAgICB2YXIgcXggPSBxLng7XHJcbiAgICAgIHZhciBxeSA9IHEueTtcclxuICAgICAgdmFyIHF6ID0gcS56O1xyXG4gICAgICB2YXIgcXcgPSBxLnc7XHJcblxyXG4gICAgICAvLyBjYWxjdWxhdGUgcXVhdCAqIHZlY3RvclxyXG5cclxuICAgICAgdmFyIGl4ID0gcXcgKiB4ICsgcXkgKiB6IC0gcXogKiB5O1xyXG4gICAgICB2YXIgaXkgPSBxdyAqIHkgKyBxeiAqIHggLSBxeCAqIHo7XHJcbiAgICAgIHZhciBpeiA9IHF3ICogeiArIHF4ICogeSAtIHF5ICogeDtcclxuICAgICAgdmFyIGl3ID0gLSBxeCAqIHggLSBxeSAqIHkgLSBxeiAqIHo7XHJcblxyXG4gICAgICAvLyBjYWxjdWxhdGUgcmVzdWx0ICogaW52ZXJzZSBxdWF0XHJcblxyXG4gICAgICB0aGlzLnggPSBpeCAqIHF3ICsgaXcgKiAtIHF4ICsgaXkgKiAtIHF6IC0gaXogKiAtIHF5O1xyXG4gICAgICB0aGlzLnkgPSBpeSAqIHF3ICsgaXcgKiAtIHF5ICsgaXogKiAtIHF4IC0gaXggKiAtIHF6O1xyXG4gICAgICB0aGlzLnogPSBpeiAqIHF3ICsgaXcgKiAtIHF6ICsgaXggKiAtIHF5IC0gaXkgKiAtIHF4O1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB0ZXN0WmVybzogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgaWYgKHRoaXMueCAhPT0gMCB8fCB0aGlzLnkgIT09IDAgfHwgdGhpcy56ICE9PSAwKSByZXR1cm4gdHJ1ZTtcclxuICAgICAgZWxzZSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB0ZXN0RGlmZjogZnVuY3Rpb24gKHYpIHtcclxuXHJcbiAgICAgIHJldHVybiB0aGlzLmVxdWFscyh2KSA/IGZhbHNlIDogdHJ1ZTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGVxdWFsczogZnVuY3Rpb24gKHYpIHtcclxuXHJcbiAgICAgIHJldHVybiB2LnggPT09IHRoaXMueCAmJiB2LnkgPT09IHRoaXMueSAmJiB2LnogPT09IHRoaXMuejtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGNsb25lOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IodGhpcy54LCB0aGlzLnksIHRoaXMueik7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB0b1N0cmluZzogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgcmV0dXJuIFwiVmVjM1tcIiArIHRoaXMueC50b0ZpeGVkKDQpICsgXCIsIFwiICsgdGhpcy55LnRvRml4ZWQoNCkgKyBcIiwgXCIgKyB0aGlzLnoudG9GaXhlZCg0KSArIFwiXVwiO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgbXVsdGlwbHlTY2FsYXI6IGZ1bmN0aW9uIChzY2FsYXIpIHtcclxuXHJcbiAgICAgIGlmIChpc0Zpbml0ZShzY2FsYXIpKSB7XHJcbiAgICAgICAgdGhpcy54ICo9IHNjYWxhcjtcclxuICAgICAgICB0aGlzLnkgKj0gc2NhbGFyO1xyXG4gICAgICAgIHRoaXMueiAqPSBzY2FsYXI7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy54ID0gMDtcclxuICAgICAgICB0aGlzLnkgPSAwO1xyXG4gICAgICAgIHRoaXMueiA9IDA7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgZGl2aWRlU2NhbGFyOiBmdW5jdGlvbiAoc2NhbGFyKSB7XHJcblxyXG4gICAgICByZXR1cm4gdGhpcy5tdWx0aXBseVNjYWxhcigxIC8gc2NhbGFyKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIG5vcm1hbGl6ZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXMuZGl2aWRlU2NhbGFyKHRoaXMubGVuZ3RoKCkpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdG9BcnJheTogZnVuY3Rpb24gKGFycmF5LCBvZmZzZXQpIHtcclxuXHJcbiAgICAgIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkgb2Zmc2V0ID0gMDtcclxuXHJcbiAgICAgIGFycmF5W29mZnNldF0gPSB0aGlzLng7XHJcbiAgICAgIGFycmF5W29mZnNldCArIDFdID0gdGhpcy55O1xyXG4gICAgICBhcnJheVtvZmZzZXQgKyAyXSA9IHRoaXMuejtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGZyb21BcnJheTogZnVuY3Rpb24gKGFycmF5LCBvZmZzZXQpIHtcclxuXHJcbiAgICAgIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkgb2Zmc2V0ID0gMDtcclxuXHJcbiAgICAgIHRoaXMueCA9IGFycmF5W29mZnNldF07XHJcbiAgICAgIHRoaXMueSA9IGFycmF5W29mZnNldCArIDFdO1xyXG4gICAgICB0aGlzLnogPSBhcnJheVtvZmZzZXQgKyAyXTtcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcblxyXG4gIH0pO1xyXG5cclxuICBmdW5jdGlvbiBRdWF0KHgsIHksIHosIHcpIHtcclxuXHJcbiAgICB0aGlzLnggPSB4IHx8IDA7XHJcbiAgICB0aGlzLnkgPSB5IHx8IDA7XHJcbiAgICB0aGlzLnogPSB6IHx8IDA7XHJcbiAgICB0aGlzLncgPSAodyAhPT0gdW5kZWZpbmVkKSA/IHcgOiAxO1xyXG5cclxuICB9XHJcblxyXG4gIE9iamVjdC5hc3NpZ24oUXVhdC5wcm90b3R5cGUsIHtcclxuXHJcbiAgICBRdWF0OiB0cnVlLFxyXG5cclxuICAgIHNldDogZnVuY3Rpb24gKHgsIHksIHosIHcpIHtcclxuXHJcblxyXG4gICAgICB0aGlzLnggPSB4O1xyXG4gICAgICB0aGlzLnkgPSB5O1xyXG4gICAgICB0aGlzLnogPSB6O1xyXG4gICAgICB0aGlzLncgPSB3O1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBhZGRUaW1lOiBmdW5jdGlvbiAodiwgdCkge1xyXG5cclxuICAgICAgdmFyIGF4ID0gdi54LCBheSA9IHYueSwgYXogPSB2Lno7XHJcbiAgICAgIHZhciBxdyA9IHRoaXMudywgcXggPSB0aGlzLngsIHF5ID0gdGhpcy55LCBxeiA9IHRoaXMuejtcclxuICAgICAgdCAqPSAwLjU7XHJcbiAgICAgIHRoaXMueCArPSB0ICogKGF4ICogcXcgKyBheSAqIHF6IC0gYXogKiBxeSk7XHJcbiAgICAgIHRoaXMueSArPSB0ICogKGF5ICogcXcgKyBheiAqIHF4IC0gYXggKiBxeik7XHJcbiAgICAgIHRoaXMueiArPSB0ICogKGF6ICogcXcgKyBheCAqIHF5IC0gYXkgKiBxeCk7XHJcbiAgICAgIHRoaXMudyArPSB0ICogKC1heCAqIHF4IC0gYXkgKiBxeSAtIGF6ICogcXopO1xyXG4gICAgICB0aGlzLm5vcm1hbGl6ZSgpO1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8qbXVsOiBmdW5jdGlvbiggcTEsIHEyICl7XHJcblxyXG4gICAgICAgIHZhciBheCA9IHExLngsIGF5ID0gcTEueSwgYXogPSBxMS56LCBhcyA9IHExLncsXHJcbiAgICAgICAgYnggPSBxMi54LCBieSA9IHEyLnksIGJ6ID0gcTIueiwgYnMgPSBxMi53O1xyXG4gICAgICAgIHRoaXMueCA9IGF4ICogYnMgKyBhcyAqIGJ4ICsgYXkgKiBieiAtIGF6ICogYnk7XHJcbiAgICAgICAgdGhpcy55ID0gYXkgKiBicyArIGFzICogYnkgKyBheiAqIGJ4IC0gYXggKiBiejtcclxuICAgICAgICB0aGlzLnogPSBheiAqIGJzICsgYXMgKiBieiArIGF4ICogYnkgLSBheSAqIGJ4O1xyXG4gICAgICAgIHRoaXMudyA9IGFzICogYnMgLSBheCAqIGJ4IC0gYXkgKiBieSAtIGF6ICogYno7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSwqL1xyXG5cclxuICAgIG11bHRpcGx5OiBmdW5jdGlvbiAocSwgcCkge1xyXG5cclxuICAgICAgaWYgKHAgIT09IHVuZGVmaW5lZCkgcmV0dXJuIHRoaXMubXVsdGlwbHlRdWF0ZXJuaW9ucyhxLCBwKTtcclxuICAgICAgcmV0dXJuIHRoaXMubXVsdGlwbHlRdWF0ZXJuaW9ucyh0aGlzLCBxKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIG11bHRpcGx5UXVhdGVybmlvbnM6IGZ1bmN0aW9uIChhLCBiKSB7XHJcblxyXG4gICAgICB2YXIgcWF4ID0gYS54LCBxYXkgPSBhLnksIHFheiA9IGEueiwgcWF3ID0gYS53O1xyXG4gICAgICB2YXIgcWJ4ID0gYi54LCBxYnkgPSBiLnksIHFieiA9IGIueiwgcWJ3ID0gYi53O1xyXG5cclxuICAgICAgdGhpcy54ID0gcWF4ICogcWJ3ICsgcWF3ICogcWJ4ICsgcWF5ICogcWJ6IC0gcWF6ICogcWJ5O1xyXG4gICAgICB0aGlzLnkgPSBxYXkgKiBxYncgKyBxYXcgKiBxYnkgKyBxYXogKiBxYnggLSBxYXggKiBxYno7XHJcbiAgICAgIHRoaXMueiA9IHFheiAqIHFidyArIHFhdyAqIHFieiArIHFheCAqIHFieSAtIHFheSAqIHFieDtcclxuICAgICAgdGhpcy53ID0gcWF3ICogcWJ3IC0gcWF4ICogcWJ4IC0gcWF5ICogcWJ5IC0gcWF6ICogcWJ6O1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNldEZyb21Vbml0VmVjdG9yczogZnVuY3Rpb24gKHYxLCB2Mikge1xyXG5cclxuICAgICAgdmFyIHZ4ID0gbmV3IFZlYzMoKTtcclxuICAgICAgdmFyIHIgPSB2MS5kb3QodjIpICsgMTtcclxuXHJcbiAgICAgIGlmIChyIDwgX01hdGguRVBTMikge1xyXG5cclxuICAgICAgICByID0gMDtcclxuICAgICAgICBpZiAoX01hdGguYWJzKHYxLngpID4gX01hdGguYWJzKHYxLnopKSB2eC5zZXQoLSB2MS55LCB2MS54LCAwKTtcclxuICAgICAgICBlbHNlIHZ4LnNldCgwLCAtIHYxLnosIHYxLnkpO1xyXG5cclxuICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgdnguY3Jvc3NWZWN0b3JzKHYxLCB2Mik7XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLl94ID0gdngueDtcclxuICAgICAgdGhpcy5feSA9IHZ4Lnk7XHJcbiAgICAgIHRoaXMuX3ogPSB2eC56O1xyXG4gICAgICB0aGlzLl93ID0gcjtcclxuXHJcbiAgICAgIHJldHVybiB0aGlzLm5vcm1hbGl6ZSgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgYXJjOiBmdW5jdGlvbiAodjEsIHYyKSB7XHJcblxyXG4gICAgICB2YXIgeDEgPSB2MS54O1xyXG4gICAgICB2YXIgeTEgPSB2MS55O1xyXG4gICAgICB2YXIgejEgPSB2MS56O1xyXG4gICAgICB2YXIgeDIgPSB2Mi54O1xyXG4gICAgICB2YXIgeTIgPSB2Mi55O1xyXG4gICAgICB2YXIgejIgPSB2Mi56O1xyXG4gICAgICB2YXIgZCA9IHgxICogeDIgKyB5MSAqIHkyICsgejEgKiB6MjtcclxuICAgICAgaWYgKGQgPT0gLTEpIHtcclxuICAgICAgICB4MiA9IHkxICogeDEgLSB6MSAqIHoxO1xyXG4gICAgICAgIHkyID0gLXoxICogeTEgLSB4MSAqIHgxO1xyXG4gICAgICAgIHoyID0geDEgKiB6MSArIHkxICogeTE7XHJcbiAgICAgICAgZCA9IDEgLyBfTWF0aC5zcXJ0KHgyICogeDIgKyB5MiAqIHkyICsgejIgKiB6Mik7XHJcbiAgICAgICAgdGhpcy53ID0gMDtcclxuICAgICAgICB0aGlzLnggPSB4MiAqIGQ7XHJcbiAgICAgICAgdGhpcy55ID0geTIgKiBkO1xyXG4gICAgICAgIHRoaXMueiA9IHoyICogZDtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgfVxyXG4gICAgICB2YXIgY3ggPSB5MSAqIHoyIC0gejEgKiB5MjtcclxuICAgICAgdmFyIGN5ID0gejEgKiB4MiAtIHgxICogejI7XHJcbiAgICAgIHZhciBjeiA9IHgxICogeTIgLSB5MSAqIHgyO1xyXG4gICAgICB0aGlzLncgPSBfTWF0aC5zcXJ0KCgxICsgZCkgKiAwLjUpO1xyXG4gICAgICBkID0gMC41IC8gdGhpcy53O1xyXG4gICAgICB0aGlzLnggPSBjeCAqIGQ7XHJcbiAgICAgIHRoaXMueSA9IGN5ICogZDtcclxuICAgICAgdGhpcy56ID0gY3ogKiBkO1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIG5vcm1hbGl6ZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdmFyIGwgPSB0aGlzLmxlbmd0aCgpO1xyXG4gICAgICBpZiAobCA9PT0gMCkge1xyXG4gICAgICAgIHRoaXMuc2V0KDAsIDAsIDAsIDEpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGwgPSAxIC8gbDtcclxuICAgICAgICB0aGlzLnggPSB0aGlzLnggKiBsO1xyXG4gICAgICAgIHRoaXMueSA9IHRoaXMueSAqIGw7XHJcbiAgICAgICAgdGhpcy56ID0gdGhpcy56ICogbDtcclxuICAgICAgICB0aGlzLncgPSB0aGlzLncgKiBsO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgaW52ZXJzZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXMuY29uanVnYXRlKCkubm9ybWFsaXplKCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBpbnZlcnQ6IGZ1bmN0aW9uIChxKSB7XHJcblxyXG4gICAgICB0aGlzLnggPSBxLng7XHJcbiAgICAgIHRoaXMueSA9IHEueTtcclxuICAgICAgdGhpcy56ID0gcS56O1xyXG4gICAgICB0aGlzLncgPSBxLnc7XHJcbiAgICAgIHRoaXMuY29uanVnYXRlKCkubm9ybWFsaXplKCk7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY29uanVnYXRlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB0aGlzLnggKj0gLSAxO1xyXG4gICAgICB0aGlzLnkgKj0gLSAxO1xyXG4gICAgICB0aGlzLnogKj0gLSAxO1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGxlbmd0aDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgcmV0dXJuIF9NYXRoLnNxcnQodGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55ICsgdGhpcy56ICogdGhpcy56ICsgdGhpcy53ICogdGhpcy53KTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGxlbmd0aFNxOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICByZXR1cm4gdGhpcy54ICogdGhpcy54ICsgdGhpcy55ICogdGhpcy55ICsgdGhpcy56ICogdGhpcy56ICsgdGhpcy53ICogdGhpcy53O1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY29weTogZnVuY3Rpb24gKHEpIHtcclxuXHJcbiAgICAgIHRoaXMueCA9IHEueDtcclxuICAgICAgdGhpcy55ID0gcS55O1xyXG4gICAgICB0aGlzLnogPSBxLno7XHJcbiAgICAgIHRoaXMudyA9IHEudztcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBjbG9uZTogZnVuY3Rpb24gKHEpIHtcclxuXHJcbiAgICAgIHJldHVybiBuZXcgUXVhdCh0aGlzLngsIHRoaXMueSwgdGhpcy56LCB0aGlzLncpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdGVzdERpZmY6IGZ1bmN0aW9uIChxKSB7XHJcblxyXG4gICAgICByZXR1cm4gdGhpcy5lcXVhbHMocSkgPyBmYWxzZSA6IHRydWU7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBlcXVhbHM6IGZ1bmN0aW9uIChxKSB7XHJcblxyXG4gICAgICByZXR1cm4gdGhpcy54ID09PSBxLnggJiYgdGhpcy55ID09PSBxLnkgJiYgdGhpcy56ID09PSBxLnogJiYgdGhpcy53ID09PSBxLnc7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB0b1N0cmluZzogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgcmV0dXJuIFwiUXVhdFtcIiArIHRoaXMueC50b0ZpeGVkKDQpICsgXCIsIChcIiArIHRoaXMueS50b0ZpeGVkKDQpICsgXCIsIFwiICsgdGhpcy56LnRvRml4ZWQoNCkgKyBcIiwgXCIgKyB0aGlzLncudG9GaXhlZCg0KSArIFwiKV1cIjtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNldEZyb21FdWxlcjogZnVuY3Rpb24gKHgsIHksIHopIHtcclxuXHJcbiAgICAgIHZhciBjMSA9IE1hdGguY29zKHggKiAwLjUpO1xyXG4gICAgICB2YXIgYzIgPSBNYXRoLmNvcyh5ICogMC41KTtcclxuICAgICAgdmFyIGMzID0gTWF0aC5jb3MoeiAqIDAuNSk7XHJcbiAgICAgIHZhciBzMSA9IE1hdGguc2luKHggKiAwLjUpO1xyXG4gICAgICB2YXIgczIgPSBNYXRoLnNpbih5ICogMC41KTtcclxuICAgICAgdmFyIHMzID0gTWF0aC5zaW4oeiAqIDAuNSk7XHJcblxyXG4gICAgICAvLyBYWVpcclxuICAgICAgdGhpcy54ID0gczEgKiBjMiAqIGMzICsgYzEgKiBzMiAqIHMzO1xyXG4gICAgICB0aGlzLnkgPSBjMSAqIHMyICogYzMgLSBzMSAqIGMyICogczM7XHJcbiAgICAgIHRoaXMueiA9IGMxICogYzIgKiBzMyArIHMxICogczIgKiBjMztcclxuICAgICAgdGhpcy53ID0gYzEgKiBjMiAqIGMzIC0gczEgKiBzMiAqIHMzO1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzZXRGcm9tQXhpczogZnVuY3Rpb24gKGF4aXMsIHJhZCkge1xyXG5cclxuICAgICAgYXhpcy5ub3JtYWxpemUoKTtcclxuICAgICAgcmFkID0gcmFkICogMC41O1xyXG4gICAgICB2YXIgcyA9IF9NYXRoLnNpbihyYWQpO1xyXG4gICAgICB0aGlzLnggPSBzICogYXhpcy54O1xyXG4gICAgICB0aGlzLnkgPSBzICogYXhpcy55O1xyXG4gICAgICB0aGlzLnogPSBzICogYXhpcy56O1xyXG4gICAgICB0aGlzLncgPSBfTWF0aC5jb3MocmFkKTtcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzZXRGcm9tTWF0MzM6IGZ1bmN0aW9uIChtKSB7XHJcblxyXG4gICAgICB2YXIgdHJhY2UgPSBtWzBdICsgbVs0XSArIG1bOF07XHJcbiAgICAgIHZhciBzO1xyXG5cclxuICAgICAgaWYgKHRyYWNlID4gMCkge1xyXG5cclxuICAgICAgICBzID0gX01hdGguc3FydCh0cmFjZSArIDEuMCk7XHJcbiAgICAgICAgdGhpcy53ID0gMC41IC8gcztcclxuICAgICAgICBzID0gMC41IC8gcztcclxuICAgICAgICB0aGlzLnggPSAobVs1XSAtIG1bN10pICogcztcclxuICAgICAgICB0aGlzLnkgPSAobVs2XSAtIG1bMl0pICogcztcclxuICAgICAgICB0aGlzLnogPSAobVsxXSAtIG1bM10pICogcztcclxuXHJcbiAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgIHZhciBvdXQgPSBbXTtcclxuICAgICAgICB2YXIgaSA9IDA7XHJcbiAgICAgICAgaWYgKG1bNF0gPiBtWzBdKSBpID0gMTtcclxuICAgICAgICBpZiAobVs4XSA+IG1baSAqIDMgKyBpXSkgaSA9IDI7XHJcblxyXG4gICAgICAgIHZhciBqID0gKGkgKyAxKSAlIDM7XHJcbiAgICAgICAgdmFyIGsgPSAoaSArIDIpICUgMztcclxuXHJcbiAgICAgICAgcyA9IF9NYXRoLnNxcnQobVtpICogMyArIGldIC0gbVtqICogMyArIGpdIC0gbVtrICogMyArIGtdICsgMS4wKTtcclxuICAgICAgICBvdXRbaV0gPSAwLjUgKiBmUm9vdDtcclxuICAgICAgICBzID0gMC41IC8gZlJvb3Q7XHJcbiAgICAgICAgdGhpcy53ID0gKG1baiAqIDMgKyBrXSAtIG1bayAqIDMgKyBqXSkgKiBzO1xyXG4gICAgICAgIG91dFtqXSA9IChtW2ogKiAzICsgaV0gKyBtW2kgKiAzICsgal0pICogcztcclxuICAgICAgICBvdXRba10gPSAobVtrICogMyArIGldICsgbVtpICogMyArIGtdKSAqIHM7XHJcblxyXG4gICAgICAgIHRoaXMueCA9IG91dFsxXTtcclxuICAgICAgICB0aGlzLnkgPSBvdXRbMl07XHJcbiAgICAgICAgdGhpcy56ID0gb3V0WzNdO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB0b0FycmF5OiBmdW5jdGlvbiAoYXJyYXksIG9mZnNldCkge1xyXG5cclxuICAgICAgb2Zmc2V0ID0gb2Zmc2V0IHx8IDA7XHJcblxyXG4gICAgICBhcnJheVtvZmZzZXRdID0gdGhpcy54O1xyXG4gICAgICBhcnJheVtvZmZzZXQgKyAxXSA9IHRoaXMueTtcclxuICAgICAgYXJyYXlbb2Zmc2V0ICsgMl0gPSB0aGlzLno7XHJcbiAgICAgIGFycmF5W29mZnNldCArIDNdID0gdGhpcy53O1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgZnJvbUFycmF5OiBmdW5jdGlvbiAoYXJyYXksIG9mZnNldCkge1xyXG5cclxuICAgICAgb2Zmc2V0ID0gb2Zmc2V0IHx8IDA7XHJcbiAgICAgIHRoaXMuc2V0KGFycmF5W29mZnNldF0sIGFycmF5W29mZnNldCArIDFdLCBhcnJheVtvZmZzZXQgKyAyXSwgYXJyYXlbb2Zmc2V0ICsgM10pO1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICBmdW5jdGlvbiBNYXQzMyhlMDAsIGUwMSwgZTAyLCBlMTAsIGUxMSwgZTEyLCBlMjAsIGUyMSwgZTIyKSB7XHJcblxyXG4gICAgdGhpcy5lbGVtZW50cyA9IFtcclxuICAgICAgMSwgMCwgMCxcclxuICAgICAgMCwgMSwgMCxcclxuICAgICAgMCwgMCwgMVxyXG4gICAgXTtcclxuXHJcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDApIHtcclxuXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ09JTU8uTWF0MzM6IHRoZSBjb25zdHJ1Y3RvciBubyBsb25nZXIgcmVhZHMgYXJndW1lbnRzLiB1c2UgLnNldCgpIGluc3RlYWQuJyk7XHJcblxyXG4gICAgfVxyXG5cclxuICB9XHJcblxyXG4gIE9iamVjdC5hc3NpZ24oTWF0MzMucHJvdG90eXBlLCB7XHJcblxyXG4gICAgTWF0MzM6IHRydWUsXHJcblxyXG4gICAgc2V0OiBmdW5jdGlvbiAoZTAwLCBlMDEsIGUwMiwgZTEwLCBlMTEsIGUxMiwgZTIwLCBlMjEsIGUyMikge1xyXG5cclxuICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcclxuICAgICAgdGVbMF0gPSBlMDA7IHRlWzFdID0gZTAxOyB0ZVsyXSA9IGUwMjtcclxuICAgICAgdGVbM10gPSBlMTA7IHRlWzRdID0gZTExOyB0ZVs1XSA9IGUxMjtcclxuICAgICAgdGVbNl0gPSBlMjA7IHRlWzddID0gZTIxOyB0ZVs4XSA9IGUyMjtcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBhZGQ6IGZ1bmN0aW9uIChhLCBiKSB7XHJcblxyXG4gICAgICBpZiAoYiAhPT0gdW5kZWZpbmVkKSByZXR1cm4gdGhpcy5hZGRNYXRyaXhzKGEsIGIpO1xyXG5cclxuICAgICAgdmFyIGUgPSB0aGlzLmVsZW1lbnRzLCB0ZSA9IGEuZWxlbWVudHM7XHJcbiAgICAgIGVbMF0gKz0gdGVbMF07IGVbMV0gKz0gdGVbMV07IGVbMl0gKz0gdGVbMl07XHJcbiAgICAgIGVbM10gKz0gdGVbM107IGVbNF0gKz0gdGVbNF07IGVbNV0gKz0gdGVbNV07XHJcbiAgICAgIGVbNl0gKz0gdGVbNl07IGVbN10gKz0gdGVbN107IGVbOF0gKz0gdGVbOF07XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgYWRkTWF0cml4czogZnVuY3Rpb24gKGEsIGIpIHtcclxuXHJcbiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsIHRlbTEgPSBhLmVsZW1lbnRzLCB0ZW0yID0gYi5lbGVtZW50cztcclxuICAgICAgdGVbMF0gPSB0ZW0xWzBdICsgdGVtMlswXTsgdGVbMV0gPSB0ZW0xWzFdICsgdGVtMlsxXTsgdGVbMl0gPSB0ZW0xWzJdICsgdGVtMlsyXTtcclxuICAgICAgdGVbM10gPSB0ZW0xWzNdICsgdGVtMlszXTsgdGVbNF0gPSB0ZW0xWzRdICsgdGVtMls0XTsgdGVbNV0gPSB0ZW0xWzVdICsgdGVtMls1XTtcclxuICAgICAgdGVbNl0gPSB0ZW0xWzZdICsgdGVtMls2XTsgdGVbN10gPSB0ZW0xWzddICsgdGVtMls3XTsgdGVbOF0gPSB0ZW0xWzhdICsgdGVtMls4XTtcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBhZGRFcXVhbDogZnVuY3Rpb24gKG0pIHtcclxuXHJcbiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsIHRlbSA9IG0uZWxlbWVudHM7XHJcbiAgICAgIHRlWzBdICs9IHRlbVswXTsgdGVbMV0gKz0gdGVtWzFdOyB0ZVsyXSArPSB0ZW1bMl07XHJcbiAgICAgIHRlWzNdICs9IHRlbVszXTsgdGVbNF0gKz0gdGVtWzRdOyB0ZVs1XSArPSB0ZW1bNV07XHJcbiAgICAgIHRlWzZdICs9IHRlbVs2XTsgdGVbN10gKz0gdGVtWzddOyB0ZVs4XSArPSB0ZW1bOF07XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc3ViOiBmdW5jdGlvbiAoYSwgYikge1xyXG5cclxuICAgICAgaWYgKGIgIT09IHVuZGVmaW5lZCkgcmV0dXJuIHRoaXMuc3ViTWF0cml4cyhhLCBiKTtcclxuXHJcbiAgICAgIHZhciBlID0gdGhpcy5lbGVtZW50cywgdGUgPSBhLmVsZW1lbnRzO1xyXG4gICAgICBlWzBdIC09IHRlWzBdOyBlWzFdIC09IHRlWzFdOyBlWzJdIC09IHRlWzJdO1xyXG4gICAgICBlWzNdIC09IHRlWzNdOyBlWzRdIC09IHRlWzRdOyBlWzVdIC09IHRlWzVdO1xyXG4gICAgICBlWzZdIC09IHRlWzZdOyBlWzddIC09IHRlWzddOyBlWzhdIC09IHRlWzhdO1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHN1Yk1hdHJpeHM6IGZ1bmN0aW9uIChhLCBiKSB7XHJcblxyXG4gICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLCB0ZW0xID0gYS5lbGVtZW50cywgdGVtMiA9IGIuZWxlbWVudHM7XHJcbiAgICAgIHRlWzBdID0gdGVtMVswXSAtIHRlbTJbMF07IHRlWzFdID0gdGVtMVsxXSAtIHRlbTJbMV07IHRlWzJdID0gdGVtMVsyXSAtIHRlbTJbMl07XHJcbiAgICAgIHRlWzNdID0gdGVtMVszXSAtIHRlbTJbM107IHRlWzRdID0gdGVtMVs0XSAtIHRlbTJbNF07IHRlWzVdID0gdGVtMVs1XSAtIHRlbTJbNV07XHJcbiAgICAgIHRlWzZdID0gdGVtMVs2XSAtIHRlbTJbNl07IHRlWzddID0gdGVtMVs3XSAtIHRlbTJbN107IHRlWzhdID0gdGVtMVs4XSAtIHRlbTJbOF07XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc3ViRXF1YWw6IGZ1bmN0aW9uIChtKSB7XHJcblxyXG4gICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLCB0ZW0gPSBtLmVsZW1lbnRzO1xyXG4gICAgICB0ZVswXSAtPSB0ZW1bMF07IHRlWzFdIC09IHRlbVsxXTsgdGVbMl0gLT0gdGVtWzJdO1xyXG4gICAgICB0ZVszXSAtPSB0ZW1bM107IHRlWzRdIC09IHRlbVs0XTsgdGVbNV0gLT0gdGVtWzVdO1xyXG4gICAgICB0ZVs2XSAtPSB0ZW1bNl07IHRlWzddIC09IHRlbVs3XTsgdGVbOF0gLT0gdGVtWzhdO1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNjYWxlOiBmdW5jdGlvbiAobSwgcykge1xyXG5cclxuICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cywgdG0gPSBtLmVsZW1lbnRzO1xyXG4gICAgICB0ZVswXSA9IHRtWzBdICogczsgdGVbMV0gPSB0bVsxXSAqIHM7IHRlWzJdID0gdG1bMl0gKiBzO1xyXG4gICAgICB0ZVszXSA9IHRtWzNdICogczsgdGVbNF0gPSB0bVs0XSAqIHM7IHRlWzVdID0gdG1bNV0gKiBzO1xyXG4gICAgICB0ZVs2XSA9IHRtWzZdICogczsgdGVbN10gPSB0bVs3XSAqIHM7IHRlWzhdID0gdG1bOF0gKiBzO1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNjYWxlRXF1YWw6IGZ1bmN0aW9uIChzKSB7Ly8gbXVsdGlwbHlTY2FsYXJcclxuXHJcbiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XHJcbiAgICAgIHRlWzBdICo9IHM7IHRlWzFdICo9IHM7IHRlWzJdICo9IHM7XHJcbiAgICAgIHRlWzNdICo9IHM7IHRlWzRdICo9IHM7IHRlWzVdICo9IHM7XHJcbiAgICAgIHRlWzZdICo9IHM7IHRlWzddICo9IHM7IHRlWzhdICo9IHM7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgbXVsdGlwbHlNYXRyaWNlczogZnVuY3Rpb24gKG0xLCBtMiwgdHJhbnNwb3NlKSB7XHJcblxyXG4gICAgICBpZiAodHJhbnNwb3NlKSBtMiA9IG0yLmNsb25lKCkudHJhbnNwb3NlKCk7XHJcblxyXG4gICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xyXG4gICAgICB2YXIgdG0xID0gbTEuZWxlbWVudHM7XHJcbiAgICAgIHZhciB0bTIgPSBtMi5lbGVtZW50cztcclxuXHJcbiAgICAgIHZhciBhMCA9IHRtMVswXSwgYTMgPSB0bTFbM10sIGE2ID0gdG0xWzZdO1xyXG4gICAgICB2YXIgYTEgPSB0bTFbMV0sIGE0ID0gdG0xWzRdLCBhNyA9IHRtMVs3XTtcclxuICAgICAgdmFyIGEyID0gdG0xWzJdLCBhNSA9IHRtMVs1XSwgYTggPSB0bTFbOF07XHJcblxyXG4gICAgICB2YXIgYjAgPSB0bTJbMF0sIGIzID0gdG0yWzNdLCBiNiA9IHRtMls2XTtcclxuICAgICAgdmFyIGIxID0gdG0yWzFdLCBiNCA9IHRtMls0XSwgYjcgPSB0bTJbN107XHJcbiAgICAgIHZhciBiMiA9IHRtMlsyXSwgYjUgPSB0bTJbNV0sIGI4ID0gdG0yWzhdO1xyXG5cclxuICAgICAgdGVbMF0gPSBhMCAqIGIwICsgYTEgKiBiMyArIGEyICogYjY7XHJcbiAgICAgIHRlWzFdID0gYTAgKiBiMSArIGExICogYjQgKyBhMiAqIGI3O1xyXG4gICAgICB0ZVsyXSA9IGEwICogYjIgKyBhMSAqIGI1ICsgYTIgKiBiODtcclxuICAgICAgdGVbM10gPSBhMyAqIGIwICsgYTQgKiBiMyArIGE1ICogYjY7XHJcbiAgICAgIHRlWzRdID0gYTMgKiBiMSArIGE0ICogYjQgKyBhNSAqIGI3O1xyXG4gICAgICB0ZVs1XSA9IGEzICogYjIgKyBhNCAqIGI1ICsgYTUgKiBiODtcclxuICAgICAgdGVbNl0gPSBhNiAqIGIwICsgYTcgKiBiMyArIGE4ICogYjY7XHJcbiAgICAgIHRlWzddID0gYTYgKiBiMSArIGE3ICogYjQgKyBhOCAqIGI3O1xyXG4gICAgICB0ZVs4XSA9IGE2ICogYjIgKyBhNyAqIGI1ICsgYTggKiBiODtcclxuXHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLyptdWw6IGZ1bmN0aW9uICggbTEsIG0yLCB0cmFuc3Bvc2UgKSB7XHJcblxyXG4gICAgICAgIGlmKCB0cmFuc3Bvc2UgKSBtMiA9IG0yLmNsb25lKCkudHJhbnNwb3NlKCk7XHJcblxyXG4gICAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XHJcbiAgICAgICAgdmFyIHRtMSA9IG0xLmVsZW1lbnRzO1xyXG4gICAgICAgIHZhciB0bTIgPSBtMi5lbGVtZW50cztcclxuICAgICAgICAvL3ZhciB0bXA7XHJcblxyXG4gICAgICAgIHZhciBhMCA9IHRtMVswXSwgYTMgPSB0bTFbM10sIGE2ID0gdG0xWzZdO1xyXG4gICAgICAgIHZhciBhMSA9IHRtMVsxXSwgYTQgPSB0bTFbNF0sIGE3ID0gdG0xWzddO1xyXG4gICAgICAgIHZhciBhMiA9IHRtMVsyXSwgYTUgPSB0bTFbNV0sIGE4ID0gdG0xWzhdO1xyXG5cclxuICAgICAgICB2YXIgYjAgPSB0bTJbMF0sIGIzID0gdG0yWzNdLCBiNiA9IHRtMls2XTtcclxuICAgICAgICB2YXIgYjEgPSB0bTJbMV0sIGI0ID0gdG0yWzRdLCBiNyA9IHRtMls3XTtcclxuICAgICAgICB2YXIgYjIgPSB0bTJbMl0sIGI1ID0gdG0yWzVdLCBiOCA9IHRtMls4XTtcclxuXHJcbiAgICAgICAgLyppZiggdHJhbnNwb3NlICl7XHJcblxyXG4gICAgICAgICAgICB0bXAgPSBiMTsgYjEgPSBiMzsgYjMgPSB0bXA7XHJcbiAgICAgICAgICAgIHRtcCA9IGIyOyBiMiA9IGI2OyBiNiA9IHRtcDtcclxuICAgICAgICAgICAgdG1wID0gYjU7IGI1ID0gYjc7IGI3ID0gdG1wO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRlWzBdID0gYTAqYjAgKyBhMSpiMyArIGEyKmI2O1xyXG4gICAgICAgIHRlWzFdID0gYTAqYjEgKyBhMSpiNCArIGEyKmI3O1xyXG4gICAgICAgIHRlWzJdID0gYTAqYjIgKyBhMSpiNSArIGEyKmI4O1xyXG4gICAgICAgIHRlWzNdID0gYTMqYjAgKyBhNCpiMyArIGE1KmI2O1xyXG4gICAgICAgIHRlWzRdID0gYTMqYjEgKyBhNCpiNCArIGE1KmI3O1xyXG4gICAgICAgIHRlWzVdID0gYTMqYjIgKyBhNCpiNSArIGE1KmI4O1xyXG4gICAgICAgIHRlWzZdID0gYTYqYjAgKyBhNypiMyArIGE4KmI2O1xyXG4gICAgICAgIHRlWzddID0gYTYqYjEgKyBhNypiNCArIGE4KmI3O1xyXG4gICAgICAgIHRlWzhdID0gYTYqYjIgKyBhNypiNSArIGE4KmI4O1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LCovXHJcblxyXG4gICAgdHJhbnNwb3NlOiBmdW5jdGlvbiAobSkge1xyXG5cclxuICAgICAgaWYgKG0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHZhciBhID0gbS5lbGVtZW50cztcclxuICAgICAgICB0aGlzLnNldChhWzBdLCBhWzNdLCBhWzZdLCBhWzFdLCBhWzRdLCBhWzddLCBhWzJdLCBhWzVdLCBhWzhdKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcclxuICAgICAgdmFyIGEwMSA9IHRlWzFdLCBhMDIgPSB0ZVsyXSwgYTEyID0gdGVbNV07XHJcbiAgICAgIHRlWzFdID0gdGVbM107XHJcbiAgICAgIHRlWzJdID0gdGVbNl07XHJcbiAgICAgIHRlWzNdID0gYTAxO1xyXG4gICAgICB0ZVs1XSA9IHRlWzddO1xyXG4gICAgICB0ZVs2XSA9IGEwMjtcclxuICAgICAgdGVbN10gPSBhMTI7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG5cclxuXHJcbiAgICAvKm11bFNjYWxlOiBmdW5jdGlvbiAoIG0sIHN4LCBzeSwgc3osIFByZXBlbmQgKSB7XHJcblxyXG4gICAgICAgIHZhciBwcmVwZW5kID0gUHJlcGVuZCB8fCBmYWxzZTtcclxuICAgICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzLCB0bSA9IG0uZWxlbWVudHM7XHJcbiAgICAgICAgaWYocHJlcGVuZCl7XHJcbiAgICAgICAgICAgIHRlWzBdID0gc3gqdG1bMF07IHRlWzFdID0gc3gqdG1bMV07IHRlWzJdID0gc3gqdG1bMl07XHJcbiAgICAgICAgICAgIHRlWzNdID0gc3kqdG1bM107IHRlWzRdID0gc3kqdG1bNF07IHRlWzVdID0gc3kqdG1bNV07XHJcbiAgICAgICAgICAgIHRlWzZdID0gc3oqdG1bNl07IHRlWzddID0gc3oqdG1bN107IHRlWzhdID0gc3oqdG1bOF07XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHRlWzBdID0gdG1bMF0qc3g7IHRlWzFdID0gdG1bMV0qc3k7IHRlWzJdID0gdG1bMl0qc3o7XHJcbiAgICAgICAgICAgIHRlWzNdID0gdG1bM10qc3g7IHRlWzRdID0gdG1bNF0qc3k7IHRlWzVdID0gdG1bNV0qc3o7XHJcbiAgICAgICAgICAgIHRlWzZdID0gdG1bNl0qc3g7IHRlWzddID0gdG1bN10qc3k7IHRlWzhdID0gdG1bOF0qc3o7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdHJhbnNwb3NlOiBmdW5jdGlvbiAoIG0gKSB7XHJcblxyXG4gICAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHMsIHRtID0gbS5lbGVtZW50cztcclxuICAgICAgICB0ZVswXSA9IHRtWzBdOyB0ZVsxXSA9IHRtWzNdOyB0ZVsyXSA9IHRtWzZdO1xyXG4gICAgICAgIHRlWzNdID0gdG1bMV07IHRlWzRdID0gdG1bNF07IHRlWzVdID0gdG1bN107XHJcbiAgICAgICAgdGVbNl0gPSB0bVsyXTsgdGVbN10gPSB0bVs1XTsgdGVbOF0gPSB0bVs4XTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LCovXHJcblxyXG4gICAgc2V0UXVhdDogZnVuY3Rpb24gKHEpIHtcclxuXHJcbiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XHJcbiAgICAgIHZhciB4ID0gcS54LCB5ID0gcS55LCB6ID0gcS56LCB3ID0gcS53O1xyXG4gICAgICB2YXIgeDIgPSB4ICsgeCwgeTIgPSB5ICsgeSwgejIgPSB6ICsgejtcclxuICAgICAgdmFyIHh4ID0geCAqIHgyLCB4eSA9IHggKiB5MiwgeHogPSB4ICogejI7XHJcbiAgICAgIHZhciB5eSA9IHkgKiB5MiwgeXogPSB5ICogejIsIHp6ID0geiAqIHoyO1xyXG4gICAgICB2YXIgd3ggPSB3ICogeDIsIHd5ID0gdyAqIHkyLCB3eiA9IHcgKiB6MjtcclxuXHJcbiAgICAgIHRlWzBdID0gMSAtICh5eSArIHp6KTtcclxuICAgICAgdGVbMV0gPSB4eSAtIHd6O1xyXG4gICAgICB0ZVsyXSA9IHh6ICsgd3k7XHJcblxyXG4gICAgICB0ZVszXSA9IHh5ICsgd3o7XHJcbiAgICAgIHRlWzRdID0gMSAtICh4eCArIHp6KTtcclxuICAgICAgdGVbNV0gPSB5eiAtIHd4O1xyXG5cclxuICAgICAgdGVbNl0gPSB4eiAtIHd5O1xyXG4gICAgICB0ZVs3XSA9IHl6ICsgd3g7XHJcbiAgICAgIHRlWzhdID0gMSAtICh4eCArIHl5KTtcclxuXHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgaW52ZXJ0OiBmdW5jdGlvbiAobSkge1xyXG5cclxuICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cywgdG0gPSBtLmVsZW1lbnRzLFxyXG4gICAgICAgIGEwMCA9IHRtWzBdLCBhMTAgPSB0bVszXSwgYTIwID0gdG1bNl0sXHJcbiAgICAgICAgYTAxID0gdG1bMV0sIGExMSA9IHRtWzRdLCBhMjEgPSB0bVs3XSxcclxuICAgICAgICBhMDIgPSB0bVsyXSwgYTEyID0gdG1bNV0sIGEyMiA9IHRtWzhdLFxyXG4gICAgICAgIGIwMSA9IGEyMiAqIGExMSAtIGExMiAqIGEyMSxcclxuICAgICAgICBiMTEgPSAtYTIyICogYTEwICsgYTEyICogYTIwLFxyXG4gICAgICAgIGIyMSA9IGEyMSAqIGExMCAtIGExMSAqIGEyMCxcclxuICAgICAgICBkZXQgPSBhMDAgKiBiMDEgKyBhMDEgKiBiMTEgKyBhMDIgKiBiMjE7XHJcblxyXG4gICAgICBpZiAoZGV0ID09PSAwKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJjYW4ndCBpbnZlcnQgbWF0cml4LCBkZXRlcm1pbmFudCBpcyAwXCIpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLmlkZW50aXR5KCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGRldCA9IDEuMCAvIGRldDtcclxuICAgICAgdGVbMF0gPSBiMDEgKiBkZXQ7XHJcbiAgICAgIHRlWzFdID0gKC1hMjIgKiBhMDEgKyBhMDIgKiBhMjEpICogZGV0O1xyXG4gICAgICB0ZVsyXSA9IChhMTIgKiBhMDEgLSBhMDIgKiBhMTEpICogZGV0O1xyXG4gICAgICB0ZVszXSA9IGIxMSAqIGRldDtcclxuICAgICAgdGVbNF0gPSAoYTIyICogYTAwIC0gYTAyICogYTIwKSAqIGRldDtcclxuICAgICAgdGVbNV0gPSAoLWExMiAqIGEwMCArIGEwMiAqIGExMCkgKiBkZXQ7XHJcbiAgICAgIHRlWzZdID0gYjIxICogZGV0O1xyXG4gICAgICB0ZVs3XSA9ICgtYTIxICogYTAwICsgYTAxICogYTIwKSAqIGRldDtcclxuICAgICAgdGVbOF0gPSAoYTExICogYTAwIC0gYTAxICogYTEwKSAqIGRldDtcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBhZGRPZmZzZXQ6IGZ1bmN0aW9uIChtLCB2KSB7XHJcblxyXG4gICAgICB2YXIgcmVsWCA9IHYueDtcclxuICAgICAgdmFyIHJlbFkgPSB2Lnk7XHJcbiAgICAgIHZhciByZWxaID0gdi56O1xyXG5cclxuICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcclxuICAgICAgdGVbMF0gKz0gbSAqIChyZWxZICogcmVsWSArIHJlbFogKiByZWxaKTtcclxuICAgICAgdGVbNF0gKz0gbSAqIChyZWxYICogcmVsWCArIHJlbFogKiByZWxaKTtcclxuICAgICAgdGVbOF0gKz0gbSAqIChyZWxYICogcmVsWCArIHJlbFkgKiByZWxZKTtcclxuICAgICAgdmFyIHh5ID0gbSAqIHJlbFggKiByZWxZO1xyXG4gICAgICB2YXIgeXogPSBtICogcmVsWSAqIHJlbFo7XHJcbiAgICAgIHZhciB6eCA9IG0gKiByZWxaICogcmVsWDtcclxuICAgICAgdGVbMV0gLT0geHk7XHJcbiAgICAgIHRlWzNdIC09IHh5O1xyXG4gICAgICB0ZVsyXSAtPSB5ejtcclxuICAgICAgdGVbNl0gLT0geXo7XHJcbiAgICAgIHRlWzVdIC09IHp4O1xyXG4gICAgICB0ZVs3XSAtPSB6eDtcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzdWJPZmZzZXQ6IGZ1bmN0aW9uIChtLCB2KSB7XHJcblxyXG4gICAgICB2YXIgcmVsWCA9IHYueDtcclxuICAgICAgdmFyIHJlbFkgPSB2Lnk7XHJcbiAgICAgIHZhciByZWxaID0gdi56O1xyXG5cclxuICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcclxuICAgICAgdGVbMF0gLT0gbSAqIChyZWxZICogcmVsWSArIHJlbFogKiByZWxaKTtcclxuICAgICAgdGVbNF0gLT0gbSAqIChyZWxYICogcmVsWCArIHJlbFogKiByZWxaKTtcclxuICAgICAgdGVbOF0gLT0gbSAqIChyZWxYICogcmVsWCArIHJlbFkgKiByZWxZKTtcclxuICAgICAgdmFyIHh5ID0gbSAqIHJlbFggKiByZWxZO1xyXG4gICAgICB2YXIgeXogPSBtICogcmVsWSAqIHJlbFo7XHJcbiAgICAgIHZhciB6eCA9IG0gKiByZWxaICogcmVsWDtcclxuICAgICAgdGVbMV0gKz0geHk7XHJcbiAgICAgIHRlWzNdICs9IHh5O1xyXG4gICAgICB0ZVsyXSArPSB5ejtcclxuICAgICAgdGVbNl0gKz0geXo7XHJcbiAgICAgIHRlWzVdICs9IHp4O1xyXG4gICAgICB0ZVs3XSArPSB6eDtcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyBPSyBcclxuXHJcbiAgICBtdWx0aXBseVNjYWxhcjogZnVuY3Rpb24gKHMpIHtcclxuXHJcbiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XHJcblxyXG4gICAgICB0ZVswXSAqPSBzOyB0ZVszXSAqPSBzOyB0ZVs2XSAqPSBzO1xyXG4gICAgICB0ZVsxXSAqPSBzOyB0ZVs0XSAqPSBzOyB0ZVs3XSAqPSBzO1xyXG4gICAgICB0ZVsyXSAqPSBzOyB0ZVs1XSAqPSBzOyB0ZVs4XSAqPSBzO1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBpZGVudGl0eTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdGhpcy5zZXQoMSwgMCwgMCwgMCwgMSwgMCwgMCwgMCwgMSk7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG5cclxuICAgIGNsb25lOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICByZXR1cm4gbmV3IE1hdDMzKCkuZnJvbUFycmF5KHRoaXMuZWxlbWVudHMpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY29weTogZnVuY3Rpb24gKG0pIHtcclxuXHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgOTsgaSsrKSB0aGlzLmVsZW1lbnRzW2ldID0gbS5lbGVtZW50c1tpXTtcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBkZXRlcm1pbmFudDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcclxuICAgICAgdmFyIGEgPSB0ZVswXSwgYiA9IHRlWzFdLCBjID0gdGVbMl0sXHJcbiAgICAgICAgZCA9IHRlWzNdLCBlID0gdGVbNF0sIGYgPSB0ZVs1XSxcclxuICAgICAgICBnID0gdGVbNl0sIGggPSB0ZVs3XSwgaSA9IHRlWzhdO1xyXG5cclxuICAgICAgcmV0dXJuIGEgKiBlICogaSAtIGEgKiBmICogaCAtIGIgKiBkICogaSArIGIgKiBmICogZyArIGMgKiBkICogaCAtIGMgKiBlICogZztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGZyb21BcnJheTogZnVuY3Rpb24gKGFycmF5LCBvZmZzZXQpIHtcclxuXHJcbiAgICAgIGlmIChvZmZzZXQgPT09IHVuZGVmaW5lZCkgb2Zmc2V0ID0gMDtcclxuXHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgOTsgaSsrKSB7XHJcblxyXG4gICAgICAgIHRoaXMuZWxlbWVudHNbaV0gPSBhcnJheVtpICsgb2Zmc2V0XTtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdG9BcnJheTogZnVuY3Rpb24gKGFycmF5LCBvZmZzZXQpIHtcclxuXHJcbiAgICAgIGlmIChhcnJheSA9PT0gdW5kZWZpbmVkKSBhcnJheSA9IFtdO1xyXG4gICAgICBpZiAob2Zmc2V0ID09PSB1bmRlZmluZWQpIG9mZnNldCA9IDA7XHJcblxyXG4gICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xyXG5cclxuICAgICAgYXJyYXlbb2Zmc2V0XSA9IHRlWzBdO1xyXG4gICAgICBhcnJheVtvZmZzZXQgKyAxXSA9IHRlWzFdO1xyXG4gICAgICBhcnJheVtvZmZzZXQgKyAyXSA9IHRlWzJdO1xyXG5cclxuICAgICAgYXJyYXlbb2Zmc2V0ICsgM10gPSB0ZVszXTtcclxuICAgICAgYXJyYXlbb2Zmc2V0ICsgNF0gPSB0ZVs0XTtcclxuICAgICAgYXJyYXlbb2Zmc2V0ICsgNV0gPSB0ZVs1XTtcclxuXHJcbiAgICAgIGFycmF5W29mZnNldCArIDZdID0gdGVbNl07XHJcbiAgICAgIGFycmF5W29mZnNldCArIDddID0gdGVbN107XHJcbiAgICAgIGFycmF5W29mZnNldCArIDhdID0gdGVbOF07XHJcblxyXG4gICAgICByZXR1cm4gYXJyYXk7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbiAgfSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIEFuIGF4aXMtYWxpZ25lZCBib3VuZGluZyBib3guXHJcbiAgICpcclxuICAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAgKiBAYXV0aG9yIGxvLXRoXHJcbiAgICovXHJcblxyXG4gIGZ1bmN0aW9uIEFBQkIobWluWCwgbWF4WCwgbWluWSwgbWF4WSwgbWluWiwgbWF4Wikge1xyXG5cclxuICAgIHRoaXMuZWxlbWVudHMgPSBuZXcgRmxvYXQzMkFycmF5KDYpO1xyXG4gICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcclxuXHJcbiAgICB0ZVswXSA9IG1pblggfHwgMDsgdGVbMV0gPSBtaW5ZIHx8IDA7IHRlWzJdID0gbWluWiB8fCAwO1xyXG4gICAgdGVbM10gPSBtYXhYIHx8IDA7IHRlWzRdID0gbWF4WSB8fCAwOyB0ZVs1XSA9IG1heFogfHwgMDtcclxuXHJcbiAgfVxyXG4gIE9iamVjdC5hc3NpZ24oQUFCQi5wcm90b3R5cGUsIHtcclxuXHJcbiAgICBBQUJCOiB0cnVlLFxyXG5cclxuICAgIHNldDogZnVuY3Rpb24gKG1pblgsIG1heFgsIG1pblksIG1heFksIG1pblosIG1heFopIHtcclxuXHJcbiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XHJcbiAgICAgIHRlWzBdID0gbWluWDtcclxuICAgICAgdGVbM10gPSBtYXhYO1xyXG4gICAgICB0ZVsxXSA9IG1pblk7XHJcbiAgICAgIHRlWzRdID0gbWF4WTtcclxuICAgICAgdGVbMl0gPSBtaW5aO1xyXG4gICAgICB0ZVs1XSA9IG1heFo7XHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSxcclxuXHJcbiAgICBpbnRlcnNlY3RUZXN0OiBmdW5jdGlvbiAoYWFiYikge1xyXG5cclxuICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcclxuICAgICAgdmFyIHVlID0gYWFiYi5lbGVtZW50cztcclxuICAgICAgcmV0dXJuIHRlWzBdID4gdWVbM10gfHwgdGVbMV0gPiB1ZVs0XSB8fCB0ZVsyXSA+IHVlWzVdIHx8IHRlWzNdIDwgdWVbMF0gfHwgdGVbNF0gPCB1ZVsxXSB8fCB0ZVs1XSA8IHVlWzJdID8gdHJ1ZSA6IGZhbHNlO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgaW50ZXJzZWN0VGVzdFR3bzogZnVuY3Rpb24gKGFhYmIpIHtcclxuXHJcbiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XHJcbiAgICAgIHZhciB1ZSA9IGFhYmIuZWxlbWVudHM7XHJcbiAgICAgIHJldHVybiB0ZVswXSA8IHVlWzBdIHx8IHRlWzFdIDwgdWVbMV0gfHwgdGVbMl0gPCB1ZVsyXSB8fCB0ZVszXSA+IHVlWzNdIHx8IHRlWzRdID4gdWVbNF0gfHwgdGVbNV0gPiB1ZVs1XSA/IHRydWUgOiBmYWxzZTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGNsb25lOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoKS5mcm9tQXJyYXkodGhpcy5lbGVtZW50cyk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBjb3B5OiBmdW5jdGlvbiAoYWFiYiwgbWFyZ2luKSB7XHJcblxyXG4gICAgICB2YXIgbSA9IG1hcmdpbiB8fCAwO1xyXG4gICAgICB2YXIgbWUgPSBhYWJiLmVsZW1lbnRzO1xyXG4gICAgICB0aGlzLnNldChtZVswXSAtIG0sIG1lWzNdICsgbSwgbWVbMV0gLSBtLCBtZVs0XSArIG0sIG1lWzJdIC0gbSwgbWVbNV0gKyBtKTtcclxuICAgICAgcmV0dXJuIHRoaXM7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBmcm9tQXJyYXk6IGZ1bmN0aW9uIChhcnJheSkge1xyXG5cclxuICAgICAgdGhpcy5lbGVtZW50cy5zZXQoYXJyYXkpO1xyXG4gICAgICByZXR1cm4gdGhpcztcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIFNldCB0aGlzIEFBQkIgdG8gdGhlIGNvbWJpbmVkIEFBQkIgb2YgYWFiYjEgYW5kIGFhYmIyLlxyXG5cclxuICAgIGNvbWJpbmU6IGZ1bmN0aW9uIChhYWJiMSwgYWFiYjIpIHtcclxuXHJcbiAgICAgIHZhciBhID0gYWFiYjEuZWxlbWVudHM7XHJcbiAgICAgIHZhciBiID0gYWFiYjIuZWxlbWVudHM7XHJcbiAgICAgIHZhciB0ZSA9IHRoaXMuZWxlbWVudHM7XHJcblxyXG4gICAgICB0ZVswXSA9IGFbMF0gPCBiWzBdID8gYVswXSA6IGJbMF07XHJcbiAgICAgIHRlWzFdID0gYVsxXSA8IGJbMV0gPyBhWzFdIDogYlsxXTtcclxuICAgICAgdGVbMl0gPSBhWzJdIDwgYlsyXSA/IGFbMl0gOiBiWzJdO1xyXG5cclxuICAgICAgdGVbM10gPSBhWzNdID4gYlszXSA/IGFbM10gOiBiWzNdO1xyXG4gICAgICB0ZVs0XSA9IGFbNF0gPiBiWzRdID8gYVs0XSA6IGJbNF07XHJcbiAgICAgIHRlWzVdID0gYVs1XSA+IGJbNV0gPyBhWzVdIDogYls1XTtcclxuXHJcbiAgICAgIHJldHVybiB0aGlzO1xyXG5cclxuICAgIH0sXHJcblxyXG5cclxuICAgIC8vIEdldCB0aGUgc3VyZmFjZSBhcmVhLlxyXG5cclxuICAgIHN1cmZhY2VBcmVhOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB2YXIgdGUgPSB0aGlzLmVsZW1lbnRzO1xyXG4gICAgICB2YXIgYSA9IHRlWzNdIC0gdGVbMF07XHJcbiAgICAgIHZhciBoID0gdGVbNF0gLSB0ZVsxXTtcclxuICAgICAgdmFyIGQgPSB0ZVs1XSAtIHRlWzJdO1xyXG4gICAgICByZXR1cm4gMiAqIChhICogKGggKyBkKSArIGggKiBkKTtcclxuXHJcbiAgICB9LFxyXG5cclxuXHJcbiAgICAvLyBHZXQgd2hldGhlciB0aGUgQUFCQiBpbnRlcnNlY3RzIHdpdGggdGhlIHBvaW50IG9yIG5vdC5cclxuXHJcbiAgICBpbnRlcnNlY3RzV2l0aFBvaW50OiBmdW5jdGlvbiAoeCwgeSwgeikge1xyXG5cclxuICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcclxuICAgICAgcmV0dXJuIHggPj0gdGVbMF0gJiYgeCA8PSB0ZVszXSAmJiB5ID49IHRlWzFdICYmIHkgPD0gdGVbNF0gJiYgeiA+PSB0ZVsyXSAmJiB6IDw9IHRlWzVdO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTZXQgdGhlIEFBQkIgZnJvbSBhbiBhcnJheVxyXG4gICAgICogb2YgdmVydGljZXMuIEZyb20gVEhSRUUuXHJcbiAgICAgKiBAYXV0aG9yIFdlc3RMYW5nbGV5XHJcbiAgICAgKiBAYXV0aG9yIHhwcm9ncmFtXHJcbiAgICAgKi9cclxuXHJcbiAgICBzZXRGcm9tUG9pbnRzOiBmdW5jdGlvbiAoYXJyKSB7XHJcbiAgICAgIHRoaXMubWFrZUVtcHR5KCk7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgdGhpcy5leHBhbmRCeVBvaW50KGFycltpXSk7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgbWFrZUVtcHR5OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHRoaXMuc2V0KC1JbmZpbml0eSwgLUluZmluaXR5LCAtSW5maW5pdHksIEluZmluaXR5LCBJbmZpbml0eSwgSW5maW5pdHkpO1xyXG4gICAgfSxcclxuXHJcbiAgICBleHBhbmRCeVBvaW50OiBmdW5jdGlvbiAocHQpIHtcclxuICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcclxuICAgICAgdGhpcy5zZXQoXHJcbiAgICAgICAgX01hdGgubWluKHRlWzBdLCBwdC54KSwgX01hdGgubWluKHRlWzFdLCBwdC55KSwgX01hdGgubWluKHRlWzJdLCBwdC56KSxcclxuICAgICAgICBfTWF0aC5tYXgodGVbM10sIHB0LngpLCBfTWF0aC5tYXgodGVbNF0sIHB0LnkpLCBfTWF0aC5tYXgodGVbNV0sIHB0LnopXHJcbiAgICAgICk7XHJcbiAgICB9LFxyXG5cclxuICAgIGV4cGFuZEJ5U2NhbGFyOiBmdW5jdGlvbiAocykge1xyXG5cclxuICAgICAgdmFyIHRlID0gdGhpcy5lbGVtZW50cztcclxuICAgICAgdGVbMF0gKz0gLXM7XHJcbiAgICAgIHRlWzFdICs9IC1zO1xyXG4gICAgICB0ZVsyXSArPSAtcztcclxuICAgICAgdGVbM10gKz0gcztcclxuICAgICAgdGVbNF0gKz0gcztcclxuICAgICAgdGVbNV0gKz0gcztcclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIHZhciBjb3VudCA9IDA7XHJcbiAgZnVuY3Rpb24gU2hhcGVJZENvdW50KCkgeyByZXR1cm4gY291bnQrKzsgfVxyXG5cclxuICAvKipcclxuICAgKiBBIHNoYXBlIGlzIHVzZWQgdG8gZGV0ZWN0IGNvbGxpc2lvbnMgb2YgcmlnaWQgYm9kaWVzLlxyXG4gICAqXHJcbiAgICogQGF1dGhvciBzYWhhcmFuXHJcbiAgICogQGF1dGhvciBsby10aFxyXG4gICAqL1xyXG5cclxuICBmdW5jdGlvbiBTaGFwZShjb25maWcpIHtcclxuXHJcbiAgICB0aGlzLnR5cGUgPSBTSEFQRV9OVUxMO1xyXG5cclxuICAgIC8vIGdsb2JhbCBpZGVudGlmaWNhdGlvbiBvZiB0aGUgc2hhcGUgc2hvdWxkIGJlIHVuaXF1ZSB0byB0aGUgc2hhcGUuXHJcbiAgICB0aGlzLmlkID0gU2hhcGVJZENvdW50KCk7XHJcblxyXG4gICAgLy8gcHJldmlvdXMgc2hhcGUgaW4gcGFyZW50IHJpZ2lkIGJvZHkuIFVzZWQgZm9yIGZhc3QgaW50ZXJhdGlvbnMuXHJcbiAgICB0aGlzLnByZXYgPSBudWxsO1xyXG5cclxuICAgIC8vIG5leHQgc2hhcGUgaW4gcGFyZW50IHJpZ2lkIGJvZHkuIFVzZWQgZm9yIGZhc3QgaW50ZXJhdGlvbnMuXHJcbiAgICB0aGlzLm5leHQgPSBudWxsO1xyXG5cclxuICAgIC8vIHByb3h5IG9mIHRoZSBzaGFwZSB1c2VkIGZvciBicm9hZC1waGFzZSBjb2xsaXNpb24gZGV0ZWN0aW9uLlxyXG4gICAgdGhpcy5wcm94eSA9IG51bGw7XHJcblxyXG4gICAgLy8gcGFyZW50IHJpZ2lkIGJvZHkgb2YgdGhlIHNoYXBlLlxyXG4gICAgdGhpcy5wYXJlbnQgPSBudWxsO1xyXG5cclxuICAgIC8vIGxpbmtlZCBsaXN0IG9mIHRoZSBjb250YWN0cyB3aXRoIHRoZSBzaGFwZS5cclxuICAgIHRoaXMuY29udGFjdExpbmsgPSBudWxsO1xyXG5cclxuICAgIC8vIG51bWJlciBvZiB0aGUgY29udGFjdHMgd2l0aCB0aGUgc2hhcGUuXHJcbiAgICB0aGlzLm51bUNvbnRhY3RzID0gMDtcclxuXHJcbiAgICAvLyBjZW50ZXIgb2YgZ3Jhdml0eSBvZiB0aGUgc2hhcGUgaW4gd29ybGQgY29vcmRpbmF0ZSBzeXN0ZW0uXHJcbiAgICB0aGlzLnBvc2l0aW9uID0gbmV3IFZlYzMoKTtcclxuXHJcbiAgICAvLyByb3RhdGlvbiBtYXRyaXggb2YgdGhlIHNoYXBlIGluIHdvcmxkIGNvb3JkaW5hdGUgc3lzdGVtLlxyXG4gICAgdGhpcy5yb3RhdGlvbiA9IG5ldyBNYXQzMygpO1xyXG5cclxuICAgIC8vIHBvc2l0aW9uIG9mIHRoZSBzaGFwZSBpbiBwYXJlbnQncyBjb29yZGluYXRlIHN5c3RlbS5cclxuICAgIHRoaXMucmVsYXRpdmVQb3NpdGlvbiA9IG5ldyBWZWMzKCkuY29weShjb25maWcucmVsYXRpdmVQb3NpdGlvbik7XHJcblxyXG4gICAgLy8gcm90YXRpb24gbWF0cml4IG9mIHRoZSBzaGFwZSBpbiBwYXJlbnQncyBjb29yZGluYXRlIHN5c3RlbS5cclxuICAgIHRoaXMucmVsYXRpdmVSb3RhdGlvbiA9IG5ldyBNYXQzMygpLmNvcHkoY29uZmlnLnJlbGF0aXZlUm90YXRpb24pO1xyXG5cclxuICAgIC8vIGF4aXMtYWxpZ25lZCBib3VuZGluZyBib3ggb2YgdGhlIHNoYXBlLlxyXG4gICAgdGhpcy5hYWJiID0gbmV3IEFBQkIoKTtcclxuXHJcbiAgICAvLyBkZW5zaXR5IG9mIHRoZSBzaGFwZS5cclxuICAgIHRoaXMuZGVuc2l0eSA9IGNvbmZpZy5kZW5zaXR5O1xyXG5cclxuICAgIC8vIGNvZWZmaWNpZW50IG9mIGZyaWN0aW9uIG9mIHRoZSBzaGFwZS5cclxuICAgIHRoaXMuZnJpY3Rpb24gPSBjb25maWcuZnJpY3Rpb247XHJcblxyXG4gICAgLy8gY29lZmZpY2llbnQgb2YgcmVzdGl0dXRpb24gb2YgdGhlIHNoYXBlLlxyXG4gICAgdGhpcy5yZXN0aXR1dGlvbiA9IGNvbmZpZy5yZXN0aXR1dGlvbjtcclxuXHJcbiAgICAvLyBiaXRzIG9mIHRoZSBjb2xsaXNpb24gZ3JvdXBzIHRvIHdoaWNoIHRoZSBzaGFwZSBiZWxvbmdzLlxyXG4gICAgdGhpcy5iZWxvbmdzVG8gPSBjb25maWcuYmVsb25nc1RvO1xyXG5cclxuICAgIC8vIGJpdHMgb2YgdGhlIGNvbGxpc2lvbiBncm91cHMgd2l0aCB3aGljaCB0aGUgc2hhcGUgY29sbGlkZXMuXHJcbiAgICB0aGlzLmNvbGxpZGVzV2l0aCA9IGNvbmZpZy5jb2xsaWRlc1dpdGg7XHJcblxyXG4gIH1cclxuICBPYmplY3QuYXNzaWduKFNoYXBlLnByb3RvdHlwZSwge1xyXG5cclxuICAgIFNoYXBlOiB0cnVlLFxyXG5cclxuICAgIC8vIENhbGN1bGF0ZSB0aGUgbWFzcyBpbmZvcm1hdGlvbiBvZiB0aGUgc2hhcGUuXHJcblxyXG4gICAgY2FsY3VsYXRlTWFzc0luZm86IGZ1bmN0aW9uIChvdXQpIHtcclxuXHJcbiAgICAgIHByaW50RXJyb3IoXCJTaGFwZVwiLCBcIkluaGVyaXRhbmNlIGVycm9yLlwiKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIFVwZGF0ZSB0aGUgcHJveHkgb2YgdGhlIHNoYXBlLlxyXG5cclxuICAgIHVwZGF0ZVByb3h5OiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICBwcmludEVycm9yKFwiU2hhcGVcIiwgXCJJbmhlcml0YW5jZSBlcnJvci5cIik7XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgICogQm94IHNoYXBlLlxyXG4gICAqIEBhdXRob3Igc2FoYXJhblxyXG4gICAqIEBhdXRob3IgbG8tdGhcclxuICAgKi9cclxuXHJcbiAgZnVuY3Rpb24gQm94KGNvbmZpZywgV2lkdGgsIEhlaWdodCwgRGVwdGgpIHtcclxuXHJcbiAgICBTaGFwZS5jYWxsKHRoaXMsIGNvbmZpZyk7XHJcblxyXG4gICAgdGhpcy50eXBlID0gU0hBUEVfQk9YO1xyXG5cclxuICAgIHRoaXMud2lkdGggPSBXaWR0aDtcclxuICAgIHRoaXMuaGVpZ2h0ID0gSGVpZ2h0O1xyXG4gICAgdGhpcy5kZXB0aCA9IERlcHRoO1xyXG5cclxuICAgIHRoaXMuaGFsZldpZHRoID0gV2lkdGggKiAwLjU7XHJcbiAgICB0aGlzLmhhbGZIZWlnaHQgPSBIZWlnaHQgKiAwLjU7XHJcbiAgICB0aGlzLmhhbGZEZXB0aCA9IERlcHRoICogMC41O1xyXG5cclxuICAgIHRoaXMuZGltZW50aW9ucyA9IG5ldyBGbG9hdDMyQXJyYXkoMTgpO1xyXG4gICAgdGhpcy5lbGVtZW50cyA9IG5ldyBGbG9hdDMyQXJyYXkoMjQpO1xyXG5cclxuICB9XHJcbiAgQm94LnByb3RvdHlwZSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShTaGFwZS5wcm90b3R5cGUpLCB7XHJcblxyXG4gICAgY29uc3RydWN0b3I6IEJveCxcclxuXHJcbiAgICBjYWxjdWxhdGVNYXNzSW5mbzogZnVuY3Rpb24gKG91dCkge1xyXG5cclxuICAgICAgdmFyIG1hc3MgPSB0aGlzLndpZHRoICogdGhpcy5oZWlnaHQgKiB0aGlzLmRlcHRoICogdGhpcy5kZW5zaXR5O1xyXG4gICAgICB2YXIgZGl2aWQgPSAxIC8gMTI7XHJcbiAgICAgIG91dC5tYXNzID0gbWFzcztcclxuICAgICAgb3V0LmluZXJ0aWEuc2V0KFxyXG4gICAgICAgIG1hc3MgKiAodGhpcy5oZWlnaHQgKiB0aGlzLmhlaWdodCArIHRoaXMuZGVwdGggKiB0aGlzLmRlcHRoKSAqIGRpdmlkLCAwLCAwLFxyXG4gICAgICAgIDAsIG1hc3MgKiAodGhpcy53aWR0aCAqIHRoaXMud2lkdGggKyB0aGlzLmRlcHRoICogdGhpcy5kZXB0aCkgKiBkaXZpZCwgMCxcclxuICAgICAgICAwLCAwLCBtYXNzICogKHRoaXMud2lkdGggKiB0aGlzLndpZHRoICsgdGhpcy5oZWlnaHQgKiB0aGlzLmhlaWdodCkgKiBkaXZpZFxyXG4gICAgICApO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlUHJveHk6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHZhciB0ZSA9IHRoaXMucm90YXRpb24uZWxlbWVudHM7XHJcbiAgICAgIHZhciBkaSA9IHRoaXMuZGltZW50aW9ucztcclxuICAgICAgLy8gV2lkdGhcclxuICAgICAgZGlbMF0gPSB0ZVswXTtcclxuICAgICAgZGlbMV0gPSB0ZVszXTtcclxuICAgICAgZGlbMl0gPSB0ZVs2XTtcclxuICAgICAgLy8gSGVpZ2h0XHJcbiAgICAgIGRpWzNdID0gdGVbMV07XHJcbiAgICAgIGRpWzRdID0gdGVbNF07XHJcbiAgICAgIGRpWzVdID0gdGVbN107XHJcbiAgICAgIC8vIERlcHRoXHJcbiAgICAgIGRpWzZdID0gdGVbMl07XHJcbiAgICAgIGRpWzddID0gdGVbNV07XHJcbiAgICAgIGRpWzhdID0gdGVbOF07XHJcbiAgICAgIC8vIGhhbGYgV2lkdGhcclxuICAgICAgZGlbOV0gPSB0ZVswXSAqIHRoaXMuaGFsZldpZHRoO1xyXG4gICAgICBkaVsxMF0gPSB0ZVszXSAqIHRoaXMuaGFsZldpZHRoO1xyXG4gICAgICBkaVsxMV0gPSB0ZVs2XSAqIHRoaXMuaGFsZldpZHRoO1xyXG4gICAgICAvLyBoYWxmIEhlaWdodFxyXG4gICAgICBkaVsxMl0gPSB0ZVsxXSAqIHRoaXMuaGFsZkhlaWdodDtcclxuICAgICAgZGlbMTNdID0gdGVbNF0gKiB0aGlzLmhhbGZIZWlnaHQ7XHJcbiAgICAgIGRpWzE0XSA9IHRlWzddICogdGhpcy5oYWxmSGVpZ2h0O1xyXG4gICAgICAvLyBoYWxmIERlcHRoXHJcbiAgICAgIGRpWzE1XSA9IHRlWzJdICogdGhpcy5oYWxmRGVwdGg7XHJcbiAgICAgIGRpWzE2XSA9IHRlWzVdICogdGhpcy5oYWxmRGVwdGg7XHJcbiAgICAgIGRpWzE3XSA9IHRlWzhdICogdGhpcy5oYWxmRGVwdGg7XHJcblxyXG4gICAgICB2YXIgd3ggPSBkaVs5XTtcclxuICAgICAgdmFyIHd5ID0gZGlbMTBdO1xyXG4gICAgICB2YXIgd3ogPSBkaVsxMV07XHJcbiAgICAgIHZhciBoeCA9IGRpWzEyXTtcclxuICAgICAgdmFyIGh5ID0gZGlbMTNdO1xyXG4gICAgICB2YXIgaHogPSBkaVsxNF07XHJcbiAgICAgIHZhciBkeCA9IGRpWzE1XTtcclxuICAgICAgdmFyIGR5ID0gZGlbMTZdO1xyXG4gICAgICB2YXIgZHogPSBkaVsxN107XHJcblxyXG4gICAgICB2YXIgeCA9IHRoaXMucG9zaXRpb24ueDtcclxuICAgICAgdmFyIHkgPSB0aGlzLnBvc2l0aW9uLnk7XHJcbiAgICAgIHZhciB6ID0gdGhpcy5wb3NpdGlvbi56O1xyXG5cclxuICAgICAgdmFyIHYgPSB0aGlzLmVsZW1lbnRzO1xyXG4gICAgICAvL3YxXHJcbiAgICAgIHZbMF0gPSB4ICsgd3ggKyBoeCArIGR4O1xyXG4gICAgICB2WzFdID0geSArIHd5ICsgaHkgKyBkeTtcclxuICAgICAgdlsyXSA9IHogKyB3eiArIGh6ICsgZHo7XHJcbiAgICAgIC8vdjJcclxuICAgICAgdlszXSA9IHggKyB3eCArIGh4IC0gZHg7XHJcbiAgICAgIHZbNF0gPSB5ICsgd3kgKyBoeSAtIGR5O1xyXG4gICAgICB2WzVdID0geiArIHd6ICsgaHogLSBkejtcclxuICAgICAgLy92M1xyXG4gICAgICB2WzZdID0geCArIHd4IC0gaHggKyBkeDtcclxuICAgICAgdls3XSA9IHkgKyB3eSAtIGh5ICsgZHk7XHJcbiAgICAgIHZbOF0gPSB6ICsgd3ogLSBoeiArIGR6O1xyXG4gICAgICAvL3Y0XHJcbiAgICAgIHZbOV0gPSB4ICsgd3ggLSBoeCAtIGR4O1xyXG4gICAgICB2WzEwXSA9IHkgKyB3eSAtIGh5IC0gZHk7XHJcbiAgICAgIHZbMTFdID0geiArIHd6IC0gaHogLSBkejtcclxuICAgICAgLy92NVxyXG4gICAgICB2WzEyXSA9IHggLSB3eCArIGh4ICsgZHg7XHJcbiAgICAgIHZbMTNdID0geSAtIHd5ICsgaHkgKyBkeTtcclxuICAgICAgdlsxNF0gPSB6IC0gd3ogKyBoeiArIGR6O1xyXG4gICAgICAvL3Y2XHJcbiAgICAgIHZbMTVdID0geCAtIHd4ICsgaHggLSBkeDtcclxuICAgICAgdlsxNl0gPSB5IC0gd3kgKyBoeSAtIGR5O1xyXG4gICAgICB2WzE3XSA9IHogLSB3eiArIGh6IC0gZHo7XHJcbiAgICAgIC8vdjdcclxuICAgICAgdlsxOF0gPSB4IC0gd3ggLSBoeCArIGR4O1xyXG4gICAgICB2WzE5XSA9IHkgLSB3eSAtIGh5ICsgZHk7XHJcbiAgICAgIHZbMjBdID0geiAtIHd6IC0gaHogKyBkejtcclxuICAgICAgLy92OFxyXG4gICAgICB2WzIxXSA9IHggLSB3eCAtIGh4IC0gZHg7XHJcbiAgICAgIHZbMjJdID0geSAtIHd5IC0gaHkgLSBkeTtcclxuICAgICAgdlsyM10gPSB6IC0gd3ogLSBoeiAtIGR6O1xyXG5cclxuICAgICAgdmFyIHcgPSBkaVs5XSA8IDAgPyAtZGlbOV0gOiBkaVs5XTtcclxuICAgICAgdmFyIGggPSBkaVsxMF0gPCAwID8gLWRpWzEwXSA6IGRpWzEwXTtcclxuICAgICAgdmFyIGQgPSBkaVsxMV0gPCAwID8gLWRpWzExXSA6IGRpWzExXTtcclxuXHJcbiAgICAgIHcgPSBkaVsxMl0gPCAwID8gdyAtIGRpWzEyXSA6IHcgKyBkaVsxMl07XHJcbiAgICAgIGggPSBkaVsxM10gPCAwID8gaCAtIGRpWzEzXSA6IGggKyBkaVsxM107XHJcbiAgICAgIGQgPSBkaVsxNF0gPCAwID8gZCAtIGRpWzE0XSA6IGQgKyBkaVsxNF07XHJcblxyXG4gICAgICB3ID0gZGlbMTVdIDwgMCA/IHcgLSBkaVsxNV0gOiB3ICsgZGlbMTVdO1xyXG4gICAgICBoID0gZGlbMTZdIDwgMCA/IGggLSBkaVsxNl0gOiBoICsgZGlbMTZdO1xyXG4gICAgICBkID0gZGlbMTddIDwgMCA/IGQgLSBkaVsxN10gOiBkICsgZGlbMTddO1xyXG5cclxuICAgICAgdmFyIHAgPSBBQUJCX1BST1g7XHJcblxyXG4gICAgICB0aGlzLmFhYmIuc2V0KFxyXG4gICAgICAgIHRoaXMucG9zaXRpb24ueCAtIHcgLSBwLCB0aGlzLnBvc2l0aW9uLnggKyB3ICsgcCxcclxuICAgICAgICB0aGlzLnBvc2l0aW9uLnkgLSBoIC0gcCwgdGhpcy5wb3NpdGlvbi55ICsgaCArIHAsXHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbi56IC0gZCAtIHAsIHRoaXMucG9zaXRpb24ueiArIGQgKyBwXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBpZiAodGhpcy5wcm94eSAhPSBudWxsKSB0aGlzLnByb3h5LnVwZGF0ZSgpO1xyXG5cclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgICogU3BoZXJlIHNoYXBlXHJcbiAgICogQGF1dGhvciBzYWhhcmFuXHJcbiAgICogQGF1dGhvciBsby10aFxyXG4gICAqL1xyXG5cclxuICBmdW5jdGlvbiBTcGhlcmUoY29uZmlnLCByYWRpdXMpIHtcclxuXHJcbiAgICBTaGFwZS5jYWxsKHRoaXMsIGNvbmZpZyk7XHJcblxyXG4gICAgdGhpcy50eXBlID0gU0hBUEVfU1BIRVJFO1xyXG5cclxuICAgIC8vIHJhZGl1cyBvZiB0aGUgc2hhcGUuXHJcbiAgICB0aGlzLnJhZGl1cyA9IHJhZGl1cztcclxuXHJcbiAgfVxyXG4gIFNwaGVyZS5wcm90b3R5cGUgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoU2hhcGUucHJvdG90eXBlKSwge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yOiBTcGhlcmUsXHJcblxyXG4gICAgdm9sdW1lOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICByZXR1cm4gX01hdGguUEkgKiB0aGlzLnJhZGl1cyAqIDEuMzMzMzMzO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2FsY3VsYXRlTWFzc0luZm86IGZ1bmN0aW9uIChvdXQpIHtcclxuXHJcbiAgICAgIHZhciBtYXNzID0gdGhpcy52b2x1bWUoKSAqIHRoaXMucmFkaXVzICogdGhpcy5yYWRpdXMgKiB0aGlzLmRlbnNpdHk7IC8vMS4zMzMgKiBfTWF0aC5QSSAqIHRoaXMucmFkaXVzICogdGhpcy5yYWRpdXMgKiB0aGlzLnJhZGl1cyAqIHRoaXMuZGVuc2l0eTtcclxuICAgICAgb3V0Lm1hc3MgPSBtYXNzO1xyXG4gICAgICB2YXIgaW5lcnRpYSA9IG1hc3MgKiB0aGlzLnJhZGl1cyAqIHRoaXMucmFkaXVzICogMC40O1xyXG4gICAgICBvdXQuaW5lcnRpYS5zZXQoaW5lcnRpYSwgMCwgMCwgMCwgaW5lcnRpYSwgMCwgMCwgMCwgaW5lcnRpYSk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGVQcm94eTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdmFyIHAgPSBBQUJCX1BST1g7XHJcblxyXG4gICAgICB0aGlzLmFhYmIuc2V0KFxyXG4gICAgICAgIHRoaXMucG9zaXRpb24ueCAtIHRoaXMucmFkaXVzIC0gcCwgdGhpcy5wb3NpdGlvbi54ICsgdGhpcy5yYWRpdXMgKyBwLFxyXG4gICAgICAgIHRoaXMucG9zaXRpb24ueSAtIHRoaXMucmFkaXVzIC0gcCwgdGhpcy5wb3NpdGlvbi55ICsgdGhpcy5yYWRpdXMgKyBwLFxyXG4gICAgICAgIHRoaXMucG9zaXRpb24ueiAtIHRoaXMucmFkaXVzIC0gcCwgdGhpcy5wb3NpdGlvbi56ICsgdGhpcy5yYWRpdXMgKyBwXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBpZiAodGhpcy5wcm94eSAhPSBudWxsKSB0aGlzLnByb3h5LnVwZGF0ZSgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIEN5bGluZGVyIHNoYXBlXHJcbiAgICogQGF1dGhvciBzYWhhcmFuXHJcbiAgICogQGF1dGhvciBsby10aFxyXG4gICAqL1xyXG5cclxuICBmdW5jdGlvbiBDeWxpbmRlcihjb25maWcsIHJhZGl1cywgaGVpZ2h0KSB7XHJcblxyXG4gICAgU2hhcGUuY2FsbCh0aGlzLCBjb25maWcpO1xyXG5cclxuICAgIHRoaXMudHlwZSA9IFNIQVBFX0NZTElOREVSO1xyXG5cclxuICAgIHRoaXMucmFkaXVzID0gcmFkaXVzO1xyXG4gICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICB0aGlzLmhhbGZIZWlnaHQgPSBoZWlnaHQgKiAwLjU7XHJcblxyXG4gICAgdGhpcy5ub3JtYWxEaXJlY3Rpb24gPSBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy5oYWxmRGlyZWN0aW9uID0gbmV3IFZlYzMoKTtcclxuXHJcbiAgfVxyXG4gIEN5bGluZGVyLnByb3RvdHlwZSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShTaGFwZS5wcm90b3R5cGUpLCB7XHJcblxyXG4gICAgY29uc3RydWN0b3I6IEN5bGluZGVyLFxyXG5cclxuICAgIGNhbGN1bGF0ZU1hc3NJbmZvOiBmdW5jdGlvbiAob3V0KSB7XHJcblxyXG4gICAgICB2YXIgcnNxID0gdGhpcy5yYWRpdXMgKiB0aGlzLnJhZGl1cztcclxuICAgICAgdmFyIG1hc3MgPSBfTWF0aC5QSSAqIHJzcSAqIHRoaXMuaGVpZ2h0ICogdGhpcy5kZW5zaXR5O1xyXG4gICAgICB2YXIgaW5lcnRpYVhaID0gKCgwLjI1ICogcnNxKSArICgwLjA4MzMgKiB0aGlzLmhlaWdodCAqIHRoaXMuaGVpZ2h0KSkgKiBtYXNzO1xyXG4gICAgICB2YXIgaW5lcnRpYVkgPSAwLjUgKiByc3E7XHJcbiAgICAgIG91dC5tYXNzID0gbWFzcztcclxuICAgICAgb3V0LmluZXJ0aWEuc2V0KGluZXJ0aWFYWiwgMCwgMCwgMCwgaW5lcnRpYVksIDAsIDAsIDAsIGluZXJ0aWFYWik7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGVQcm94eTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdmFyIHRlID0gdGhpcy5yb3RhdGlvbi5lbGVtZW50cztcclxuICAgICAgdmFyIGxlbiwgd3gsIGh5LCBkeiwgeHgsIHl5LCB6eiwgdywgaCwgZCwgcDtcclxuXHJcbiAgICAgIHh4ID0gdGVbMV0gKiB0ZVsxXTtcclxuICAgICAgeXkgPSB0ZVs0XSAqIHRlWzRdO1xyXG4gICAgICB6eiA9IHRlWzddICogdGVbN107XHJcblxyXG4gICAgICB0aGlzLm5vcm1hbERpcmVjdGlvbi5zZXQodGVbMV0sIHRlWzRdLCB0ZVs3XSk7XHJcbiAgICAgIHRoaXMuaGFsZkRpcmVjdGlvbi5zY2FsZSh0aGlzLm5vcm1hbERpcmVjdGlvbiwgdGhpcy5oYWxmSGVpZ2h0KTtcclxuXHJcbiAgICAgIHd4ID0gMSAtIHh4O1xyXG4gICAgICBsZW4gPSBfTWF0aC5zcXJ0KHd4ICogd3ggKyB4eCAqIHl5ICsgeHggKiB6eik7XHJcbiAgICAgIGlmIChsZW4gPiAwKSBsZW4gPSB0aGlzLnJhZGl1cyAvIGxlbjtcclxuICAgICAgd3ggKj0gbGVuO1xyXG4gICAgICBoeSA9IDEgLSB5eTtcclxuICAgICAgbGVuID0gX01hdGguc3FydCh5eSAqIHh4ICsgaHkgKiBoeSArIHl5ICogenopO1xyXG4gICAgICBpZiAobGVuID4gMCkgbGVuID0gdGhpcy5yYWRpdXMgLyBsZW47XHJcbiAgICAgIGh5ICo9IGxlbjtcclxuICAgICAgZHogPSAxIC0geno7XHJcbiAgICAgIGxlbiA9IF9NYXRoLnNxcnQoenogKiB4eCArIHp6ICogeXkgKyBkeiAqIGR6KTtcclxuICAgICAgaWYgKGxlbiA+IDApIGxlbiA9IHRoaXMucmFkaXVzIC8gbGVuO1xyXG4gICAgICBkeiAqPSBsZW47XHJcblxyXG4gICAgICB3ID0gdGhpcy5oYWxmRGlyZWN0aW9uLnggPCAwID8gLXRoaXMuaGFsZkRpcmVjdGlvbi54IDogdGhpcy5oYWxmRGlyZWN0aW9uLng7XHJcbiAgICAgIGggPSB0aGlzLmhhbGZEaXJlY3Rpb24ueSA8IDAgPyAtdGhpcy5oYWxmRGlyZWN0aW9uLnkgOiB0aGlzLmhhbGZEaXJlY3Rpb24ueTtcclxuICAgICAgZCA9IHRoaXMuaGFsZkRpcmVjdGlvbi56IDwgMCA/IC10aGlzLmhhbGZEaXJlY3Rpb24ueiA6IHRoaXMuaGFsZkRpcmVjdGlvbi56O1xyXG5cclxuICAgICAgdyA9IHd4IDwgMCA/IHcgLSB3eCA6IHcgKyB3eDtcclxuICAgICAgaCA9IGh5IDwgMCA/IGggLSBoeSA6IGggKyBoeTtcclxuICAgICAgZCA9IGR6IDwgMCA/IGQgLSBkeiA6IGQgKyBkejtcclxuXHJcbiAgICAgIHAgPSBBQUJCX1BST1g7XHJcblxyXG4gICAgICB0aGlzLmFhYmIuc2V0KFxyXG4gICAgICAgIHRoaXMucG9zaXRpb24ueCAtIHcgLSBwLCB0aGlzLnBvc2l0aW9uLnggKyB3ICsgcCxcclxuICAgICAgICB0aGlzLnBvc2l0aW9uLnkgLSBoIC0gcCwgdGhpcy5wb3NpdGlvbi55ICsgaCArIHAsXHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbi56IC0gZCAtIHAsIHRoaXMucG9zaXRpb24ueiArIGQgKyBwXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBpZiAodGhpcy5wcm94eSAhPSBudWxsKSB0aGlzLnByb3h5LnVwZGF0ZSgpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFBsYW5lIHNoYXBlLlxyXG4gICAqIEBhdXRob3IgbG8tdGhcclxuICAgKi9cclxuXHJcbiAgZnVuY3Rpb24gUGxhbmUoY29uZmlnLCBub3JtYWwpIHtcclxuXHJcbiAgICBTaGFwZS5jYWxsKHRoaXMsIGNvbmZpZyk7XHJcblxyXG4gICAgdGhpcy50eXBlID0gU0hBUEVfUExBTkU7XHJcblxyXG4gICAgLy8gcmFkaXVzIG9mIHRoZSBzaGFwZS5cclxuICAgIHRoaXMubm9ybWFsID0gbmV3IFZlYzMoMCwgMSwgMCk7XHJcblxyXG4gIH1cclxuICBQbGFuZS5wcm90b3R5cGUgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoU2hhcGUucHJvdG90eXBlKSwge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yOiBQbGFuZSxcclxuXHJcbiAgICB2b2x1bWU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHJldHVybiBOdW1iZXIuTUFYX1ZBTFVFO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2FsY3VsYXRlTWFzc0luZm86IGZ1bmN0aW9uIChvdXQpIHtcclxuXHJcbiAgICAgIG91dC5tYXNzID0gdGhpcy5kZW5zaXR5Oy8vMC4wMDAxO1xyXG4gICAgICB2YXIgaW5lcnRpYSA9IDE7XHJcbiAgICAgIG91dC5pbmVydGlhLnNldChpbmVydGlhLCAwLCAwLCAwLCBpbmVydGlhLCAwLCAwLCAwLCBpbmVydGlhKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHVwZGF0ZVByb3h5OiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB2YXIgcCA9IEFBQkJfUFJPWDtcclxuXHJcbiAgICAgIHZhciBtaW4gPSAtX01hdGguSU5GO1xyXG4gICAgICB2YXIgbWF4ID0gX01hdGguSU5GO1xyXG4gICAgICB2YXIgbiA9IHRoaXMubm9ybWFsO1xyXG4gICAgICAvLyBUaGUgcGxhbmUgQUFCQiBpcyBpbmZpbml0ZSwgZXhjZXB0IGlmIHRoZSBub3JtYWwgaXMgcG9pbnRpbmcgYWxvbmcgYW55IGF4aXNcclxuICAgICAgdGhpcy5hYWJiLnNldChcclxuICAgICAgICBuLnggPT09IC0xID8gdGhpcy5wb3NpdGlvbi54IC0gcCA6IG1pbiwgbi54ID09PSAxID8gdGhpcy5wb3NpdGlvbi54ICsgcCA6IG1heCxcclxuICAgICAgICBuLnkgPT09IC0xID8gdGhpcy5wb3NpdGlvbi55IC0gcCA6IG1pbiwgbi55ID09PSAxID8gdGhpcy5wb3NpdGlvbi55ICsgcCA6IG1heCxcclxuICAgICAgICBuLnogPT09IC0xID8gdGhpcy5wb3NpdGlvbi56IC0gcCA6IG1pbiwgbi56ID09PSAxID8gdGhpcy5wb3NpdGlvbi56ICsgcCA6IG1heFxyXG4gICAgICApO1xyXG5cclxuICAgICAgaWYgKHRoaXMucHJveHkgIT0gbnVsbCkgdGhpcy5wcm94eS51cGRhdGUoKTtcclxuXHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAvKipcclxuICAgKiBBIFBhcnRpY3VsZSBzaGFwZVxyXG4gICAqIEBhdXRob3IgbG8tdGhcclxuICAgKi9cclxuXHJcbiAgZnVuY3Rpb24gUGFydGljbGUoY29uZmlnLCBub3JtYWwpIHtcclxuXHJcbiAgICBTaGFwZS5jYWxsKHRoaXMsIGNvbmZpZyk7XHJcblxyXG4gICAgdGhpcy50eXBlID0gU0hBUEVfUEFSVElDTEU7XHJcblxyXG4gIH1cclxuICBQYXJ0aWNsZS5wcm90b3R5cGUgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoU2hhcGUucHJvdG90eXBlKSwge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yOiBQYXJ0aWNsZSxcclxuXHJcbiAgICB2b2x1bWU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHJldHVybiBOdW1iZXIuTUFYX1ZBTFVFO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2FsY3VsYXRlTWFzc0luZm86IGZ1bmN0aW9uIChvdXQpIHtcclxuXHJcbiAgICAgIHZhciBpbmVydGlhID0gMDtcclxuICAgICAgb3V0LmluZXJ0aWEuc2V0KGluZXJ0aWEsIDAsIDAsIDAsIGluZXJ0aWEsIDAsIDAsIDAsIGluZXJ0aWEpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlUHJveHk6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHZhciBwID0gMDsvL0FBQkJfUFJPWDtcclxuXHJcbiAgICAgIHRoaXMuYWFiYi5zZXQoXHJcbiAgICAgICAgdGhpcy5wb3NpdGlvbi54IC0gcCwgdGhpcy5wb3NpdGlvbi54ICsgcCxcclxuICAgICAgICB0aGlzLnBvc2l0aW9uLnkgLSBwLCB0aGlzLnBvc2l0aW9uLnkgKyBwLFxyXG4gICAgICAgIHRoaXMucG9zaXRpb24ueiAtIHAsIHRoaXMucG9zaXRpb24ueiArIHBcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGlmICh0aGlzLnByb3h5ICE9IG51bGwpIHRoaXMucHJveHkudXBkYXRlKCk7XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgICogQSBzaGFwZSBjb25maWd1cmF0aW9uIGhvbGRzIGNvbW1vbiBjb25maWd1cmF0aW9uIGRhdGEgZm9yIGNvbnN0cnVjdGluZyBhIHNoYXBlLlxyXG4gICAqIFRoZXNlIGNvbmZpZ3VyYXRpb25zIGNhbiBiZSByZXVzZWQgc2FmZWx5LlxyXG4gICAqXHJcbiAgICogQGF1dGhvciBzYWhhcmFuXHJcbiAgICogQGF1dGhvciBsby10aFxyXG4gICAqL1xyXG5cclxuICBmdW5jdGlvbiBTaGFwZUNvbmZpZygpIHtcclxuXHJcbiAgICAvLyBwb3NpdGlvbiBvZiB0aGUgc2hhcGUgaW4gcGFyZW50J3MgY29vcmRpbmF0ZSBzeXN0ZW0uXHJcbiAgICB0aGlzLnJlbGF0aXZlUG9zaXRpb24gPSBuZXcgVmVjMygpO1xyXG4gICAgLy8gcm90YXRpb24gbWF0cml4IG9mIHRoZSBzaGFwZSBpbiBwYXJlbnQncyBjb29yZGluYXRlIHN5c3RlbS5cclxuICAgIHRoaXMucmVsYXRpdmVSb3RhdGlvbiA9IG5ldyBNYXQzMygpO1xyXG4gICAgLy8gY29lZmZpY2llbnQgb2YgZnJpY3Rpb24gb2YgdGhlIHNoYXBlLlxyXG4gICAgdGhpcy5mcmljdGlvbiA9IDAuMjsgLy8gMC40XHJcbiAgICAvLyBjb2VmZmljaWVudCBvZiByZXN0aXR1dGlvbiBvZiB0aGUgc2hhcGUuXHJcbiAgICB0aGlzLnJlc3RpdHV0aW9uID0gMC4yO1xyXG4gICAgLy8gZGVuc2l0eSBvZiB0aGUgc2hhcGUuXHJcbiAgICB0aGlzLmRlbnNpdHkgPSAxO1xyXG4gICAgLy8gYml0cyBvZiB0aGUgY29sbGlzaW9uIGdyb3VwcyB0byB3aGljaCB0aGUgc2hhcGUgYmVsb25ncy5cclxuICAgIHRoaXMuYmVsb25nc1RvID0gMTtcclxuICAgIC8vIGJpdHMgb2YgdGhlIGNvbGxpc2lvbiBncm91cHMgd2l0aCB3aGljaCB0aGUgc2hhcGUgY29sbGlkZXMuXHJcbiAgICB0aGlzLmNvbGxpZGVzV2l0aCA9IDB4ZmZmZmZmZmY7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBBbiBpbmZvcm1hdGlvbiBvZiBsaW1pdCBhbmQgbW90b3IuXHJcbiAgKlxyXG4gICogQGF1dGhvciBzYWhhcmFuXHJcbiAgKi9cclxuXHJcbiAgZnVuY3Rpb24gTGltaXRNb3RvcihheGlzLCBmaXhlZCkge1xyXG5cclxuICAgIGZpeGVkID0gZml4ZWQgfHwgZmFsc2U7XHJcbiAgICAvLyBUaGUgYXhpcyBvZiB0aGUgY29uc3RyYWludC5cclxuICAgIHRoaXMuYXhpcyA9IGF4aXM7XHJcbiAgICAvLyBUaGUgY3VycmVudCBhbmdsZSBmb3Igcm90YXRpb25hbCBjb25zdHJhaW50cy5cclxuICAgIHRoaXMuYW5nbGUgPSAwO1xyXG4gICAgLy8gVGhlIGxvd2VyIGxpbWl0LiBTZXQgbG93ZXIgPiB1cHBlciB0byBkaXNhYmxlXHJcbiAgICB0aGlzLmxvd2VyTGltaXQgPSBmaXhlZCA/IDAgOiAxO1xyXG5cclxuICAgIC8vICBUaGUgdXBwZXIgbGltaXQuIFNldCBsb3dlciA+IHVwcGVyIHRvIGRpc2FibGUuXHJcbiAgICB0aGlzLnVwcGVyTGltaXQgPSAwO1xyXG4gICAgLy8gVGhlIHRhcmdldCBtb3RvciBzcGVlZC5cclxuICAgIHRoaXMubW90b3JTcGVlZCA9IDA7XHJcbiAgICAvLyBUaGUgbWF4aW11bSBtb3RvciBmb3JjZSBvciB0b3JxdWUuIFNldCAwIHRvIGRpc2FibGUuXHJcbiAgICB0aGlzLm1heE1vdG9yRm9yY2UgPSAwO1xyXG4gICAgLy8gVGhlIGZyZXF1ZW5jeSBvZiB0aGUgc3ByaW5nLiBTZXQgMCB0byBkaXNhYmxlLlxyXG4gICAgdGhpcy5mcmVxdWVuY3kgPSAwO1xyXG4gICAgLy8gVGhlIGRhbXBpbmcgcmF0aW8gb2YgdGhlIHNwcmluZy4gU2V0IDAgZm9yIG5vIGRhbXBpbmcsIDEgZm9yIGNyaXRpY2FsIGRhbXBpbmcuXHJcbiAgICB0aGlzLmRhbXBpbmdSYXRpbyA9IDA7XHJcblxyXG4gIH1cclxuICBPYmplY3QuYXNzaWduKExpbWl0TW90b3IucHJvdG90eXBlLCB7XHJcblxyXG4gICAgTGltaXRNb3RvcjogdHJ1ZSxcclxuXHJcbiAgICAvLyBTZXQgbGltaXQgZGF0YSBpbnRvIHRoaXMgY29uc3RyYWludC5cclxuICAgIHNldExpbWl0OiBmdW5jdGlvbiAobG93ZXJMaW1pdCwgdXBwZXJMaW1pdCkge1xyXG5cclxuICAgICAgdGhpcy5sb3dlckxpbWl0ID0gbG93ZXJMaW1pdDtcclxuICAgICAgdGhpcy51cHBlckxpbWl0ID0gdXBwZXJMaW1pdDtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIFNldCBtb3RvciBkYXRhIGludG8gdGhpcyBjb25zdHJhaW50LlxyXG4gICAgc2V0TW90b3I6IGZ1bmN0aW9uIChtb3RvclNwZWVkLCBtYXhNb3RvckZvcmNlKSB7XHJcblxyXG4gICAgICB0aGlzLm1vdG9yU3BlZWQgPSBtb3RvclNwZWVkO1xyXG4gICAgICB0aGlzLm1heE1vdG9yRm9yY2UgPSBtYXhNb3RvckZvcmNlO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gU2V0IHNwcmluZyBkYXRhIGludG8gdGhpcyBjb25zdHJhaW50LlxyXG4gICAgc2V0U3ByaW5nOiBmdW5jdGlvbiAoZnJlcXVlbmN5LCBkYW1waW5nUmF0aW8pIHtcclxuXHJcbiAgICAgIHRoaXMuZnJlcXVlbmN5ID0gZnJlcXVlbmN5O1xyXG4gICAgICB0aGlzLmRhbXBpbmdSYXRpbyA9IGRhbXBpbmdSYXRpbztcclxuXHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAvKipcclxuICAgKiBUaGUgYmFzZSBjbGFzcyBvZiBhbGwgdHlwZSBvZiB0aGUgY29uc3RyYWludHMuXHJcbiAgICpcclxuICAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAgKiBAYXV0aG9yIGxvLXRoXHJcbiAgICovXHJcblxyXG4gIGZ1bmN0aW9uIENvbnN0cmFpbnQoKSB7XHJcblxyXG4gICAgLy8gcGFyZW50IHdvcmxkIG9mIHRoZSBjb25zdHJhaW50LlxyXG4gICAgdGhpcy5wYXJlbnQgPSBudWxsO1xyXG5cclxuICAgIC8vIGZpcnN0IGJvZHkgb2YgdGhlIGNvbnN0cmFpbnQuXHJcbiAgICB0aGlzLmJvZHkxID0gbnVsbDtcclxuXHJcbiAgICAvLyBzZWNvbmQgYm9keSBvZiB0aGUgY29uc3RyYWludC5cclxuICAgIHRoaXMuYm9keTIgPSBudWxsO1xyXG5cclxuICAgIC8vIEludGVybmFsXHJcbiAgICB0aGlzLmFkZGVkVG9Jc2xhbmQgPSBmYWxzZTtcclxuXHJcbiAgfVxyXG5cclxuICBPYmplY3QuYXNzaWduKENvbnN0cmFpbnQucHJvdG90eXBlLCB7XHJcblxyXG4gICAgQ29uc3RyYWludDogdHJ1ZSxcclxuXHJcbiAgICAvLyBQcmVwYXJlIGZvciBzb2x2aW5nIHRoZSBjb25zdHJhaW50XHJcbiAgICBwcmVTb2x2ZTogZnVuY3Rpb24gKHRpbWVTdGVwLCBpbnZUaW1lU3RlcCkge1xyXG5cclxuICAgICAgcHJpbnRFcnJvcihcIkNvbnN0cmFpbnRcIiwgXCJJbmhlcml0YW5jZSBlcnJvci5cIik7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyBTb2x2ZSB0aGUgY29uc3RyYWludC4gVGhpcyBpcyB1c3VhbGx5IGNhbGxlZCBpdGVyYXRpdmVseS5cclxuICAgIHNvbHZlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICBwcmludEVycm9yKFwiQ29uc3RyYWludFwiLCBcIkluaGVyaXRhbmNlIGVycm9yLlwiKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIERvIHRoZSBwb3N0LXByb2Nlc3NpbmcuXHJcbiAgICBwb3N0U29sdmU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHByaW50RXJyb3IoXCJDb25zdHJhaW50XCIsIFwiSW5oZXJpdGFuY2UgZXJyb3IuXCIpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIEpvaW50TGluayhqb2ludCkge1xyXG5cclxuICAgIC8vIFRoZSBwcmV2aW91cyBqb2ludCBsaW5rLlxyXG4gICAgdGhpcy5wcmV2ID0gbnVsbDtcclxuICAgIC8vIFRoZSBuZXh0IGpvaW50IGxpbmsuXHJcbiAgICB0aGlzLm5leHQgPSBudWxsO1xyXG4gICAgLy8gVGhlIG90aGVyIHJpZ2lkIGJvZHkgY29ubmVjdGVkIHRvIHRoZSBqb2ludC5cclxuICAgIHRoaXMuYm9keSA9IG51bGw7XHJcbiAgICAvLyBUaGUgam9pbnQgb2YgdGhlIGxpbmsuXHJcbiAgICB0aGlzLmpvaW50ID0gam9pbnQ7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSm9pbnRzIGFyZSB1c2VkIHRvIGNvbnN0cmFpbiB0aGUgbW90aW9uIGJldHdlZW4gdHdvIHJpZ2lkIGJvZGllcy5cclxuICAgKlxyXG4gICAqIEBhdXRob3Igc2FoYXJhblxyXG4gICAqIEBhdXRob3IgbG8tdGhcclxuICAgKi9cclxuXHJcbiAgZnVuY3Rpb24gSm9pbnQoY29uZmlnKSB7XHJcblxyXG4gICAgQ29uc3RyYWludC5jYWxsKHRoaXMpO1xyXG5cclxuICAgIHRoaXMuc2NhbGUgPSAxO1xyXG4gICAgdGhpcy5pbnZTY2FsZSA9IDE7XHJcblxyXG4gICAgLy8gam9pbnQgbmFtZVxyXG4gICAgdGhpcy5uYW1lID0gXCJcIjtcclxuICAgIHRoaXMuaWQgPSBOYU47XHJcblxyXG4gICAgLy8gVGhlIHR5cGUgb2YgdGhlIGpvaW50LlxyXG4gICAgdGhpcy50eXBlID0gSk9JTlRfTlVMTDtcclxuICAgIC8vICBUaGUgcHJldmlvdXMgam9pbnQgaW4gdGhlIHdvcmxkLlxyXG4gICAgdGhpcy5wcmV2ID0gbnVsbDtcclxuICAgIC8vIFRoZSBuZXh0IGpvaW50IGluIHRoZSB3b3JsZC5cclxuICAgIHRoaXMubmV4dCA9IG51bGw7XHJcblxyXG4gICAgdGhpcy5ib2R5MSA9IGNvbmZpZy5ib2R5MTtcclxuICAgIHRoaXMuYm9keTIgPSBjb25maWcuYm9keTI7XHJcblxyXG4gICAgLy8gYW5jaG9yIHBvaW50IG9uIHRoZSBmaXJzdCByaWdpZCBib2R5IGluIGxvY2FsIGNvb3JkaW5hdGUgc3lzdGVtLlxyXG4gICAgdGhpcy5sb2NhbEFuY2hvclBvaW50MSA9IG5ldyBWZWMzKCkuY29weShjb25maWcubG9jYWxBbmNob3JQb2ludDEpO1xyXG4gICAgLy8gYW5jaG9yIHBvaW50IG9uIHRoZSBzZWNvbmQgcmlnaWQgYm9keSBpbiBsb2NhbCBjb29yZGluYXRlIHN5c3RlbS5cclxuICAgIHRoaXMubG9jYWxBbmNob3JQb2ludDIgPSBuZXcgVmVjMygpLmNvcHkoY29uZmlnLmxvY2FsQW5jaG9yUG9pbnQyKTtcclxuICAgIC8vIGFuY2hvciBwb2ludCBvbiB0aGUgZmlyc3QgcmlnaWQgYm9keSBpbiB3b3JsZCBjb29yZGluYXRlIHN5c3RlbSByZWxhdGl2ZSB0byB0aGUgYm9keSdzIG9yaWdpbi5cclxuICAgIHRoaXMucmVsYXRpdmVBbmNob3JQb2ludDEgPSBuZXcgVmVjMygpO1xyXG4gICAgLy8gYW5jaG9yIHBvaW50IG9uIHRoZSBzZWNvbmQgcmlnaWQgYm9keSBpbiB3b3JsZCBjb29yZGluYXRlIHN5c3RlbSByZWxhdGl2ZSB0byB0aGUgYm9keSdzIG9yaWdpbi5cclxuICAgIHRoaXMucmVsYXRpdmVBbmNob3JQb2ludDIgPSBuZXcgVmVjMygpO1xyXG4gICAgLy8gIGFuY2hvciBwb2ludCBvbiB0aGUgZmlyc3QgcmlnaWQgYm9keSBpbiB3b3JsZCBjb29yZGluYXRlIHN5c3RlbS5cclxuICAgIHRoaXMuYW5jaG9yUG9pbnQxID0gbmV3IFZlYzMoKTtcclxuICAgIC8vIGFuY2hvciBwb2ludCBvbiB0aGUgc2Vjb25kIHJpZ2lkIGJvZHkgaW4gd29ybGQgY29vcmRpbmF0ZSBzeXN0ZW0uXHJcbiAgICB0aGlzLmFuY2hvclBvaW50MiA9IG5ldyBWZWMzKCk7XHJcbiAgICAvLyBXaGV0aGVyIGFsbG93IGNvbGxpc2lvbiBiZXR3ZWVuIGNvbm5lY3RlZCByaWdpZCBib2RpZXMgb3Igbm90LlxyXG4gICAgdGhpcy5hbGxvd0NvbGxpc2lvbiA9IGNvbmZpZy5hbGxvd0NvbGxpc2lvbjtcclxuXHJcbiAgICB0aGlzLmIxTGluayA9IG5ldyBKb2ludExpbmsodGhpcyk7XHJcbiAgICB0aGlzLmIyTGluayA9IG5ldyBKb2ludExpbmsodGhpcyk7XHJcblxyXG4gIH1cclxuICBKb2ludC5wcm90b3R5cGUgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoQ29uc3RyYWludC5wcm90b3R5cGUpLCB7XHJcblxyXG4gICAgY29uc3RydWN0b3I6IEpvaW50LFxyXG5cclxuICAgIHNldElkOiBmdW5jdGlvbiAobikge1xyXG5cclxuICAgICAgdGhpcy5pZCA9IGk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzZXRQYXJlbnQ6IGZ1bmN0aW9uICh3b3JsZCkge1xyXG5cclxuICAgICAgdGhpcy5wYXJlbnQgPSB3b3JsZDtcclxuICAgICAgdGhpcy5zY2FsZSA9IHRoaXMucGFyZW50LnNjYWxlO1xyXG4gICAgICB0aGlzLmludlNjYWxlID0gdGhpcy5wYXJlbnQuaW52U2NhbGU7XHJcbiAgICAgIHRoaXMuaWQgPSB0aGlzLnBhcmVudC5udW1Kb2ludHM7XHJcbiAgICAgIGlmICghdGhpcy5uYW1lKSB0aGlzLm5hbWUgPSAnSicgKyB0aGlzLmlkO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gVXBkYXRlIGFsbCB0aGUgYW5jaG9yIHBvaW50cy5cclxuXHJcbiAgICB1cGRhdGVBbmNob3JQb2ludHM6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHRoaXMucmVsYXRpdmVBbmNob3JQb2ludDEuY29weSh0aGlzLmxvY2FsQW5jaG9yUG9pbnQxKS5hcHBseU1hdHJpeDModGhpcy5ib2R5MS5yb3RhdGlvbiwgdHJ1ZSk7XHJcbiAgICAgIHRoaXMucmVsYXRpdmVBbmNob3JQb2ludDIuY29weSh0aGlzLmxvY2FsQW5jaG9yUG9pbnQyKS5hcHBseU1hdHJpeDModGhpcy5ib2R5Mi5yb3RhdGlvbiwgdHJ1ZSk7XHJcblxyXG4gICAgICB0aGlzLmFuY2hvclBvaW50MS5hZGQodGhpcy5yZWxhdGl2ZUFuY2hvclBvaW50MSwgdGhpcy5ib2R5MS5wb3NpdGlvbik7XHJcbiAgICAgIHRoaXMuYW5jaG9yUG9pbnQyLmFkZCh0aGlzLnJlbGF0aXZlQW5jaG9yUG9pbnQyLCB0aGlzLmJvZHkyLnBvc2l0aW9uKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIEF0dGFjaCB0aGUgam9pbnQgZnJvbSB0aGUgYm9kaWVzLlxyXG5cclxuICAgIGF0dGFjaDogZnVuY3Rpb24gKGlzWCkge1xyXG5cclxuICAgICAgdGhpcy5iMUxpbmsuYm9keSA9IHRoaXMuYm9keTI7XHJcbiAgICAgIHRoaXMuYjJMaW5rLmJvZHkgPSB0aGlzLmJvZHkxO1xyXG5cclxuICAgICAgaWYgKGlzWCkge1xyXG5cclxuICAgICAgICB0aGlzLmJvZHkxLmpvaW50TGluay5wdXNoKHRoaXMuYjFMaW5rKTtcclxuICAgICAgICB0aGlzLmJvZHkyLmpvaW50TGluay5wdXNoKHRoaXMuYjJMaW5rKTtcclxuICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuYm9keTEuam9pbnRMaW5rICE9IG51bGwpICh0aGlzLmIxTGluay5uZXh0ID0gdGhpcy5ib2R5MS5qb2ludExpbmspLnByZXYgPSB0aGlzLmIxTGluaztcclxuICAgICAgICBlbHNlIHRoaXMuYjFMaW5rLm5leHQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuYm9keTEuam9pbnRMaW5rID0gdGhpcy5iMUxpbms7XHJcbiAgICAgICAgdGhpcy5ib2R5MS5udW1Kb2ludHMrKztcclxuICAgICAgICBpZiAodGhpcy5ib2R5Mi5qb2ludExpbmsgIT0gbnVsbCkgKHRoaXMuYjJMaW5rLm5leHQgPSB0aGlzLmJvZHkyLmpvaW50TGluaykucHJldiA9IHRoaXMuYjJMaW5rO1xyXG4gICAgICAgIGVsc2UgdGhpcy5iMkxpbmsubmV4dCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5ib2R5Mi5qb2ludExpbmsgPSB0aGlzLmIyTGluaztcclxuICAgICAgICB0aGlzLmJvZHkyLm51bUpvaW50cysrO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gRGV0YWNoIHRoZSBqb2ludCBmcm9tIHRoZSBib2RpZXMuXHJcblxyXG4gICAgZGV0YWNoOiBmdW5jdGlvbiAoaXNYKSB7XHJcblxyXG4gICAgICBpZiAoaXNYKSB7XHJcblxyXG4gICAgICAgIHRoaXMuYm9keTEuam9pbnRMaW5rLnNwbGljZSh0aGlzLmJvZHkxLmpvaW50TGluay5pbmRleE9mKHRoaXMuYjFMaW5rKSwgMSk7XHJcbiAgICAgICAgdGhpcy5ib2R5Mi5qb2ludExpbmsuc3BsaWNlKHRoaXMuYm9keTIuam9pbnRMaW5rLmluZGV4T2YodGhpcy5iMkxpbmspLCAxKTtcclxuXHJcbiAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgIHZhciBwcmV2ID0gdGhpcy5iMUxpbmsucHJldjtcclxuICAgICAgICB2YXIgbmV4dCA9IHRoaXMuYjFMaW5rLm5leHQ7XHJcbiAgICAgICAgaWYgKHByZXYgIT0gbnVsbCkgcHJldi5uZXh0ID0gbmV4dDtcclxuICAgICAgICBpZiAobmV4dCAhPSBudWxsKSBuZXh0LnByZXYgPSBwcmV2O1xyXG4gICAgICAgIGlmICh0aGlzLmJvZHkxLmpvaW50TGluayA9PSB0aGlzLmIxTGluaykgdGhpcy5ib2R5MS5qb2ludExpbmsgPSBuZXh0O1xyXG4gICAgICAgIHRoaXMuYjFMaW5rLnByZXYgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuYjFMaW5rLm5leHQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuYjFMaW5rLmJvZHkgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuYm9keTEubnVtSm9pbnRzLS07XHJcblxyXG4gICAgICAgIHByZXYgPSB0aGlzLmIyTGluay5wcmV2O1xyXG4gICAgICAgIG5leHQgPSB0aGlzLmIyTGluay5uZXh0O1xyXG4gICAgICAgIGlmIChwcmV2ICE9IG51bGwpIHByZXYubmV4dCA9IG5leHQ7XHJcbiAgICAgICAgaWYgKG5leHQgIT0gbnVsbCkgbmV4dC5wcmV2ID0gcHJldjtcclxuICAgICAgICBpZiAodGhpcy5ib2R5Mi5qb2ludExpbmsgPT0gdGhpcy5iMkxpbmspIHRoaXMuYm9keTIuam9pbnRMaW5rID0gbmV4dDtcclxuICAgICAgICB0aGlzLmIyTGluay5wcmV2ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmIyTGluay5uZXh0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmIyTGluay5ib2R5ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmJvZHkyLm51bUpvaW50cy0tO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5iMUxpbmsuYm9keSA9IG51bGw7XHJcbiAgICAgIHRoaXMuYjJMaW5rLmJvZHkgPSBudWxsO1xyXG5cclxuICAgIH0sXHJcblxyXG5cclxuICAgIC8vIEF3YWtlIHRoZSBib2RpZXMuXHJcblxyXG4gICAgYXdha2U6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHRoaXMuYm9keTEuYXdha2UoKTtcclxuICAgICAgdGhpcy5ib2R5Mi5hd2FrZSgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gY2FsY3VsYXRpb24gZnVuY3Rpb25cclxuXHJcbiAgICBwcmVTb2x2ZTogZnVuY3Rpb24gKHRpbWVTdGVwLCBpbnZUaW1lU3RlcCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc29sdmU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHBvc3RTb2x2ZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gRGVsZXRlIHByb2Nlc3NcclxuXHJcbiAgICByZW1vdmU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHRoaXMuZGlzcG9zZSgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgZGlzcG9zZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdGhpcy5wYXJlbnQucmVtb3ZlSm9pbnQodGhpcyk7XHJcblxyXG4gICAgfSxcclxuXHJcblxyXG4gICAgLy8gVGhyZWUganMgYWRkXHJcblxyXG4gICAgZ2V0UG9zaXRpb246IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHZhciBwMSA9IG5ldyBWZWMzKCkuc2NhbGUodGhpcy5hbmNob3JQb2ludDEsIHRoaXMuc2NhbGUpO1xyXG4gICAgICB2YXIgcDIgPSBuZXcgVmVjMygpLnNjYWxlKHRoaXMuYW5jaG9yUG9pbnQyLCB0aGlzLnNjYWxlKTtcclxuICAgICAgcmV0dXJuIFtwMSwgcDJdO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIC8qKlxyXG4gICogQSBsaW5lYXIgY29uc3RyYWludCBmb3IgYWxsIGF4ZXMgZm9yIHZhcmlvdXMgam9pbnRzLlxyXG4gICogQGF1dGhvciBzYWhhcmFuXHJcbiAgKi9cclxuICBmdW5jdGlvbiBMaW5lYXJDb25zdHJhaW50KGpvaW50KSB7XHJcblxyXG4gICAgdGhpcy5tMSA9IE5hTjtcclxuICAgIHRoaXMubTIgPSBOYU47XHJcblxyXG4gICAgdGhpcy5paTEgPSBudWxsO1xyXG4gICAgdGhpcy5paTIgPSBudWxsO1xyXG4gICAgdGhpcy5kZCA9IG51bGw7XHJcblxyXG4gICAgdGhpcy5yMXggPSBOYU47XHJcbiAgICB0aGlzLnIxeSA9IE5hTjtcclxuICAgIHRoaXMucjF6ID0gTmFOO1xyXG5cclxuICAgIHRoaXMucjJ4ID0gTmFOO1xyXG4gICAgdGhpcy5yMnkgPSBOYU47XHJcbiAgICB0aGlzLnIyeiA9IE5hTjtcclxuXHJcbiAgICB0aGlzLmF4MXggPSBOYU47XHJcbiAgICB0aGlzLmF4MXkgPSBOYU47XHJcbiAgICB0aGlzLmF4MXogPSBOYU47XHJcbiAgICB0aGlzLmF5MXggPSBOYU47XHJcbiAgICB0aGlzLmF5MXkgPSBOYU47XHJcbiAgICB0aGlzLmF5MXogPSBOYU47XHJcbiAgICB0aGlzLmF6MXggPSBOYU47XHJcbiAgICB0aGlzLmF6MXkgPSBOYU47XHJcbiAgICB0aGlzLmF6MXogPSBOYU47XHJcblxyXG4gICAgdGhpcy5heDJ4ID0gTmFOO1xyXG4gICAgdGhpcy5heDJ5ID0gTmFOO1xyXG4gICAgdGhpcy5heDJ6ID0gTmFOO1xyXG4gICAgdGhpcy5heTJ4ID0gTmFOO1xyXG4gICAgdGhpcy5heTJ5ID0gTmFOO1xyXG4gICAgdGhpcy5heTJ6ID0gTmFOO1xyXG4gICAgdGhpcy5hejJ4ID0gTmFOO1xyXG4gICAgdGhpcy5hejJ5ID0gTmFOO1xyXG4gICAgdGhpcy5hejJ6ID0gTmFOO1xyXG5cclxuICAgIHRoaXMudmVsID0gTmFOO1xyXG4gICAgdGhpcy52ZWx4ID0gTmFOO1xyXG4gICAgdGhpcy52ZWx5ID0gTmFOO1xyXG4gICAgdGhpcy52ZWx6ID0gTmFOO1xyXG5cclxuXHJcbiAgICB0aGlzLmpvaW50ID0gam9pbnQ7XHJcbiAgICB0aGlzLnIxID0gam9pbnQucmVsYXRpdmVBbmNob3JQb2ludDE7XHJcbiAgICB0aGlzLnIyID0gam9pbnQucmVsYXRpdmVBbmNob3JQb2ludDI7XHJcbiAgICB0aGlzLnAxID0gam9pbnQuYW5jaG9yUG9pbnQxO1xyXG4gICAgdGhpcy5wMiA9IGpvaW50LmFuY2hvclBvaW50MjtcclxuICAgIHRoaXMuYjEgPSBqb2ludC5ib2R5MTtcclxuICAgIHRoaXMuYjIgPSBqb2ludC5ib2R5MjtcclxuICAgIHRoaXMubDEgPSB0aGlzLmIxLmxpbmVhclZlbG9jaXR5O1xyXG4gICAgdGhpcy5sMiA9IHRoaXMuYjIubGluZWFyVmVsb2NpdHk7XHJcbiAgICB0aGlzLmExID0gdGhpcy5iMS5hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICB0aGlzLmEyID0gdGhpcy5iMi5hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICB0aGlzLmkxID0gdGhpcy5iMS5pbnZlcnNlSW5lcnRpYTtcclxuICAgIHRoaXMuaTIgPSB0aGlzLmIyLmludmVyc2VJbmVydGlhO1xyXG4gICAgdGhpcy5pbXB4ID0gMDtcclxuICAgIHRoaXMuaW1weSA9IDA7XHJcbiAgICB0aGlzLmltcHogPSAwO1xyXG5cclxuICB9XHJcblxyXG4gIE9iamVjdC5hc3NpZ24oTGluZWFyQ29uc3RyYWludC5wcm90b3R5cGUsIHtcclxuXHJcbiAgICBMaW5lYXJDb25zdHJhaW50OiB0cnVlLFxyXG5cclxuICAgIHByZVNvbHZlOiBmdW5jdGlvbiAodGltZVN0ZXAsIGludlRpbWVTdGVwKSB7XHJcblxyXG4gICAgICB0aGlzLnIxeCA9IHRoaXMucjEueDtcclxuICAgICAgdGhpcy5yMXkgPSB0aGlzLnIxLnk7XHJcbiAgICAgIHRoaXMucjF6ID0gdGhpcy5yMS56O1xyXG5cclxuICAgICAgdGhpcy5yMnggPSB0aGlzLnIyLng7XHJcbiAgICAgIHRoaXMucjJ5ID0gdGhpcy5yMi55O1xyXG4gICAgICB0aGlzLnIyeiA9IHRoaXMucjIuejtcclxuXHJcbiAgICAgIHRoaXMubTEgPSB0aGlzLmIxLmludmVyc2VNYXNzO1xyXG4gICAgICB0aGlzLm0yID0gdGhpcy5iMi5pbnZlcnNlTWFzcztcclxuXHJcbiAgICAgIHRoaXMuaWkxID0gdGhpcy5pMS5jbG9uZSgpO1xyXG4gICAgICB0aGlzLmlpMiA9IHRoaXMuaTIuY2xvbmUoKTtcclxuXHJcbiAgICAgIHZhciBpaTEgPSB0aGlzLmlpMS5lbGVtZW50cztcclxuICAgICAgdmFyIGlpMiA9IHRoaXMuaWkyLmVsZW1lbnRzO1xyXG5cclxuICAgICAgdGhpcy5heDF4ID0gdGhpcy5yMXogKiBpaTFbMV0gKyAtdGhpcy5yMXkgKiBpaTFbMl07XHJcbiAgICAgIHRoaXMuYXgxeSA9IHRoaXMucjF6ICogaWkxWzRdICsgLXRoaXMucjF5ICogaWkxWzVdO1xyXG4gICAgICB0aGlzLmF4MXogPSB0aGlzLnIxeiAqIGlpMVs3XSArIC10aGlzLnIxeSAqIGlpMVs4XTtcclxuICAgICAgdGhpcy5heTF4ID0gLXRoaXMucjF6ICogaWkxWzBdICsgdGhpcy5yMXggKiBpaTFbMl07XHJcbiAgICAgIHRoaXMuYXkxeSA9IC10aGlzLnIxeiAqIGlpMVszXSArIHRoaXMucjF4ICogaWkxWzVdO1xyXG4gICAgICB0aGlzLmF5MXogPSAtdGhpcy5yMXogKiBpaTFbNl0gKyB0aGlzLnIxeCAqIGlpMVs4XTtcclxuICAgICAgdGhpcy5hejF4ID0gdGhpcy5yMXkgKiBpaTFbMF0gKyAtdGhpcy5yMXggKiBpaTFbMV07XHJcbiAgICAgIHRoaXMuYXoxeSA9IHRoaXMucjF5ICogaWkxWzNdICsgLXRoaXMucjF4ICogaWkxWzRdO1xyXG4gICAgICB0aGlzLmF6MXogPSB0aGlzLnIxeSAqIGlpMVs2XSArIC10aGlzLnIxeCAqIGlpMVs3XTtcclxuICAgICAgdGhpcy5heDJ4ID0gdGhpcy5yMnogKiBpaTJbMV0gKyAtdGhpcy5yMnkgKiBpaTJbMl07XHJcbiAgICAgIHRoaXMuYXgyeSA9IHRoaXMucjJ6ICogaWkyWzRdICsgLXRoaXMucjJ5ICogaWkyWzVdO1xyXG4gICAgICB0aGlzLmF4MnogPSB0aGlzLnIyeiAqIGlpMls3XSArIC10aGlzLnIyeSAqIGlpMls4XTtcclxuICAgICAgdGhpcy5heTJ4ID0gLXRoaXMucjJ6ICogaWkyWzBdICsgdGhpcy5yMnggKiBpaTJbMl07XHJcbiAgICAgIHRoaXMuYXkyeSA9IC10aGlzLnIyeiAqIGlpMlszXSArIHRoaXMucjJ4ICogaWkyWzVdO1xyXG4gICAgICB0aGlzLmF5MnogPSAtdGhpcy5yMnogKiBpaTJbNl0gKyB0aGlzLnIyeCAqIGlpMls4XTtcclxuICAgICAgdGhpcy5hejJ4ID0gdGhpcy5yMnkgKiBpaTJbMF0gKyAtdGhpcy5yMnggKiBpaTJbMV07XHJcbiAgICAgIHRoaXMuYXoyeSA9IHRoaXMucjJ5ICogaWkyWzNdICsgLXRoaXMucjJ4ICogaWkyWzRdO1xyXG4gICAgICB0aGlzLmF6MnogPSB0aGlzLnIyeSAqIGlpMls2XSArIC10aGlzLnIyeCAqIGlpMls3XTtcclxuXHJcbiAgICAgIC8vIGNhbGN1bGF0ZSBwb2ludC10by1wb2ludCBtYXNzIG1hdHJpeFxyXG4gICAgICAvLyBmcm9tIGltcHVsc2UgZXF1YXRpb25cclxuICAgICAgLy8gXHJcbiAgICAgIC8vIE0gPSAoWy9tXSAtIFtyXl1bL0ldW3JeXSkgXiAtMVxyXG4gICAgICAvLyBcclxuICAgICAgLy8gd2hlcmVcclxuICAgICAgLy8gXHJcbiAgICAgIC8vIFsvbV0gPSB8MS9tLCAwLCAwfFxyXG4gICAgICAvLyAgICAgICAgfDAsIDEvbSwgMHxcclxuICAgICAgLy8gICAgICAgIHwwLCAwLCAxL218XHJcbiAgICAgIC8vIFxyXG4gICAgICAvLyBbcl5dID0gfDAsIC1yeiwgcnl8XHJcbiAgICAgIC8vICAgICAgICB8cnosIDAsIC1yeHxcclxuICAgICAgLy8gICAgICAgIHwtcnksIHJ4LCAwfFxyXG4gICAgICAvLyBcclxuICAgICAgLy8gWy9JXSA9IEludmVydGVkIG1vbWVudCBpbmVydGlhXHJcblxyXG4gICAgICB2YXIgcnh4ID0gdGhpcy5tMSArIHRoaXMubTI7XHJcblxyXG4gICAgICB2YXIga2sgPSBuZXcgTWF0MzMoKS5zZXQocnh4LCAwLCAwLCAwLCByeHgsIDAsIDAsIDAsIHJ4eCk7XHJcbiAgICAgIHZhciBrID0ga2suZWxlbWVudHM7XHJcblxyXG4gICAgICBrWzBdICs9IGlpMVs0XSAqIHRoaXMucjF6ICogdGhpcy5yMXogLSAoaWkxWzddICsgaWkxWzVdKSAqIHRoaXMucjF5ICogdGhpcy5yMXogKyBpaTFbOF0gKiB0aGlzLnIxeSAqIHRoaXMucjF5O1xyXG4gICAgICBrWzFdICs9IChpaTFbNl0gKiB0aGlzLnIxeSArIGlpMVs1XSAqIHRoaXMucjF4KSAqIHRoaXMucjF6IC0gaWkxWzNdICogdGhpcy5yMXogKiB0aGlzLnIxeiAtIGlpMVs4XSAqIHRoaXMucjF4ICogdGhpcy5yMXk7XHJcbiAgICAgIGtbMl0gKz0gKGlpMVszXSAqIHRoaXMucjF5IC0gaWkxWzRdICogdGhpcy5yMXgpICogdGhpcy5yMXogLSBpaTFbNl0gKiB0aGlzLnIxeSAqIHRoaXMucjF5ICsgaWkxWzddICogdGhpcy5yMXggKiB0aGlzLnIxeTtcclxuICAgICAga1szXSArPSAoaWkxWzJdICogdGhpcy5yMXkgKyBpaTFbN10gKiB0aGlzLnIxeCkgKiB0aGlzLnIxeiAtIGlpMVsxXSAqIHRoaXMucjF6ICogdGhpcy5yMXogLSBpaTFbOF0gKiB0aGlzLnIxeCAqIHRoaXMucjF5O1xyXG4gICAgICBrWzRdICs9IGlpMVswXSAqIHRoaXMucjF6ICogdGhpcy5yMXogLSAoaWkxWzZdICsgaWkxWzJdKSAqIHRoaXMucjF4ICogdGhpcy5yMXogKyBpaTFbOF0gKiB0aGlzLnIxeCAqIHRoaXMucjF4O1xyXG4gICAgICBrWzVdICs9IChpaTFbMV0gKiB0aGlzLnIxeCAtIGlpMVswXSAqIHRoaXMucjF5KSAqIHRoaXMucjF6IC0gaWkxWzddICogdGhpcy5yMXggKiB0aGlzLnIxeCArIGlpMVs2XSAqIHRoaXMucjF4ICogdGhpcy5yMXk7XHJcbiAgICAgIGtbNl0gKz0gKGlpMVsxXSAqIHRoaXMucjF5IC0gaWkxWzRdICogdGhpcy5yMXgpICogdGhpcy5yMXogLSBpaTFbMl0gKiB0aGlzLnIxeSAqIHRoaXMucjF5ICsgaWkxWzVdICogdGhpcy5yMXggKiB0aGlzLnIxeTtcclxuICAgICAga1s3XSArPSAoaWkxWzNdICogdGhpcy5yMXggLSBpaTFbMF0gKiB0aGlzLnIxeSkgKiB0aGlzLnIxeiAtIGlpMVs1XSAqIHRoaXMucjF4ICogdGhpcy5yMXggKyBpaTFbMl0gKiB0aGlzLnIxeCAqIHRoaXMucjF5O1xyXG4gICAgICBrWzhdICs9IGlpMVswXSAqIHRoaXMucjF5ICogdGhpcy5yMXkgLSAoaWkxWzNdICsgaWkxWzFdKSAqIHRoaXMucjF4ICogdGhpcy5yMXkgKyBpaTFbNF0gKiB0aGlzLnIxeCAqIHRoaXMucjF4O1xyXG5cclxuICAgICAga1swXSArPSBpaTJbNF0gKiB0aGlzLnIyeiAqIHRoaXMucjJ6IC0gKGlpMls3XSArIGlpMls1XSkgKiB0aGlzLnIyeSAqIHRoaXMucjJ6ICsgaWkyWzhdICogdGhpcy5yMnkgKiB0aGlzLnIyeTtcclxuICAgICAga1sxXSArPSAoaWkyWzZdICogdGhpcy5yMnkgKyBpaTJbNV0gKiB0aGlzLnIyeCkgKiB0aGlzLnIyeiAtIGlpMlszXSAqIHRoaXMucjJ6ICogdGhpcy5yMnogLSBpaTJbOF0gKiB0aGlzLnIyeCAqIHRoaXMucjJ5O1xyXG4gICAgICBrWzJdICs9IChpaTJbM10gKiB0aGlzLnIyeSAtIGlpMls0XSAqIHRoaXMucjJ4KSAqIHRoaXMucjJ6IC0gaWkyWzZdICogdGhpcy5yMnkgKiB0aGlzLnIyeSArIGlpMls3XSAqIHRoaXMucjJ4ICogdGhpcy5yMnk7XHJcbiAgICAgIGtbM10gKz0gKGlpMlsyXSAqIHRoaXMucjJ5ICsgaWkyWzddICogdGhpcy5yMngpICogdGhpcy5yMnogLSBpaTJbMV0gKiB0aGlzLnIyeiAqIHRoaXMucjJ6IC0gaWkyWzhdICogdGhpcy5yMnggKiB0aGlzLnIyeTtcclxuICAgICAga1s0XSArPSBpaTJbMF0gKiB0aGlzLnIyeiAqIHRoaXMucjJ6IC0gKGlpMls2XSArIGlpMlsyXSkgKiB0aGlzLnIyeCAqIHRoaXMucjJ6ICsgaWkyWzhdICogdGhpcy5yMnggKiB0aGlzLnIyeDtcclxuICAgICAga1s1XSArPSAoaWkyWzFdICogdGhpcy5yMnggLSBpaTJbMF0gKiB0aGlzLnIyeSkgKiB0aGlzLnIyeiAtIGlpMls3XSAqIHRoaXMucjJ4ICogdGhpcy5yMnggKyBpaTJbNl0gKiB0aGlzLnIyeCAqIHRoaXMucjJ5O1xyXG4gICAgICBrWzZdICs9IChpaTJbMV0gKiB0aGlzLnIyeSAtIGlpMls0XSAqIHRoaXMucjJ4KSAqIHRoaXMucjJ6IC0gaWkyWzJdICogdGhpcy5yMnkgKiB0aGlzLnIyeSArIGlpMls1XSAqIHRoaXMucjJ4ICogdGhpcy5yMnk7XHJcbiAgICAgIGtbN10gKz0gKGlpMlszXSAqIHRoaXMucjJ4IC0gaWkyWzBdICogdGhpcy5yMnkpICogdGhpcy5yMnogLSBpaTJbNV0gKiB0aGlzLnIyeCAqIHRoaXMucjJ4ICsgaWkyWzJdICogdGhpcy5yMnggKiB0aGlzLnIyeTtcclxuICAgICAga1s4XSArPSBpaTJbMF0gKiB0aGlzLnIyeSAqIHRoaXMucjJ5IC0gKGlpMlszXSArIGlpMlsxXSkgKiB0aGlzLnIyeCAqIHRoaXMucjJ5ICsgaWkyWzRdICogdGhpcy5yMnggKiB0aGlzLnIyeDtcclxuXHJcbiAgICAgIHZhciBpbnYgPSAxIC8gKGtbMF0gKiAoa1s0XSAqIGtbOF0gLSBrWzddICoga1s1XSkgKyBrWzNdICogKGtbN10gKiBrWzJdIC0ga1sxXSAqIGtbOF0pICsga1s2XSAqIChrWzFdICoga1s1XSAtIGtbNF0gKiBrWzJdKSk7XHJcbiAgICAgIHRoaXMuZGQgPSBuZXcgTWF0MzMoKS5zZXQoXHJcbiAgICAgICAga1s0XSAqIGtbOF0gLSBrWzVdICoga1s3XSwga1syXSAqIGtbN10gLSBrWzFdICoga1s4XSwga1sxXSAqIGtbNV0gLSBrWzJdICoga1s0XSxcclxuICAgICAgICBrWzVdICoga1s2XSAtIGtbM10gKiBrWzhdLCBrWzBdICoga1s4XSAtIGtbMl0gKiBrWzZdLCBrWzJdICoga1szXSAtIGtbMF0gKiBrWzVdLFxyXG4gICAgICAgIGtbM10gKiBrWzddIC0ga1s0XSAqIGtbNl0sIGtbMV0gKiBrWzZdIC0ga1swXSAqIGtbN10sIGtbMF0gKiBrWzRdIC0ga1sxXSAqIGtbM11cclxuICAgICAgKS5zY2FsZUVxdWFsKGludik7XHJcblxyXG4gICAgICB0aGlzLnZlbHggPSB0aGlzLnAyLnggLSB0aGlzLnAxLng7XHJcbiAgICAgIHRoaXMudmVseSA9IHRoaXMucDIueSAtIHRoaXMucDEueTtcclxuICAgICAgdGhpcy52ZWx6ID0gdGhpcy5wMi56IC0gdGhpcy5wMS56O1xyXG4gICAgICB2YXIgbGVuID0gX01hdGguc3FydCh0aGlzLnZlbHggKiB0aGlzLnZlbHggKyB0aGlzLnZlbHkgKiB0aGlzLnZlbHkgKyB0aGlzLnZlbHogKiB0aGlzLnZlbHopO1xyXG4gICAgICBpZiAobGVuID4gMC4wMDUpIHtcclxuICAgICAgICBsZW4gPSAoMC4wMDUgLSBsZW4pIC8gbGVuICogaW52VGltZVN0ZXAgKiAwLjA1O1xyXG4gICAgICAgIHRoaXMudmVseCAqPSBsZW47XHJcbiAgICAgICAgdGhpcy52ZWx5ICo9IGxlbjtcclxuICAgICAgICB0aGlzLnZlbHogKj0gbGVuO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMudmVseCA9IDA7XHJcbiAgICAgICAgdGhpcy52ZWx5ID0gMDtcclxuICAgICAgICB0aGlzLnZlbHogPSAwO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLmltcHggKj0gMC45NTtcclxuICAgICAgdGhpcy5pbXB5ICo9IDAuOTU7XHJcbiAgICAgIHRoaXMuaW1weiAqPSAwLjk1O1xyXG5cclxuICAgICAgdGhpcy5sMS54ICs9IHRoaXMuaW1weCAqIHRoaXMubTE7XHJcbiAgICAgIHRoaXMubDEueSArPSB0aGlzLmltcHkgKiB0aGlzLm0xO1xyXG4gICAgICB0aGlzLmwxLnogKz0gdGhpcy5pbXB6ICogdGhpcy5tMTtcclxuICAgICAgdGhpcy5hMS54ICs9IHRoaXMuaW1weCAqIHRoaXMuYXgxeCArIHRoaXMuaW1weSAqIHRoaXMuYXkxeCArIHRoaXMuaW1weiAqIHRoaXMuYXoxeDtcclxuICAgICAgdGhpcy5hMS55ICs9IHRoaXMuaW1weCAqIHRoaXMuYXgxeSArIHRoaXMuaW1weSAqIHRoaXMuYXkxeSArIHRoaXMuaW1weiAqIHRoaXMuYXoxeTtcclxuICAgICAgdGhpcy5hMS56ICs9IHRoaXMuaW1weCAqIHRoaXMuYXgxeiArIHRoaXMuaW1weSAqIHRoaXMuYXkxeiArIHRoaXMuaW1weiAqIHRoaXMuYXoxejtcclxuICAgICAgdGhpcy5sMi54IC09IHRoaXMuaW1weCAqIHRoaXMubTI7XHJcbiAgICAgIHRoaXMubDIueSAtPSB0aGlzLmltcHkgKiB0aGlzLm0yO1xyXG4gICAgICB0aGlzLmwyLnogLT0gdGhpcy5pbXB6ICogdGhpcy5tMjtcclxuICAgICAgdGhpcy5hMi54IC09IHRoaXMuaW1weCAqIHRoaXMuYXgyeCArIHRoaXMuaW1weSAqIHRoaXMuYXkyeCArIHRoaXMuaW1weiAqIHRoaXMuYXoyeDtcclxuICAgICAgdGhpcy5hMi55IC09IHRoaXMuaW1weCAqIHRoaXMuYXgyeSArIHRoaXMuaW1weSAqIHRoaXMuYXkyeSArIHRoaXMuaW1weiAqIHRoaXMuYXoyeTtcclxuICAgICAgdGhpcy5hMi56IC09IHRoaXMuaW1weCAqIHRoaXMuYXgyeiArIHRoaXMuaW1weSAqIHRoaXMuYXkyeiArIHRoaXMuaW1weiAqIHRoaXMuYXoyejtcclxuICAgIH0sXHJcblxyXG4gICAgc29sdmU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHZhciBkID0gdGhpcy5kZC5lbGVtZW50cztcclxuICAgICAgdmFyIHJ2eCA9IHRoaXMubDIueCAtIHRoaXMubDEueCArIHRoaXMuYTIueSAqIHRoaXMucjJ6IC0gdGhpcy5hMi56ICogdGhpcy5yMnkgLSB0aGlzLmExLnkgKiB0aGlzLnIxeiArIHRoaXMuYTEueiAqIHRoaXMucjF5IC0gdGhpcy52ZWx4O1xyXG4gICAgICB2YXIgcnZ5ID0gdGhpcy5sMi55IC0gdGhpcy5sMS55ICsgdGhpcy5hMi56ICogdGhpcy5yMnggLSB0aGlzLmEyLnggKiB0aGlzLnIyeiAtIHRoaXMuYTEueiAqIHRoaXMucjF4ICsgdGhpcy5hMS54ICogdGhpcy5yMXogLSB0aGlzLnZlbHk7XHJcbiAgICAgIHZhciBydnogPSB0aGlzLmwyLnogLSB0aGlzLmwxLnogKyB0aGlzLmEyLnggKiB0aGlzLnIyeSAtIHRoaXMuYTIueSAqIHRoaXMucjJ4IC0gdGhpcy5hMS54ICogdGhpcy5yMXkgKyB0aGlzLmExLnkgKiB0aGlzLnIxeCAtIHRoaXMudmVsejtcclxuICAgICAgdmFyIG5pbXB4ID0gcnZ4ICogZFswXSArIHJ2eSAqIGRbMV0gKyBydnogKiBkWzJdO1xyXG4gICAgICB2YXIgbmltcHkgPSBydnggKiBkWzNdICsgcnZ5ICogZFs0XSArIHJ2eiAqIGRbNV07XHJcbiAgICAgIHZhciBuaW1weiA9IHJ2eCAqIGRbNl0gKyBydnkgKiBkWzddICsgcnZ6ICogZFs4XTtcclxuICAgICAgdGhpcy5pbXB4ICs9IG5pbXB4O1xyXG4gICAgICB0aGlzLmltcHkgKz0gbmltcHk7XHJcbiAgICAgIHRoaXMuaW1weiArPSBuaW1wejtcclxuICAgICAgdGhpcy5sMS54ICs9IG5pbXB4ICogdGhpcy5tMTtcclxuICAgICAgdGhpcy5sMS55ICs9IG5pbXB5ICogdGhpcy5tMTtcclxuICAgICAgdGhpcy5sMS56ICs9IG5pbXB6ICogdGhpcy5tMTtcclxuICAgICAgdGhpcy5hMS54ICs9IG5pbXB4ICogdGhpcy5heDF4ICsgbmltcHkgKiB0aGlzLmF5MXggKyBuaW1weiAqIHRoaXMuYXoxeDtcclxuICAgICAgdGhpcy5hMS55ICs9IG5pbXB4ICogdGhpcy5heDF5ICsgbmltcHkgKiB0aGlzLmF5MXkgKyBuaW1weiAqIHRoaXMuYXoxeTtcclxuICAgICAgdGhpcy5hMS56ICs9IG5pbXB4ICogdGhpcy5heDF6ICsgbmltcHkgKiB0aGlzLmF5MXogKyBuaW1weiAqIHRoaXMuYXoxejtcclxuICAgICAgdGhpcy5sMi54IC09IG5pbXB4ICogdGhpcy5tMjtcclxuICAgICAgdGhpcy5sMi55IC09IG5pbXB5ICogdGhpcy5tMjtcclxuICAgICAgdGhpcy5sMi56IC09IG5pbXB6ICogdGhpcy5tMjtcclxuICAgICAgdGhpcy5hMi54IC09IG5pbXB4ICogdGhpcy5heDJ4ICsgbmltcHkgKiB0aGlzLmF5MnggKyBuaW1weiAqIHRoaXMuYXoyeDtcclxuICAgICAgdGhpcy5hMi55IC09IG5pbXB4ICogdGhpcy5heDJ5ICsgbmltcHkgKiB0aGlzLmF5MnkgKyBuaW1weiAqIHRoaXMuYXoyeTtcclxuICAgICAgdGhpcy5hMi56IC09IG5pbXB4ICogdGhpcy5heDJ6ICsgbmltcHkgKiB0aGlzLmF5MnogKyBuaW1weiAqIHRoaXMuYXoyejtcclxuXHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAvKipcclxuICAqIEEgdGhyZWUtYXhpcyByb3RhdGlvbmFsIGNvbnN0cmFpbnQgZm9yIHZhcmlvdXMgam9pbnRzLlxyXG4gICogQGF1dGhvciBzYWhhcmFuXHJcbiAgKi9cclxuXHJcbiAgZnVuY3Rpb24gUm90YXRpb25hbDNDb25zdHJhaW50KGpvaW50LCBsaW1pdE1vdG9yMSwgbGltaXRNb3RvcjIsIGxpbWl0TW90b3IzKSB7XHJcblxyXG4gICAgdGhpcy5jZm0xID0gTmFOO1xyXG4gICAgdGhpcy5jZm0yID0gTmFOO1xyXG4gICAgdGhpcy5jZm0zID0gTmFOO1xyXG4gICAgdGhpcy5pMWUwMCA9IE5hTjtcclxuICAgIHRoaXMuaTFlMDEgPSBOYU47XHJcbiAgICB0aGlzLmkxZTAyID0gTmFOO1xyXG4gICAgdGhpcy5pMWUxMCA9IE5hTjtcclxuICAgIHRoaXMuaTFlMTEgPSBOYU47XHJcbiAgICB0aGlzLmkxZTEyID0gTmFOO1xyXG4gICAgdGhpcy5pMWUyMCA9IE5hTjtcclxuICAgIHRoaXMuaTFlMjEgPSBOYU47XHJcbiAgICB0aGlzLmkxZTIyID0gTmFOO1xyXG4gICAgdGhpcy5pMmUwMCA9IE5hTjtcclxuICAgIHRoaXMuaTJlMDEgPSBOYU47XHJcbiAgICB0aGlzLmkyZTAyID0gTmFOO1xyXG4gICAgdGhpcy5pMmUxMCA9IE5hTjtcclxuICAgIHRoaXMuaTJlMTEgPSBOYU47XHJcbiAgICB0aGlzLmkyZTEyID0gTmFOO1xyXG4gICAgdGhpcy5pMmUyMCA9IE5hTjtcclxuICAgIHRoaXMuaTJlMjEgPSBOYU47XHJcbiAgICB0aGlzLmkyZTIyID0gTmFOO1xyXG4gICAgdGhpcy5heDEgPSBOYU47XHJcbiAgICB0aGlzLmF5MSA9IE5hTjtcclxuICAgIHRoaXMuYXoxID0gTmFOO1xyXG4gICAgdGhpcy5heDIgPSBOYU47XHJcbiAgICB0aGlzLmF5MiA9IE5hTjtcclxuICAgIHRoaXMuYXoyID0gTmFOO1xyXG4gICAgdGhpcy5heDMgPSBOYU47XHJcbiAgICB0aGlzLmF5MyA9IE5hTjtcclxuICAgIHRoaXMuYXozID0gTmFOO1xyXG5cclxuICAgIHRoaXMuYTF4MSA9IE5hTjsgLy8gamFjb2lhbnNcclxuICAgIHRoaXMuYTF5MSA9IE5hTjtcclxuICAgIHRoaXMuYTF6MSA9IE5hTjtcclxuICAgIHRoaXMuYTJ4MSA9IE5hTjtcclxuICAgIHRoaXMuYTJ5MSA9IE5hTjtcclxuICAgIHRoaXMuYTJ6MSA9IE5hTjtcclxuICAgIHRoaXMuYTF4MiA9IE5hTjtcclxuICAgIHRoaXMuYTF5MiA9IE5hTjtcclxuICAgIHRoaXMuYTF6MiA9IE5hTjtcclxuICAgIHRoaXMuYTJ4MiA9IE5hTjtcclxuICAgIHRoaXMuYTJ5MiA9IE5hTjtcclxuICAgIHRoaXMuYTJ6MiA9IE5hTjtcclxuICAgIHRoaXMuYTF4MyA9IE5hTjtcclxuICAgIHRoaXMuYTF5MyA9IE5hTjtcclxuICAgIHRoaXMuYTF6MyA9IE5hTjtcclxuICAgIHRoaXMuYTJ4MyA9IE5hTjtcclxuICAgIHRoaXMuYTJ5MyA9IE5hTjtcclxuICAgIHRoaXMuYTJ6MyA9IE5hTjtcclxuXHJcbiAgICB0aGlzLmxvd2VyTGltaXQxID0gTmFOO1xyXG4gICAgdGhpcy51cHBlckxpbWl0MSA9IE5hTjtcclxuICAgIHRoaXMubGltaXRWZWxvY2l0eTEgPSBOYU47XHJcbiAgICB0aGlzLmxpbWl0U3RhdGUxID0gMDsgLy8gLTE6IGF0IGxvd2VyLCAwOiBsb2NrZWQsIDE6IGF0IHVwcGVyLCAyOiBmcmVlXHJcbiAgICB0aGlzLmVuYWJsZU1vdG9yMSA9IGZhbHNlO1xyXG4gICAgdGhpcy5tb3RvclNwZWVkMSA9IE5hTjtcclxuICAgIHRoaXMubWF4TW90b3JGb3JjZTEgPSBOYU47XHJcbiAgICB0aGlzLm1heE1vdG9ySW1wdWxzZTEgPSBOYU47XHJcbiAgICB0aGlzLmxvd2VyTGltaXQyID0gTmFOO1xyXG4gICAgdGhpcy51cHBlckxpbWl0MiA9IE5hTjtcclxuICAgIHRoaXMubGltaXRWZWxvY2l0eTIgPSBOYU47XHJcbiAgICB0aGlzLmxpbWl0U3RhdGUyID0gMDsgLy8gLTE6IGF0IGxvd2VyLCAwOiBsb2NrZWQsIDE6IGF0IHVwcGVyLCAyOiBmcmVlXHJcbiAgICB0aGlzLmVuYWJsZU1vdG9yMiA9IGZhbHNlO1xyXG4gICAgdGhpcy5tb3RvclNwZWVkMiA9IE5hTjtcclxuICAgIHRoaXMubWF4TW90b3JGb3JjZTIgPSBOYU47XHJcbiAgICB0aGlzLm1heE1vdG9ySW1wdWxzZTIgPSBOYU47XHJcbiAgICB0aGlzLmxvd2VyTGltaXQzID0gTmFOO1xyXG4gICAgdGhpcy51cHBlckxpbWl0MyA9IE5hTjtcclxuICAgIHRoaXMubGltaXRWZWxvY2l0eTMgPSBOYU47XHJcbiAgICB0aGlzLmxpbWl0U3RhdGUzID0gMDsgLy8gLTE6IGF0IGxvd2VyLCAwOiBsb2NrZWQsIDE6IGF0IHVwcGVyLCAyOiBmcmVlXHJcbiAgICB0aGlzLmVuYWJsZU1vdG9yMyA9IGZhbHNlO1xyXG4gICAgdGhpcy5tb3RvclNwZWVkMyA9IE5hTjtcclxuICAgIHRoaXMubWF4TW90b3JGb3JjZTMgPSBOYU47XHJcbiAgICB0aGlzLm1heE1vdG9ySW1wdWxzZTMgPSBOYU47XHJcblxyXG4gICAgdGhpcy5rMDAgPSBOYU47IC8vIEsgPSBKKk0qSlRcclxuICAgIHRoaXMuazAxID0gTmFOO1xyXG4gICAgdGhpcy5rMDIgPSBOYU47XHJcbiAgICB0aGlzLmsxMCA9IE5hTjtcclxuICAgIHRoaXMuazExID0gTmFOO1xyXG4gICAgdGhpcy5rMTIgPSBOYU47XHJcbiAgICB0aGlzLmsyMCA9IE5hTjtcclxuICAgIHRoaXMuazIxID0gTmFOO1xyXG4gICAgdGhpcy5rMjIgPSBOYU47XHJcblxyXG4gICAgdGhpcy5rdjAwID0gTmFOOyAvLyBkaWFnb25hbHMgd2l0aG91dCBDRk1zXHJcbiAgICB0aGlzLmt2MTEgPSBOYU47XHJcbiAgICB0aGlzLmt2MjIgPSBOYU47XHJcblxyXG4gICAgdGhpcy5kdjAwID0gTmFOOyAvLyAuLi5pbnZlcnRlZFxyXG4gICAgdGhpcy5kdjExID0gTmFOO1xyXG4gICAgdGhpcy5kdjIyID0gTmFOO1xyXG5cclxuICAgIHRoaXMuZDAwID0gTmFOOyAgLy8gS14tMVxyXG4gICAgdGhpcy5kMDEgPSBOYU47XHJcbiAgICB0aGlzLmQwMiA9IE5hTjtcclxuICAgIHRoaXMuZDEwID0gTmFOO1xyXG4gICAgdGhpcy5kMTEgPSBOYU47XHJcbiAgICB0aGlzLmQxMiA9IE5hTjtcclxuICAgIHRoaXMuZDIwID0gTmFOO1xyXG4gICAgdGhpcy5kMjEgPSBOYU47XHJcbiAgICB0aGlzLmQyMiA9IE5hTjtcclxuXHJcbiAgICB0aGlzLmxpbWl0TW90b3IxID0gbGltaXRNb3RvcjE7XHJcbiAgICB0aGlzLmxpbWl0TW90b3IyID0gbGltaXRNb3RvcjI7XHJcbiAgICB0aGlzLmxpbWl0TW90b3IzID0gbGltaXRNb3RvcjM7XHJcbiAgICB0aGlzLmIxID0gam9pbnQuYm9keTE7XHJcbiAgICB0aGlzLmIyID0gam9pbnQuYm9keTI7XHJcbiAgICB0aGlzLmExID0gdGhpcy5iMS5hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICB0aGlzLmEyID0gdGhpcy5iMi5hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICB0aGlzLmkxID0gdGhpcy5iMS5pbnZlcnNlSW5lcnRpYTtcclxuICAgIHRoaXMuaTIgPSB0aGlzLmIyLmludmVyc2VJbmVydGlhO1xyXG4gICAgdGhpcy5saW1pdEltcHVsc2UxID0gMDtcclxuICAgIHRoaXMubW90b3JJbXB1bHNlMSA9IDA7XHJcbiAgICB0aGlzLmxpbWl0SW1wdWxzZTIgPSAwO1xyXG4gICAgdGhpcy5tb3RvckltcHVsc2UyID0gMDtcclxuICAgIHRoaXMubGltaXRJbXB1bHNlMyA9IDA7XHJcbiAgICB0aGlzLm1vdG9ySW1wdWxzZTMgPSAwO1xyXG5cclxuICB9XHJcblxyXG4gIE9iamVjdC5hc3NpZ24oUm90YXRpb25hbDNDb25zdHJhaW50LnByb3RvdHlwZSwge1xyXG5cclxuICAgIFJvdGF0aW9uYWwzQ29uc3RyYWludDogdHJ1ZSxcclxuXHJcbiAgICBwcmVTb2x2ZTogZnVuY3Rpb24gKHRpbWVTdGVwLCBpbnZUaW1lU3RlcCkge1xyXG5cclxuICAgICAgdGhpcy5heDEgPSB0aGlzLmxpbWl0TW90b3IxLmF4aXMueDtcclxuICAgICAgdGhpcy5heTEgPSB0aGlzLmxpbWl0TW90b3IxLmF4aXMueTtcclxuICAgICAgdGhpcy5hejEgPSB0aGlzLmxpbWl0TW90b3IxLmF4aXMuejtcclxuICAgICAgdGhpcy5heDIgPSB0aGlzLmxpbWl0TW90b3IyLmF4aXMueDtcclxuICAgICAgdGhpcy5heTIgPSB0aGlzLmxpbWl0TW90b3IyLmF4aXMueTtcclxuICAgICAgdGhpcy5hejIgPSB0aGlzLmxpbWl0TW90b3IyLmF4aXMuejtcclxuICAgICAgdGhpcy5heDMgPSB0aGlzLmxpbWl0TW90b3IzLmF4aXMueDtcclxuICAgICAgdGhpcy5heTMgPSB0aGlzLmxpbWl0TW90b3IzLmF4aXMueTtcclxuICAgICAgdGhpcy5hejMgPSB0aGlzLmxpbWl0TW90b3IzLmF4aXMuejtcclxuICAgICAgdGhpcy5sb3dlckxpbWl0MSA9IHRoaXMubGltaXRNb3RvcjEubG93ZXJMaW1pdDtcclxuICAgICAgdGhpcy51cHBlckxpbWl0MSA9IHRoaXMubGltaXRNb3RvcjEudXBwZXJMaW1pdDtcclxuICAgICAgdGhpcy5tb3RvclNwZWVkMSA9IHRoaXMubGltaXRNb3RvcjEubW90b3JTcGVlZDtcclxuICAgICAgdGhpcy5tYXhNb3RvckZvcmNlMSA9IHRoaXMubGltaXRNb3RvcjEubWF4TW90b3JGb3JjZTtcclxuICAgICAgdGhpcy5lbmFibGVNb3RvcjEgPSB0aGlzLm1heE1vdG9yRm9yY2UxID4gMDtcclxuICAgICAgdGhpcy5sb3dlckxpbWl0MiA9IHRoaXMubGltaXRNb3RvcjIubG93ZXJMaW1pdDtcclxuICAgICAgdGhpcy51cHBlckxpbWl0MiA9IHRoaXMubGltaXRNb3RvcjIudXBwZXJMaW1pdDtcclxuICAgICAgdGhpcy5tb3RvclNwZWVkMiA9IHRoaXMubGltaXRNb3RvcjIubW90b3JTcGVlZDtcclxuICAgICAgdGhpcy5tYXhNb3RvckZvcmNlMiA9IHRoaXMubGltaXRNb3RvcjIubWF4TW90b3JGb3JjZTtcclxuICAgICAgdGhpcy5lbmFibGVNb3RvcjIgPSB0aGlzLm1heE1vdG9yRm9yY2UyID4gMDtcclxuICAgICAgdGhpcy5sb3dlckxpbWl0MyA9IHRoaXMubGltaXRNb3RvcjMubG93ZXJMaW1pdDtcclxuICAgICAgdGhpcy51cHBlckxpbWl0MyA9IHRoaXMubGltaXRNb3RvcjMudXBwZXJMaW1pdDtcclxuICAgICAgdGhpcy5tb3RvclNwZWVkMyA9IHRoaXMubGltaXRNb3RvcjMubW90b3JTcGVlZDtcclxuICAgICAgdGhpcy5tYXhNb3RvckZvcmNlMyA9IHRoaXMubGltaXRNb3RvcjMubWF4TW90b3JGb3JjZTtcclxuICAgICAgdGhpcy5lbmFibGVNb3RvcjMgPSB0aGlzLm1heE1vdG9yRm9yY2UzID4gMDtcclxuXHJcbiAgICAgIHZhciB0aTEgPSB0aGlzLmkxLmVsZW1lbnRzO1xyXG4gICAgICB2YXIgdGkyID0gdGhpcy5pMi5lbGVtZW50cztcclxuICAgICAgdGhpcy5pMWUwMCA9IHRpMVswXTtcclxuICAgICAgdGhpcy5pMWUwMSA9IHRpMVsxXTtcclxuICAgICAgdGhpcy5pMWUwMiA9IHRpMVsyXTtcclxuICAgICAgdGhpcy5pMWUxMCA9IHRpMVszXTtcclxuICAgICAgdGhpcy5pMWUxMSA9IHRpMVs0XTtcclxuICAgICAgdGhpcy5pMWUxMiA9IHRpMVs1XTtcclxuICAgICAgdGhpcy5pMWUyMCA9IHRpMVs2XTtcclxuICAgICAgdGhpcy5pMWUyMSA9IHRpMVs3XTtcclxuICAgICAgdGhpcy5pMWUyMiA9IHRpMVs4XTtcclxuXHJcbiAgICAgIHRoaXMuaTJlMDAgPSB0aTJbMF07XHJcbiAgICAgIHRoaXMuaTJlMDEgPSB0aTJbMV07XHJcbiAgICAgIHRoaXMuaTJlMDIgPSB0aTJbMl07XHJcbiAgICAgIHRoaXMuaTJlMTAgPSB0aTJbM107XHJcbiAgICAgIHRoaXMuaTJlMTEgPSB0aTJbNF07XHJcbiAgICAgIHRoaXMuaTJlMTIgPSB0aTJbNV07XHJcbiAgICAgIHRoaXMuaTJlMjAgPSB0aTJbNl07XHJcbiAgICAgIHRoaXMuaTJlMjEgPSB0aTJbN107XHJcbiAgICAgIHRoaXMuaTJlMjIgPSB0aTJbOF07XHJcblxyXG4gICAgICB2YXIgZnJlcXVlbmN5MSA9IHRoaXMubGltaXRNb3RvcjEuZnJlcXVlbmN5O1xyXG4gICAgICB2YXIgZnJlcXVlbmN5MiA9IHRoaXMubGltaXRNb3RvcjIuZnJlcXVlbmN5O1xyXG4gICAgICB2YXIgZnJlcXVlbmN5MyA9IHRoaXMubGltaXRNb3RvcjMuZnJlcXVlbmN5O1xyXG4gICAgICB2YXIgZW5hYmxlU3ByaW5nMSA9IGZyZXF1ZW5jeTEgPiAwO1xyXG4gICAgICB2YXIgZW5hYmxlU3ByaW5nMiA9IGZyZXF1ZW5jeTIgPiAwO1xyXG4gICAgICB2YXIgZW5hYmxlU3ByaW5nMyA9IGZyZXF1ZW5jeTMgPiAwO1xyXG4gICAgICB2YXIgZW5hYmxlTGltaXQxID0gdGhpcy5sb3dlckxpbWl0MSA8PSB0aGlzLnVwcGVyTGltaXQxO1xyXG4gICAgICB2YXIgZW5hYmxlTGltaXQyID0gdGhpcy5sb3dlckxpbWl0MiA8PSB0aGlzLnVwcGVyTGltaXQyO1xyXG4gICAgICB2YXIgZW5hYmxlTGltaXQzID0gdGhpcy5sb3dlckxpbWl0MyA8PSB0aGlzLnVwcGVyTGltaXQzO1xyXG4gICAgICB2YXIgYW5nbGUxID0gdGhpcy5saW1pdE1vdG9yMS5hbmdsZTtcclxuICAgICAgaWYgKGVuYWJsZUxpbWl0MSkge1xyXG4gICAgICAgIGlmICh0aGlzLmxvd2VyTGltaXQxID09IHRoaXMudXBwZXJMaW1pdDEpIHtcclxuICAgICAgICAgIGlmICh0aGlzLmxpbWl0U3RhdGUxICE9IDApIHtcclxuICAgICAgICAgICAgdGhpcy5saW1pdFN0YXRlMSA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMubGltaXRJbXB1bHNlMSA9IDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLmxpbWl0VmVsb2NpdHkxID0gdGhpcy5sb3dlckxpbWl0MSAtIGFuZ2xlMTtcclxuICAgICAgICB9IGVsc2UgaWYgKGFuZ2xlMSA8IHRoaXMubG93ZXJMaW1pdDEpIHtcclxuICAgICAgICAgIGlmICh0aGlzLmxpbWl0U3RhdGUxICE9IC0xKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGltaXRTdGF0ZTEgPSAtMTtcclxuICAgICAgICAgICAgdGhpcy5saW1pdEltcHVsc2UxID0gMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTEgPSB0aGlzLmxvd2VyTGltaXQxIC0gYW5nbGUxO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYW5nbGUxID4gdGhpcy51cHBlckxpbWl0MSkge1xyXG4gICAgICAgICAgaWYgKHRoaXMubGltaXRTdGF0ZTEgIT0gMSkge1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0U3RhdGUxID0gMTtcclxuICAgICAgICAgICAgdGhpcy5saW1pdEltcHVsc2UxID0gMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTEgPSB0aGlzLnVwcGVyTGltaXQxIC0gYW5nbGUxO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmxpbWl0U3RhdGUxID0gMjtcclxuICAgICAgICAgIHRoaXMubGltaXRJbXB1bHNlMSA9IDA7XHJcbiAgICAgICAgICB0aGlzLmxpbWl0VmVsb2NpdHkxID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFlbmFibGVTcHJpbmcxKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5saW1pdFZlbG9jaXR5MSA+IDAuMDIpIHRoaXMubGltaXRWZWxvY2l0eTEgLT0gMC4wMjtcclxuICAgICAgICAgIGVsc2UgaWYgKHRoaXMubGltaXRWZWxvY2l0eTEgPCAtMC4wMikgdGhpcy5saW1pdFZlbG9jaXR5MSArPSAwLjAyO1xyXG4gICAgICAgICAgZWxzZSB0aGlzLmxpbWl0VmVsb2NpdHkxID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5saW1pdFN0YXRlMSA9IDI7XHJcbiAgICAgICAgdGhpcy5saW1pdEltcHVsc2UxID0gMDtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGFuZ2xlMiA9IHRoaXMubGltaXRNb3RvcjIuYW5nbGU7XHJcbiAgICAgIGlmIChlbmFibGVMaW1pdDIpIHtcclxuICAgICAgICBpZiAodGhpcy5sb3dlckxpbWl0MiA9PSB0aGlzLnVwcGVyTGltaXQyKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5saW1pdFN0YXRlMiAhPSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGltaXRTdGF0ZTIgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0SW1wdWxzZTIgPSAwO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5saW1pdFZlbG9jaXR5MiA9IHRoaXMubG93ZXJMaW1pdDIgLSBhbmdsZTI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChhbmdsZTIgPCB0aGlzLmxvd2VyTGltaXQyKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5saW1pdFN0YXRlMiAhPSAtMSkge1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0U3RhdGUyID0gLTE7XHJcbiAgICAgICAgICAgIHRoaXMubGltaXRJbXB1bHNlMiA9IDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLmxpbWl0VmVsb2NpdHkyID0gdGhpcy5sb3dlckxpbWl0MiAtIGFuZ2xlMjtcclxuICAgICAgICB9IGVsc2UgaWYgKGFuZ2xlMiA+IHRoaXMudXBwZXJMaW1pdDIpIHtcclxuICAgICAgICAgIGlmICh0aGlzLmxpbWl0U3RhdGUyICE9IDEpIHtcclxuICAgICAgICAgICAgdGhpcy5saW1pdFN0YXRlMiA9IDE7XHJcbiAgICAgICAgICAgIHRoaXMubGltaXRJbXB1bHNlMiA9IDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLmxpbWl0VmVsb2NpdHkyID0gdGhpcy51cHBlckxpbWl0MiAtIGFuZ2xlMjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5saW1pdFN0YXRlMiA9IDI7XHJcbiAgICAgICAgICB0aGlzLmxpbWl0SW1wdWxzZTIgPSAwO1xyXG4gICAgICAgICAgdGhpcy5saW1pdFZlbG9jaXR5MiA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZW5hYmxlU3ByaW5nMikge1xyXG4gICAgICAgICAgaWYgKHRoaXMubGltaXRWZWxvY2l0eTIgPiAwLjAyKSB0aGlzLmxpbWl0VmVsb2NpdHkyIC09IDAuMDI7XHJcbiAgICAgICAgICBlbHNlIGlmICh0aGlzLmxpbWl0VmVsb2NpdHkyIDwgLTAuMDIpIHRoaXMubGltaXRWZWxvY2l0eTIgKz0gMC4wMjtcclxuICAgICAgICAgIGVsc2UgdGhpcy5saW1pdFZlbG9jaXR5MiA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMubGltaXRTdGF0ZTIgPSAyO1xyXG4gICAgICAgIHRoaXMubGltaXRJbXB1bHNlMiA9IDA7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciBhbmdsZTMgPSB0aGlzLmxpbWl0TW90b3IzLmFuZ2xlO1xyXG4gICAgICBpZiAoZW5hYmxlTGltaXQzKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubG93ZXJMaW1pdDMgPT0gdGhpcy51cHBlckxpbWl0Mykge1xyXG4gICAgICAgICAgaWYgKHRoaXMubGltaXRTdGF0ZTMgIT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0U3RhdGUzID0gMDtcclxuICAgICAgICAgICAgdGhpcy5saW1pdEltcHVsc2UzID0gMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTMgPSB0aGlzLmxvd2VyTGltaXQzIC0gYW5nbGUzO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYW5nbGUzIDwgdGhpcy5sb3dlckxpbWl0Mykge1xyXG4gICAgICAgICAgaWYgKHRoaXMubGltaXRTdGF0ZTMgIT0gLTEpIHtcclxuICAgICAgICAgICAgdGhpcy5saW1pdFN0YXRlMyA9IC0xO1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0SW1wdWxzZTMgPSAwO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5saW1pdFZlbG9jaXR5MyA9IHRoaXMubG93ZXJMaW1pdDMgLSBhbmdsZTM7XHJcbiAgICAgICAgfSBlbHNlIGlmIChhbmdsZTMgPiB0aGlzLnVwcGVyTGltaXQzKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5saW1pdFN0YXRlMyAhPSAxKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGltaXRTdGF0ZTMgPSAxO1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0SW1wdWxzZTMgPSAwO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5saW1pdFZlbG9jaXR5MyA9IHRoaXMudXBwZXJMaW1pdDMgLSBhbmdsZTM7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMubGltaXRTdGF0ZTMgPSAyO1xyXG4gICAgICAgICAgdGhpcy5saW1pdEltcHVsc2UzID0gMDtcclxuICAgICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTMgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWVuYWJsZVNwcmluZzMpIHtcclxuICAgICAgICAgIGlmICh0aGlzLmxpbWl0VmVsb2NpdHkzID4gMC4wMikgdGhpcy5saW1pdFZlbG9jaXR5MyAtPSAwLjAyO1xyXG4gICAgICAgICAgZWxzZSBpZiAodGhpcy5saW1pdFZlbG9jaXR5MyA8IC0wLjAyKSB0aGlzLmxpbWl0VmVsb2NpdHkzICs9IDAuMDI7XHJcbiAgICAgICAgICBlbHNlIHRoaXMubGltaXRWZWxvY2l0eTMgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmxpbWl0U3RhdGUzID0gMjtcclxuICAgICAgICB0aGlzLmxpbWl0SW1wdWxzZTMgPSAwO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAodGhpcy5lbmFibGVNb3RvcjEgJiYgKHRoaXMubGltaXRTdGF0ZTEgIT0gMCB8fCBlbmFibGVTcHJpbmcxKSkge1xyXG4gICAgICAgIHRoaXMubWF4TW90b3JJbXB1bHNlMSA9IHRoaXMubWF4TW90b3JGb3JjZTEgKiB0aW1lU3RlcDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLm1vdG9ySW1wdWxzZTEgPSAwO1xyXG4gICAgICAgIHRoaXMubWF4TW90b3JJbXB1bHNlMSA9IDA7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuZW5hYmxlTW90b3IyICYmICh0aGlzLmxpbWl0U3RhdGUyICE9IDAgfHwgZW5hYmxlU3ByaW5nMikpIHtcclxuICAgICAgICB0aGlzLm1heE1vdG9ySW1wdWxzZTIgPSB0aGlzLm1heE1vdG9yRm9yY2UyICogdGltZVN0ZXA7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5tb3RvckltcHVsc2UyID0gMDtcclxuICAgICAgICB0aGlzLm1heE1vdG9ySW1wdWxzZTIgPSAwO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLmVuYWJsZU1vdG9yMyAmJiAodGhpcy5saW1pdFN0YXRlMyAhPSAwIHx8IGVuYWJsZVNwcmluZzMpKSB7XHJcbiAgICAgICAgdGhpcy5tYXhNb3RvckltcHVsc2UzID0gdGhpcy5tYXhNb3RvckZvcmNlMyAqIHRpbWVTdGVwO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMubW90b3JJbXB1bHNlMyA9IDA7XHJcbiAgICAgICAgdGhpcy5tYXhNb3RvckltcHVsc2UzID0gMDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gYnVpbGQgamFjb2JpYW5zXHJcbiAgICAgIHRoaXMuYTF4MSA9IHRoaXMuYXgxICogdGhpcy5pMWUwMCArIHRoaXMuYXkxICogdGhpcy5pMWUwMSArIHRoaXMuYXoxICogdGhpcy5pMWUwMjtcclxuICAgICAgdGhpcy5hMXkxID0gdGhpcy5heDEgKiB0aGlzLmkxZTEwICsgdGhpcy5heTEgKiB0aGlzLmkxZTExICsgdGhpcy5hejEgKiB0aGlzLmkxZTEyO1xyXG4gICAgICB0aGlzLmExejEgPSB0aGlzLmF4MSAqIHRoaXMuaTFlMjAgKyB0aGlzLmF5MSAqIHRoaXMuaTFlMjEgKyB0aGlzLmF6MSAqIHRoaXMuaTFlMjI7XHJcbiAgICAgIHRoaXMuYTJ4MSA9IHRoaXMuYXgxICogdGhpcy5pMmUwMCArIHRoaXMuYXkxICogdGhpcy5pMmUwMSArIHRoaXMuYXoxICogdGhpcy5pMmUwMjtcclxuICAgICAgdGhpcy5hMnkxID0gdGhpcy5heDEgKiB0aGlzLmkyZTEwICsgdGhpcy5heTEgKiB0aGlzLmkyZTExICsgdGhpcy5hejEgKiB0aGlzLmkyZTEyO1xyXG4gICAgICB0aGlzLmEyejEgPSB0aGlzLmF4MSAqIHRoaXMuaTJlMjAgKyB0aGlzLmF5MSAqIHRoaXMuaTJlMjEgKyB0aGlzLmF6MSAqIHRoaXMuaTJlMjI7XHJcblxyXG4gICAgICB0aGlzLmExeDIgPSB0aGlzLmF4MiAqIHRoaXMuaTFlMDAgKyB0aGlzLmF5MiAqIHRoaXMuaTFlMDEgKyB0aGlzLmF6MiAqIHRoaXMuaTFlMDI7XHJcbiAgICAgIHRoaXMuYTF5MiA9IHRoaXMuYXgyICogdGhpcy5pMWUxMCArIHRoaXMuYXkyICogdGhpcy5pMWUxMSArIHRoaXMuYXoyICogdGhpcy5pMWUxMjtcclxuICAgICAgdGhpcy5hMXoyID0gdGhpcy5heDIgKiB0aGlzLmkxZTIwICsgdGhpcy5heTIgKiB0aGlzLmkxZTIxICsgdGhpcy5hejIgKiB0aGlzLmkxZTIyO1xyXG4gICAgICB0aGlzLmEyeDIgPSB0aGlzLmF4MiAqIHRoaXMuaTJlMDAgKyB0aGlzLmF5MiAqIHRoaXMuaTJlMDEgKyB0aGlzLmF6MiAqIHRoaXMuaTJlMDI7XHJcbiAgICAgIHRoaXMuYTJ5MiA9IHRoaXMuYXgyICogdGhpcy5pMmUxMCArIHRoaXMuYXkyICogdGhpcy5pMmUxMSArIHRoaXMuYXoyICogdGhpcy5pMmUxMjtcclxuICAgICAgdGhpcy5hMnoyID0gdGhpcy5heDIgKiB0aGlzLmkyZTIwICsgdGhpcy5heTIgKiB0aGlzLmkyZTIxICsgdGhpcy5hejIgKiB0aGlzLmkyZTIyO1xyXG5cclxuICAgICAgdGhpcy5hMXgzID0gdGhpcy5heDMgKiB0aGlzLmkxZTAwICsgdGhpcy5heTMgKiB0aGlzLmkxZTAxICsgdGhpcy5hejMgKiB0aGlzLmkxZTAyO1xyXG4gICAgICB0aGlzLmExeTMgPSB0aGlzLmF4MyAqIHRoaXMuaTFlMTAgKyB0aGlzLmF5MyAqIHRoaXMuaTFlMTEgKyB0aGlzLmF6MyAqIHRoaXMuaTFlMTI7XHJcbiAgICAgIHRoaXMuYTF6MyA9IHRoaXMuYXgzICogdGhpcy5pMWUyMCArIHRoaXMuYXkzICogdGhpcy5pMWUyMSArIHRoaXMuYXozICogdGhpcy5pMWUyMjtcclxuICAgICAgdGhpcy5hMngzID0gdGhpcy5heDMgKiB0aGlzLmkyZTAwICsgdGhpcy5heTMgKiB0aGlzLmkyZTAxICsgdGhpcy5hejMgKiB0aGlzLmkyZTAyO1xyXG4gICAgICB0aGlzLmEyeTMgPSB0aGlzLmF4MyAqIHRoaXMuaTJlMTAgKyB0aGlzLmF5MyAqIHRoaXMuaTJlMTEgKyB0aGlzLmF6MyAqIHRoaXMuaTJlMTI7XHJcbiAgICAgIHRoaXMuYTJ6MyA9IHRoaXMuYXgzICogdGhpcy5pMmUyMCArIHRoaXMuYXkzICogdGhpcy5pMmUyMSArIHRoaXMuYXozICogdGhpcy5pMmUyMjtcclxuXHJcbiAgICAgIC8vIGJ1aWxkIGFuIGltcHVsc2UgbWF0cml4XHJcbiAgICAgIHRoaXMuazAwID0gdGhpcy5heDEgKiAodGhpcy5hMXgxICsgdGhpcy5hMngxKSArIHRoaXMuYXkxICogKHRoaXMuYTF5MSArIHRoaXMuYTJ5MSkgKyB0aGlzLmF6MSAqICh0aGlzLmExejEgKyB0aGlzLmEyejEpO1xyXG4gICAgICB0aGlzLmswMSA9IHRoaXMuYXgxICogKHRoaXMuYTF4MiArIHRoaXMuYTJ4MikgKyB0aGlzLmF5MSAqICh0aGlzLmExeTIgKyB0aGlzLmEyeTIpICsgdGhpcy5hejEgKiAodGhpcy5hMXoyICsgdGhpcy5hMnoyKTtcclxuICAgICAgdGhpcy5rMDIgPSB0aGlzLmF4MSAqICh0aGlzLmExeDMgKyB0aGlzLmEyeDMpICsgdGhpcy5heTEgKiAodGhpcy5hMXkzICsgdGhpcy5hMnkzKSArIHRoaXMuYXoxICogKHRoaXMuYTF6MyArIHRoaXMuYTJ6Myk7XHJcbiAgICAgIHRoaXMuazEwID0gdGhpcy5heDIgKiAodGhpcy5hMXgxICsgdGhpcy5hMngxKSArIHRoaXMuYXkyICogKHRoaXMuYTF5MSArIHRoaXMuYTJ5MSkgKyB0aGlzLmF6MiAqICh0aGlzLmExejEgKyB0aGlzLmEyejEpO1xyXG4gICAgICB0aGlzLmsxMSA9IHRoaXMuYXgyICogKHRoaXMuYTF4MiArIHRoaXMuYTJ4MikgKyB0aGlzLmF5MiAqICh0aGlzLmExeTIgKyB0aGlzLmEyeTIpICsgdGhpcy5hejIgKiAodGhpcy5hMXoyICsgdGhpcy5hMnoyKTtcclxuICAgICAgdGhpcy5rMTIgPSB0aGlzLmF4MiAqICh0aGlzLmExeDMgKyB0aGlzLmEyeDMpICsgdGhpcy5heTIgKiAodGhpcy5hMXkzICsgdGhpcy5hMnkzKSArIHRoaXMuYXoyICogKHRoaXMuYTF6MyArIHRoaXMuYTJ6Myk7XHJcbiAgICAgIHRoaXMuazIwID0gdGhpcy5heDMgKiAodGhpcy5hMXgxICsgdGhpcy5hMngxKSArIHRoaXMuYXkzICogKHRoaXMuYTF5MSArIHRoaXMuYTJ5MSkgKyB0aGlzLmF6MyAqICh0aGlzLmExejEgKyB0aGlzLmEyejEpO1xyXG4gICAgICB0aGlzLmsyMSA9IHRoaXMuYXgzICogKHRoaXMuYTF4MiArIHRoaXMuYTJ4MikgKyB0aGlzLmF5MyAqICh0aGlzLmExeTIgKyB0aGlzLmEyeTIpICsgdGhpcy5hejMgKiAodGhpcy5hMXoyICsgdGhpcy5hMnoyKTtcclxuICAgICAgdGhpcy5rMjIgPSB0aGlzLmF4MyAqICh0aGlzLmExeDMgKyB0aGlzLmEyeDMpICsgdGhpcy5heTMgKiAodGhpcy5hMXkzICsgdGhpcy5hMnkzKSArIHRoaXMuYXozICogKHRoaXMuYTF6MyArIHRoaXMuYTJ6Myk7XHJcblxyXG4gICAgICB0aGlzLmt2MDAgPSB0aGlzLmswMDtcclxuICAgICAgdGhpcy5rdjExID0gdGhpcy5rMTE7XHJcbiAgICAgIHRoaXMua3YyMiA9IHRoaXMuazIyO1xyXG4gICAgICB0aGlzLmR2MDAgPSAxIC8gdGhpcy5rdjAwO1xyXG4gICAgICB0aGlzLmR2MTEgPSAxIC8gdGhpcy5rdjExO1xyXG4gICAgICB0aGlzLmR2MjIgPSAxIC8gdGhpcy5rdjIyO1xyXG5cclxuICAgICAgaWYgKGVuYWJsZVNwcmluZzEgJiYgdGhpcy5saW1pdFN0YXRlMSAhPSAyKSB7XHJcbiAgICAgICAgdmFyIG9tZWdhID0gNi4yODMxODUzICogZnJlcXVlbmN5MTtcclxuICAgICAgICB2YXIgayA9IG9tZWdhICogb21lZ2EgKiB0aW1lU3RlcDtcclxuICAgICAgICB2YXIgZG1wID0gaW52VGltZVN0ZXAgLyAoayArIDIgKiB0aGlzLmxpbWl0TW90b3IxLmRhbXBpbmdSYXRpbyAqIG9tZWdhKTtcclxuICAgICAgICB0aGlzLmNmbTEgPSB0aGlzLmt2MDAgKiBkbXA7XHJcbiAgICAgICAgdGhpcy5saW1pdFZlbG9jaXR5MSAqPSBrICogZG1wO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuY2ZtMSA9IDA7XHJcbiAgICAgICAgdGhpcy5saW1pdFZlbG9jaXR5MSAqPSBpbnZUaW1lU3RlcCAqIDAuMDU7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChlbmFibGVTcHJpbmcyICYmIHRoaXMubGltaXRTdGF0ZTIgIT0gMikge1xyXG4gICAgICAgIG9tZWdhID0gNi4yODMxODUzICogZnJlcXVlbmN5MjtcclxuICAgICAgICBrID0gb21lZ2EgKiBvbWVnYSAqIHRpbWVTdGVwO1xyXG4gICAgICAgIGRtcCA9IGludlRpbWVTdGVwIC8gKGsgKyAyICogdGhpcy5saW1pdE1vdG9yMi5kYW1waW5nUmF0aW8gKiBvbWVnYSk7XHJcbiAgICAgICAgdGhpcy5jZm0yID0gdGhpcy5rdjExICogZG1wO1xyXG4gICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTIgKj0gayAqIGRtcDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmNmbTIgPSAwO1xyXG4gICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTIgKj0gaW52VGltZVN0ZXAgKiAwLjA1O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoZW5hYmxlU3ByaW5nMyAmJiB0aGlzLmxpbWl0U3RhdGUzICE9IDIpIHtcclxuICAgICAgICBvbWVnYSA9IDYuMjgzMTg1MyAqIGZyZXF1ZW5jeTM7XHJcbiAgICAgICAgayA9IG9tZWdhICogb21lZ2EgKiB0aW1lU3RlcDtcclxuICAgICAgICBkbXAgPSBpbnZUaW1lU3RlcCAvIChrICsgMiAqIHRoaXMubGltaXRNb3RvcjMuZGFtcGluZ1JhdGlvICogb21lZ2EpO1xyXG4gICAgICAgIHRoaXMuY2ZtMyA9IHRoaXMua3YyMiAqIGRtcDtcclxuICAgICAgICB0aGlzLmxpbWl0VmVsb2NpdHkzICo9IGsgKiBkbXA7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5jZm0zID0gMDtcclxuICAgICAgICB0aGlzLmxpbWl0VmVsb2NpdHkzICo9IGludlRpbWVTdGVwICogMC4wNTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5rMDAgKz0gdGhpcy5jZm0xO1xyXG4gICAgICB0aGlzLmsxMSArPSB0aGlzLmNmbTI7XHJcbiAgICAgIHRoaXMuazIyICs9IHRoaXMuY2ZtMztcclxuXHJcbiAgICAgIHZhciBpbnYgPSAxIC8gKFxyXG4gICAgICAgIHRoaXMuazAwICogKHRoaXMuazExICogdGhpcy5rMjIgLSB0aGlzLmsyMSAqIHRoaXMuazEyKSArXHJcbiAgICAgICAgdGhpcy5rMTAgKiAodGhpcy5rMjEgKiB0aGlzLmswMiAtIHRoaXMuazAxICogdGhpcy5rMjIpICtcclxuICAgICAgICB0aGlzLmsyMCAqICh0aGlzLmswMSAqIHRoaXMuazEyIC0gdGhpcy5rMTEgKiB0aGlzLmswMilcclxuICAgICAgKTtcclxuICAgICAgdGhpcy5kMDAgPSAodGhpcy5rMTEgKiB0aGlzLmsyMiAtIHRoaXMuazEyICogdGhpcy5rMjEpICogaW52O1xyXG4gICAgICB0aGlzLmQwMSA9ICh0aGlzLmswMiAqIHRoaXMuazIxIC0gdGhpcy5rMDEgKiB0aGlzLmsyMikgKiBpbnY7XHJcbiAgICAgIHRoaXMuZDAyID0gKHRoaXMuazAxICogdGhpcy5rMTIgLSB0aGlzLmswMiAqIHRoaXMuazExKSAqIGludjtcclxuICAgICAgdGhpcy5kMTAgPSAodGhpcy5rMTIgKiB0aGlzLmsyMCAtIHRoaXMuazEwICogdGhpcy5rMjIpICogaW52O1xyXG4gICAgICB0aGlzLmQxMSA9ICh0aGlzLmswMCAqIHRoaXMuazIyIC0gdGhpcy5rMDIgKiB0aGlzLmsyMCkgKiBpbnY7XHJcbiAgICAgIHRoaXMuZDEyID0gKHRoaXMuazAyICogdGhpcy5rMTAgLSB0aGlzLmswMCAqIHRoaXMuazEyKSAqIGludjtcclxuICAgICAgdGhpcy5kMjAgPSAodGhpcy5rMTAgKiB0aGlzLmsyMSAtIHRoaXMuazExICogdGhpcy5rMjApICogaW52O1xyXG4gICAgICB0aGlzLmQyMSA9ICh0aGlzLmswMSAqIHRoaXMuazIwIC0gdGhpcy5rMDAgKiB0aGlzLmsyMSkgKiBpbnY7XHJcbiAgICAgIHRoaXMuZDIyID0gKHRoaXMuazAwICogdGhpcy5rMTEgLSB0aGlzLmswMSAqIHRoaXMuazEwKSAqIGludjtcclxuXHJcbiAgICAgIHRoaXMubGltaXRJbXB1bHNlMSAqPSAwLjk1O1xyXG4gICAgICB0aGlzLm1vdG9ySW1wdWxzZTEgKj0gMC45NTtcclxuICAgICAgdGhpcy5saW1pdEltcHVsc2UyICo9IDAuOTU7XHJcbiAgICAgIHRoaXMubW90b3JJbXB1bHNlMiAqPSAwLjk1O1xyXG4gICAgICB0aGlzLmxpbWl0SW1wdWxzZTMgKj0gMC45NTtcclxuICAgICAgdGhpcy5tb3RvckltcHVsc2UzICo9IDAuOTU7XHJcbiAgICAgIHZhciB0b3RhbEltcHVsc2UxID0gdGhpcy5saW1pdEltcHVsc2UxICsgdGhpcy5tb3RvckltcHVsc2UxO1xyXG4gICAgICB2YXIgdG90YWxJbXB1bHNlMiA9IHRoaXMubGltaXRJbXB1bHNlMiArIHRoaXMubW90b3JJbXB1bHNlMjtcclxuICAgICAgdmFyIHRvdGFsSW1wdWxzZTMgPSB0aGlzLmxpbWl0SW1wdWxzZTMgKyB0aGlzLm1vdG9ySW1wdWxzZTM7XHJcbiAgICAgIHRoaXMuYTEueCArPSB0b3RhbEltcHVsc2UxICogdGhpcy5hMXgxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMuYTF4MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmExeDM7XHJcbiAgICAgIHRoaXMuYTEueSArPSB0b3RhbEltcHVsc2UxICogdGhpcy5hMXkxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMuYTF5MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmExeTM7XHJcbiAgICAgIHRoaXMuYTEueiArPSB0b3RhbEltcHVsc2UxICogdGhpcy5hMXoxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMuYTF6MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmExejM7XHJcbiAgICAgIHRoaXMuYTIueCAtPSB0b3RhbEltcHVsc2UxICogdGhpcy5hMngxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMuYTJ4MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmEyeDM7XHJcbiAgICAgIHRoaXMuYTIueSAtPSB0b3RhbEltcHVsc2UxICogdGhpcy5hMnkxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMuYTJ5MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmEyeTM7XHJcbiAgICAgIHRoaXMuYTIueiAtPSB0b3RhbEltcHVsc2UxICogdGhpcy5hMnoxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMuYTJ6MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmEyejM7XHJcbiAgICB9LFxyXG4gICAgc29sdmVfOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB2YXIgcnZ4ID0gdGhpcy5hMi54IC0gdGhpcy5hMS54O1xyXG4gICAgICB2YXIgcnZ5ID0gdGhpcy5hMi55IC0gdGhpcy5hMS55O1xyXG4gICAgICB2YXIgcnZ6ID0gdGhpcy5hMi56IC0gdGhpcy5hMS56O1xyXG5cclxuICAgICAgdGhpcy5saW1pdFZlbG9jaXR5MyA9IDMwO1xyXG4gICAgICB2YXIgcnZuMSA9IHJ2eCAqIHRoaXMuYXgxICsgcnZ5ICogdGhpcy5heTEgKyBydnogKiB0aGlzLmF6MSAtIHRoaXMubGltaXRWZWxvY2l0eTE7XHJcbiAgICAgIHZhciBydm4yID0gcnZ4ICogdGhpcy5heDIgKyBydnkgKiB0aGlzLmF5MiArIHJ2eiAqIHRoaXMuYXoyIC0gdGhpcy5saW1pdFZlbG9jaXR5MjtcclxuICAgICAgdmFyIHJ2bjMgPSBydnggKiB0aGlzLmF4MyArIHJ2eSAqIHRoaXMuYXkzICsgcnZ6ICogdGhpcy5hejMgLSB0aGlzLmxpbWl0VmVsb2NpdHkzO1xyXG5cclxuICAgICAgdmFyIGRMaW1pdEltcHVsc2UxID0gcnZuMSAqIHRoaXMuZDAwICsgcnZuMiAqIHRoaXMuZDAxICsgcnZuMyAqIHRoaXMuZDAyO1xyXG4gICAgICB2YXIgZExpbWl0SW1wdWxzZTIgPSBydm4xICogdGhpcy5kMTAgKyBydm4yICogdGhpcy5kMTEgKyBydm4zICogdGhpcy5kMTI7XHJcbiAgICAgIHZhciBkTGltaXRJbXB1bHNlMyA9IHJ2bjEgKiB0aGlzLmQyMCArIHJ2bjIgKiB0aGlzLmQyMSArIHJ2bjMgKiB0aGlzLmQyMjtcclxuXHJcbiAgICAgIHRoaXMubGltaXRJbXB1bHNlMSArPSBkTGltaXRJbXB1bHNlMTtcclxuICAgICAgdGhpcy5saW1pdEltcHVsc2UyICs9IGRMaW1pdEltcHVsc2UyO1xyXG4gICAgICB0aGlzLmxpbWl0SW1wdWxzZTMgKz0gZExpbWl0SW1wdWxzZTM7XHJcblxyXG4gICAgICB0aGlzLmExLnggKz0gZExpbWl0SW1wdWxzZTEgKiB0aGlzLmExeDEgKyBkTGltaXRJbXB1bHNlMiAqIHRoaXMuYTF4MiArIGRMaW1pdEltcHVsc2UzICogdGhpcy5hMXgzO1xyXG4gICAgICB0aGlzLmExLnkgKz0gZExpbWl0SW1wdWxzZTEgKiB0aGlzLmExeTEgKyBkTGltaXRJbXB1bHNlMiAqIHRoaXMuYTF5MiArIGRMaW1pdEltcHVsc2UzICogdGhpcy5hMXkzO1xyXG4gICAgICB0aGlzLmExLnogKz0gZExpbWl0SW1wdWxzZTEgKiB0aGlzLmExejEgKyBkTGltaXRJbXB1bHNlMiAqIHRoaXMuYTF6MiArIGRMaW1pdEltcHVsc2UzICogdGhpcy5hMXozO1xyXG4gICAgICB0aGlzLmEyLnggLT0gZExpbWl0SW1wdWxzZTEgKiB0aGlzLmEyeDEgKyBkTGltaXRJbXB1bHNlMiAqIHRoaXMuYTJ4MiArIGRMaW1pdEltcHVsc2UzICogdGhpcy5hMngzO1xyXG4gICAgICB0aGlzLmEyLnkgLT0gZExpbWl0SW1wdWxzZTEgKiB0aGlzLmEyeTEgKyBkTGltaXRJbXB1bHNlMiAqIHRoaXMuYTJ5MiArIGRMaW1pdEltcHVsc2UzICogdGhpcy5hMnkzO1xyXG4gICAgICB0aGlzLmEyLnogLT0gZExpbWl0SW1wdWxzZTEgKiB0aGlzLmEyejEgKyBkTGltaXRJbXB1bHNlMiAqIHRoaXMuYTJ6MiArIGRMaW1pdEltcHVsc2UzICogdGhpcy5hMnozO1xyXG4gICAgfSxcclxuICAgIHNvbHZlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB2YXIgcnZ4ID0gdGhpcy5hMi54IC0gdGhpcy5hMS54O1xyXG4gICAgICB2YXIgcnZ5ID0gdGhpcy5hMi55IC0gdGhpcy5hMS55O1xyXG4gICAgICB2YXIgcnZ6ID0gdGhpcy5hMi56IC0gdGhpcy5hMS56O1xyXG5cclxuICAgICAgdmFyIHJ2bjEgPSBydnggKiB0aGlzLmF4MSArIHJ2eSAqIHRoaXMuYXkxICsgcnZ6ICogdGhpcy5hejE7XHJcbiAgICAgIHZhciBydm4yID0gcnZ4ICogdGhpcy5heDIgKyBydnkgKiB0aGlzLmF5MiArIHJ2eiAqIHRoaXMuYXoyO1xyXG4gICAgICB2YXIgcnZuMyA9IHJ2eCAqIHRoaXMuYXgzICsgcnZ5ICogdGhpcy5heTMgKyBydnogKiB0aGlzLmF6MztcclxuXHJcbiAgICAgIHZhciBvbGRNb3RvckltcHVsc2UxID0gdGhpcy5tb3RvckltcHVsc2UxO1xyXG4gICAgICB2YXIgb2xkTW90b3JJbXB1bHNlMiA9IHRoaXMubW90b3JJbXB1bHNlMjtcclxuICAgICAgdmFyIG9sZE1vdG9ySW1wdWxzZTMgPSB0aGlzLm1vdG9ySW1wdWxzZTM7XHJcblxyXG4gICAgICB2YXIgZE1vdG9ySW1wdWxzZTEgPSAwO1xyXG4gICAgICB2YXIgZE1vdG9ySW1wdWxzZTIgPSAwO1xyXG4gICAgICB2YXIgZE1vdG9ySW1wdWxzZTMgPSAwO1xyXG5cclxuICAgICAgaWYgKHRoaXMuZW5hYmxlTW90b3IxKSB7XHJcbiAgICAgICAgZE1vdG9ySW1wdWxzZTEgPSAocnZuMSAtIHRoaXMubW90b3JTcGVlZDEpICogdGhpcy5kdjAwO1xyXG4gICAgICAgIHRoaXMubW90b3JJbXB1bHNlMSArPSBkTW90b3JJbXB1bHNlMTtcclxuICAgICAgICBpZiAodGhpcy5tb3RvckltcHVsc2UxID4gdGhpcy5tYXhNb3RvckltcHVsc2UxKSB7IC8vIGNsYW1wIG1vdG9yIGltcHVsc2VcclxuICAgICAgICAgIHRoaXMubW90b3JJbXB1bHNlMSA9IHRoaXMubWF4TW90b3JJbXB1bHNlMTtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubW90b3JJbXB1bHNlMSA8IC10aGlzLm1heE1vdG9ySW1wdWxzZTEpIHtcclxuICAgICAgICAgIHRoaXMubW90b3JJbXB1bHNlMSA9IC10aGlzLm1heE1vdG9ySW1wdWxzZTE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRNb3RvckltcHVsc2UxID0gdGhpcy5tb3RvckltcHVsc2UxIC0gb2xkTW90b3JJbXB1bHNlMTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5lbmFibGVNb3RvcjIpIHtcclxuICAgICAgICBkTW90b3JJbXB1bHNlMiA9IChydm4yIC0gdGhpcy5tb3RvclNwZWVkMikgKiB0aGlzLmR2MTE7XHJcbiAgICAgICAgdGhpcy5tb3RvckltcHVsc2UyICs9IGRNb3RvckltcHVsc2UyO1xyXG4gICAgICAgIGlmICh0aGlzLm1vdG9ySW1wdWxzZTIgPiB0aGlzLm1heE1vdG9ySW1wdWxzZTIpIHsgLy8gY2xhbXAgbW90b3IgaW1wdWxzZVxyXG4gICAgICAgICAgdGhpcy5tb3RvckltcHVsc2UyID0gdGhpcy5tYXhNb3RvckltcHVsc2UyO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5tb3RvckltcHVsc2UyIDwgLXRoaXMubWF4TW90b3JJbXB1bHNlMikge1xyXG4gICAgICAgICAgdGhpcy5tb3RvckltcHVsc2UyID0gLXRoaXMubWF4TW90b3JJbXB1bHNlMjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZE1vdG9ySW1wdWxzZTIgPSB0aGlzLm1vdG9ySW1wdWxzZTIgLSBvbGRNb3RvckltcHVsc2UyO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLmVuYWJsZU1vdG9yMykge1xyXG4gICAgICAgIGRNb3RvckltcHVsc2UzID0gKHJ2bjMgLSB0aGlzLm1vdG9yU3BlZWQzKSAqIHRoaXMuZHYyMjtcclxuICAgICAgICB0aGlzLm1vdG9ySW1wdWxzZTMgKz0gZE1vdG9ySW1wdWxzZTM7XHJcbiAgICAgICAgaWYgKHRoaXMubW90b3JJbXB1bHNlMyA+IHRoaXMubWF4TW90b3JJbXB1bHNlMykgeyAvLyBjbGFtcCBtb3RvciBpbXB1bHNlXHJcbiAgICAgICAgICB0aGlzLm1vdG9ySW1wdWxzZTMgPSB0aGlzLm1heE1vdG9ySW1wdWxzZTM7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1vdG9ySW1wdWxzZTMgPCAtdGhpcy5tYXhNb3RvckltcHVsc2UzKSB7XHJcbiAgICAgICAgICB0aGlzLm1vdG9ySW1wdWxzZTMgPSAtdGhpcy5tYXhNb3RvckltcHVsc2UzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkTW90b3JJbXB1bHNlMyA9IHRoaXMubW90b3JJbXB1bHNlMyAtIG9sZE1vdG9ySW1wdWxzZTM7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIGFwcGx5IG1vdG9yIGltcHVsc2UgdG8gcmVsYXRpdmUgdmVsb2NpdHlcclxuICAgICAgcnZuMSArPSBkTW90b3JJbXB1bHNlMSAqIHRoaXMua3YwMCArIGRNb3RvckltcHVsc2UyICogdGhpcy5rMDEgKyBkTW90b3JJbXB1bHNlMyAqIHRoaXMuazAyO1xyXG4gICAgICBydm4yICs9IGRNb3RvckltcHVsc2UxICogdGhpcy5rMTAgKyBkTW90b3JJbXB1bHNlMiAqIHRoaXMua3YxMSArIGRNb3RvckltcHVsc2UzICogdGhpcy5rMTI7XHJcbiAgICAgIHJ2bjMgKz0gZE1vdG9ySW1wdWxzZTEgKiB0aGlzLmsyMCArIGRNb3RvckltcHVsc2UyICogdGhpcy5rMjEgKyBkTW90b3JJbXB1bHNlMyAqIHRoaXMua3YyMjtcclxuXHJcbiAgICAgIC8vIHN1YnRyYWN0IHRhcmdldCB2ZWxvY2l0eSBhbmQgYXBwbGllZCBpbXB1bHNlXHJcbiAgICAgIHJ2bjEgLT0gdGhpcy5saW1pdFZlbG9jaXR5MSArIHRoaXMubGltaXRJbXB1bHNlMSAqIHRoaXMuY2ZtMTtcclxuICAgICAgcnZuMiAtPSB0aGlzLmxpbWl0VmVsb2NpdHkyICsgdGhpcy5saW1pdEltcHVsc2UyICogdGhpcy5jZm0yO1xyXG4gICAgICBydm4zIC09IHRoaXMubGltaXRWZWxvY2l0eTMgKyB0aGlzLmxpbWl0SW1wdWxzZTMgKiB0aGlzLmNmbTM7XHJcblxyXG4gICAgICB2YXIgb2xkTGltaXRJbXB1bHNlMSA9IHRoaXMubGltaXRJbXB1bHNlMTtcclxuICAgICAgdmFyIG9sZExpbWl0SW1wdWxzZTIgPSB0aGlzLmxpbWl0SW1wdWxzZTI7XHJcbiAgICAgIHZhciBvbGRMaW1pdEltcHVsc2UzID0gdGhpcy5saW1pdEltcHVsc2UzO1xyXG5cclxuICAgICAgdmFyIGRMaW1pdEltcHVsc2UxID0gcnZuMSAqIHRoaXMuZDAwICsgcnZuMiAqIHRoaXMuZDAxICsgcnZuMyAqIHRoaXMuZDAyO1xyXG4gICAgICB2YXIgZExpbWl0SW1wdWxzZTIgPSBydm4xICogdGhpcy5kMTAgKyBydm4yICogdGhpcy5kMTEgKyBydm4zICogdGhpcy5kMTI7XHJcbiAgICAgIHZhciBkTGltaXRJbXB1bHNlMyA9IHJ2bjEgKiB0aGlzLmQyMCArIHJ2bjIgKiB0aGlzLmQyMSArIHJ2bjMgKiB0aGlzLmQyMjtcclxuXHJcbiAgICAgIHRoaXMubGltaXRJbXB1bHNlMSArPSBkTGltaXRJbXB1bHNlMTtcclxuICAgICAgdGhpcy5saW1pdEltcHVsc2UyICs9IGRMaW1pdEltcHVsc2UyO1xyXG4gICAgICB0aGlzLmxpbWl0SW1wdWxzZTMgKz0gZExpbWl0SW1wdWxzZTM7XHJcblxyXG4gICAgICAvLyBjbGFtcFxyXG4gICAgICB2YXIgY2xhbXBTdGF0ZSA9IDA7XHJcbiAgICAgIGlmICh0aGlzLmxpbWl0U3RhdGUxID09IDIgfHwgdGhpcy5saW1pdEltcHVsc2UxICogdGhpcy5saW1pdFN0YXRlMSA8IDApIHtcclxuICAgICAgICBkTGltaXRJbXB1bHNlMSA9IC1vbGRMaW1pdEltcHVsc2UxO1xyXG4gICAgICAgIHJ2bjIgKz0gZExpbWl0SW1wdWxzZTEgKiB0aGlzLmsxMDtcclxuICAgICAgICBydm4zICs9IGRMaW1pdEltcHVsc2UxICogdGhpcy5rMjA7XHJcbiAgICAgICAgY2xhbXBTdGF0ZSB8PSAxO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLmxpbWl0U3RhdGUyID09IDIgfHwgdGhpcy5saW1pdEltcHVsc2UyICogdGhpcy5saW1pdFN0YXRlMiA8IDApIHtcclxuICAgICAgICBkTGltaXRJbXB1bHNlMiA9IC1vbGRMaW1pdEltcHVsc2UyO1xyXG4gICAgICAgIHJ2bjEgKz0gZExpbWl0SW1wdWxzZTIgKiB0aGlzLmswMTtcclxuICAgICAgICBydm4zICs9IGRMaW1pdEltcHVsc2UyICogdGhpcy5rMjE7XHJcbiAgICAgICAgY2xhbXBTdGF0ZSB8PSAyO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh0aGlzLmxpbWl0U3RhdGUzID09IDIgfHwgdGhpcy5saW1pdEltcHVsc2UzICogdGhpcy5saW1pdFN0YXRlMyA8IDApIHtcclxuICAgICAgICBkTGltaXRJbXB1bHNlMyA9IC1vbGRMaW1pdEltcHVsc2UzO1xyXG4gICAgICAgIHJ2bjEgKz0gZExpbWl0SW1wdWxzZTMgKiB0aGlzLmswMjtcclxuICAgICAgICBydm4yICs9IGRMaW1pdEltcHVsc2UzICogdGhpcy5rMTI7XHJcbiAgICAgICAgY2xhbXBTdGF0ZSB8PSA0O1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyB1cGRhdGUgdW4tY2xhbXBlZCBpbXB1bHNlXHJcbiAgICAgIC8vIFRPRE86IGlzb2xhdGUgZGl2aXNpb25cclxuICAgICAgdmFyIGRldDtcclxuICAgICAgc3dpdGNoIChjbGFtcFN0YXRlKSB7XHJcbiAgICAgICAgY2FzZSAxOiAvLyB1cGRhdGUgMiAzXHJcbiAgICAgICAgICBkZXQgPSAxIC8gKHRoaXMuazExICogdGhpcy5rMjIgLSB0aGlzLmsxMiAqIHRoaXMuazIxKTtcclxuICAgICAgICAgIGRMaW1pdEltcHVsc2UyID0gKHRoaXMuazIyICogcnZuMiArIC10aGlzLmsxMiAqIHJ2bjMpICogZGV0O1xyXG4gICAgICAgICAgZExpbWl0SW1wdWxzZTMgPSAoLXRoaXMuazIxICogcnZuMiArIHRoaXMuazExICogcnZuMykgKiBkZXQ7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIDI6IC8vIHVwZGF0ZSAxIDNcclxuICAgICAgICAgIGRldCA9IDEgLyAodGhpcy5rMDAgKiB0aGlzLmsyMiAtIHRoaXMuazAyICogdGhpcy5rMjApO1xyXG4gICAgICAgICAgZExpbWl0SW1wdWxzZTEgPSAodGhpcy5rMjIgKiBydm4xICsgLXRoaXMuazAyICogcnZuMykgKiBkZXQ7XHJcbiAgICAgICAgICBkTGltaXRJbXB1bHNlMyA9ICgtdGhpcy5rMjAgKiBydm4xICsgdGhpcy5rMDAgKiBydm4zKSAqIGRldDtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgMzogLy8gdXBkYXRlIDNcclxuICAgICAgICAgIGRMaW1pdEltcHVsc2UzID0gcnZuMyAvIHRoaXMuazIyO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSA0OiAvLyB1cGRhdGUgMSAyXHJcbiAgICAgICAgICBkZXQgPSAxIC8gKHRoaXMuazAwICogdGhpcy5rMTEgLSB0aGlzLmswMSAqIHRoaXMuazEwKTtcclxuICAgICAgICAgIGRMaW1pdEltcHVsc2UxID0gKHRoaXMuazExICogcnZuMSArIC10aGlzLmswMSAqIHJ2bjIpICogZGV0O1xyXG4gICAgICAgICAgZExpbWl0SW1wdWxzZTIgPSAoLXRoaXMuazEwICogcnZuMSArIHRoaXMuazAwICogcnZuMikgKiBkZXQ7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIDU6IC8vIHVwZGF0ZSAyXHJcbiAgICAgICAgICBkTGltaXRJbXB1bHNlMiA9IHJ2bjIgLyB0aGlzLmsxMTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgNjogLy8gdXBkYXRlIDFcclxuICAgICAgICAgIGRMaW1pdEltcHVsc2UxID0gcnZuMSAvIHRoaXMuazAwO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMubGltaXRJbXB1bHNlMSA9IGRMaW1pdEltcHVsc2UxICsgb2xkTGltaXRJbXB1bHNlMTtcclxuICAgICAgdGhpcy5saW1pdEltcHVsc2UyID0gZExpbWl0SW1wdWxzZTIgKyBvbGRMaW1pdEltcHVsc2UyO1xyXG4gICAgICB0aGlzLmxpbWl0SW1wdWxzZTMgPSBkTGltaXRJbXB1bHNlMyArIG9sZExpbWl0SW1wdWxzZTM7XHJcblxyXG4gICAgICB2YXIgZEltcHVsc2UxID0gZE1vdG9ySW1wdWxzZTEgKyBkTGltaXRJbXB1bHNlMTtcclxuICAgICAgdmFyIGRJbXB1bHNlMiA9IGRNb3RvckltcHVsc2UyICsgZExpbWl0SW1wdWxzZTI7XHJcbiAgICAgIHZhciBkSW1wdWxzZTMgPSBkTW90b3JJbXB1bHNlMyArIGRMaW1pdEltcHVsc2UzO1xyXG5cclxuICAgICAgLy8gYXBwbHkgaW1wdWxzZVxyXG4gICAgICB0aGlzLmExLnggKz0gZEltcHVsc2UxICogdGhpcy5hMXgxICsgZEltcHVsc2UyICogdGhpcy5hMXgyICsgZEltcHVsc2UzICogdGhpcy5hMXgzO1xyXG4gICAgICB0aGlzLmExLnkgKz0gZEltcHVsc2UxICogdGhpcy5hMXkxICsgZEltcHVsc2UyICogdGhpcy5hMXkyICsgZEltcHVsc2UzICogdGhpcy5hMXkzO1xyXG4gICAgICB0aGlzLmExLnogKz0gZEltcHVsc2UxICogdGhpcy5hMXoxICsgZEltcHVsc2UyICogdGhpcy5hMXoyICsgZEltcHVsc2UzICogdGhpcy5hMXozO1xyXG4gICAgICB0aGlzLmEyLnggLT0gZEltcHVsc2UxICogdGhpcy5hMngxICsgZEltcHVsc2UyICogdGhpcy5hMngyICsgZEltcHVsc2UzICogdGhpcy5hMngzO1xyXG4gICAgICB0aGlzLmEyLnkgLT0gZEltcHVsc2UxICogdGhpcy5hMnkxICsgZEltcHVsc2UyICogdGhpcy5hMnkyICsgZEltcHVsc2UzICogdGhpcy5hMnkzO1xyXG4gICAgICB0aGlzLmEyLnogLT0gZEltcHVsc2UxICogdGhpcy5hMnoxICsgZEltcHVsc2UyICogdGhpcy5hMnoyICsgZEltcHVsc2UzICogdGhpcy5hMnozO1xyXG4gICAgICBydnggPSB0aGlzLmEyLnggLSB0aGlzLmExLng7XHJcbiAgICAgIHJ2eSA9IHRoaXMuYTIueSAtIHRoaXMuYTEueTtcclxuICAgICAgcnZ6ID0gdGhpcy5hMi56IC0gdGhpcy5hMS56O1xyXG5cclxuICAgICAgcnZuMiA9IHJ2eCAqIHRoaXMuYXgyICsgcnZ5ICogdGhpcy5heTIgKyBydnogKiB0aGlzLmF6MjtcclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIEEgaGluZ2Ugam9pbnQgYWxsb3dzIG9ubHkgZm9yIHJlbGF0aXZlIHJvdGF0aW9uIG9mIHJpZ2lkIGJvZGllcyBhbG9uZyB0aGUgYXhpcy5cclxuICAgKlxyXG4gICAqIEBhdXRob3Igc2FoYXJhblxyXG4gICAqIEBhdXRob3IgbG8tdGhcclxuICAgKi9cclxuXHJcbiAgZnVuY3Rpb24gSGluZ2VKb2ludChjb25maWcsIGxvd2VyQW5nbGVMaW1pdCwgdXBwZXJBbmdsZUxpbWl0KSB7XHJcblxyXG4gICAgSm9pbnQuY2FsbCh0aGlzLCBjb25maWcpO1xyXG5cclxuICAgIHRoaXMudHlwZSA9IEpPSU5UX0hJTkdFO1xyXG5cclxuICAgIC8vIFRoZSBheGlzIGluIHRoZSBmaXJzdCBib2R5J3MgY29vcmRpbmF0ZSBzeXN0ZW0uXHJcbiAgICB0aGlzLmxvY2FsQXhpczEgPSBjb25maWcubG9jYWxBeGlzMS5jbG9uZSgpLm5vcm1hbGl6ZSgpO1xyXG4gICAgLy8gVGhlIGF4aXMgaW4gdGhlIHNlY29uZCBib2R5J3MgY29vcmRpbmF0ZSBzeXN0ZW0uXHJcbiAgICB0aGlzLmxvY2FsQXhpczIgPSBjb25maWcubG9jYWxBeGlzMi5jbG9uZSgpLm5vcm1hbGl6ZSgpO1xyXG5cclxuICAgIC8vIG1ha2UgYW5nbGUgYXhpc1xyXG4gICAgdmFyIGFyYyA9IG5ldyBNYXQzMygpLnNldFF1YXQobmV3IFF1YXQoKS5zZXRGcm9tVW5pdFZlY3RvcnModGhpcy5sb2NhbEF4aXMxLCB0aGlzLmxvY2FsQXhpczIpKTtcclxuICAgIHRoaXMubG9jYWxBbmdsZTEgPSBuZXcgVmVjMygpLnRhbmdlbnQodGhpcy5sb2NhbEF4aXMxKS5ub3JtYWxpemUoKTtcclxuICAgIHRoaXMubG9jYWxBbmdsZTIgPSB0aGlzLmxvY2FsQW5nbGUxLmNsb25lKCkuYXBwbHlNYXRyaXgzKGFyYywgdHJ1ZSk7XHJcblxyXG4gICAgdGhpcy5heDEgPSBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy5heDIgPSBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy5hbjEgPSBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy5hbjIgPSBuZXcgVmVjMygpO1xyXG5cclxuICAgIHRoaXMudG1wID0gbmV3IFZlYzMoKTtcclxuXHJcbiAgICB0aGlzLm5vciA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLnRhbiA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLmJpbiA9IG5ldyBWZWMzKCk7XHJcblxyXG4gICAgLy8gVGhlIHJvdGF0aW9uYWwgbGltaXQgYW5kIG1vdG9yIGluZm9ybWF0aW9uIG9mIHRoZSBqb2ludC5cclxuICAgIHRoaXMubGltaXRNb3RvciA9IG5ldyBMaW1pdE1vdG9yKHRoaXMubm9yLCBmYWxzZSk7XHJcbiAgICB0aGlzLmxpbWl0TW90b3IubG93ZXJMaW1pdCA9IGxvd2VyQW5nbGVMaW1pdDtcclxuICAgIHRoaXMubGltaXRNb3Rvci51cHBlckxpbWl0ID0gdXBwZXJBbmdsZUxpbWl0O1xyXG5cclxuICAgIHRoaXMubGMgPSBuZXcgTGluZWFyQ29uc3RyYWludCh0aGlzKTtcclxuICAgIHRoaXMucjMgPSBuZXcgUm90YXRpb25hbDNDb25zdHJhaW50KHRoaXMsIHRoaXMubGltaXRNb3RvciwgbmV3IExpbWl0TW90b3IodGhpcy50YW4sIHRydWUpLCBuZXcgTGltaXRNb3Rvcih0aGlzLmJpbiwgdHJ1ZSkpO1xyXG4gIH1cclxuICBIaW5nZUpvaW50LnByb3RvdHlwZSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShKb2ludC5wcm90b3R5cGUpLCB7XHJcblxyXG4gICAgY29uc3RydWN0b3I6IEhpbmdlSm9pbnQsXHJcblxyXG5cclxuICAgIHByZVNvbHZlOiBmdW5jdGlvbiAodGltZVN0ZXAsIGludlRpbWVTdGVwKSB7XHJcblxyXG4gICAgICB0aGlzLnVwZGF0ZUFuY2hvclBvaW50cygpO1xyXG5cclxuICAgICAgdGhpcy5heDEuY29weSh0aGlzLmxvY2FsQXhpczEpLmFwcGx5TWF0cml4Myh0aGlzLmJvZHkxLnJvdGF0aW9uLCB0cnVlKTtcclxuICAgICAgdGhpcy5heDIuY29weSh0aGlzLmxvY2FsQXhpczIpLmFwcGx5TWF0cml4Myh0aGlzLmJvZHkyLnJvdGF0aW9uLCB0cnVlKTtcclxuXHJcbiAgICAgIHRoaXMuYW4xLmNvcHkodGhpcy5sb2NhbEFuZ2xlMSkuYXBwbHlNYXRyaXgzKHRoaXMuYm9keTEucm90YXRpb24sIHRydWUpO1xyXG4gICAgICB0aGlzLmFuMi5jb3B5KHRoaXMubG9jYWxBbmdsZTIpLmFwcGx5TWF0cml4Myh0aGlzLmJvZHkyLnJvdGF0aW9uLCB0cnVlKTtcclxuXHJcbiAgICAgIC8vIG5vcm1hbCB0YW5nZW50IGJpbm9ybWFsXHJcblxyXG4gICAgICB0aGlzLm5vci5zZXQoXHJcbiAgICAgICAgdGhpcy5heDEueCAqIHRoaXMuYm9keTIuaW52ZXJzZU1hc3MgKyB0aGlzLmF4Mi54ICogdGhpcy5ib2R5MS5pbnZlcnNlTWFzcyxcclxuICAgICAgICB0aGlzLmF4MS55ICogdGhpcy5ib2R5Mi5pbnZlcnNlTWFzcyArIHRoaXMuYXgyLnkgKiB0aGlzLmJvZHkxLmludmVyc2VNYXNzLFxyXG4gICAgICAgIHRoaXMuYXgxLnogKiB0aGlzLmJvZHkyLmludmVyc2VNYXNzICsgdGhpcy5heDIueiAqIHRoaXMuYm9keTEuaW52ZXJzZU1hc3NcclxuICAgICAgKS5ub3JtYWxpemUoKTtcclxuXHJcbiAgICAgIHRoaXMudGFuLnRhbmdlbnQodGhpcy5ub3IpLm5vcm1hbGl6ZSgpO1xyXG5cclxuICAgICAgdGhpcy5iaW4uY3Jvc3NWZWN0b3JzKHRoaXMubm9yLCB0aGlzLnRhbik7XHJcblxyXG4gICAgICAvLyBjYWxjdWxhdGUgaGluZ2UgYW5nbGVcclxuXHJcbiAgICAgIHZhciBsaW1pdGUgPSBfTWF0aC5hY29zQ2xhbXAoX01hdGguZG90VmVjdG9ycyh0aGlzLmFuMSwgdGhpcy5hbjIpKTtcclxuXHJcbiAgICAgIHRoaXMudG1wLmNyb3NzVmVjdG9ycyh0aGlzLmFuMSwgdGhpcy5hbjIpO1xyXG5cclxuICAgICAgaWYgKF9NYXRoLmRvdFZlY3RvcnModGhpcy5ub3IsIHRoaXMudG1wKSA8IDApIHRoaXMubGltaXRNb3Rvci5hbmdsZSA9IC1saW1pdGU7XHJcbiAgICAgIGVsc2UgdGhpcy5saW1pdE1vdG9yLmFuZ2xlID0gbGltaXRlO1xyXG5cclxuICAgICAgdGhpcy50bXAuY3Jvc3NWZWN0b3JzKHRoaXMuYXgxLCB0aGlzLmF4Mik7XHJcblxyXG4gICAgICB0aGlzLnIzLmxpbWl0TW90b3IyLmFuZ2xlID0gX01hdGguZG90VmVjdG9ycyh0aGlzLnRhbiwgdGhpcy50bXApO1xyXG4gICAgICB0aGlzLnIzLmxpbWl0TW90b3IzLmFuZ2xlID0gX01hdGguZG90VmVjdG9ycyh0aGlzLmJpbiwgdGhpcy50bXApO1xyXG5cclxuICAgICAgLy8gcHJlU29sdmVcclxuXHJcbiAgICAgIHRoaXMucjMucHJlU29sdmUodGltZVN0ZXAsIGludlRpbWVTdGVwKTtcclxuICAgICAgdGhpcy5sYy5wcmVTb2x2ZSh0aW1lU3RlcCwgaW52VGltZVN0ZXApO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc29sdmU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHRoaXMucjMuc29sdmUoKTtcclxuICAgICAgdGhpcy5sYy5zb2x2ZSgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcG9zdFNvbHZlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgICogQSBiYWxsLWFuZC1zb2NrZXQgam9pbnQgbGltaXRzIHJlbGF0aXZlIHRyYW5zbGF0aW9uIG9uIHR3byBhbmNob3IgcG9pbnRzIG9uIHJpZ2lkIGJvZGllcy5cclxuICAgKlxyXG4gICAqIEBhdXRob3Igc2FoYXJhblxyXG4gICAqIEBhdXRob3IgbG8tdGhcclxuICAgKi9cclxuXHJcbiAgZnVuY3Rpb24gQmFsbEFuZFNvY2tldEpvaW50KGNvbmZpZykge1xyXG5cclxuICAgIEpvaW50LmNhbGwodGhpcywgY29uZmlnKTtcclxuXHJcbiAgICB0aGlzLnR5cGUgPSBKT0lOVF9CQUxMX0FORF9TT0NLRVQ7XHJcblxyXG4gICAgdGhpcy5sYyA9IG5ldyBMaW5lYXJDb25zdHJhaW50KHRoaXMpO1xyXG5cclxuICB9XHJcbiAgQmFsbEFuZFNvY2tldEpvaW50LnByb3RvdHlwZSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShKb2ludC5wcm90b3R5cGUpLCB7XHJcblxyXG4gICAgY29uc3RydWN0b3I6IEJhbGxBbmRTb2NrZXRKb2ludCxcclxuXHJcbiAgICBwcmVTb2x2ZTogZnVuY3Rpb24gKHRpbWVTdGVwLCBpbnZUaW1lU3RlcCkge1xyXG5cclxuICAgICAgdGhpcy51cGRhdGVBbmNob3JQb2ludHMoKTtcclxuXHJcbiAgICAgIC8vIHByZVNvbHZlXHJcblxyXG4gICAgICB0aGlzLmxjLnByZVNvbHZlKHRpbWVTdGVwLCBpbnZUaW1lU3RlcCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzb2x2ZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdGhpcy5sYy5zb2x2ZSgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcG9zdFNvbHZlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgKiBBIHRyYW5zbGF0aW9uYWwgY29uc3RyYWludCBmb3IgdmFyaW91cyBqb2ludHMuXHJcbiAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAqL1xyXG4gIGZ1bmN0aW9uIFRyYW5zbGF0aW9uYWxDb25zdHJhaW50KGpvaW50LCBsaW1pdE1vdG9yKSB7XHJcbiAgICB0aGlzLmNmbSA9IE5hTjtcclxuICAgIHRoaXMubTEgPSBOYU47XHJcbiAgICB0aGlzLm0yID0gTmFOO1xyXG4gICAgdGhpcy5pMWUwMCA9IE5hTjtcclxuICAgIHRoaXMuaTFlMDEgPSBOYU47XHJcbiAgICB0aGlzLmkxZTAyID0gTmFOO1xyXG4gICAgdGhpcy5pMWUxMCA9IE5hTjtcclxuICAgIHRoaXMuaTFlMTEgPSBOYU47XHJcbiAgICB0aGlzLmkxZTEyID0gTmFOO1xyXG4gICAgdGhpcy5pMWUyMCA9IE5hTjtcclxuICAgIHRoaXMuaTFlMjEgPSBOYU47XHJcbiAgICB0aGlzLmkxZTIyID0gTmFOO1xyXG4gICAgdGhpcy5pMmUwMCA9IE5hTjtcclxuICAgIHRoaXMuaTJlMDEgPSBOYU47XHJcbiAgICB0aGlzLmkyZTAyID0gTmFOO1xyXG4gICAgdGhpcy5pMmUxMCA9IE5hTjtcclxuICAgIHRoaXMuaTJlMTEgPSBOYU47XHJcbiAgICB0aGlzLmkyZTEyID0gTmFOO1xyXG4gICAgdGhpcy5pMmUyMCA9IE5hTjtcclxuICAgIHRoaXMuaTJlMjEgPSBOYU47XHJcbiAgICB0aGlzLmkyZTIyID0gTmFOO1xyXG4gICAgdGhpcy5tb3RvckRlbm9tID0gTmFOO1xyXG4gICAgdGhpcy5pbnZNb3RvckRlbm9tID0gTmFOO1xyXG4gICAgdGhpcy5pbnZEZW5vbSA9IE5hTjtcclxuICAgIHRoaXMuYXggPSBOYU47XHJcbiAgICB0aGlzLmF5ID0gTmFOO1xyXG4gICAgdGhpcy5heiA9IE5hTjtcclxuICAgIHRoaXMucjF4ID0gTmFOO1xyXG4gICAgdGhpcy5yMXkgPSBOYU47XHJcbiAgICB0aGlzLnIxeiA9IE5hTjtcclxuICAgIHRoaXMucjJ4ID0gTmFOO1xyXG4gICAgdGhpcy5yMnkgPSBOYU47XHJcbiAgICB0aGlzLnIyeiA9IE5hTjtcclxuICAgIHRoaXMudDF4ID0gTmFOO1xyXG4gICAgdGhpcy50MXkgPSBOYU47XHJcbiAgICB0aGlzLnQxeiA9IE5hTjtcclxuICAgIHRoaXMudDJ4ID0gTmFOO1xyXG4gICAgdGhpcy50MnkgPSBOYU47XHJcbiAgICB0aGlzLnQyeiA9IE5hTjtcclxuICAgIHRoaXMubDF4ID0gTmFOO1xyXG4gICAgdGhpcy5sMXkgPSBOYU47XHJcbiAgICB0aGlzLmwxeiA9IE5hTjtcclxuICAgIHRoaXMubDJ4ID0gTmFOO1xyXG4gICAgdGhpcy5sMnkgPSBOYU47XHJcbiAgICB0aGlzLmwyeiA9IE5hTjtcclxuICAgIHRoaXMuYTF4ID0gTmFOO1xyXG4gICAgdGhpcy5hMXkgPSBOYU47XHJcbiAgICB0aGlzLmExeiA9IE5hTjtcclxuICAgIHRoaXMuYTJ4ID0gTmFOO1xyXG4gICAgdGhpcy5hMnkgPSBOYU47XHJcbiAgICB0aGlzLmEyeiA9IE5hTjtcclxuICAgIHRoaXMubG93ZXJMaW1pdCA9IE5hTjtcclxuICAgIHRoaXMudXBwZXJMaW1pdCA9IE5hTjtcclxuICAgIHRoaXMubGltaXRWZWxvY2l0eSA9IE5hTjtcclxuICAgIHRoaXMubGltaXRTdGF0ZSA9IDA7IC8vIC0xOiBhdCBsb3dlciwgMDogbG9ja2VkLCAxOiBhdCB1cHBlciwgMjogZnJlZVxyXG4gICAgdGhpcy5lbmFibGVNb3RvciA9IGZhbHNlO1xyXG4gICAgdGhpcy5tb3RvclNwZWVkID0gTmFOO1xyXG4gICAgdGhpcy5tYXhNb3RvckZvcmNlID0gTmFOO1xyXG4gICAgdGhpcy5tYXhNb3RvckltcHVsc2UgPSBOYU47XHJcblxyXG4gICAgdGhpcy5saW1pdE1vdG9yID0gbGltaXRNb3RvcjtcclxuICAgIHRoaXMuYjEgPSBqb2ludC5ib2R5MTtcclxuICAgIHRoaXMuYjIgPSBqb2ludC5ib2R5MjtcclxuICAgIHRoaXMucDEgPSBqb2ludC5hbmNob3JQb2ludDE7XHJcbiAgICB0aGlzLnAyID0gam9pbnQuYW5jaG9yUG9pbnQyO1xyXG4gICAgdGhpcy5yMSA9IGpvaW50LnJlbGF0aXZlQW5jaG9yUG9pbnQxO1xyXG4gICAgdGhpcy5yMiA9IGpvaW50LnJlbGF0aXZlQW5jaG9yUG9pbnQyO1xyXG4gICAgdGhpcy5sMSA9IHRoaXMuYjEubGluZWFyVmVsb2NpdHk7XHJcbiAgICB0aGlzLmwyID0gdGhpcy5iMi5saW5lYXJWZWxvY2l0eTtcclxuICAgIHRoaXMuYTEgPSB0aGlzLmIxLmFuZ3VsYXJWZWxvY2l0eTtcclxuICAgIHRoaXMuYTIgPSB0aGlzLmIyLmFuZ3VsYXJWZWxvY2l0eTtcclxuICAgIHRoaXMuaTEgPSB0aGlzLmIxLmludmVyc2VJbmVydGlhO1xyXG4gICAgdGhpcy5pMiA9IHRoaXMuYjIuaW52ZXJzZUluZXJ0aWE7XHJcbiAgICB0aGlzLmxpbWl0SW1wdWxzZSA9IDA7XHJcbiAgICB0aGlzLm1vdG9ySW1wdWxzZSA9IDA7XHJcbiAgfVxyXG5cclxuICBPYmplY3QuYXNzaWduKFRyYW5zbGF0aW9uYWxDb25zdHJhaW50LnByb3RvdHlwZSwge1xyXG5cclxuICAgIFRyYW5zbGF0aW9uYWxDb25zdHJhaW50OiB0cnVlLFxyXG5cclxuICAgIHByZVNvbHZlOiBmdW5jdGlvbiAodGltZVN0ZXAsIGludlRpbWVTdGVwKSB7XHJcbiAgICAgIHRoaXMuYXggPSB0aGlzLmxpbWl0TW90b3IuYXhpcy54O1xyXG4gICAgICB0aGlzLmF5ID0gdGhpcy5saW1pdE1vdG9yLmF4aXMueTtcclxuICAgICAgdGhpcy5heiA9IHRoaXMubGltaXRNb3Rvci5heGlzLno7XHJcbiAgICAgIHRoaXMubG93ZXJMaW1pdCA9IHRoaXMubGltaXRNb3Rvci5sb3dlckxpbWl0O1xyXG4gICAgICB0aGlzLnVwcGVyTGltaXQgPSB0aGlzLmxpbWl0TW90b3IudXBwZXJMaW1pdDtcclxuICAgICAgdGhpcy5tb3RvclNwZWVkID0gdGhpcy5saW1pdE1vdG9yLm1vdG9yU3BlZWQ7XHJcbiAgICAgIHRoaXMubWF4TW90b3JGb3JjZSA9IHRoaXMubGltaXRNb3Rvci5tYXhNb3RvckZvcmNlO1xyXG4gICAgICB0aGlzLmVuYWJsZU1vdG9yID0gdGhpcy5tYXhNb3RvckZvcmNlID4gMDtcclxuICAgICAgdGhpcy5tMSA9IHRoaXMuYjEuaW52ZXJzZU1hc3M7XHJcbiAgICAgIHRoaXMubTIgPSB0aGlzLmIyLmludmVyc2VNYXNzO1xyXG5cclxuICAgICAgdmFyIHRpMSA9IHRoaXMuaTEuZWxlbWVudHM7XHJcbiAgICAgIHZhciB0aTIgPSB0aGlzLmkyLmVsZW1lbnRzO1xyXG4gICAgICB0aGlzLmkxZTAwID0gdGkxWzBdO1xyXG4gICAgICB0aGlzLmkxZTAxID0gdGkxWzFdO1xyXG4gICAgICB0aGlzLmkxZTAyID0gdGkxWzJdO1xyXG4gICAgICB0aGlzLmkxZTEwID0gdGkxWzNdO1xyXG4gICAgICB0aGlzLmkxZTExID0gdGkxWzRdO1xyXG4gICAgICB0aGlzLmkxZTEyID0gdGkxWzVdO1xyXG4gICAgICB0aGlzLmkxZTIwID0gdGkxWzZdO1xyXG4gICAgICB0aGlzLmkxZTIxID0gdGkxWzddO1xyXG4gICAgICB0aGlzLmkxZTIyID0gdGkxWzhdO1xyXG5cclxuICAgICAgdGhpcy5pMmUwMCA9IHRpMlswXTtcclxuICAgICAgdGhpcy5pMmUwMSA9IHRpMlsxXTtcclxuICAgICAgdGhpcy5pMmUwMiA9IHRpMlsyXTtcclxuICAgICAgdGhpcy5pMmUxMCA9IHRpMlszXTtcclxuICAgICAgdGhpcy5pMmUxMSA9IHRpMls0XTtcclxuICAgICAgdGhpcy5pMmUxMiA9IHRpMls1XTtcclxuICAgICAgdGhpcy5pMmUyMCA9IHRpMls2XTtcclxuICAgICAgdGhpcy5pMmUyMSA9IHRpMls3XTtcclxuICAgICAgdGhpcy5pMmUyMiA9IHRpMls4XTtcclxuXHJcbiAgICAgIHZhciBkeCA9IHRoaXMucDIueCAtIHRoaXMucDEueDtcclxuICAgICAgdmFyIGR5ID0gdGhpcy5wMi55IC0gdGhpcy5wMS55O1xyXG4gICAgICB2YXIgZHogPSB0aGlzLnAyLnogLSB0aGlzLnAxLno7XHJcbiAgICAgIHZhciBkID0gZHggKiB0aGlzLmF4ICsgZHkgKiB0aGlzLmF5ICsgZHogKiB0aGlzLmF6O1xyXG4gICAgICB2YXIgZnJlcXVlbmN5ID0gdGhpcy5saW1pdE1vdG9yLmZyZXF1ZW5jeTtcclxuICAgICAgdmFyIGVuYWJsZVNwcmluZyA9IGZyZXF1ZW5jeSA+IDA7XHJcbiAgICAgIHZhciBlbmFibGVMaW1pdCA9IHRoaXMubG93ZXJMaW1pdCA8PSB0aGlzLnVwcGVyTGltaXQ7XHJcbiAgICAgIGlmIChlbmFibGVTcHJpbmcgJiYgZCA+IDIwIHx8IGQgPCAtMjApIHtcclxuICAgICAgICBlbmFibGVTcHJpbmcgPSBmYWxzZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGVuYWJsZUxpbWl0KSB7XHJcbiAgICAgICAgaWYgKHRoaXMubG93ZXJMaW1pdCA9PSB0aGlzLnVwcGVyTGltaXQpIHtcclxuICAgICAgICAgIGlmICh0aGlzLmxpbWl0U3RhdGUgIT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0U3RhdGUgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0SW1wdWxzZSA9IDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLmxpbWl0VmVsb2NpdHkgPSB0aGlzLmxvd2VyTGltaXQgLSBkO1xyXG4gICAgICAgICAgaWYgKCFlbmFibGVTcHJpbmcpIGQgPSB0aGlzLmxvd2VyTGltaXQ7XHJcbiAgICAgICAgfSBlbHNlIGlmIChkIDwgdGhpcy5sb3dlckxpbWl0KSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5saW1pdFN0YXRlICE9IC0xKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGltaXRTdGF0ZSA9IC0xO1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0SW1wdWxzZSA9IDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLmxpbWl0VmVsb2NpdHkgPSB0aGlzLmxvd2VyTGltaXQgLSBkO1xyXG4gICAgICAgICAgaWYgKCFlbmFibGVTcHJpbmcpIGQgPSB0aGlzLmxvd2VyTGltaXQ7XHJcbiAgICAgICAgfSBlbHNlIGlmIChkID4gdGhpcy51cHBlckxpbWl0KSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5saW1pdFN0YXRlICE9IDEpIHtcclxuICAgICAgICAgICAgdGhpcy5saW1pdFN0YXRlID0gMTtcclxuICAgICAgICAgICAgdGhpcy5saW1pdEltcHVsc2UgPSAwO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5saW1pdFZlbG9jaXR5ID0gdGhpcy51cHBlckxpbWl0IC0gZDtcclxuICAgICAgICAgIGlmICghZW5hYmxlU3ByaW5nKSBkID0gdGhpcy51cHBlckxpbWl0O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmxpbWl0U3RhdGUgPSAyO1xyXG4gICAgICAgICAgdGhpcy5saW1pdEltcHVsc2UgPSAwO1xyXG4gICAgICAgICAgdGhpcy5saW1pdFZlbG9jaXR5ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFlbmFibGVTcHJpbmcpIHtcclxuICAgICAgICAgIGlmICh0aGlzLmxpbWl0VmVsb2NpdHkgPiAwLjAwNSkgdGhpcy5saW1pdFZlbG9jaXR5IC09IDAuMDA1O1xyXG4gICAgICAgICAgZWxzZSBpZiAodGhpcy5saW1pdFZlbG9jaXR5IDwgLTAuMDA1KSB0aGlzLmxpbWl0VmVsb2NpdHkgKz0gMC4wMDU7XHJcbiAgICAgICAgICBlbHNlIHRoaXMubGltaXRWZWxvY2l0eSA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMubGltaXRTdGF0ZSA9IDI7XHJcbiAgICAgICAgdGhpcy5saW1pdEltcHVsc2UgPSAwO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAodGhpcy5lbmFibGVNb3RvciAmJiAodGhpcy5saW1pdFN0YXRlICE9IDAgfHwgZW5hYmxlU3ByaW5nKSkge1xyXG4gICAgICAgIHRoaXMubWF4TW90b3JJbXB1bHNlID0gdGhpcy5tYXhNb3RvckZvcmNlICogdGltZVN0ZXA7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5tb3RvckltcHVsc2UgPSAwO1xyXG4gICAgICAgIHRoaXMubWF4TW90b3JJbXB1bHNlID0gMDtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIHJkeCA9IGQgKiB0aGlzLmF4O1xyXG4gICAgICB2YXIgcmR5ID0gZCAqIHRoaXMuYXk7XHJcbiAgICAgIHZhciByZHogPSBkICogdGhpcy5hejtcclxuICAgICAgdmFyIHcxID0gdGhpcy5tMSAvICh0aGlzLm0xICsgdGhpcy5tMik7XHJcbiAgICAgIHZhciB3MiA9IDEgLSB3MTtcclxuICAgICAgdGhpcy5yMXggPSB0aGlzLnIxLnggKyByZHggKiB3MTtcclxuICAgICAgdGhpcy5yMXkgPSB0aGlzLnIxLnkgKyByZHkgKiB3MTtcclxuICAgICAgdGhpcy5yMXogPSB0aGlzLnIxLnogKyByZHogKiB3MTtcclxuICAgICAgdGhpcy5yMnggPSB0aGlzLnIyLnggLSByZHggKiB3MjtcclxuICAgICAgdGhpcy5yMnkgPSB0aGlzLnIyLnkgLSByZHkgKiB3MjtcclxuICAgICAgdGhpcy5yMnogPSB0aGlzLnIyLnogLSByZHogKiB3MjtcclxuXHJcbiAgICAgIHRoaXMudDF4ID0gdGhpcy5yMXkgKiB0aGlzLmF6IC0gdGhpcy5yMXogKiB0aGlzLmF5O1xyXG4gICAgICB0aGlzLnQxeSA9IHRoaXMucjF6ICogdGhpcy5heCAtIHRoaXMucjF4ICogdGhpcy5hejtcclxuICAgICAgdGhpcy50MXogPSB0aGlzLnIxeCAqIHRoaXMuYXkgLSB0aGlzLnIxeSAqIHRoaXMuYXg7XHJcbiAgICAgIHRoaXMudDJ4ID0gdGhpcy5yMnkgKiB0aGlzLmF6IC0gdGhpcy5yMnogKiB0aGlzLmF5O1xyXG4gICAgICB0aGlzLnQyeSA9IHRoaXMucjJ6ICogdGhpcy5heCAtIHRoaXMucjJ4ICogdGhpcy5hejtcclxuICAgICAgdGhpcy50MnogPSB0aGlzLnIyeCAqIHRoaXMuYXkgLSB0aGlzLnIyeSAqIHRoaXMuYXg7XHJcbiAgICAgIHRoaXMubDF4ID0gdGhpcy5heCAqIHRoaXMubTE7XHJcbiAgICAgIHRoaXMubDF5ID0gdGhpcy5heSAqIHRoaXMubTE7XHJcbiAgICAgIHRoaXMubDF6ID0gdGhpcy5heiAqIHRoaXMubTE7XHJcbiAgICAgIHRoaXMubDJ4ID0gdGhpcy5heCAqIHRoaXMubTI7XHJcbiAgICAgIHRoaXMubDJ5ID0gdGhpcy5heSAqIHRoaXMubTI7XHJcbiAgICAgIHRoaXMubDJ6ID0gdGhpcy5heiAqIHRoaXMubTI7XHJcbiAgICAgIHRoaXMuYTF4ID0gdGhpcy50MXggKiB0aGlzLmkxZTAwICsgdGhpcy50MXkgKiB0aGlzLmkxZTAxICsgdGhpcy50MXogKiB0aGlzLmkxZTAyO1xyXG4gICAgICB0aGlzLmExeSA9IHRoaXMudDF4ICogdGhpcy5pMWUxMCArIHRoaXMudDF5ICogdGhpcy5pMWUxMSArIHRoaXMudDF6ICogdGhpcy5pMWUxMjtcclxuICAgICAgdGhpcy5hMXogPSB0aGlzLnQxeCAqIHRoaXMuaTFlMjAgKyB0aGlzLnQxeSAqIHRoaXMuaTFlMjEgKyB0aGlzLnQxeiAqIHRoaXMuaTFlMjI7XHJcbiAgICAgIHRoaXMuYTJ4ID0gdGhpcy50MnggKiB0aGlzLmkyZTAwICsgdGhpcy50MnkgKiB0aGlzLmkyZTAxICsgdGhpcy50MnogKiB0aGlzLmkyZTAyO1xyXG4gICAgICB0aGlzLmEyeSA9IHRoaXMudDJ4ICogdGhpcy5pMmUxMCArIHRoaXMudDJ5ICogdGhpcy5pMmUxMSArIHRoaXMudDJ6ICogdGhpcy5pMmUxMjtcclxuICAgICAgdGhpcy5hMnogPSB0aGlzLnQyeCAqIHRoaXMuaTJlMjAgKyB0aGlzLnQyeSAqIHRoaXMuaTJlMjEgKyB0aGlzLnQyeiAqIHRoaXMuaTJlMjI7XHJcbiAgICAgIHRoaXMubW90b3JEZW5vbSA9XHJcbiAgICAgICAgdGhpcy5tMSArIHRoaXMubTIgK1xyXG4gICAgICAgIHRoaXMuYXggKiAodGhpcy5hMXkgKiB0aGlzLnIxeiAtIHRoaXMuYTF6ICogdGhpcy5yMXkgKyB0aGlzLmEyeSAqIHRoaXMucjJ6IC0gdGhpcy5hMnogKiB0aGlzLnIyeSkgK1xyXG4gICAgICAgIHRoaXMuYXkgKiAodGhpcy5hMXogKiB0aGlzLnIxeCAtIHRoaXMuYTF4ICogdGhpcy5yMXogKyB0aGlzLmEyeiAqIHRoaXMucjJ4IC0gdGhpcy5hMnggKiB0aGlzLnIyeikgK1xyXG4gICAgICAgIHRoaXMuYXogKiAodGhpcy5hMXggKiB0aGlzLnIxeSAtIHRoaXMuYTF5ICogdGhpcy5yMXggKyB0aGlzLmEyeCAqIHRoaXMucjJ5IC0gdGhpcy5hMnkgKiB0aGlzLnIyeCk7XHJcblxyXG4gICAgICB0aGlzLmludk1vdG9yRGVub20gPSAxIC8gdGhpcy5tb3RvckRlbm9tO1xyXG5cclxuICAgICAgaWYgKGVuYWJsZVNwcmluZyAmJiB0aGlzLmxpbWl0U3RhdGUgIT0gMikge1xyXG4gICAgICAgIHZhciBvbWVnYSA9IDYuMjgzMTg1MyAqIGZyZXF1ZW5jeTtcclxuICAgICAgICB2YXIgayA9IG9tZWdhICogb21lZ2EgKiB0aW1lU3RlcDtcclxuICAgICAgICB2YXIgZG1wID0gaW52VGltZVN0ZXAgLyAoayArIDIgKiB0aGlzLmxpbWl0TW90b3IuZGFtcGluZ1JhdGlvICogb21lZ2EpO1xyXG4gICAgICAgIHRoaXMuY2ZtID0gdGhpcy5tb3RvckRlbm9tICogZG1wO1xyXG4gICAgICAgIHRoaXMubGltaXRWZWxvY2l0eSAqPSBrICogZG1wO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuY2ZtID0gMDtcclxuICAgICAgICB0aGlzLmxpbWl0VmVsb2NpdHkgKj0gaW52VGltZVN0ZXAgKiAwLjA1O1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLmludkRlbm9tID0gMSAvICh0aGlzLm1vdG9yRGVub20gKyB0aGlzLmNmbSk7XHJcblxyXG4gICAgICB2YXIgdG90YWxJbXB1bHNlID0gdGhpcy5saW1pdEltcHVsc2UgKyB0aGlzLm1vdG9ySW1wdWxzZTtcclxuICAgICAgdGhpcy5sMS54ICs9IHRvdGFsSW1wdWxzZSAqIHRoaXMubDF4O1xyXG4gICAgICB0aGlzLmwxLnkgKz0gdG90YWxJbXB1bHNlICogdGhpcy5sMXk7XHJcbiAgICAgIHRoaXMubDEueiArPSB0b3RhbEltcHVsc2UgKiB0aGlzLmwxejtcclxuICAgICAgdGhpcy5hMS54ICs9IHRvdGFsSW1wdWxzZSAqIHRoaXMuYTF4O1xyXG4gICAgICB0aGlzLmExLnkgKz0gdG90YWxJbXB1bHNlICogdGhpcy5hMXk7XHJcbiAgICAgIHRoaXMuYTEueiArPSB0b3RhbEltcHVsc2UgKiB0aGlzLmExejtcclxuICAgICAgdGhpcy5sMi54IC09IHRvdGFsSW1wdWxzZSAqIHRoaXMubDJ4O1xyXG4gICAgICB0aGlzLmwyLnkgLT0gdG90YWxJbXB1bHNlICogdGhpcy5sMnk7XHJcbiAgICAgIHRoaXMubDIueiAtPSB0b3RhbEltcHVsc2UgKiB0aGlzLmwyejtcclxuICAgICAgdGhpcy5hMi54IC09IHRvdGFsSW1wdWxzZSAqIHRoaXMuYTJ4O1xyXG4gICAgICB0aGlzLmEyLnkgLT0gdG90YWxJbXB1bHNlICogdGhpcy5hMnk7XHJcbiAgICAgIHRoaXMuYTIueiAtPSB0b3RhbEltcHVsc2UgKiB0aGlzLmEyejtcclxuICAgIH0sXHJcbiAgICBzb2x2ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgICB2YXIgcnZuID1cclxuICAgICAgICB0aGlzLmF4ICogKHRoaXMubDIueCAtIHRoaXMubDEueCkgKyB0aGlzLmF5ICogKHRoaXMubDIueSAtIHRoaXMubDEueSkgKyB0aGlzLmF6ICogKHRoaXMubDIueiAtIHRoaXMubDEueikgK1xyXG4gICAgICAgIHRoaXMudDJ4ICogdGhpcy5hMi54IC0gdGhpcy50MXggKiB0aGlzLmExLnggKyB0aGlzLnQyeSAqIHRoaXMuYTIueSAtIHRoaXMudDF5ICogdGhpcy5hMS55ICsgdGhpcy50MnogKiB0aGlzLmEyLnogLSB0aGlzLnQxeiAqIHRoaXMuYTEuejtcclxuXHJcbiAgICAgIC8vIG1vdG9yIHBhcnRcclxuICAgICAgdmFyIG5ld01vdG9ySW1wdWxzZTtcclxuICAgICAgaWYgKHRoaXMuZW5hYmxlTW90b3IpIHtcclxuICAgICAgICBuZXdNb3RvckltcHVsc2UgPSAocnZuIC0gdGhpcy5tb3RvclNwZWVkKSAqIHRoaXMuaW52TW90b3JEZW5vbTtcclxuICAgICAgICB2YXIgb2xkTW90b3JJbXB1bHNlID0gdGhpcy5tb3RvckltcHVsc2U7XHJcbiAgICAgICAgdGhpcy5tb3RvckltcHVsc2UgKz0gbmV3TW90b3JJbXB1bHNlO1xyXG4gICAgICAgIGlmICh0aGlzLm1vdG9ySW1wdWxzZSA+IHRoaXMubWF4TW90b3JJbXB1bHNlKSB0aGlzLm1vdG9ySW1wdWxzZSA9IHRoaXMubWF4TW90b3JJbXB1bHNlO1xyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMubW90b3JJbXB1bHNlIDwgLXRoaXMubWF4TW90b3JJbXB1bHNlKSB0aGlzLm1vdG9ySW1wdWxzZSA9IC10aGlzLm1heE1vdG9ySW1wdWxzZTtcclxuICAgICAgICBuZXdNb3RvckltcHVsc2UgPSB0aGlzLm1vdG9ySW1wdWxzZSAtIG9sZE1vdG9ySW1wdWxzZTtcclxuICAgICAgICBydm4gLT0gbmV3TW90b3JJbXB1bHNlICogdGhpcy5tb3RvckRlbm9tO1xyXG4gICAgICB9IGVsc2UgbmV3TW90b3JJbXB1bHNlID0gMDtcclxuXHJcbiAgICAgIC8vIGxpbWl0IHBhcnRcclxuICAgICAgdmFyIG5ld0xpbWl0SW1wdWxzZTtcclxuICAgICAgaWYgKHRoaXMubGltaXRTdGF0ZSAhPSAyKSB7XHJcbiAgICAgICAgbmV3TGltaXRJbXB1bHNlID0gKHJ2biAtIHRoaXMubGltaXRWZWxvY2l0eSAtIHRoaXMubGltaXRJbXB1bHNlICogdGhpcy5jZm0pICogdGhpcy5pbnZEZW5vbTtcclxuICAgICAgICB2YXIgb2xkTGltaXRJbXB1bHNlID0gdGhpcy5saW1pdEltcHVsc2U7XHJcbiAgICAgICAgdGhpcy5saW1pdEltcHVsc2UgKz0gbmV3TGltaXRJbXB1bHNlO1xyXG4gICAgICAgIGlmICh0aGlzLmxpbWl0SW1wdWxzZSAqIHRoaXMubGltaXRTdGF0ZSA8IDApIHRoaXMubGltaXRJbXB1bHNlID0gMDtcclxuICAgICAgICBuZXdMaW1pdEltcHVsc2UgPSB0aGlzLmxpbWl0SW1wdWxzZSAtIG9sZExpbWl0SW1wdWxzZTtcclxuICAgICAgfSBlbHNlIG5ld0xpbWl0SW1wdWxzZSA9IDA7XHJcblxyXG4gICAgICB2YXIgdG90YWxJbXB1bHNlID0gbmV3TGltaXRJbXB1bHNlICsgbmV3TW90b3JJbXB1bHNlO1xyXG4gICAgICB0aGlzLmwxLnggKz0gdG90YWxJbXB1bHNlICogdGhpcy5sMXg7XHJcbiAgICAgIHRoaXMubDEueSArPSB0b3RhbEltcHVsc2UgKiB0aGlzLmwxeTtcclxuICAgICAgdGhpcy5sMS56ICs9IHRvdGFsSW1wdWxzZSAqIHRoaXMubDF6O1xyXG4gICAgICB0aGlzLmExLnggKz0gdG90YWxJbXB1bHNlICogdGhpcy5hMXg7XHJcbiAgICAgIHRoaXMuYTEueSArPSB0b3RhbEltcHVsc2UgKiB0aGlzLmExeTtcclxuICAgICAgdGhpcy5hMS56ICs9IHRvdGFsSW1wdWxzZSAqIHRoaXMuYTF6O1xyXG4gICAgICB0aGlzLmwyLnggLT0gdG90YWxJbXB1bHNlICogdGhpcy5sMng7XHJcbiAgICAgIHRoaXMubDIueSAtPSB0b3RhbEltcHVsc2UgKiB0aGlzLmwyeTtcclxuICAgICAgdGhpcy5sMi56IC09IHRvdGFsSW1wdWxzZSAqIHRoaXMubDJ6O1xyXG4gICAgICB0aGlzLmEyLnggLT0gdG90YWxJbXB1bHNlICogdGhpcy5hMng7XHJcbiAgICAgIHRoaXMuYTIueSAtPSB0b3RhbEltcHVsc2UgKiB0aGlzLmEyeTtcclxuICAgICAgdGhpcy5hMi56IC09IHRvdGFsSW1wdWxzZSAqIHRoaXMuYTJ6O1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAvKipcclxuICAgKiBBIGRpc3RhbmNlIGpvaW50IGxpbWl0cyB0aGUgZGlzdGFuY2UgYmV0d2VlbiB0d28gYW5jaG9yIHBvaW50cyBvbiByaWdpZCBib2RpZXMuXHJcbiAgICpcclxuICAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAgKiBAYXV0aG9yIGxvLXRoXHJcbiAgICovXHJcblxyXG4gIGZ1bmN0aW9uIERpc3RhbmNlSm9pbnQoY29uZmlnLCBtaW5EaXN0YW5jZSwgbWF4RGlzdGFuY2UpIHtcclxuXHJcbiAgICBKb2ludC5jYWxsKHRoaXMsIGNvbmZpZyk7XHJcblxyXG4gICAgdGhpcy50eXBlID0gSk9JTlRfRElTVEFOQ0U7XHJcblxyXG4gICAgdGhpcy5ub3IgPSBuZXcgVmVjMygpO1xyXG5cclxuICAgIC8vIFRoZSBsaW1pdCBhbmQgbW90b3IgaW5mb3JtYXRpb24gb2YgdGhlIGpvaW50LlxyXG4gICAgdGhpcy5saW1pdE1vdG9yID0gbmV3IExpbWl0TW90b3IodGhpcy5ub3IsIHRydWUpO1xyXG4gICAgdGhpcy5saW1pdE1vdG9yLmxvd2VyTGltaXQgPSBtaW5EaXN0YW5jZTtcclxuICAgIHRoaXMubGltaXRNb3Rvci51cHBlckxpbWl0ID0gbWF4RGlzdGFuY2U7XHJcblxyXG4gICAgdGhpcy50ID0gbmV3IFRyYW5zbGF0aW9uYWxDb25zdHJhaW50KHRoaXMsIHRoaXMubGltaXRNb3Rvcik7XHJcblxyXG4gIH1cclxuICBEaXN0YW5jZUpvaW50LnByb3RvdHlwZSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShKb2ludC5wcm90b3R5cGUpLCB7XHJcblxyXG4gICAgY29uc3RydWN0b3I6IERpc3RhbmNlSm9pbnQsXHJcblxyXG4gICAgcHJlU29sdmU6IGZ1bmN0aW9uICh0aW1lU3RlcCwgaW52VGltZVN0ZXApIHtcclxuXHJcbiAgICAgIHRoaXMudXBkYXRlQW5jaG9yUG9pbnRzKCk7XHJcblxyXG4gICAgICB0aGlzLm5vci5zdWIodGhpcy5hbmNob3JQb2ludDIsIHRoaXMuYW5jaG9yUG9pbnQxKS5ub3JtYWxpemUoKTtcclxuXHJcbiAgICAgIC8vIHByZVNvbHZlXHJcblxyXG4gICAgICB0aGlzLnQucHJlU29sdmUodGltZVN0ZXAsIGludlRpbWVTdGVwKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNvbHZlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB0aGlzLnQuc29sdmUoKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHBvc3RTb2x2ZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIC8qKlxyXG4gICogQW4gYW5ndWxhciBjb25zdHJhaW50IGZvciBhbGwgYXhlcyBmb3IgdmFyaW91cyBqb2ludHMuXHJcbiAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAqL1xyXG5cclxuICBmdW5jdGlvbiBBbmd1bGFyQ29uc3RyYWludChqb2ludCwgdGFyZ2V0T3JpZW50YXRpb24pIHtcclxuXHJcbiAgICB0aGlzLmpvaW50ID0gam9pbnQ7XHJcblxyXG4gICAgdGhpcy50YXJnZXRPcmllbnRhdGlvbiA9IG5ldyBRdWF0KCkuaW52ZXJ0KHRhcmdldE9yaWVudGF0aW9uKTtcclxuXHJcbiAgICB0aGlzLnJlbGF0aXZlT3JpZW50YXRpb24gPSBuZXcgUXVhdCgpO1xyXG5cclxuICAgIHRoaXMuaWkxID0gbnVsbDtcclxuICAgIHRoaXMuaWkyID0gbnVsbDtcclxuICAgIHRoaXMuZGQgPSBudWxsO1xyXG5cclxuICAgIHRoaXMudmVsID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMuaW1wID0gbmV3IFZlYzMoKTtcclxuXHJcbiAgICB0aGlzLnJuMCA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLnJuMSA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLnJuMiA9IG5ldyBWZWMzKCk7XHJcblxyXG4gICAgdGhpcy5iMSA9IGpvaW50LmJvZHkxO1xyXG4gICAgdGhpcy5iMiA9IGpvaW50LmJvZHkyO1xyXG4gICAgdGhpcy5hMSA9IHRoaXMuYjEuYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgdGhpcy5hMiA9IHRoaXMuYjIuYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgdGhpcy5pMSA9IHRoaXMuYjEuaW52ZXJzZUluZXJ0aWE7XHJcbiAgICB0aGlzLmkyID0gdGhpcy5iMi5pbnZlcnNlSW5lcnRpYTtcclxuXHJcbiAgfVxyXG4gIE9iamVjdC5hc3NpZ24oQW5ndWxhckNvbnN0cmFpbnQucHJvdG90eXBlLCB7XHJcblxyXG4gICAgQW5ndWxhckNvbnN0cmFpbnQ6IHRydWUsXHJcblxyXG4gICAgcHJlU29sdmU6IGZ1bmN0aW9uICh0aW1lU3RlcCwgaW52VGltZVN0ZXApIHtcclxuXHJcbiAgICAgIHZhciBpbnYsIGxlbiwgdjtcclxuXHJcbiAgICAgIHRoaXMuaWkxID0gdGhpcy5pMS5jbG9uZSgpO1xyXG4gICAgICB0aGlzLmlpMiA9IHRoaXMuaTIuY2xvbmUoKTtcclxuXHJcbiAgICAgIHYgPSBuZXcgTWF0MzMoKS5hZGQodGhpcy5paTEsIHRoaXMuaWkyKS5lbGVtZW50cztcclxuICAgICAgaW52ID0gMSAvICh2WzBdICogKHZbNF0gKiB2WzhdIC0gdls3XSAqIHZbNV0pICsgdlszXSAqICh2WzddICogdlsyXSAtIHZbMV0gKiB2WzhdKSArIHZbNl0gKiAodlsxXSAqIHZbNV0gLSB2WzRdICogdlsyXSkpO1xyXG4gICAgICB0aGlzLmRkID0gbmV3IE1hdDMzKCkuc2V0KFxyXG4gICAgICAgIHZbNF0gKiB2WzhdIC0gdls1XSAqIHZbN10sIHZbMl0gKiB2WzddIC0gdlsxXSAqIHZbOF0sIHZbMV0gKiB2WzVdIC0gdlsyXSAqIHZbNF0sXHJcbiAgICAgICAgdls1XSAqIHZbNl0gLSB2WzNdICogdls4XSwgdlswXSAqIHZbOF0gLSB2WzJdICogdls2XSwgdlsyXSAqIHZbM10gLSB2WzBdICogdls1XSxcclxuICAgICAgICB2WzNdICogdls3XSAtIHZbNF0gKiB2WzZdLCB2WzFdICogdls2XSAtIHZbMF0gKiB2WzddLCB2WzBdICogdls0XSAtIHZbMV0gKiB2WzNdXHJcbiAgICAgICkubXVsdGlwbHlTY2FsYXIoaW52KTtcclxuXHJcbiAgICAgIHRoaXMucmVsYXRpdmVPcmllbnRhdGlvbi5pbnZlcnQodGhpcy5iMS5vcmllbnRhdGlvbikubXVsdGlwbHkodGhpcy50YXJnZXRPcmllbnRhdGlvbikubXVsdGlwbHkodGhpcy5iMi5vcmllbnRhdGlvbik7XHJcblxyXG4gICAgICBpbnYgPSB0aGlzLnJlbGF0aXZlT3JpZW50YXRpb24udyAqIDI7XHJcblxyXG4gICAgICB0aGlzLnZlbC5jb3B5KHRoaXMucmVsYXRpdmVPcmllbnRhdGlvbikubXVsdGlwbHlTY2FsYXIoaW52KTtcclxuXHJcbiAgICAgIGxlbiA9IHRoaXMudmVsLmxlbmd0aCgpO1xyXG5cclxuICAgICAgaWYgKGxlbiA+IDAuMDIpIHtcclxuICAgICAgICBsZW4gPSAoMC4wMiAtIGxlbikgLyBsZW4gKiBpbnZUaW1lU3RlcCAqIDAuMDU7XHJcbiAgICAgICAgdGhpcy52ZWwubXVsdGlwbHlTY2FsYXIobGVuKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLnZlbC5zZXQoMCwgMCwgMCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMucm4xLmNvcHkodGhpcy5pbXApLmFwcGx5TWF0cml4Myh0aGlzLmlpMSwgdHJ1ZSk7XHJcbiAgICAgIHRoaXMucm4yLmNvcHkodGhpcy5pbXApLmFwcGx5TWF0cml4Myh0aGlzLmlpMiwgdHJ1ZSk7XHJcblxyXG4gICAgICB0aGlzLmExLmFkZCh0aGlzLnJuMSk7XHJcbiAgICAgIHRoaXMuYTIuc3ViKHRoaXMucm4yKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNvbHZlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB2YXIgciA9IHRoaXMuYTIuY2xvbmUoKS5zdWIodGhpcy5hMSkuc3ViKHRoaXMudmVsKTtcclxuXHJcbiAgICAgIHRoaXMucm4wLmNvcHkocikuYXBwbHlNYXRyaXgzKHRoaXMuZGQsIHRydWUpO1xyXG4gICAgICB0aGlzLnJuMS5jb3B5KHRoaXMucm4wKS5hcHBseU1hdHJpeDModGhpcy5paTEsIHRydWUpO1xyXG4gICAgICB0aGlzLnJuMi5jb3B5KHRoaXMucm4wKS5hcHBseU1hdHJpeDModGhpcy5paTIsIHRydWUpO1xyXG5cclxuICAgICAgdGhpcy5pbXAuYWRkKHRoaXMucm4wKTtcclxuICAgICAgdGhpcy5hMS5hZGQodGhpcy5ybjEpO1xyXG4gICAgICB0aGlzLmEyLnN1Yih0aGlzLnJuMik7XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgKiBBIHRocmVlLWF4aXMgdHJhbnNsYXRpb25hbCBjb25zdHJhaW50IGZvciB2YXJpb3VzIGpvaW50cy5cclxuICAqIEBhdXRob3Igc2FoYXJhblxyXG4gICovXHJcbiAgZnVuY3Rpb24gVHJhbnNsYXRpb25hbDNDb25zdHJhaW50KGpvaW50LCBsaW1pdE1vdG9yMSwgbGltaXRNb3RvcjIsIGxpbWl0TW90b3IzKSB7XHJcblxyXG4gICAgdGhpcy5tMSA9IE5hTjtcclxuICAgIHRoaXMubTIgPSBOYU47XHJcbiAgICB0aGlzLmkxZTAwID0gTmFOO1xyXG4gICAgdGhpcy5pMWUwMSA9IE5hTjtcclxuICAgIHRoaXMuaTFlMDIgPSBOYU47XHJcbiAgICB0aGlzLmkxZTEwID0gTmFOO1xyXG4gICAgdGhpcy5pMWUxMSA9IE5hTjtcclxuICAgIHRoaXMuaTFlMTIgPSBOYU47XHJcbiAgICB0aGlzLmkxZTIwID0gTmFOO1xyXG4gICAgdGhpcy5pMWUyMSA9IE5hTjtcclxuICAgIHRoaXMuaTFlMjIgPSBOYU47XHJcbiAgICB0aGlzLmkyZTAwID0gTmFOO1xyXG4gICAgdGhpcy5pMmUwMSA9IE5hTjtcclxuICAgIHRoaXMuaTJlMDIgPSBOYU47XHJcbiAgICB0aGlzLmkyZTEwID0gTmFOO1xyXG4gICAgdGhpcy5pMmUxMSA9IE5hTjtcclxuICAgIHRoaXMuaTJlMTIgPSBOYU47XHJcbiAgICB0aGlzLmkyZTIwID0gTmFOO1xyXG4gICAgdGhpcy5pMmUyMSA9IE5hTjtcclxuICAgIHRoaXMuaTJlMjIgPSBOYU47XHJcbiAgICB0aGlzLmF4MSA9IE5hTjtcclxuICAgIHRoaXMuYXkxID0gTmFOO1xyXG4gICAgdGhpcy5hejEgPSBOYU47XHJcbiAgICB0aGlzLmF4MiA9IE5hTjtcclxuICAgIHRoaXMuYXkyID0gTmFOO1xyXG4gICAgdGhpcy5hejIgPSBOYU47XHJcbiAgICB0aGlzLmF4MyA9IE5hTjtcclxuICAgIHRoaXMuYXkzID0gTmFOO1xyXG4gICAgdGhpcy5hejMgPSBOYU47XHJcbiAgICB0aGlzLnIxeCA9IE5hTjtcclxuICAgIHRoaXMucjF5ID0gTmFOO1xyXG4gICAgdGhpcy5yMXogPSBOYU47XHJcbiAgICB0aGlzLnIyeCA9IE5hTjtcclxuICAgIHRoaXMucjJ5ID0gTmFOO1xyXG4gICAgdGhpcy5yMnogPSBOYU47XHJcbiAgICB0aGlzLnQxeDEgPSBOYU47Ly8gamFjb2JpYW5zXHJcbiAgICB0aGlzLnQxeTEgPSBOYU47XHJcbiAgICB0aGlzLnQxejEgPSBOYU47XHJcbiAgICB0aGlzLnQyeDEgPSBOYU47XHJcbiAgICB0aGlzLnQyeTEgPSBOYU47XHJcbiAgICB0aGlzLnQyejEgPSBOYU47XHJcbiAgICB0aGlzLmwxeDEgPSBOYU47XHJcbiAgICB0aGlzLmwxeTEgPSBOYU47XHJcbiAgICB0aGlzLmwxejEgPSBOYU47XHJcbiAgICB0aGlzLmwyeDEgPSBOYU47XHJcbiAgICB0aGlzLmwyeTEgPSBOYU47XHJcbiAgICB0aGlzLmwyejEgPSBOYU47XHJcbiAgICB0aGlzLmExeDEgPSBOYU47XHJcbiAgICB0aGlzLmExeTEgPSBOYU47XHJcbiAgICB0aGlzLmExejEgPSBOYU47XHJcbiAgICB0aGlzLmEyeDEgPSBOYU47XHJcbiAgICB0aGlzLmEyeTEgPSBOYU47XHJcbiAgICB0aGlzLmEyejEgPSBOYU47XHJcbiAgICB0aGlzLnQxeDIgPSBOYU47XHJcbiAgICB0aGlzLnQxeTIgPSBOYU47XHJcbiAgICB0aGlzLnQxejIgPSBOYU47XHJcbiAgICB0aGlzLnQyeDIgPSBOYU47XHJcbiAgICB0aGlzLnQyeTIgPSBOYU47XHJcbiAgICB0aGlzLnQyejIgPSBOYU47XHJcbiAgICB0aGlzLmwxeDIgPSBOYU47XHJcbiAgICB0aGlzLmwxeTIgPSBOYU47XHJcbiAgICB0aGlzLmwxejIgPSBOYU47XHJcbiAgICB0aGlzLmwyeDIgPSBOYU47XHJcbiAgICB0aGlzLmwyeTIgPSBOYU47XHJcbiAgICB0aGlzLmwyejIgPSBOYU47XHJcbiAgICB0aGlzLmExeDIgPSBOYU47XHJcbiAgICB0aGlzLmExeTIgPSBOYU47XHJcbiAgICB0aGlzLmExejIgPSBOYU47XHJcbiAgICB0aGlzLmEyeDIgPSBOYU47XHJcbiAgICB0aGlzLmEyeTIgPSBOYU47XHJcbiAgICB0aGlzLmEyejIgPSBOYU47XHJcbiAgICB0aGlzLnQxeDMgPSBOYU47XHJcbiAgICB0aGlzLnQxeTMgPSBOYU47XHJcbiAgICB0aGlzLnQxejMgPSBOYU47XHJcbiAgICB0aGlzLnQyeDMgPSBOYU47XHJcbiAgICB0aGlzLnQyeTMgPSBOYU47XHJcbiAgICB0aGlzLnQyejMgPSBOYU47XHJcbiAgICB0aGlzLmwxeDMgPSBOYU47XHJcbiAgICB0aGlzLmwxeTMgPSBOYU47XHJcbiAgICB0aGlzLmwxejMgPSBOYU47XHJcbiAgICB0aGlzLmwyeDMgPSBOYU47XHJcbiAgICB0aGlzLmwyeTMgPSBOYU47XHJcbiAgICB0aGlzLmwyejMgPSBOYU47XHJcbiAgICB0aGlzLmExeDMgPSBOYU47XHJcbiAgICB0aGlzLmExeTMgPSBOYU47XHJcbiAgICB0aGlzLmExejMgPSBOYU47XHJcbiAgICB0aGlzLmEyeDMgPSBOYU47XHJcbiAgICB0aGlzLmEyeTMgPSBOYU47XHJcbiAgICB0aGlzLmEyejMgPSBOYU47XHJcbiAgICB0aGlzLmxvd2VyTGltaXQxID0gTmFOO1xyXG4gICAgdGhpcy51cHBlckxpbWl0MSA9IE5hTjtcclxuICAgIHRoaXMubGltaXRWZWxvY2l0eTEgPSBOYU47XHJcbiAgICB0aGlzLmxpbWl0U3RhdGUxID0gMDsgLy8gLTE6IGF0IGxvd2VyLCAwOiBsb2NrZWQsIDE6IGF0IHVwcGVyLCAyOiB1bmxpbWl0ZWRcclxuICAgIHRoaXMuZW5hYmxlTW90b3IxID0gZmFsc2U7XHJcbiAgICB0aGlzLm1vdG9yU3BlZWQxID0gTmFOO1xyXG4gICAgdGhpcy5tYXhNb3RvckZvcmNlMSA9IE5hTjtcclxuICAgIHRoaXMubWF4TW90b3JJbXB1bHNlMSA9IE5hTjtcclxuICAgIHRoaXMubG93ZXJMaW1pdDIgPSBOYU47XHJcbiAgICB0aGlzLnVwcGVyTGltaXQyID0gTmFOO1xyXG4gICAgdGhpcy5saW1pdFZlbG9jaXR5MiA9IE5hTjtcclxuICAgIHRoaXMubGltaXRTdGF0ZTIgPSAwOyAvLyAtMTogYXQgbG93ZXIsIDA6IGxvY2tlZCwgMTogYXQgdXBwZXIsIDI6IHVubGltaXRlZFxyXG4gICAgdGhpcy5lbmFibGVNb3RvcjIgPSBmYWxzZTtcclxuICAgIHRoaXMubW90b3JTcGVlZDIgPSBOYU47XHJcbiAgICB0aGlzLm1heE1vdG9yRm9yY2UyID0gTmFOO1xyXG4gICAgdGhpcy5tYXhNb3RvckltcHVsc2UyID0gTmFOO1xyXG4gICAgdGhpcy5sb3dlckxpbWl0MyA9IE5hTjtcclxuICAgIHRoaXMudXBwZXJMaW1pdDMgPSBOYU47XHJcbiAgICB0aGlzLmxpbWl0VmVsb2NpdHkzID0gTmFOO1xyXG4gICAgdGhpcy5saW1pdFN0YXRlMyA9IDA7IC8vIC0xOiBhdCBsb3dlciwgMDogbG9ja2VkLCAxOiBhdCB1cHBlciwgMjogdW5saW1pdGVkXHJcbiAgICB0aGlzLmVuYWJsZU1vdG9yMyA9IGZhbHNlO1xyXG4gICAgdGhpcy5tb3RvclNwZWVkMyA9IE5hTjtcclxuICAgIHRoaXMubWF4TW90b3JGb3JjZTMgPSBOYU47XHJcbiAgICB0aGlzLm1heE1vdG9ySW1wdWxzZTMgPSBOYU47XHJcbiAgICB0aGlzLmswMCA9IE5hTjsgLy8gSyA9IEoqTSpKVFxyXG4gICAgdGhpcy5rMDEgPSBOYU47XHJcbiAgICB0aGlzLmswMiA9IE5hTjtcclxuICAgIHRoaXMuazEwID0gTmFOO1xyXG4gICAgdGhpcy5rMTEgPSBOYU47XHJcbiAgICB0aGlzLmsxMiA9IE5hTjtcclxuICAgIHRoaXMuazIwID0gTmFOO1xyXG4gICAgdGhpcy5rMjEgPSBOYU47XHJcbiAgICB0aGlzLmsyMiA9IE5hTjtcclxuICAgIHRoaXMua3YwMCA9IE5hTjsgLy8gZGlhZ29uYWxzIHdpdGhvdXQgQ0ZNc1xyXG4gICAgdGhpcy5rdjExID0gTmFOO1xyXG4gICAgdGhpcy5rdjIyID0gTmFOO1xyXG4gICAgdGhpcy5kdjAwID0gTmFOOyAvLyAuLi5pbnZlcnRlZFxyXG4gICAgdGhpcy5kdjExID0gTmFOO1xyXG4gICAgdGhpcy5kdjIyID0gTmFOO1xyXG4gICAgdGhpcy5kMDAgPSBOYU47IC8vIEteLTFcclxuICAgIHRoaXMuZDAxID0gTmFOO1xyXG4gICAgdGhpcy5kMDIgPSBOYU47XHJcbiAgICB0aGlzLmQxMCA9IE5hTjtcclxuICAgIHRoaXMuZDExID0gTmFOO1xyXG4gICAgdGhpcy5kMTIgPSBOYU47XHJcbiAgICB0aGlzLmQyMCA9IE5hTjtcclxuICAgIHRoaXMuZDIxID0gTmFOO1xyXG4gICAgdGhpcy5kMjIgPSBOYU47XHJcblxyXG4gICAgdGhpcy5saW1pdE1vdG9yMSA9IGxpbWl0TW90b3IxO1xyXG4gICAgdGhpcy5saW1pdE1vdG9yMiA9IGxpbWl0TW90b3IyO1xyXG4gICAgdGhpcy5saW1pdE1vdG9yMyA9IGxpbWl0TW90b3IzO1xyXG4gICAgdGhpcy5iMSA9IGpvaW50LmJvZHkxO1xyXG4gICAgdGhpcy5iMiA9IGpvaW50LmJvZHkyO1xyXG4gICAgdGhpcy5wMSA9IGpvaW50LmFuY2hvclBvaW50MTtcclxuICAgIHRoaXMucDIgPSBqb2ludC5hbmNob3JQb2ludDI7XHJcbiAgICB0aGlzLnIxID0gam9pbnQucmVsYXRpdmVBbmNob3JQb2ludDE7XHJcbiAgICB0aGlzLnIyID0gam9pbnQucmVsYXRpdmVBbmNob3JQb2ludDI7XHJcbiAgICB0aGlzLmwxID0gdGhpcy5iMS5saW5lYXJWZWxvY2l0eTtcclxuICAgIHRoaXMubDIgPSB0aGlzLmIyLmxpbmVhclZlbG9jaXR5O1xyXG4gICAgdGhpcy5hMSA9IHRoaXMuYjEuYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgdGhpcy5hMiA9IHRoaXMuYjIuYW5ndWxhclZlbG9jaXR5O1xyXG4gICAgdGhpcy5pMSA9IHRoaXMuYjEuaW52ZXJzZUluZXJ0aWE7XHJcbiAgICB0aGlzLmkyID0gdGhpcy5iMi5pbnZlcnNlSW5lcnRpYTtcclxuICAgIHRoaXMubGltaXRJbXB1bHNlMSA9IDA7XHJcbiAgICB0aGlzLm1vdG9ySW1wdWxzZTEgPSAwO1xyXG4gICAgdGhpcy5saW1pdEltcHVsc2UyID0gMDtcclxuICAgIHRoaXMubW90b3JJbXB1bHNlMiA9IDA7XHJcbiAgICB0aGlzLmxpbWl0SW1wdWxzZTMgPSAwO1xyXG4gICAgdGhpcy5tb3RvckltcHVsc2UzID0gMDtcclxuICAgIHRoaXMuY2ZtMSA9IDA7Ly8gQ29uc3RyYWludCBGb3JjZSBNaXhpbmdcclxuICAgIHRoaXMuY2ZtMiA9IDA7XHJcbiAgICB0aGlzLmNmbTMgPSAwO1xyXG4gICAgdGhpcy53ZWlnaHQgPSAtMTtcclxuICB9XHJcblxyXG4gIE9iamVjdC5hc3NpZ24oVHJhbnNsYXRpb25hbDNDb25zdHJhaW50LnByb3RvdHlwZSwge1xyXG5cclxuICAgIFRyYW5zbGF0aW9uYWwzQ29uc3RyYWludDogdHJ1ZSxcclxuXHJcbiAgICBwcmVTb2x2ZTogZnVuY3Rpb24gKHRpbWVTdGVwLCBpbnZUaW1lU3RlcCkge1xyXG4gICAgICB0aGlzLmF4MSA9IHRoaXMubGltaXRNb3RvcjEuYXhpcy54O1xyXG4gICAgICB0aGlzLmF5MSA9IHRoaXMubGltaXRNb3RvcjEuYXhpcy55O1xyXG4gICAgICB0aGlzLmF6MSA9IHRoaXMubGltaXRNb3RvcjEuYXhpcy56O1xyXG4gICAgICB0aGlzLmF4MiA9IHRoaXMubGltaXRNb3RvcjIuYXhpcy54O1xyXG4gICAgICB0aGlzLmF5MiA9IHRoaXMubGltaXRNb3RvcjIuYXhpcy55O1xyXG4gICAgICB0aGlzLmF6MiA9IHRoaXMubGltaXRNb3RvcjIuYXhpcy56O1xyXG4gICAgICB0aGlzLmF4MyA9IHRoaXMubGltaXRNb3RvcjMuYXhpcy54O1xyXG4gICAgICB0aGlzLmF5MyA9IHRoaXMubGltaXRNb3RvcjMuYXhpcy55O1xyXG4gICAgICB0aGlzLmF6MyA9IHRoaXMubGltaXRNb3RvcjMuYXhpcy56O1xyXG4gICAgICB0aGlzLmxvd2VyTGltaXQxID0gdGhpcy5saW1pdE1vdG9yMS5sb3dlckxpbWl0O1xyXG4gICAgICB0aGlzLnVwcGVyTGltaXQxID0gdGhpcy5saW1pdE1vdG9yMS51cHBlckxpbWl0O1xyXG4gICAgICB0aGlzLm1vdG9yU3BlZWQxID0gdGhpcy5saW1pdE1vdG9yMS5tb3RvclNwZWVkO1xyXG4gICAgICB0aGlzLm1heE1vdG9yRm9yY2UxID0gdGhpcy5saW1pdE1vdG9yMS5tYXhNb3RvckZvcmNlO1xyXG4gICAgICB0aGlzLmVuYWJsZU1vdG9yMSA9IHRoaXMubWF4TW90b3JGb3JjZTEgPiAwO1xyXG4gICAgICB0aGlzLmxvd2VyTGltaXQyID0gdGhpcy5saW1pdE1vdG9yMi5sb3dlckxpbWl0O1xyXG4gICAgICB0aGlzLnVwcGVyTGltaXQyID0gdGhpcy5saW1pdE1vdG9yMi51cHBlckxpbWl0O1xyXG4gICAgICB0aGlzLm1vdG9yU3BlZWQyID0gdGhpcy5saW1pdE1vdG9yMi5tb3RvclNwZWVkO1xyXG4gICAgICB0aGlzLm1heE1vdG9yRm9yY2UyID0gdGhpcy5saW1pdE1vdG9yMi5tYXhNb3RvckZvcmNlO1xyXG4gICAgICB0aGlzLmVuYWJsZU1vdG9yMiA9IHRoaXMubWF4TW90b3JGb3JjZTIgPiAwO1xyXG4gICAgICB0aGlzLmxvd2VyTGltaXQzID0gdGhpcy5saW1pdE1vdG9yMy5sb3dlckxpbWl0O1xyXG4gICAgICB0aGlzLnVwcGVyTGltaXQzID0gdGhpcy5saW1pdE1vdG9yMy51cHBlckxpbWl0O1xyXG4gICAgICB0aGlzLm1vdG9yU3BlZWQzID0gdGhpcy5saW1pdE1vdG9yMy5tb3RvclNwZWVkO1xyXG4gICAgICB0aGlzLm1heE1vdG9yRm9yY2UzID0gdGhpcy5saW1pdE1vdG9yMy5tYXhNb3RvckZvcmNlO1xyXG4gICAgICB0aGlzLmVuYWJsZU1vdG9yMyA9IHRoaXMubWF4TW90b3JGb3JjZTMgPiAwO1xyXG4gICAgICB0aGlzLm0xID0gdGhpcy5iMS5pbnZlcnNlTWFzcztcclxuICAgICAgdGhpcy5tMiA9IHRoaXMuYjIuaW52ZXJzZU1hc3M7XHJcblxyXG4gICAgICB2YXIgdGkxID0gdGhpcy5pMS5lbGVtZW50cztcclxuICAgICAgdmFyIHRpMiA9IHRoaXMuaTIuZWxlbWVudHM7XHJcbiAgICAgIHRoaXMuaTFlMDAgPSB0aTFbMF07XHJcbiAgICAgIHRoaXMuaTFlMDEgPSB0aTFbMV07XHJcbiAgICAgIHRoaXMuaTFlMDIgPSB0aTFbMl07XHJcbiAgICAgIHRoaXMuaTFlMTAgPSB0aTFbM107XHJcbiAgICAgIHRoaXMuaTFlMTEgPSB0aTFbNF07XHJcbiAgICAgIHRoaXMuaTFlMTIgPSB0aTFbNV07XHJcbiAgICAgIHRoaXMuaTFlMjAgPSB0aTFbNl07XHJcbiAgICAgIHRoaXMuaTFlMjEgPSB0aTFbN107XHJcbiAgICAgIHRoaXMuaTFlMjIgPSB0aTFbOF07XHJcblxyXG4gICAgICB0aGlzLmkyZTAwID0gdGkyWzBdO1xyXG4gICAgICB0aGlzLmkyZTAxID0gdGkyWzFdO1xyXG4gICAgICB0aGlzLmkyZTAyID0gdGkyWzJdO1xyXG4gICAgICB0aGlzLmkyZTEwID0gdGkyWzNdO1xyXG4gICAgICB0aGlzLmkyZTExID0gdGkyWzRdO1xyXG4gICAgICB0aGlzLmkyZTEyID0gdGkyWzVdO1xyXG4gICAgICB0aGlzLmkyZTIwID0gdGkyWzZdO1xyXG4gICAgICB0aGlzLmkyZTIxID0gdGkyWzddO1xyXG4gICAgICB0aGlzLmkyZTIyID0gdGkyWzhdO1xyXG5cclxuICAgICAgdmFyIGR4ID0gdGhpcy5wMi54IC0gdGhpcy5wMS54O1xyXG4gICAgICB2YXIgZHkgPSB0aGlzLnAyLnkgLSB0aGlzLnAxLnk7XHJcbiAgICAgIHZhciBkeiA9IHRoaXMucDIueiAtIHRoaXMucDEuejtcclxuICAgICAgdmFyIGQxID0gZHggKiB0aGlzLmF4MSArIGR5ICogdGhpcy5heTEgKyBkeiAqIHRoaXMuYXoxO1xyXG4gICAgICB2YXIgZDIgPSBkeCAqIHRoaXMuYXgyICsgZHkgKiB0aGlzLmF5MiArIGR6ICogdGhpcy5hejI7XHJcbiAgICAgIHZhciBkMyA9IGR4ICogdGhpcy5heDMgKyBkeSAqIHRoaXMuYXkzICsgZHogKiB0aGlzLmF6MztcclxuICAgICAgdmFyIGZyZXF1ZW5jeTEgPSB0aGlzLmxpbWl0TW90b3IxLmZyZXF1ZW5jeTtcclxuICAgICAgdmFyIGZyZXF1ZW5jeTIgPSB0aGlzLmxpbWl0TW90b3IyLmZyZXF1ZW5jeTtcclxuICAgICAgdmFyIGZyZXF1ZW5jeTMgPSB0aGlzLmxpbWl0TW90b3IzLmZyZXF1ZW5jeTtcclxuICAgICAgdmFyIGVuYWJsZVNwcmluZzEgPSBmcmVxdWVuY3kxID4gMDtcclxuICAgICAgdmFyIGVuYWJsZVNwcmluZzIgPSBmcmVxdWVuY3kyID4gMDtcclxuICAgICAgdmFyIGVuYWJsZVNwcmluZzMgPSBmcmVxdWVuY3kzID4gMDtcclxuICAgICAgdmFyIGVuYWJsZUxpbWl0MSA9IHRoaXMubG93ZXJMaW1pdDEgPD0gdGhpcy51cHBlckxpbWl0MTtcclxuICAgICAgdmFyIGVuYWJsZUxpbWl0MiA9IHRoaXMubG93ZXJMaW1pdDIgPD0gdGhpcy51cHBlckxpbWl0MjtcclxuICAgICAgdmFyIGVuYWJsZUxpbWl0MyA9IHRoaXMubG93ZXJMaW1pdDMgPD0gdGhpcy51cHBlckxpbWl0MztcclxuXHJcbiAgICAgIC8vIGZvciBzdGFiaWxpdHlcclxuICAgICAgaWYgKGVuYWJsZVNwcmluZzEgJiYgZDEgPiAyMCB8fCBkMSA8IC0yMCkge1xyXG4gICAgICAgIGVuYWJsZVNwcmluZzEgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZW5hYmxlU3ByaW5nMiAmJiBkMiA+IDIwIHx8IGQyIDwgLTIwKSB7XHJcbiAgICAgICAgZW5hYmxlU3ByaW5nMiA9IGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChlbmFibGVTcHJpbmczICYmIGQzID4gMjAgfHwgZDMgPCAtMjApIHtcclxuICAgICAgICBlbmFibGVTcHJpbmczID0gZmFsc2U7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChlbmFibGVMaW1pdDEpIHtcclxuICAgICAgICBpZiAodGhpcy5sb3dlckxpbWl0MSA9PSB0aGlzLnVwcGVyTGltaXQxKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5saW1pdFN0YXRlMSAhPSAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGltaXRTdGF0ZTEgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0SW1wdWxzZTEgPSAwO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5saW1pdFZlbG9jaXR5MSA9IHRoaXMubG93ZXJMaW1pdDEgLSBkMTtcclxuICAgICAgICAgIGlmICghZW5hYmxlU3ByaW5nMSkgZDEgPSB0aGlzLmxvd2VyTGltaXQxO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZDEgPCB0aGlzLmxvd2VyTGltaXQxKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5saW1pdFN0YXRlMSAhPSAtMSkge1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0U3RhdGUxID0gLTE7XHJcbiAgICAgICAgICAgIHRoaXMubGltaXRJbXB1bHNlMSA9IDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLmxpbWl0VmVsb2NpdHkxID0gdGhpcy5sb3dlckxpbWl0MSAtIGQxO1xyXG4gICAgICAgICAgaWYgKCFlbmFibGVTcHJpbmcxKSBkMSA9IHRoaXMubG93ZXJMaW1pdDE7XHJcbiAgICAgICAgfSBlbHNlIGlmIChkMSA+IHRoaXMudXBwZXJMaW1pdDEpIHtcclxuICAgICAgICAgIGlmICh0aGlzLmxpbWl0U3RhdGUxICE9IDEpIHtcclxuICAgICAgICAgICAgdGhpcy5saW1pdFN0YXRlMSA9IDE7XHJcbiAgICAgICAgICAgIHRoaXMubGltaXRJbXB1bHNlMSA9IDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLmxpbWl0VmVsb2NpdHkxID0gdGhpcy51cHBlckxpbWl0MSAtIGQxO1xyXG4gICAgICAgICAgaWYgKCFlbmFibGVTcHJpbmcxKSBkMSA9IHRoaXMudXBwZXJMaW1pdDE7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMubGltaXRTdGF0ZTEgPSAyO1xyXG4gICAgICAgICAgdGhpcy5saW1pdEltcHVsc2UxID0gMDtcclxuICAgICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTEgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWVuYWJsZVNwcmluZzEpIHtcclxuICAgICAgICAgIGlmICh0aGlzLmxpbWl0VmVsb2NpdHkxID4gMC4wMDUpIHRoaXMubGltaXRWZWxvY2l0eTEgLT0gMC4wMDU7XHJcbiAgICAgICAgICBlbHNlIGlmICh0aGlzLmxpbWl0VmVsb2NpdHkxIDwgLTAuMDA1KSB0aGlzLmxpbWl0VmVsb2NpdHkxICs9IDAuMDA1O1xyXG4gICAgICAgICAgZWxzZSB0aGlzLmxpbWl0VmVsb2NpdHkxID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5saW1pdFN0YXRlMSA9IDI7XHJcbiAgICAgICAgdGhpcy5saW1pdEltcHVsc2UxID0gMDtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGVuYWJsZUxpbWl0Mikge1xyXG4gICAgICAgIGlmICh0aGlzLmxvd2VyTGltaXQyID09IHRoaXMudXBwZXJMaW1pdDIpIHtcclxuICAgICAgICAgIGlmICh0aGlzLmxpbWl0U3RhdGUyICE9IDApIHtcclxuICAgICAgICAgICAgdGhpcy5saW1pdFN0YXRlMiA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMubGltaXRJbXB1bHNlMiA9IDA7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLmxpbWl0VmVsb2NpdHkyID0gdGhpcy5sb3dlckxpbWl0MiAtIGQyO1xyXG4gICAgICAgICAgaWYgKCFlbmFibGVTcHJpbmcyKSBkMiA9IHRoaXMubG93ZXJMaW1pdDI7XHJcbiAgICAgICAgfSBlbHNlIGlmIChkMiA8IHRoaXMubG93ZXJMaW1pdDIpIHtcclxuICAgICAgICAgIGlmICh0aGlzLmxpbWl0U3RhdGUyICE9IC0xKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGltaXRTdGF0ZTIgPSAtMTtcclxuICAgICAgICAgICAgdGhpcy5saW1pdEltcHVsc2UyID0gMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTIgPSB0aGlzLmxvd2VyTGltaXQyIC0gZDI7XHJcbiAgICAgICAgICBpZiAoIWVuYWJsZVNwcmluZzIpIGQyID0gdGhpcy5sb3dlckxpbWl0MjtcclxuICAgICAgICB9IGVsc2UgaWYgKGQyID4gdGhpcy51cHBlckxpbWl0Mikge1xyXG4gICAgICAgICAgaWYgKHRoaXMubGltaXRTdGF0ZTIgIT0gMSkge1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0U3RhdGUyID0gMTtcclxuICAgICAgICAgICAgdGhpcy5saW1pdEltcHVsc2UyID0gMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTIgPSB0aGlzLnVwcGVyTGltaXQyIC0gZDI7XHJcbiAgICAgICAgICBpZiAoIWVuYWJsZVNwcmluZzIpIGQyID0gdGhpcy51cHBlckxpbWl0MjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5saW1pdFN0YXRlMiA9IDI7XHJcbiAgICAgICAgICB0aGlzLmxpbWl0SW1wdWxzZTIgPSAwO1xyXG4gICAgICAgICAgdGhpcy5saW1pdFZlbG9jaXR5MiA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZW5hYmxlU3ByaW5nMikge1xyXG4gICAgICAgICAgaWYgKHRoaXMubGltaXRWZWxvY2l0eTIgPiAwLjAwNSkgdGhpcy5saW1pdFZlbG9jaXR5MiAtPSAwLjAwNTtcclxuICAgICAgICAgIGVsc2UgaWYgKHRoaXMubGltaXRWZWxvY2l0eTIgPCAtMC4wMDUpIHRoaXMubGltaXRWZWxvY2l0eTIgKz0gMC4wMDU7XHJcbiAgICAgICAgICBlbHNlIHRoaXMubGltaXRWZWxvY2l0eTIgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmxpbWl0U3RhdGUyID0gMjtcclxuICAgICAgICB0aGlzLmxpbWl0SW1wdWxzZTIgPSAwO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoZW5hYmxlTGltaXQzKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubG93ZXJMaW1pdDMgPT0gdGhpcy51cHBlckxpbWl0Mykge1xyXG4gICAgICAgICAgaWYgKHRoaXMubGltaXRTdGF0ZTMgIT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0U3RhdGUzID0gMDtcclxuICAgICAgICAgICAgdGhpcy5saW1pdEltcHVsc2UzID0gMDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTMgPSB0aGlzLmxvd2VyTGltaXQzIC0gZDM7XHJcbiAgICAgICAgICBpZiAoIWVuYWJsZVNwcmluZzMpIGQzID0gdGhpcy5sb3dlckxpbWl0MztcclxuICAgICAgICB9IGVsc2UgaWYgKGQzIDwgdGhpcy5sb3dlckxpbWl0Mykge1xyXG4gICAgICAgICAgaWYgKHRoaXMubGltaXRTdGF0ZTMgIT0gLTEpIHtcclxuICAgICAgICAgICAgdGhpcy5saW1pdFN0YXRlMyA9IC0xO1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0SW1wdWxzZTMgPSAwO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5saW1pdFZlbG9jaXR5MyA9IHRoaXMubG93ZXJMaW1pdDMgLSBkMztcclxuICAgICAgICAgIGlmICghZW5hYmxlU3ByaW5nMykgZDMgPSB0aGlzLmxvd2VyTGltaXQzO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoZDMgPiB0aGlzLnVwcGVyTGltaXQzKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5saW1pdFN0YXRlMyAhPSAxKSB7XHJcbiAgICAgICAgICAgIHRoaXMubGltaXRTdGF0ZTMgPSAxO1xyXG4gICAgICAgICAgICB0aGlzLmxpbWl0SW1wdWxzZTMgPSAwO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5saW1pdFZlbG9jaXR5MyA9IHRoaXMudXBwZXJMaW1pdDMgLSBkMztcclxuICAgICAgICAgIGlmICghZW5hYmxlU3ByaW5nMykgZDMgPSB0aGlzLnVwcGVyTGltaXQzO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmxpbWl0U3RhdGUzID0gMjtcclxuICAgICAgICAgIHRoaXMubGltaXRJbXB1bHNlMyA9IDA7XHJcbiAgICAgICAgICB0aGlzLmxpbWl0VmVsb2NpdHkzID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFlbmFibGVTcHJpbmczKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5saW1pdFZlbG9jaXR5MyA+IDAuMDA1KSB0aGlzLmxpbWl0VmVsb2NpdHkzIC09IDAuMDA1O1xyXG4gICAgICAgICAgZWxzZSBpZiAodGhpcy5saW1pdFZlbG9jaXR5MyA8IC0wLjAwNSkgdGhpcy5saW1pdFZlbG9jaXR5MyArPSAwLjAwNTtcclxuICAgICAgICAgIGVsc2UgdGhpcy5saW1pdFZlbG9jaXR5MyA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMubGltaXRTdGF0ZTMgPSAyO1xyXG4gICAgICAgIHRoaXMubGltaXRJbXB1bHNlMyA9IDA7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh0aGlzLmVuYWJsZU1vdG9yMSAmJiAodGhpcy5saW1pdFN0YXRlMSAhPSAwIHx8IGVuYWJsZVNwcmluZzEpKSB7XHJcbiAgICAgICAgdGhpcy5tYXhNb3RvckltcHVsc2UxID0gdGhpcy5tYXhNb3RvckZvcmNlMSAqIHRpbWVTdGVwO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMubW90b3JJbXB1bHNlMSA9IDA7XHJcbiAgICAgICAgdGhpcy5tYXhNb3RvckltcHVsc2UxID0gMDtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKHRoaXMuZW5hYmxlTW90b3IyICYmICh0aGlzLmxpbWl0U3RhdGUyICE9IDAgfHwgZW5hYmxlU3ByaW5nMikpIHtcclxuICAgICAgICB0aGlzLm1heE1vdG9ySW1wdWxzZTIgPSB0aGlzLm1heE1vdG9yRm9yY2UyICogdGltZVN0ZXA7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5tb3RvckltcHVsc2UyID0gMDtcclxuICAgICAgICB0aGlzLm1heE1vdG9ySW1wdWxzZTIgPSAwO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAodGhpcy5lbmFibGVNb3RvcjMgJiYgKHRoaXMubGltaXRTdGF0ZTMgIT0gMCB8fCBlbmFibGVTcHJpbmczKSkge1xyXG4gICAgICAgIHRoaXMubWF4TW90b3JJbXB1bHNlMyA9IHRoaXMubWF4TW90b3JGb3JjZTMgKiB0aW1lU3RlcDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLm1vdG9ySW1wdWxzZTMgPSAwO1xyXG4gICAgICAgIHRoaXMubWF4TW90b3JJbXB1bHNlMyA9IDA7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciByZHggPSBkMSAqIHRoaXMuYXgxICsgZDIgKiB0aGlzLmF4MiArIGQzICogdGhpcy5heDI7XHJcbiAgICAgIHZhciByZHkgPSBkMSAqIHRoaXMuYXkxICsgZDIgKiB0aGlzLmF5MiArIGQzICogdGhpcy5heTI7XHJcbiAgICAgIHZhciByZHogPSBkMSAqIHRoaXMuYXoxICsgZDIgKiB0aGlzLmF6MiArIGQzICogdGhpcy5hejI7XHJcbiAgICAgIHZhciB3MSA9IHRoaXMubTIgLyAodGhpcy5tMSArIHRoaXMubTIpO1xyXG4gICAgICBpZiAodGhpcy53ZWlnaHQgPj0gMCkgdzEgPSB0aGlzLndlaWdodDsgLy8gdXNlIGdpdmVuIHdlaWdodFxyXG4gICAgICB2YXIgdzIgPSAxIC0gdzE7XHJcbiAgICAgIHRoaXMucjF4ID0gdGhpcy5yMS54ICsgcmR4ICogdzE7XHJcbiAgICAgIHRoaXMucjF5ID0gdGhpcy5yMS55ICsgcmR5ICogdzE7XHJcbiAgICAgIHRoaXMucjF6ID0gdGhpcy5yMS56ICsgcmR6ICogdzE7XHJcbiAgICAgIHRoaXMucjJ4ID0gdGhpcy5yMi54IC0gcmR4ICogdzI7XHJcbiAgICAgIHRoaXMucjJ5ID0gdGhpcy5yMi55IC0gcmR5ICogdzI7XHJcbiAgICAgIHRoaXMucjJ6ID0gdGhpcy5yMi56IC0gcmR6ICogdzI7XHJcblxyXG4gICAgICAvLyBidWlsZCBqYWNvYmlhbnNcclxuICAgICAgdGhpcy50MXgxID0gdGhpcy5yMXkgKiB0aGlzLmF6MSAtIHRoaXMucjF6ICogdGhpcy5heTE7XHJcbiAgICAgIHRoaXMudDF5MSA9IHRoaXMucjF6ICogdGhpcy5heDEgLSB0aGlzLnIxeCAqIHRoaXMuYXoxO1xyXG4gICAgICB0aGlzLnQxejEgPSB0aGlzLnIxeCAqIHRoaXMuYXkxIC0gdGhpcy5yMXkgKiB0aGlzLmF4MTtcclxuICAgICAgdGhpcy50MngxID0gdGhpcy5yMnkgKiB0aGlzLmF6MSAtIHRoaXMucjJ6ICogdGhpcy5heTE7XHJcbiAgICAgIHRoaXMudDJ5MSA9IHRoaXMucjJ6ICogdGhpcy5heDEgLSB0aGlzLnIyeCAqIHRoaXMuYXoxO1xyXG4gICAgICB0aGlzLnQyejEgPSB0aGlzLnIyeCAqIHRoaXMuYXkxIC0gdGhpcy5yMnkgKiB0aGlzLmF4MTtcclxuICAgICAgdGhpcy5sMXgxID0gdGhpcy5heDEgKiB0aGlzLm0xO1xyXG4gICAgICB0aGlzLmwxeTEgPSB0aGlzLmF5MSAqIHRoaXMubTE7XHJcbiAgICAgIHRoaXMubDF6MSA9IHRoaXMuYXoxICogdGhpcy5tMTtcclxuICAgICAgdGhpcy5sMngxID0gdGhpcy5heDEgKiB0aGlzLm0yO1xyXG4gICAgICB0aGlzLmwyeTEgPSB0aGlzLmF5MSAqIHRoaXMubTI7XHJcbiAgICAgIHRoaXMubDJ6MSA9IHRoaXMuYXoxICogdGhpcy5tMjtcclxuICAgICAgdGhpcy5hMXgxID0gdGhpcy50MXgxICogdGhpcy5pMWUwMCArIHRoaXMudDF5MSAqIHRoaXMuaTFlMDEgKyB0aGlzLnQxejEgKiB0aGlzLmkxZTAyO1xyXG4gICAgICB0aGlzLmExeTEgPSB0aGlzLnQxeDEgKiB0aGlzLmkxZTEwICsgdGhpcy50MXkxICogdGhpcy5pMWUxMSArIHRoaXMudDF6MSAqIHRoaXMuaTFlMTI7XHJcbiAgICAgIHRoaXMuYTF6MSA9IHRoaXMudDF4MSAqIHRoaXMuaTFlMjAgKyB0aGlzLnQxeTEgKiB0aGlzLmkxZTIxICsgdGhpcy50MXoxICogdGhpcy5pMWUyMjtcclxuICAgICAgdGhpcy5hMngxID0gdGhpcy50MngxICogdGhpcy5pMmUwMCArIHRoaXMudDJ5MSAqIHRoaXMuaTJlMDEgKyB0aGlzLnQyejEgKiB0aGlzLmkyZTAyO1xyXG4gICAgICB0aGlzLmEyeTEgPSB0aGlzLnQyeDEgKiB0aGlzLmkyZTEwICsgdGhpcy50MnkxICogdGhpcy5pMmUxMSArIHRoaXMudDJ6MSAqIHRoaXMuaTJlMTI7XHJcbiAgICAgIHRoaXMuYTJ6MSA9IHRoaXMudDJ4MSAqIHRoaXMuaTJlMjAgKyB0aGlzLnQyeTEgKiB0aGlzLmkyZTIxICsgdGhpcy50MnoxICogdGhpcy5pMmUyMjtcclxuXHJcbiAgICAgIHRoaXMudDF4MiA9IHRoaXMucjF5ICogdGhpcy5hejIgLSB0aGlzLnIxeiAqIHRoaXMuYXkyO1xyXG4gICAgICB0aGlzLnQxeTIgPSB0aGlzLnIxeiAqIHRoaXMuYXgyIC0gdGhpcy5yMXggKiB0aGlzLmF6MjtcclxuICAgICAgdGhpcy50MXoyID0gdGhpcy5yMXggKiB0aGlzLmF5MiAtIHRoaXMucjF5ICogdGhpcy5heDI7XHJcbiAgICAgIHRoaXMudDJ4MiA9IHRoaXMucjJ5ICogdGhpcy5hejIgLSB0aGlzLnIyeiAqIHRoaXMuYXkyO1xyXG4gICAgICB0aGlzLnQyeTIgPSB0aGlzLnIyeiAqIHRoaXMuYXgyIC0gdGhpcy5yMnggKiB0aGlzLmF6MjtcclxuICAgICAgdGhpcy50MnoyID0gdGhpcy5yMnggKiB0aGlzLmF5MiAtIHRoaXMucjJ5ICogdGhpcy5heDI7XHJcbiAgICAgIHRoaXMubDF4MiA9IHRoaXMuYXgyICogdGhpcy5tMTtcclxuICAgICAgdGhpcy5sMXkyID0gdGhpcy5heTIgKiB0aGlzLm0xO1xyXG4gICAgICB0aGlzLmwxejIgPSB0aGlzLmF6MiAqIHRoaXMubTE7XHJcbiAgICAgIHRoaXMubDJ4MiA9IHRoaXMuYXgyICogdGhpcy5tMjtcclxuICAgICAgdGhpcy5sMnkyID0gdGhpcy5heTIgKiB0aGlzLm0yO1xyXG4gICAgICB0aGlzLmwyejIgPSB0aGlzLmF6MiAqIHRoaXMubTI7XHJcbiAgICAgIHRoaXMuYTF4MiA9IHRoaXMudDF4MiAqIHRoaXMuaTFlMDAgKyB0aGlzLnQxeTIgKiB0aGlzLmkxZTAxICsgdGhpcy50MXoyICogdGhpcy5pMWUwMjtcclxuICAgICAgdGhpcy5hMXkyID0gdGhpcy50MXgyICogdGhpcy5pMWUxMCArIHRoaXMudDF5MiAqIHRoaXMuaTFlMTEgKyB0aGlzLnQxejIgKiB0aGlzLmkxZTEyO1xyXG4gICAgICB0aGlzLmExejIgPSB0aGlzLnQxeDIgKiB0aGlzLmkxZTIwICsgdGhpcy50MXkyICogdGhpcy5pMWUyMSArIHRoaXMudDF6MiAqIHRoaXMuaTFlMjI7XHJcbiAgICAgIHRoaXMuYTJ4MiA9IHRoaXMudDJ4MiAqIHRoaXMuaTJlMDAgKyB0aGlzLnQyeTIgKiB0aGlzLmkyZTAxICsgdGhpcy50MnoyICogdGhpcy5pMmUwMjtcclxuICAgICAgdGhpcy5hMnkyID0gdGhpcy50MngyICogdGhpcy5pMmUxMCArIHRoaXMudDJ5MiAqIHRoaXMuaTJlMTEgKyB0aGlzLnQyejIgKiB0aGlzLmkyZTEyO1xyXG4gICAgICB0aGlzLmEyejIgPSB0aGlzLnQyeDIgKiB0aGlzLmkyZTIwICsgdGhpcy50MnkyICogdGhpcy5pMmUyMSArIHRoaXMudDJ6MiAqIHRoaXMuaTJlMjI7XHJcblxyXG4gICAgICB0aGlzLnQxeDMgPSB0aGlzLnIxeSAqIHRoaXMuYXozIC0gdGhpcy5yMXogKiB0aGlzLmF5MztcclxuICAgICAgdGhpcy50MXkzID0gdGhpcy5yMXogKiB0aGlzLmF4MyAtIHRoaXMucjF4ICogdGhpcy5hejM7XHJcbiAgICAgIHRoaXMudDF6MyA9IHRoaXMucjF4ICogdGhpcy5heTMgLSB0aGlzLnIxeSAqIHRoaXMuYXgzO1xyXG4gICAgICB0aGlzLnQyeDMgPSB0aGlzLnIyeSAqIHRoaXMuYXozIC0gdGhpcy5yMnogKiB0aGlzLmF5MztcclxuICAgICAgdGhpcy50MnkzID0gdGhpcy5yMnogKiB0aGlzLmF4MyAtIHRoaXMucjJ4ICogdGhpcy5hejM7XHJcbiAgICAgIHRoaXMudDJ6MyA9IHRoaXMucjJ4ICogdGhpcy5heTMgLSB0aGlzLnIyeSAqIHRoaXMuYXgzO1xyXG4gICAgICB0aGlzLmwxeDMgPSB0aGlzLmF4MyAqIHRoaXMubTE7XHJcbiAgICAgIHRoaXMubDF5MyA9IHRoaXMuYXkzICogdGhpcy5tMTtcclxuICAgICAgdGhpcy5sMXozID0gdGhpcy5hejMgKiB0aGlzLm0xO1xyXG4gICAgICB0aGlzLmwyeDMgPSB0aGlzLmF4MyAqIHRoaXMubTI7XHJcbiAgICAgIHRoaXMubDJ5MyA9IHRoaXMuYXkzICogdGhpcy5tMjtcclxuICAgICAgdGhpcy5sMnozID0gdGhpcy5hejMgKiB0aGlzLm0yO1xyXG4gICAgICB0aGlzLmExeDMgPSB0aGlzLnQxeDMgKiB0aGlzLmkxZTAwICsgdGhpcy50MXkzICogdGhpcy5pMWUwMSArIHRoaXMudDF6MyAqIHRoaXMuaTFlMDI7XHJcbiAgICAgIHRoaXMuYTF5MyA9IHRoaXMudDF4MyAqIHRoaXMuaTFlMTAgKyB0aGlzLnQxeTMgKiB0aGlzLmkxZTExICsgdGhpcy50MXozICogdGhpcy5pMWUxMjtcclxuICAgICAgdGhpcy5hMXozID0gdGhpcy50MXgzICogdGhpcy5pMWUyMCArIHRoaXMudDF5MyAqIHRoaXMuaTFlMjEgKyB0aGlzLnQxejMgKiB0aGlzLmkxZTIyO1xyXG4gICAgICB0aGlzLmEyeDMgPSB0aGlzLnQyeDMgKiB0aGlzLmkyZTAwICsgdGhpcy50MnkzICogdGhpcy5pMmUwMSArIHRoaXMudDJ6MyAqIHRoaXMuaTJlMDI7XHJcbiAgICAgIHRoaXMuYTJ5MyA9IHRoaXMudDJ4MyAqIHRoaXMuaTJlMTAgKyB0aGlzLnQyeTMgKiB0aGlzLmkyZTExICsgdGhpcy50MnozICogdGhpcy5pMmUxMjtcclxuICAgICAgdGhpcy5hMnozID0gdGhpcy50MngzICogdGhpcy5pMmUyMCArIHRoaXMudDJ5MyAqIHRoaXMuaTJlMjEgKyB0aGlzLnQyejMgKiB0aGlzLmkyZTIyO1xyXG5cclxuICAgICAgLy8gYnVpbGQgYW4gaW1wdWxzZSBtYXRyaXhcclxuICAgICAgdmFyIG0xMiA9IHRoaXMubTEgKyB0aGlzLm0yO1xyXG4gICAgICB0aGlzLmswMCA9ICh0aGlzLmF4MSAqIHRoaXMuYXgxICsgdGhpcy5heTEgKiB0aGlzLmF5MSArIHRoaXMuYXoxICogdGhpcy5hejEpICogbTEyO1xyXG4gICAgICB0aGlzLmswMSA9ICh0aGlzLmF4MSAqIHRoaXMuYXgyICsgdGhpcy5heTEgKiB0aGlzLmF5MiArIHRoaXMuYXoxICogdGhpcy5hejIpICogbTEyO1xyXG4gICAgICB0aGlzLmswMiA9ICh0aGlzLmF4MSAqIHRoaXMuYXgzICsgdGhpcy5heTEgKiB0aGlzLmF5MyArIHRoaXMuYXoxICogdGhpcy5hejMpICogbTEyO1xyXG4gICAgICB0aGlzLmsxMCA9ICh0aGlzLmF4MiAqIHRoaXMuYXgxICsgdGhpcy5heTIgKiB0aGlzLmF5MSArIHRoaXMuYXoyICogdGhpcy5hejEpICogbTEyO1xyXG4gICAgICB0aGlzLmsxMSA9ICh0aGlzLmF4MiAqIHRoaXMuYXgyICsgdGhpcy5heTIgKiB0aGlzLmF5MiArIHRoaXMuYXoyICogdGhpcy5hejIpICogbTEyO1xyXG4gICAgICB0aGlzLmsxMiA9ICh0aGlzLmF4MiAqIHRoaXMuYXgzICsgdGhpcy5heTIgKiB0aGlzLmF5MyArIHRoaXMuYXoyICogdGhpcy5hejMpICogbTEyO1xyXG4gICAgICB0aGlzLmsyMCA9ICh0aGlzLmF4MyAqIHRoaXMuYXgxICsgdGhpcy5heTMgKiB0aGlzLmF5MSArIHRoaXMuYXozICogdGhpcy5hejEpICogbTEyO1xyXG4gICAgICB0aGlzLmsyMSA9ICh0aGlzLmF4MyAqIHRoaXMuYXgyICsgdGhpcy5heTMgKiB0aGlzLmF5MiArIHRoaXMuYXozICogdGhpcy5hejIpICogbTEyO1xyXG4gICAgICB0aGlzLmsyMiA9ICh0aGlzLmF4MyAqIHRoaXMuYXgzICsgdGhpcy5heTMgKiB0aGlzLmF5MyArIHRoaXMuYXozICogdGhpcy5hejMpICogbTEyO1xyXG5cclxuICAgICAgdGhpcy5rMDAgKz0gdGhpcy50MXgxICogdGhpcy5hMXgxICsgdGhpcy50MXkxICogdGhpcy5hMXkxICsgdGhpcy50MXoxICogdGhpcy5hMXoxO1xyXG4gICAgICB0aGlzLmswMSArPSB0aGlzLnQxeDEgKiB0aGlzLmExeDIgKyB0aGlzLnQxeTEgKiB0aGlzLmExeTIgKyB0aGlzLnQxejEgKiB0aGlzLmExejI7XHJcbiAgICAgIHRoaXMuazAyICs9IHRoaXMudDF4MSAqIHRoaXMuYTF4MyArIHRoaXMudDF5MSAqIHRoaXMuYTF5MyArIHRoaXMudDF6MSAqIHRoaXMuYTF6MztcclxuICAgICAgdGhpcy5rMTAgKz0gdGhpcy50MXgyICogdGhpcy5hMXgxICsgdGhpcy50MXkyICogdGhpcy5hMXkxICsgdGhpcy50MXoyICogdGhpcy5hMXoxO1xyXG4gICAgICB0aGlzLmsxMSArPSB0aGlzLnQxeDIgKiB0aGlzLmExeDIgKyB0aGlzLnQxeTIgKiB0aGlzLmExeTIgKyB0aGlzLnQxejIgKiB0aGlzLmExejI7XHJcbiAgICAgIHRoaXMuazEyICs9IHRoaXMudDF4MiAqIHRoaXMuYTF4MyArIHRoaXMudDF5MiAqIHRoaXMuYTF5MyArIHRoaXMudDF6MiAqIHRoaXMuYTF6MztcclxuICAgICAgdGhpcy5rMjAgKz0gdGhpcy50MXgzICogdGhpcy5hMXgxICsgdGhpcy50MXkzICogdGhpcy5hMXkxICsgdGhpcy50MXozICogdGhpcy5hMXoxO1xyXG4gICAgICB0aGlzLmsyMSArPSB0aGlzLnQxeDMgKiB0aGlzLmExeDIgKyB0aGlzLnQxeTMgKiB0aGlzLmExeTIgKyB0aGlzLnQxejMgKiB0aGlzLmExejI7XHJcbiAgICAgIHRoaXMuazIyICs9IHRoaXMudDF4MyAqIHRoaXMuYTF4MyArIHRoaXMudDF5MyAqIHRoaXMuYTF5MyArIHRoaXMudDF6MyAqIHRoaXMuYTF6MztcclxuXHJcbiAgICAgIHRoaXMuazAwICs9IHRoaXMudDJ4MSAqIHRoaXMuYTJ4MSArIHRoaXMudDJ5MSAqIHRoaXMuYTJ5MSArIHRoaXMudDJ6MSAqIHRoaXMuYTJ6MTtcclxuICAgICAgdGhpcy5rMDEgKz0gdGhpcy50MngxICogdGhpcy5hMngyICsgdGhpcy50MnkxICogdGhpcy5hMnkyICsgdGhpcy50MnoxICogdGhpcy5hMnoyO1xyXG4gICAgICB0aGlzLmswMiArPSB0aGlzLnQyeDEgKiB0aGlzLmEyeDMgKyB0aGlzLnQyeTEgKiB0aGlzLmEyeTMgKyB0aGlzLnQyejEgKiB0aGlzLmEyejM7XHJcbiAgICAgIHRoaXMuazEwICs9IHRoaXMudDJ4MiAqIHRoaXMuYTJ4MSArIHRoaXMudDJ5MiAqIHRoaXMuYTJ5MSArIHRoaXMudDJ6MiAqIHRoaXMuYTJ6MTtcclxuICAgICAgdGhpcy5rMTEgKz0gdGhpcy50MngyICogdGhpcy5hMngyICsgdGhpcy50MnkyICogdGhpcy5hMnkyICsgdGhpcy50MnoyICogdGhpcy5hMnoyO1xyXG4gICAgICB0aGlzLmsxMiArPSB0aGlzLnQyeDIgKiB0aGlzLmEyeDMgKyB0aGlzLnQyeTIgKiB0aGlzLmEyeTMgKyB0aGlzLnQyejIgKiB0aGlzLmEyejM7XHJcbiAgICAgIHRoaXMuazIwICs9IHRoaXMudDJ4MyAqIHRoaXMuYTJ4MSArIHRoaXMudDJ5MyAqIHRoaXMuYTJ5MSArIHRoaXMudDJ6MyAqIHRoaXMuYTJ6MTtcclxuICAgICAgdGhpcy5rMjEgKz0gdGhpcy50MngzICogdGhpcy5hMngyICsgdGhpcy50MnkzICogdGhpcy5hMnkyICsgdGhpcy50MnozICogdGhpcy5hMnoyO1xyXG4gICAgICB0aGlzLmsyMiArPSB0aGlzLnQyeDMgKiB0aGlzLmEyeDMgKyB0aGlzLnQyeTMgKiB0aGlzLmEyeTMgKyB0aGlzLnQyejMgKiB0aGlzLmEyejM7XHJcblxyXG4gICAgICB0aGlzLmt2MDAgPSB0aGlzLmswMDtcclxuICAgICAgdGhpcy5rdjExID0gdGhpcy5rMTE7XHJcbiAgICAgIHRoaXMua3YyMiA9IHRoaXMuazIyO1xyXG5cclxuICAgICAgdGhpcy5kdjAwID0gMSAvIHRoaXMua3YwMDtcclxuICAgICAgdGhpcy5kdjExID0gMSAvIHRoaXMua3YxMTtcclxuICAgICAgdGhpcy5kdjIyID0gMSAvIHRoaXMua3YyMjtcclxuXHJcbiAgICAgIGlmIChlbmFibGVTcHJpbmcxICYmIHRoaXMubGltaXRTdGF0ZTEgIT0gMikge1xyXG4gICAgICAgIHZhciBvbWVnYSA9IDYuMjgzMTg1MyAqIGZyZXF1ZW5jeTE7XHJcbiAgICAgICAgdmFyIGsgPSBvbWVnYSAqIG9tZWdhICogdGltZVN0ZXA7XHJcbiAgICAgICAgdmFyIGRtcCA9IGludlRpbWVTdGVwIC8gKGsgKyAyICogdGhpcy5saW1pdE1vdG9yMS5kYW1waW5nUmF0aW8gKiBvbWVnYSk7XHJcbiAgICAgICAgdGhpcy5jZm0xID0gdGhpcy5rdjAwICogZG1wO1xyXG4gICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTEgKj0gayAqIGRtcDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmNmbTEgPSAwO1xyXG4gICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTEgKj0gaW52VGltZVN0ZXAgKiAwLjA1O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChlbmFibGVTcHJpbmcyICYmIHRoaXMubGltaXRTdGF0ZTIgIT0gMikge1xyXG4gICAgICAgIG9tZWdhID0gNi4yODMxODUzICogZnJlcXVlbmN5MjtcclxuICAgICAgICBrID0gb21lZ2EgKiBvbWVnYSAqIHRpbWVTdGVwO1xyXG4gICAgICAgIGRtcCA9IGludlRpbWVTdGVwIC8gKGsgKyAyICogdGhpcy5saW1pdE1vdG9yMi5kYW1waW5nUmF0aW8gKiBvbWVnYSk7XHJcbiAgICAgICAgdGhpcy5jZm0yID0gdGhpcy5rdjExICogZG1wO1xyXG4gICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTIgKj0gayAqIGRtcDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmNmbTIgPSAwO1xyXG4gICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTIgKj0gaW52VGltZVN0ZXAgKiAwLjA1O1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChlbmFibGVTcHJpbmczICYmIHRoaXMubGltaXRTdGF0ZTMgIT0gMikge1xyXG4gICAgICAgIG9tZWdhID0gNi4yODMxODUzICogZnJlcXVlbmN5MztcclxuICAgICAgICBrID0gb21lZ2EgKiBvbWVnYSAqIHRpbWVTdGVwO1xyXG4gICAgICAgIGRtcCA9IGludlRpbWVTdGVwIC8gKGsgKyAyICogdGhpcy5saW1pdE1vdG9yMy5kYW1waW5nUmF0aW8gKiBvbWVnYSk7XHJcbiAgICAgICAgdGhpcy5jZm0zID0gdGhpcy5rdjIyICogZG1wO1xyXG4gICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTMgKj0gayAqIGRtcDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmNmbTMgPSAwO1xyXG4gICAgICAgIHRoaXMubGltaXRWZWxvY2l0eTMgKj0gaW52VGltZVN0ZXAgKiAwLjA1O1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuazAwICs9IHRoaXMuY2ZtMTtcclxuICAgICAgdGhpcy5rMTEgKz0gdGhpcy5jZm0yO1xyXG4gICAgICB0aGlzLmsyMiArPSB0aGlzLmNmbTM7XHJcblxyXG4gICAgICB2YXIgaW52ID0gMSAvIChcclxuICAgICAgICB0aGlzLmswMCAqICh0aGlzLmsxMSAqIHRoaXMuazIyIC0gdGhpcy5rMjEgKiB0aGlzLmsxMikgK1xyXG4gICAgICAgIHRoaXMuazEwICogKHRoaXMuazIxICogdGhpcy5rMDIgLSB0aGlzLmswMSAqIHRoaXMuazIyKSArXHJcbiAgICAgICAgdGhpcy5rMjAgKiAodGhpcy5rMDEgKiB0aGlzLmsxMiAtIHRoaXMuazExICogdGhpcy5rMDIpXHJcbiAgICAgICk7XHJcbiAgICAgIHRoaXMuZDAwID0gKHRoaXMuazExICogdGhpcy5rMjIgLSB0aGlzLmsxMiAqIHRoaXMuazIxKSAqIGludjtcclxuICAgICAgdGhpcy5kMDEgPSAodGhpcy5rMDIgKiB0aGlzLmsyMSAtIHRoaXMuazAxICogdGhpcy5rMjIpICogaW52O1xyXG4gICAgICB0aGlzLmQwMiA9ICh0aGlzLmswMSAqIHRoaXMuazEyIC0gdGhpcy5rMDIgKiB0aGlzLmsxMSkgKiBpbnY7XHJcbiAgICAgIHRoaXMuZDEwID0gKHRoaXMuazEyICogdGhpcy5rMjAgLSB0aGlzLmsxMCAqIHRoaXMuazIyKSAqIGludjtcclxuICAgICAgdGhpcy5kMTEgPSAodGhpcy5rMDAgKiB0aGlzLmsyMiAtIHRoaXMuazAyICogdGhpcy5rMjApICogaW52O1xyXG4gICAgICB0aGlzLmQxMiA9ICh0aGlzLmswMiAqIHRoaXMuazEwIC0gdGhpcy5rMDAgKiB0aGlzLmsxMikgKiBpbnY7XHJcbiAgICAgIHRoaXMuZDIwID0gKHRoaXMuazEwICogdGhpcy5rMjEgLSB0aGlzLmsxMSAqIHRoaXMuazIwKSAqIGludjtcclxuICAgICAgdGhpcy5kMjEgPSAodGhpcy5rMDEgKiB0aGlzLmsyMCAtIHRoaXMuazAwICogdGhpcy5rMjEpICogaW52O1xyXG4gICAgICB0aGlzLmQyMiA9ICh0aGlzLmswMCAqIHRoaXMuazExIC0gdGhpcy5rMDEgKiB0aGlzLmsxMCkgKiBpbnY7XHJcblxyXG4gICAgICAvLyB3YXJtIHN0YXJ0aW5nXHJcbiAgICAgIHZhciB0b3RhbEltcHVsc2UxID0gdGhpcy5saW1pdEltcHVsc2UxICsgdGhpcy5tb3RvckltcHVsc2UxO1xyXG4gICAgICB2YXIgdG90YWxJbXB1bHNlMiA9IHRoaXMubGltaXRJbXB1bHNlMiArIHRoaXMubW90b3JJbXB1bHNlMjtcclxuICAgICAgdmFyIHRvdGFsSW1wdWxzZTMgPSB0aGlzLmxpbWl0SW1wdWxzZTMgKyB0aGlzLm1vdG9ySW1wdWxzZTM7XHJcbiAgICAgIHRoaXMubDEueCArPSB0b3RhbEltcHVsc2UxICogdGhpcy5sMXgxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMubDF4MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmwxeDM7XHJcbiAgICAgIHRoaXMubDEueSArPSB0b3RhbEltcHVsc2UxICogdGhpcy5sMXkxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMubDF5MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmwxeTM7XHJcbiAgICAgIHRoaXMubDEueiArPSB0b3RhbEltcHVsc2UxICogdGhpcy5sMXoxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMubDF6MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmwxejM7XHJcbiAgICAgIHRoaXMuYTEueCArPSB0b3RhbEltcHVsc2UxICogdGhpcy5hMXgxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMuYTF4MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmExeDM7XHJcbiAgICAgIHRoaXMuYTEueSArPSB0b3RhbEltcHVsc2UxICogdGhpcy5hMXkxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMuYTF5MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmExeTM7XHJcbiAgICAgIHRoaXMuYTEueiArPSB0b3RhbEltcHVsc2UxICogdGhpcy5hMXoxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMuYTF6MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmExejM7XHJcbiAgICAgIHRoaXMubDIueCAtPSB0b3RhbEltcHVsc2UxICogdGhpcy5sMngxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMubDJ4MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmwyeDM7XHJcbiAgICAgIHRoaXMubDIueSAtPSB0b3RhbEltcHVsc2UxICogdGhpcy5sMnkxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMubDJ5MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmwyeTM7XHJcbiAgICAgIHRoaXMubDIueiAtPSB0b3RhbEltcHVsc2UxICogdGhpcy5sMnoxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMubDJ6MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmwyejM7XHJcbiAgICAgIHRoaXMuYTIueCAtPSB0b3RhbEltcHVsc2UxICogdGhpcy5hMngxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMuYTJ4MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmEyeDM7XHJcbiAgICAgIHRoaXMuYTIueSAtPSB0b3RhbEltcHVsc2UxICogdGhpcy5hMnkxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMuYTJ5MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmEyeTM7XHJcbiAgICAgIHRoaXMuYTIueiAtPSB0b3RhbEltcHVsc2UxICogdGhpcy5hMnoxICsgdG90YWxJbXB1bHNlMiAqIHRoaXMuYTJ6MiArIHRvdGFsSW1wdWxzZTMgKiB0aGlzLmEyejM7XHJcbiAgICB9LFxyXG5cclxuICAgIHNvbHZlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHZhciBydnggPSB0aGlzLmwyLnggLSB0aGlzLmwxLnggKyB0aGlzLmEyLnkgKiB0aGlzLnIyeiAtIHRoaXMuYTIueiAqIHRoaXMucjJ5IC0gdGhpcy5hMS55ICogdGhpcy5yMXogKyB0aGlzLmExLnogKiB0aGlzLnIxeTtcclxuICAgICAgdmFyIHJ2eSA9IHRoaXMubDIueSAtIHRoaXMubDEueSArIHRoaXMuYTIueiAqIHRoaXMucjJ4IC0gdGhpcy5hMi54ICogdGhpcy5yMnogLSB0aGlzLmExLnogKiB0aGlzLnIxeCArIHRoaXMuYTEueCAqIHRoaXMucjF6O1xyXG4gICAgICB2YXIgcnZ6ID0gdGhpcy5sMi56IC0gdGhpcy5sMS56ICsgdGhpcy5hMi54ICogdGhpcy5yMnkgLSB0aGlzLmEyLnkgKiB0aGlzLnIyeCAtIHRoaXMuYTEueCAqIHRoaXMucjF5ICsgdGhpcy5hMS55ICogdGhpcy5yMXg7XHJcbiAgICAgIHZhciBydm4xID0gcnZ4ICogdGhpcy5heDEgKyBydnkgKiB0aGlzLmF5MSArIHJ2eiAqIHRoaXMuYXoxO1xyXG4gICAgICB2YXIgcnZuMiA9IHJ2eCAqIHRoaXMuYXgyICsgcnZ5ICogdGhpcy5heTIgKyBydnogKiB0aGlzLmF6MjtcclxuICAgICAgdmFyIHJ2bjMgPSBydnggKiB0aGlzLmF4MyArIHJ2eSAqIHRoaXMuYXkzICsgcnZ6ICogdGhpcy5hejM7XHJcbiAgICAgIHZhciBvbGRNb3RvckltcHVsc2UxID0gdGhpcy5tb3RvckltcHVsc2UxO1xyXG4gICAgICB2YXIgb2xkTW90b3JJbXB1bHNlMiA9IHRoaXMubW90b3JJbXB1bHNlMjtcclxuICAgICAgdmFyIG9sZE1vdG9ySW1wdWxzZTMgPSB0aGlzLm1vdG9ySW1wdWxzZTM7XHJcbiAgICAgIHZhciBkTW90b3JJbXB1bHNlMSA9IDA7XHJcbiAgICAgIHZhciBkTW90b3JJbXB1bHNlMiA9IDA7XHJcbiAgICAgIHZhciBkTW90b3JJbXB1bHNlMyA9IDA7XHJcbiAgICAgIGlmICh0aGlzLmVuYWJsZU1vdG9yMSkge1xyXG4gICAgICAgIGRNb3RvckltcHVsc2UxID0gKHJ2bjEgLSB0aGlzLm1vdG9yU3BlZWQxKSAqIHRoaXMuZHYwMDtcclxuICAgICAgICB0aGlzLm1vdG9ySW1wdWxzZTEgKz0gZE1vdG9ySW1wdWxzZTE7XHJcbiAgICAgICAgaWYgKHRoaXMubW90b3JJbXB1bHNlMSA+IHRoaXMubWF4TW90b3JJbXB1bHNlMSkgeyAvLyBjbGFtcCBtb3RvciBpbXB1bHNlXHJcbiAgICAgICAgICB0aGlzLm1vdG9ySW1wdWxzZTEgPSB0aGlzLm1heE1vdG9ySW1wdWxzZTE7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm1vdG9ySW1wdWxzZTEgPCAtdGhpcy5tYXhNb3RvckltcHVsc2UxKSB7XHJcbiAgICAgICAgICB0aGlzLm1vdG9ySW1wdWxzZTEgPSAtdGhpcy5tYXhNb3RvckltcHVsc2UxO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkTW90b3JJbXB1bHNlMSA9IHRoaXMubW90b3JJbXB1bHNlMSAtIG9sZE1vdG9ySW1wdWxzZTE7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuZW5hYmxlTW90b3IyKSB7XHJcbiAgICAgICAgZE1vdG9ySW1wdWxzZTIgPSAocnZuMiAtIHRoaXMubW90b3JTcGVlZDIpICogdGhpcy5kdjExO1xyXG4gICAgICAgIHRoaXMubW90b3JJbXB1bHNlMiArPSBkTW90b3JJbXB1bHNlMjtcclxuICAgICAgICBpZiAodGhpcy5tb3RvckltcHVsc2UyID4gdGhpcy5tYXhNb3RvckltcHVsc2UyKSB7IC8vIGNsYW1wIG1vdG9yIGltcHVsc2VcclxuICAgICAgICAgIHRoaXMubW90b3JJbXB1bHNlMiA9IHRoaXMubWF4TW90b3JJbXB1bHNlMjtcclxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMubW90b3JJbXB1bHNlMiA8IC10aGlzLm1heE1vdG9ySW1wdWxzZTIpIHtcclxuICAgICAgICAgIHRoaXMubW90b3JJbXB1bHNlMiA9IC10aGlzLm1heE1vdG9ySW1wdWxzZTI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRNb3RvckltcHVsc2UyID0gdGhpcy5tb3RvckltcHVsc2UyIC0gb2xkTW90b3JJbXB1bHNlMjtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5lbmFibGVNb3RvcjMpIHtcclxuICAgICAgICBkTW90b3JJbXB1bHNlMyA9IChydm4zIC0gdGhpcy5tb3RvclNwZWVkMykgKiB0aGlzLmR2MjI7XHJcbiAgICAgICAgdGhpcy5tb3RvckltcHVsc2UzICs9IGRNb3RvckltcHVsc2UzO1xyXG4gICAgICAgIGlmICh0aGlzLm1vdG9ySW1wdWxzZTMgPiB0aGlzLm1heE1vdG9ySW1wdWxzZTMpIHsgLy8gY2xhbXAgbW90b3IgaW1wdWxzZVxyXG4gICAgICAgICAgdGhpcy5tb3RvckltcHVsc2UzID0gdGhpcy5tYXhNb3RvckltcHVsc2UzO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5tb3RvckltcHVsc2UzIDwgLXRoaXMubWF4TW90b3JJbXB1bHNlMykge1xyXG4gICAgICAgICAgdGhpcy5tb3RvckltcHVsc2UzID0gLXRoaXMubWF4TW90b3JJbXB1bHNlMztcclxuICAgICAgICB9XHJcbiAgICAgICAgZE1vdG9ySW1wdWxzZTMgPSB0aGlzLm1vdG9ySW1wdWxzZTMgLSBvbGRNb3RvckltcHVsc2UzO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBhcHBseSBtb3RvciBpbXB1bHNlIHRvIHJlbGF0aXZlIHZlbG9jaXR5XHJcbiAgICAgIHJ2bjEgKz0gZE1vdG9ySW1wdWxzZTEgKiB0aGlzLmt2MDAgKyBkTW90b3JJbXB1bHNlMiAqIHRoaXMuazAxICsgZE1vdG9ySW1wdWxzZTMgKiB0aGlzLmswMjtcclxuICAgICAgcnZuMiArPSBkTW90b3JJbXB1bHNlMSAqIHRoaXMuazEwICsgZE1vdG9ySW1wdWxzZTIgKiB0aGlzLmt2MTEgKyBkTW90b3JJbXB1bHNlMyAqIHRoaXMuazEyO1xyXG4gICAgICBydm4zICs9IGRNb3RvckltcHVsc2UxICogdGhpcy5rMjAgKyBkTW90b3JJbXB1bHNlMiAqIHRoaXMuazIxICsgZE1vdG9ySW1wdWxzZTMgKiB0aGlzLmt2MjI7XHJcblxyXG4gICAgICAvLyBzdWJ0cmFjdCB0YXJnZXQgdmVsb2NpdHkgYW5kIGFwcGxpZWQgaW1wdWxzZVxyXG4gICAgICBydm4xIC09IHRoaXMubGltaXRWZWxvY2l0eTEgKyB0aGlzLmxpbWl0SW1wdWxzZTEgKiB0aGlzLmNmbTE7XHJcbiAgICAgIHJ2bjIgLT0gdGhpcy5saW1pdFZlbG9jaXR5MiArIHRoaXMubGltaXRJbXB1bHNlMiAqIHRoaXMuY2ZtMjtcclxuICAgICAgcnZuMyAtPSB0aGlzLmxpbWl0VmVsb2NpdHkzICsgdGhpcy5saW1pdEltcHVsc2UzICogdGhpcy5jZm0zO1xyXG5cclxuICAgICAgdmFyIG9sZExpbWl0SW1wdWxzZTEgPSB0aGlzLmxpbWl0SW1wdWxzZTE7XHJcbiAgICAgIHZhciBvbGRMaW1pdEltcHVsc2UyID0gdGhpcy5saW1pdEltcHVsc2UyO1xyXG4gICAgICB2YXIgb2xkTGltaXRJbXB1bHNlMyA9IHRoaXMubGltaXRJbXB1bHNlMztcclxuXHJcbiAgICAgIHZhciBkTGltaXRJbXB1bHNlMSA9IHJ2bjEgKiB0aGlzLmQwMCArIHJ2bjIgKiB0aGlzLmQwMSArIHJ2bjMgKiB0aGlzLmQwMjtcclxuICAgICAgdmFyIGRMaW1pdEltcHVsc2UyID0gcnZuMSAqIHRoaXMuZDEwICsgcnZuMiAqIHRoaXMuZDExICsgcnZuMyAqIHRoaXMuZDEyO1xyXG4gICAgICB2YXIgZExpbWl0SW1wdWxzZTMgPSBydm4xICogdGhpcy5kMjAgKyBydm4yICogdGhpcy5kMjEgKyBydm4zICogdGhpcy5kMjI7XHJcblxyXG4gICAgICB0aGlzLmxpbWl0SW1wdWxzZTEgKz0gZExpbWl0SW1wdWxzZTE7XHJcbiAgICAgIHRoaXMubGltaXRJbXB1bHNlMiArPSBkTGltaXRJbXB1bHNlMjtcclxuICAgICAgdGhpcy5saW1pdEltcHVsc2UzICs9IGRMaW1pdEltcHVsc2UzO1xyXG5cclxuICAgICAgLy8gY2xhbXBcclxuICAgICAgdmFyIGNsYW1wU3RhdGUgPSAwO1xyXG4gICAgICBpZiAodGhpcy5saW1pdFN0YXRlMSA9PSAyIHx8IHRoaXMubGltaXRJbXB1bHNlMSAqIHRoaXMubGltaXRTdGF0ZTEgPCAwKSB7XHJcbiAgICAgICAgZExpbWl0SW1wdWxzZTEgPSAtb2xkTGltaXRJbXB1bHNlMTtcclxuICAgICAgICBydm4yICs9IGRMaW1pdEltcHVsc2UxICogdGhpcy5rMTA7XHJcbiAgICAgICAgcnZuMyArPSBkTGltaXRJbXB1bHNlMSAqIHRoaXMuazIwO1xyXG4gICAgICAgIGNsYW1wU3RhdGUgfD0gMTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5saW1pdFN0YXRlMiA9PSAyIHx8IHRoaXMubGltaXRJbXB1bHNlMiAqIHRoaXMubGltaXRTdGF0ZTIgPCAwKSB7XHJcbiAgICAgICAgZExpbWl0SW1wdWxzZTIgPSAtb2xkTGltaXRJbXB1bHNlMjtcclxuICAgICAgICBydm4xICs9IGRMaW1pdEltcHVsc2UyICogdGhpcy5rMDE7XHJcbiAgICAgICAgcnZuMyArPSBkTGltaXRJbXB1bHNlMiAqIHRoaXMuazIxO1xyXG4gICAgICAgIGNsYW1wU3RhdGUgfD0gMjtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5saW1pdFN0YXRlMyA9PSAyIHx8IHRoaXMubGltaXRJbXB1bHNlMyAqIHRoaXMubGltaXRTdGF0ZTMgPCAwKSB7XHJcbiAgICAgICAgZExpbWl0SW1wdWxzZTMgPSAtb2xkTGltaXRJbXB1bHNlMztcclxuICAgICAgICBydm4xICs9IGRMaW1pdEltcHVsc2UzICogdGhpcy5rMDI7XHJcbiAgICAgICAgcnZuMiArPSBkTGltaXRJbXB1bHNlMyAqIHRoaXMuazEyO1xyXG4gICAgICAgIGNsYW1wU3RhdGUgfD0gNDtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gdXBkYXRlIHVuLWNsYW1wZWQgaW1wdWxzZVxyXG4gICAgICAvLyBUT0RPOiBpc29sYXRlIGRpdmlzaW9uXHJcbiAgICAgIHZhciBkZXQ7XHJcbiAgICAgIHN3aXRjaCAoY2xhbXBTdGF0ZSkge1xyXG4gICAgICAgIGNhc2UgMTovLyB1cGRhdGUgMiAzXHJcbiAgICAgICAgICBkZXQgPSAxIC8gKHRoaXMuazExICogdGhpcy5rMjIgLSB0aGlzLmsxMiAqIHRoaXMuazIxKTtcclxuICAgICAgICAgIGRMaW1pdEltcHVsc2UyID0gKHRoaXMuazIyICogcnZuMiArIC10aGlzLmsxMiAqIHJ2bjMpICogZGV0O1xyXG4gICAgICAgICAgZExpbWl0SW1wdWxzZTMgPSAoLXRoaXMuazIxICogcnZuMiArIHRoaXMuazExICogcnZuMykgKiBkZXQ7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIDI6Ly8gdXBkYXRlIDEgM1xyXG4gICAgICAgICAgZGV0ID0gMSAvICh0aGlzLmswMCAqIHRoaXMuazIyIC0gdGhpcy5rMDIgKiB0aGlzLmsyMCk7XHJcbiAgICAgICAgICBkTGltaXRJbXB1bHNlMSA9ICh0aGlzLmsyMiAqIHJ2bjEgKyAtdGhpcy5rMDIgKiBydm4zKSAqIGRldDtcclxuICAgICAgICAgIGRMaW1pdEltcHVsc2UzID0gKC10aGlzLmsyMCAqIHJ2bjEgKyB0aGlzLmswMCAqIHJ2bjMpICogZGV0O1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAzOi8vIHVwZGF0ZSAzXHJcbiAgICAgICAgICBkTGltaXRJbXB1bHNlMyA9IHJ2bjMgLyB0aGlzLmsyMjtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgNDovLyB1cGRhdGUgMSAyXHJcbiAgICAgICAgICBkZXQgPSAxIC8gKHRoaXMuazAwICogdGhpcy5rMTEgLSB0aGlzLmswMSAqIHRoaXMuazEwKTtcclxuICAgICAgICAgIGRMaW1pdEltcHVsc2UxID0gKHRoaXMuazExICogcnZuMSArIC10aGlzLmswMSAqIHJ2bjIpICogZGV0O1xyXG4gICAgICAgICAgZExpbWl0SW1wdWxzZTIgPSAoLXRoaXMuazEwICogcnZuMSArIHRoaXMuazAwICogcnZuMikgKiBkZXQ7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIDU6Ly8gdXBkYXRlIDJcclxuICAgICAgICAgIGRMaW1pdEltcHVsc2UyID0gcnZuMiAvIHRoaXMuazExO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSA2Oi8vIHVwZGF0ZSAxXHJcbiAgICAgICAgICBkTGltaXRJbXB1bHNlMSA9IHJ2bjEgLyB0aGlzLmswMDtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLmxpbWl0SW1wdWxzZTEgPSBvbGRMaW1pdEltcHVsc2UxICsgZExpbWl0SW1wdWxzZTE7XHJcbiAgICAgIHRoaXMubGltaXRJbXB1bHNlMiA9IG9sZExpbWl0SW1wdWxzZTIgKyBkTGltaXRJbXB1bHNlMjtcclxuICAgICAgdGhpcy5saW1pdEltcHVsc2UzID0gb2xkTGltaXRJbXB1bHNlMyArIGRMaW1pdEltcHVsc2UzO1xyXG5cclxuICAgICAgdmFyIGRJbXB1bHNlMSA9IGRNb3RvckltcHVsc2UxICsgZExpbWl0SW1wdWxzZTE7XHJcbiAgICAgIHZhciBkSW1wdWxzZTIgPSBkTW90b3JJbXB1bHNlMiArIGRMaW1pdEltcHVsc2UyO1xyXG4gICAgICB2YXIgZEltcHVsc2UzID0gZE1vdG9ySW1wdWxzZTMgKyBkTGltaXRJbXB1bHNlMztcclxuXHJcbiAgICAgIC8vIGFwcGx5IGltcHVsc2VcclxuICAgICAgdGhpcy5sMS54ICs9IGRJbXB1bHNlMSAqIHRoaXMubDF4MSArIGRJbXB1bHNlMiAqIHRoaXMubDF4MiArIGRJbXB1bHNlMyAqIHRoaXMubDF4MztcclxuICAgICAgdGhpcy5sMS55ICs9IGRJbXB1bHNlMSAqIHRoaXMubDF5MSArIGRJbXB1bHNlMiAqIHRoaXMubDF5MiArIGRJbXB1bHNlMyAqIHRoaXMubDF5MztcclxuICAgICAgdGhpcy5sMS56ICs9IGRJbXB1bHNlMSAqIHRoaXMubDF6MSArIGRJbXB1bHNlMiAqIHRoaXMubDF6MiArIGRJbXB1bHNlMyAqIHRoaXMubDF6MztcclxuICAgICAgdGhpcy5hMS54ICs9IGRJbXB1bHNlMSAqIHRoaXMuYTF4MSArIGRJbXB1bHNlMiAqIHRoaXMuYTF4MiArIGRJbXB1bHNlMyAqIHRoaXMuYTF4MztcclxuICAgICAgdGhpcy5hMS55ICs9IGRJbXB1bHNlMSAqIHRoaXMuYTF5MSArIGRJbXB1bHNlMiAqIHRoaXMuYTF5MiArIGRJbXB1bHNlMyAqIHRoaXMuYTF5MztcclxuICAgICAgdGhpcy5hMS56ICs9IGRJbXB1bHNlMSAqIHRoaXMuYTF6MSArIGRJbXB1bHNlMiAqIHRoaXMuYTF6MiArIGRJbXB1bHNlMyAqIHRoaXMuYTF6MztcclxuICAgICAgdGhpcy5sMi54IC09IGRJbXB1bHNlMSAqIHRoaXMubDJ4MSArIGRJbXB1bHNlMiAqIHRoaXMubDJ4MiArIGRJbXB1bHNlMyAqIHRoaXMubDJ4MztcclxuICAgICAgdGhpcy5sMi55IC09IGRJbXB1bHNlMSAqIHRoaXMubDJ5MSArIGRJbXB1bHNlMiAqIHRoaXMubDJ5MiArIGRJbXB1bHNlMyAqIHRoaXMubDJ5MztcclxuICAgICAgdGhpcy5sMi56IC09IGRJbXB1bHNlMSAqIHRoaXMubDJ6MSArIGRJbXB1bHNlMiAqIHRoaXMubDJ6MiArIGRJbXB1bHNlMyAqIHRoaXMubDJ6MztcclxuICAgICAgdGhpcy5hMi54IC09IGRJbXB1bHNlMSAqIHRoaXMuYTJ4MSArIGRJbXB1bHNlMiAqIHRoaXMuYTJ4MiArIGRJbXB1bHNlMyAqIHRoaXMuYTJ4MztcclxuICAgICAgdGhpcy5hMi55IC09IGRJbXB1bHNlMSAqIHRoaXMuYTJ5MSArIGRJbXB1bHNlMiAqIHRoaXMuYTJ5MiArIGRJbXB1bHNlMyAqIHRoaXMuYTJ5MztcclxuICAgICAgdGhpcy5hMi56IC09IGRJbXB1bHNlMSAqIHRoaXMuYTJ6MSArIGRJbXB1bHNlMiAqIHRoaXMuYTJ6MiArIGRJbXB1bHNlMyAqIHRoaXMuYTJ6MztcclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIEEgcHJpc21hdGljIGpvaW50IGFsbG93cyBvbmx5IGZvciByZWxhdGl2ZSB0cmFuc2xhdGlvbiBvZiByaWdpZCBib2RpZXMgYWxvbmcgdGhlIGF4aXMuXHJcbiAgICpcclxuICAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAgKiBAYXV0aG9yIGxvLXRoXHJcbiAgICovXHJcblxyXG4gIGZ1bmN0aW9uIFByaXNtYXRpY0pvaW50KGNvbmZpZywgbG93ZXJUcmFuc2xhdGlvbiwgdXBwZXJUcmFuc2xhdGlvbikge1xyXG5cclxuICAgIEpvaW50LmNhbGwodGhpcywgY29uZmlnKTtcclxuXHJcbiAgICB0aGlzLnR5cGUgPSBKT0lOVF9QUklTTUFUSUM7XHJcblxyXG4gICAgLy8gVGhlIGF4aXMgaW4gdGhlIGZpcnN0IGJvZHkncyBjb29yZGluYXRlIHN5c3RlbS5cclxuICAgIHRoaXMubG9jYWxBeGlzMSA9IGNvbmZpZy5sb2NhbEF4aXMxLmNsb25lKCkubm9ybWFsaXplKCk7XHJcbiAgICAvLyBUaGUgYXhpcyBpbiB0aGUgc2Vjb25kIGJvZHkncyBjb29yZGluYXRlIHN5c3RlbS5cclxuICAgIHRoaXMubG9jYWxBeGlzMiA9IGNvbmZpZy5sb2NhbEF4aXMyLmNsb25lKCkubm9ybWFsaXplKCk7XHJcblxyXG4gICAgdGhpcy5heDEgPSBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy5heDIgPSBuZXcgVmVjMygpO1xyXG5cclxuICAgIHRoaXMubm9yID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMudGFuID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMuYmluID0gbmV3IFZlYzMoKTtcclxuXHJcbiAgICB0aGlzLmFjID0gbmV3IEFuZ3VsYXJDb25zdHJhaW50KHRoaXMsIG5ldyBRdWF0KCkuc2V0RnJvbVVuaXRWZWN0b3JzKHRoaXMubG9jYWxBeGlzMSwgdGhpcy5sb2NhbEF4aXMyKSk7XHJcblxyXG4gICAgLy8gVGhlIHRyYW5zbGF0aW9uYWwgbGltaXQgYW5kIG1vdG9yIGluZm9ybWF0aW9uIG9mIHRoZSBqb2ludC5cclxuICAgIHRoaXMubGltaXRNb3RvciA9IG5ldyBMaW1pdE1vdG9yKHRoaXMubm9yLCB0cnVlKTtcclxuICAgIHRoaXMubGltaXRNb3Rvci5sb3dlckxpbWl0ID0gbG93ZXJUcmFuc2xhdGlvbjtcclxuICAgIHRoaXMubGltaXRNb3Rvci51cHBlckxpbWl0ID0gdXBwZXJUcmFuc2xhdGlvbjtcclxuICAgIHRoaXMudDMgPSBuZXcgVHJhbnNsYXRpb25hbDNDb25zdHJhaW50KHRoaXMsIHRoaXMubGltaXRNb3RvciwgbmV3IExpbWl0TW90b3IodGhpcy50YW4sIHRydWUpLCBuZXcgTGltaXRNb3Rvcih0aGlzLmJpbiwgdHJ1ZSkpO1xyXG5cclxuICB9XHJcbiAgUHJpc21hdGljSm9pbnQucHJvdG90eXBlID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKEpvaW50LnByb3RvdHlwZSksIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcjogUHJpc21hdGljSm9pbnQsXHJcblxyXG4gICAgcHJlU29sdmU6IGZ1bmN0aW9uICh0aW1lU3RlcCwgaW52VGltZVN0ZXApIHtcclxuXHJcbiAgICAgIHRoaXMudXBkYXRlQW5jaG9yUG9pbnRzKCk7XHJcblxyXG4gICAgICB0aGlzLmF4MS5jb3B5KHRoaXMubG9jYWxBeGlzMSkuYXBwbHlNYXRyaXgzKHRoaXMuYm9keTEucm90YXRpb24sIHRydWUpO1xyXG4gICAgICB0aGlzLmF4Mi5jb3B5KHRoaXMubG9jYWxBeGlzMikuYXBwbHlNYXRyaXgzKHRoaXMuYm9keTIucm90YXRpb24sIHRydWUpO1xyXG5cclxuICAgICAgLy8gbm9ybWFsIHRhbmdlbnQgYmlub3JtYWxcclxuXHJcbiAgICAgIHRoaXMubm9yLnNldChcclxuICAgICAgICB0aGlzLmF4MS54ICogdGhpcy5ib2R5Mi5pbnZlcnNlTWFzcyArIHRoaXMuYXgyLnggKiB0aGlzLmJvZHkxLmludmVyc2VNYXNzLFxyXG4gICAgICAgIHRoaXMuYXgxLnkgKiB0aGlzLmJvZHkyLmludmVyc2VNYXNzICsgdGhpcy5heDIueSAqIHRoaXMuYm9keTEuaW52ZXJzZU1hc3MsXHJcbiAgICAgICAgdGhpcy5heDEueiAqIHRoaXMuYm9keTIuaW52ZXJzZU1hc3MgKyB0aGlzLmF4Mi56ICogdGhpcy5ib2R5MS5pbnZlcnNlTWFzc1xyXG4gICAgICApLm5vcm1hbGl6ZSgpO1xyXG4gICAgICB0aGlzLnRhbi50YW5nZW50KHRoaXMubm9yKS5ub3JtYWxpemUoKTtcclxuICAgICAgdGhpcy5iaW4uY3Jvc3NWZWN0b3JzKHRoaXMubm9yLCB0aGlzLnRhbik7XHJcblxyXG4gICAgICAvLyBwcmVTb2x2ZVxyXG5cclxuICAgICAgdGhpcy5hYy5wcmVTb2x2ZSh0aW1lU3RlcCwgaW52VGltZVN0ZXApO1xyXG4gICAgICB0aGlzLnQzLnByZVNvbHZlKHRpbWVTdGVwLCBpbnZUaW1lU3RlcCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzb2x2ZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdGhpcy5hYy5zb2x2ZSgpO1xyXG4gICAgICB0aGlzLnQzLnNvbHZlKCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBwb3N0U29sdmU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAvKipcclxuICAgKiBBIHNsaWRlciBqb2ludCBhbGxvd3MgZm9yIHJlbGF0aXZlIHRyYW5zbGF0aW9uIGFuZCByZWxhdGl2ZSByb3RhdGlvbiBiZXR3ZWVuIHR3byByaWdpZCBib2RpZXMgYWxvbmcgdGhlIGF4aXMuXHJcbiAgICpcclxuICAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAgKiBAYXV0aG9yIGxvLXRoXHJcbiAgICovXHJcblxyXG4gIGZ1bmN0aW9uIFNsaWRlckpvaW50KGNvbmZpZywgbG93ZXJUcmFuc2xhdGlvbiwgdXBwZXJUcmFuc2xhdGlvbikge1xyXG5cclxuICAgIEpvaW50LmNhbGwodGhpcywgY29uZmlnKTtcclxuXHJcbiAgICB0aGlzLnR5cGUgPSBKT0lOVF9TTElERVI7XHJcblxyXG4gICAgLy8gVGhlIGF4aXMgaW4gdGhlIGZpcnN0IGJvZHkncyBjb29yZGluYXRlIHN5c3RlbS5cclxuICAgIHRoaXMubG9jYWxBeGlzMSA9IGNvbmZpZy5sb2NhbEF4aXMxLmNsb25lKCkubm9ybWFsaXplKCk7XHJcbiAgICAvLyBUaGUgYXhpcyBpbiB0aGUgc2Vjb25kIGJvZHkncyBjb29yZGluYXRlIHN5c3RlbS5cclxuICAgIHRoaXMubG9jYWxBeGlzMiA9IGNvbmZpZy5sb2NhbEF4aXMyLmNsb25lKCkubm9ybWFsaXplKCk7XHJcblxyXG4gICAgLy8gbWFrZSBhbmdsZSBheGlzXHJcbiAgICB2YXIgYXJjID0gbmV3IE1hdDMzKCkuc2V0UXVhdChuZXcgUXVhdCgpLnNldEZyb21Vbml0VmVjdG9ycyh0aGlzLmxvY2FsQXhpczEsIHRoaXMubG9jYWxBeGlzMikpO1xyXG4gICAgdGhpcy5sb2NhbEFuZ2xlMSA9IG5ldyBWZWMzKCkudGFuZ2VudCh0aGlzLmxvY2FsQXhpczEpLm5vcm1hbGl6ZSgpO1xyXG4gICAgdGhpcy5sb2NhbEFuZ2xlMiA9IHRoaXMubG9jYWxBbmdsZTEuY2xvbmUoKS5hcHBseU1hdHJpeDMoYXJjLCB0cnVlKTtcclxuXHJcbiAgICB0aGlzLmF4MSA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLmF4MiA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLmFuMSA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLmFuMiA9IG5ldyBWZWMzKCk7XHJcblxyXG4gICAgdGhpcy50bXAgPSBuZXcgVmVjMygpO1xyXG5cclxuICAgIHRoaXMubm9yID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMudGFuID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMuYmluID0gbmV3IFZlYzMoKTtcclxuXHJcbiAgICAvLyBUaGUgbGltaXQgYW5kIG1vdG9yIGZvciB0aGUgcm90YXRpb25cclxuICAgIHRoaXMucm90YXRpb25hbExpbWl0TW90b3IgPSBuZXcgTGltaXRNb3Rvcih0aGlzLm5vciwgZmFsc2UpO1xyXG4gICAgdGhpcy5yMyA9IG5ldyBSb3RhdGlvbmFsM0NvbnN0cmFpbnQodGhpcywgdGhpcy5yb3RhdGlvbmFsTGltaXRNb3RvciwgbmV3IExpbWl0TW90b3IodGhpcy50YW4sIHRydWUpLCBuZXcgTGltaXRNb3Rvcih0aGlzLmJpbiwgdHJ1ZSkpO1xyXG5cclxuICAgIC8vIFRoZSBsaW1pdCBhbmQgbW90b3IgZm9yIHRoZSB0cmFuc2xhdGlvbi5cclxuICAgIHRoaXMudHJhbnNsYXRpb25hbExpbWl0TW90b3IgPSBuZXcgTGltaXRNb3Rvcih0aGlzLm5vciwgdHJ1ZSk7XHJcbiAgICB0aGlzLnRyYW5zbGF0aW9uYWxMaW1pdE1vdG9yLmxvd2VyTGltaXQgPSBsb3dlclRyYW5zbGF0aW9uO1xyXG4gICAgdGhpcy50cmFuc2xhdGlvbmFsTGltaXRNb3Rvci51cHBlckxpbWl0ID0gdXBwZXJUcmFuc2xhdGlvbjtcclxuICAgIHRoaXMudDMgPSBuZXcgVHJhbnNsYXRpb25hbDNDb25zdHJhaW50KHRoaXMsIHRoaXMudHJhbnNsYXRpb25hbExpbWl0TW90b3IsIG5ldyBMaW1pdE1vdG9yKHRoaXMudGFuLCB0cnVlKSwgbmV3IExpbWl0TW90b3IodGhpcy5iaW4sIHRydWUpKTtcclxuXHJcbiAgfVxyXG4gIFNsaWRlckpvaW50LnByb3RvdHlwZSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShKb2ludC5wcm90b3R5cGUpLCB7XHJcblxyXG4gICAgY29uc3RydWN0b3I6IFNsaWRlckpvaW50LFxyXG5cclxuICAgIHByZVNvbHZlOiBmdW5jdGlvbiAodGltZVN0ZXAsIGludlRpbWVTdGVwKSB7XHJcblxyXG4gICAgICB0aGlzLnVwZGF0ZUFuY2hvclBvaW50cygpO1xyXG5cclxuICAgICAgdGhpcy5heDEuY29weSh0aGlzLmxvY2FsQXhpczEpLmFwcGx5TWF0cml4Myh0aGlzLmJvZHkxLnJvdGF0aW9uLCB0cnVlKTtcclxuICAgICAgdGhpcy5hbjEuY29weSh0aGlzLmxvY2FsQW5nbGUxKS5hcHBseU1hdHJpeDModGhpcy5ib2R5MS5yb3RhdGlvbiwgdHJ1ZSk7XHJcblxyXG4gICAgICB0aGlzLmF4Mi5jb3B5KHRoaXMubG9jYWxBeGlzMikuYXBwbHlNYXRyaXgzKHRoaXMuYm9keTIucm90YXRpb24sIHRydWUpO1xyXG4gICAgICB0aGlzLmFuMi5jb3B5KHRoaXMubG9jYWxBbmdsZTIpLmFwcGx5TWF0cml4Myh0aGlzLmJvZHkyLnJvdGF0aW9uLCB0cnVlKTtcclxuXHJcbiAgICAgIC8vIG5vcm1hbCB0YW5nZW50IGJpbm9ybWFsXHJcblxyXG4gICAgICB0aGlzLm5vci5zZXQoXHJcbiAgICAgICAgdGhpcy5heDEueCAqIHRoaXMuYm9keTIuaW52ZXJzZU1hc3MgKyB0aGlzLmF4Mi54ICogdGhpcy5ib2R5MS5pbnZlcnNlTWFzcyxcclxuICAgICAgICB0aGlzLmF4MS55ICogdGhpcy5ib2R5Mi5pbnZlcnNlTWFzcyArIHRoaXMuYXgyLnkgKiB0aGlzLmJvZHkxLmludmVyc2VNYXNzLFxyXG4gICAgICAgIHRoaXMuYXgxLnogKiB0aGlzLmJvZHkyLmludmVyc2VNYXNzICsgdGhpcy5heDIueiAqIHRoaXMuYm9keTEuaW52ZXJzZU1hc3NcclxuICAgICAgKS5ub3JtYWxpemUoKTtcclxuICAgICAgdGhpcy50YW4udGFuZ2VudCh0aGlzLm5vcikubm9ybWFsaXplKCk7XHJcbiAgICAgIHRoaXMuYmluLmNyb3NzVmVjdG9ycyh0aGlzLm5vciwgdGhpcy50YW4pO1xyXG5cclxuICAgICAgLy8gY2FsY3VsYXRlIGhpbmdlIGFuZ2xlXHJcblxyXG4gICAgICB0aGlzLnRtcC5jcm9zc1ZlY3RvcnModGhpcy5hbjEsIHRoaXMuYW4yKTtcclxuXHJcbiAgICAgIHZhciBsaW1pdGUgPSBfTWF0aC5hY29zQ2xhbXAoX01hdGguZG90VmVjdG9ycyh0aGlzLmFuMSwgdGhpcy5hbjIpKTtcclxuXHJcbiAgICAgIGlmIChfTWF0aC5kb3RWZWN0b3JzKHRoaXMubm9yLCB0aGlzLnRtcCkgPCAwKSB0aGlzLnJvdGF0aW9uYWxMaW1pdE1vdG9yLmFuZ2xlID0gLWxpbWl0ZTtcclxuICAgICAgZWxzZSB0aGlzLnJvdGF0aW9uYWxMaW1pdE1vdG9yLmFuZ2xlID0gbGltaXRlO1xyXG5cclxuICAgICAgLy8gYW5ndWxhciBlcnJvclxyXG5cclxuICAgICAgdGhpcy50bXAuY3Jvc3NWZWN0b3JzKHRoaXMuYXgxLCB0aGlzLmF4Mik7XHJcbiAgICAgIHRoaXMucjMubGltaXRNb3RvcjIuYW5nbGUgPSBfTWF0aC5kb3RWZWN0b3JzKHRoaXMudGFuLCB0aGlzLnRtcCk7XHJcbiAgICAgIHRoaXMucjMubGltaXRNb3RvcjMuYW5nbGUgPSBfTWF0aC5kb3RWZWN0b3JzKHRoaXMuYmluLCB0aGlzLnRtcCk7XHJcblxyXG4gICAgICAvLyBwcmVTb2x2ZVxyXG5cclxuICAgICAgdGhpcy5yMy5wcmVTb2x2ZSh0aW1lU3RlcCwgaW52VGltZVN0ZXApO1xyXG4gICAgICB0aGlzLnQzLnByZVNvbHZlKHRpbWVTdGVwLCBpbnZUaW1lU3RlcCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzb2x2ZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdGhpcy5yMy5zb2x2ZSgpO1xyXG4gICAgICB0aGlzLnQzLnNvbHZlKCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBwb3N0U29sdmU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAvKipcclxuICAgKiBBIHdoZWVsIGpvaW50IGFsbG93cyBmb3IgcmVsYXRpdmUgcm90YXRpb24gYmV0d2VlbiB0d28gcmlnaWQgYm9kaWVzIGFsb25nIHR3byBheGVzLlxyXG4gICAqIFRoZSB3aGVlbCBqb2ludCBhbHNvIGFsbG93cyBmb3IgcmVsYXRpdmUgdHJhbnNsYXRpb24gZm9yIHRoZSBzdXNwZW5zaW9uLlxyXG4gICAqXHJcbiAgICogQGF1dGhvciBzYWhhcmFuXHJcbiAgICogQGF1dGhvciBsby10aFxyXG4gICAqL1xyXG5cclxuICBmdW5jdGlvbiBXaGVlbEpvaW50KGNvbmZpZykge1xyXG5cclxuICAgIEpvaW50LmNhbGwodGhpcywgY29uZmlnKTtcclxuXHJcbiAgICB0aGlzLnR5cGUgPSBKT0lOVF9XSEVFTDtcclxuXHJcbiAgICAvLyBUaGUgYXhpcyBpbiB0aGUgZmlyc3QgYm9keSdzIGNvb3JkaW5hdGUgc3lzdGVtLlxyXG4gICAgdGhpcy5sb2NhbEF4aXMxID0gY29uZmlnLmxvY2FsQXhpczEuY2xvbmUoKS5ub3JtYWxpemUoKTtcclxuICAgIC8vIFRoZSBheGlzIGluIHRoZSBzZWNvbmQgYm9keSdzIGNvb3JkaW5hdGUgc3lzdGVtLlxyXG4gICAgdGhpcy5sb2NhbEF4aXMyID0gY29uZmlnLmxvY2FsQXhpczIuY2xvbmUoKS5ub3JtYWxpemUoKTtcclxuXHJcbiAgICB0aGlzLmxvY2FsQW5nbGUxID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMubG9jYWxBbmdsZTIgPSBuZXcgVmVjMygpO1xyXG5cclxuICAgIHZhciBkb3QgPSBfTWF0aC5kb3RWZWN0b3JzKHRoaXMubG9jYWxBeGlzMSwgdGhpcy5sb2NhbEF4aXMyKTtcclxuXHJcbiAgICBpZiAoZG90ID4gLTEgJiYgZG90IDwgMSkge1xyXG5cclxuICAgICAgdGhpcy5sb2NhbEFuZ2xlMS5zZXQoXHJcbiAgICAgICAgdGhpcy5sb2NhbEF4aXMyLnggLSBkb3QgKiB0aGlzLmxvY2FsQXhpczEueCxcclxuICAgICAgICB0aGlzLmxvY2FsQXhpczIueSAtIGRvdCAqIHRoaXMubG9jYWxBeGlzMS55LFxyXG4gICAgICAgIHRoaXMubG9jYWxBeGlzMi56IC0gZG90ICogdGhpcy5sb2NhbEF4aXMxLnpcclxuICAgICAgKS5ub3JtYWxpemUoKTtcclxuXHJcbiAgICAgIHRoaXMubG9jYWxBbmdsZTIuc2V0KFxyXG4gICAgICAgIHRoaXMubG9jYWxBeGlzMS54IC0gZG90ICogdGhpcy5sb2NhbEF4aXMyLngsXHJcbiAgICAgICAgdGhpcy5sb2NhbEF4aXMxLnkgLSBkb3QgKiB0aGlzLmxvY2FsQXhpczIueSxcclxuICAgICAgICB0aGlzLmxvY2FsQXhpczEueiAtIGRvdCAqIHRoaXMubG9jYWxBeGlzMi56XHJcbiAgICAgICkubm9ybWFsaXplKCk7XHJcblxyXG4gICAgfSBlbHNlIHtcclxuXHJcbiAgICAgIHZhciBhcmMgPSBuZXcgTWF0MzMoKS5zZXRRdWF0KG5ldyBRdWF0KCkuc2V0RnJvbVVuaXRWZWN0b3JzKHRoaXMubG9jYWxBeGlzMSwgdGhpcy5sb2NhbEF4aXMyKSk7XHJcbiAgICAgIHRoaXMubG9jYWxBbmdsZTEudGFuZ2VudCh0aGlzLmxvY2FsQXhpczEpLm5vcm1hbGl6ZSgpO1xyXG4gICAgICB0aGlzLmxvY2FsQW5nbGUyID0gdGhpcy5sb2NhbEFuZ2xlMS5jbG9uZSgpLmFwcGx5TWF0cml4MyhhcmMsIHRydWUpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmF4MSA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLmF4MiA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLmFuMSA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLmFuMiA9IG5ldyBWZWMzKCk7XHJcblxyXG4gICAgdGhpcy50bXAgPSBuZXcgVmVjMygpO1xyXG5cclxuICAgIHRoaXMubm9yID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMudGFuID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMuYmluID0gbmV3IFZlYzMoKTtcclxuXHJcbiAgICAvLyBUaGUgdHJhbnNsYXRpb25hbCBsaW1pdCBhbmQgbW90b3IgaW5mb3JtYXRpb24gb2YgdGhlIGpvaW50LlxyXG4gICAgdGhpcy50cmFuc2xhdGlvbmFsTGltaXRNb3RvciA9IG5ldyBMaW1pdE1vdG9yKHRoaXMudGFuLCB0cnVlKTtcclxuICAgIHRoaXMudHJhbnNsYXRpb25hbExpbWl0TW90b3IuZnJlcXVlbmN5ID0gODtcclxuICAgIHRoaXMudHJhbnNsYXRpb25hbExpbWl0TW90b3IuZGFtcGluZ1JhdGlvID0gMTtcclxuICAgIC8vIFRoZSBmaXJzdCByb3RhdGlvbmFsIGxpbWl0IGFuZCBtb3RvciBpbmZvcm1hdGlvbiBvZiB0aGUgam9pbnQuXHJcbiAgICB0aGlzLnJvdGF0aW9uYWxMaW1pdE1vdG9yMSA9IG5ldyBMaW1pdE1vdG9yKHRoaXMudGFuLCBmYWxzZSk7XHJcbiAgICAvLyBUaGUgc2Vjb25kIHJvdGF0aW9uYWwgbGltaXQgYW5kIG1vdG9yIGluZm9ybWF0aW9uIG9mIHRoZSBqb2ludC5cclxuICAgIHRoaXMucm90YXRpb25hbExpbWl0TW90b3IyID0gbmV3IExpbWl0TW90b3IodGhpcy5iaW4sIGZhbHNlKTtcclxuXHJcbiAgICB0aGlzLnQzID0gbmV3IFRyYW5zbGF0aW9uYWwzQ29uc3RyYWludCh0aGlzLCBuZXcgTGltaXRNb3Rvcih0aGlzLm5vciwgdHJ1ZSksIHRoaXMudHJhbnNsYXRpb25hbExpbWl0TW90b3IsIG5ldyBMaW1pdE1vdG9yKHRoaXMuYmluLCB0cnVlKSk7XHJcbiAgICB0aGlzLnQzLndlaWdodCA9IDE7XHJcbiAgICB0aGlzLnIzID0gbmV3IFJvdGF0aW9uYWwzQ29uc3RyYWludCh0aGlzLCBuZXcgTGltaXRNb3Rvcih0aGlzLm5vciwgdHJ1ZSksIHRoaXMucm90YXRpb25hbExpbWl0TW90b3IxLCB0aGlzLnJvdGF0aW9uYWxMaW1pdE1vdG9yMik7XHJcblxyXG4gIH1cclxuICBXaGVlbEpvaW50LnByb3RvdHlwZSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShKb2ludC5wcm90b3R5cGUpLCB7XHJcblxyXG4gICAgY29uc3RydWN0b3I6IFdoZWVsSm9pbnQsXHJcblxyXG4gICAgcHJlU29sdmU6IGZ1bmN0aW9uICh0aW1lU3RlcCwgaW52VGltZVN0ZXApIHtcclxuXHJcbiAgICAgIHRoaXMudXBkYXRlQW5jaG9yUG9pbnRzKCk7XHJcblxyXG4gICAgICB0aGlzLmF4MS5jb3B5KHRoaXMubG9jYWxBeGlzMSkuYXBwbHlNYXRyaXgzKHRoaXMuYm9keTEucm90YXRpb24sIHRydWUpO1xyXG4gICAgICB0aGlzLmFuMS5jb3B5KHRoaXMubG9jYWxBbmdsZTEpLmFwcGx5TWF0cml4Myh0aGlzLmJvZHkxLnJvdGF0aW9uLCB0cnVlKTtcclxuXHJcbiAgICAgIHRoaXMuYXgyLmNvcHkodGhpcy5sb2NhbEF4aXMyKS5hcHBseU1hdHJpeDModGhpcy5ib2R5Mi5yb3RhdGlvbiwgdHJ1ZSk7XHJcbiAgICAgIHRoaXMuYW4yLmNvcHkodGhpcy5sb2NhbEFuZ2xlMikuYXBwbHlNYXRyaXgzKHRoaXMuYm9keTIucm90YXRpb24sIHRydWUpO1xyXG5cclxuICAgICAgdGhpcy5yMy5saW1pdE1vdG9yMS5hbmdsZSA9IF9NYXRoLmRvdFZlY3RvcnModGhpcy5heDEsIHRoaXMuYXgyKTtcclxuXHJcbiAgICAgIHZhciBsaW1pdGUgPSBfTWF0aC5kb3RWZWN0b3JzKHRoaXMuYW4xLCB0aGlzLmF4Mik7XHJcblxyXG4gICAgICBpZiAoX01hdGguZG90VmVjdG9ycyh0aGlzLmF4MSwgdGhpcy50bXAuY3Jvc3NWZWN0b3JzKHRoaXMuYW4xLCB0aGlzLmF4MikpIDwgMCkgdGhpcy5yb3RhdGlvbmFsTGltaXRNb3RvcjEuYW5nbGUgPSAtbGltaXRlO1xyXG4gICAgICBlbHNlIHRoaXMucm90YXRpb25hbExpbWl0TW90b3IxLmFuZ2xlID0gbGltaXRlO1xyXG5cclxuICAgICAgbGltaXRlID0gX01hdGguZG90VmVjdG9ycyh0aGlzLmFuMiwgdGhpcy5heDEpO1xyXG5cclxuICAgICAgaWYgKF9NYXRoLmRvdFZlY3RvcnModGhpcy5heDIsIHRoaXMudG1wLmNyb3NzVmVjdG9ycyh0aGlzLmFuMiwgdGhpcy5heDEpKSA8IDApIHRoaXMucm90YXRpb25hbExpbWl0TW90b3IyLmFuZ2xlID0gLWxpbWl0ZTtcclxuICAgICAgZWxzZSB0aGlzLnJvdGF0aW9uYWxMaW1pdE1vdG9yMi5hbmdsZSA9IGxpbWl0ZTtcclxuXHJcbiAgICAgIHRoaXMubm9yLmNyb3NzVmVjdG9ycyh0aGlzLmF4MSwgdGhpcy5heDIpLm5vcm1hbGl6ZSgpO1xyXG4gICAgICB0aGlzLnRhbi5jcm9zc1ZlY3RvcnModGhpcy5ub3IsIHRoaXMuYXgyKS5ub3JtYWxpemUoKTtcclxuICAgICAgdGhpcy5iaW4uY3Jvc3NWZWN0b3JzKHRoaXMubm9yLCB0aGlzLmF4MSkubm9ybWFsaXplKCk7XHJcblxyXG4gICAgICB0aGlzLnIzLnByZVNvbHZlKHRpbWVTdGVwLCBpbnZUaW1lU3RlcCk7XHJcbiAgICAgIHRoaXMudDMucHJlU29sdmUodGltZVN0ZXAsIGludlRpbWVTdGVwKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNvbHZlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB0aGlzLnIzLnNvbHZlKCk7XHJcbiAgICAgIHRoaXMudDMuc29sdmUoKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHBvc3RTb2x2ZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIEpvaW50Q29uZmlnKCkge1xyXG5cclxuICAgIHRoaXMuc2NhbGUgPSAxO1xyXG4gICAgdGhpcy5pbnZTY2FsZSA9IDE7XHJcblxyXG4gICAgLy8gVGhlIGZpcnN0IHJpZ2lkIGJvZHkgb2YgdGhlIGpvaW50LlxyXG4gICAgdGhpcy5ib2R5MSA9IG51bGw7XHJcbiAgICAvLyBUaGUgc2Vjb25kIHJpZ2lkIGJvZHkgb2YgdGhlIGpvaW50LlxyXG4gICAgdGhpcy5ib2R5MiA9IG51bGw7XHJcbiAgICAvLyBUaGUgYW5jaG9yIHBvaW50IG9uIHRoZSBmaXJzdCByaWdpZCBib2R5IGluIGxvY2FsIGNvb3JkaW5hdGUgc3lzdGVtLlxyXG4gICAgdGhpcy5sb2NhbEFuY2hvclBvaW50MSA9IG5ldyBWZWMzKCk7XHJcbiAgICAvLyAgVGhlIGFuY2hvciBwb2ludCBvbiB0aGUgc2Vjb25kIHJpZ2lkIGJvZHkgaW4gbG9jYWwgY29vcmRpbmF0ZSBzeXN0ZW0uXHJcbiAgICB0aGlzLmxvY2FsQW5jaG9yUG9pbnQyID0gbmV3IFZlYzMoKTtcclxuICAgIC8vIFRoZSBheGlzIGluIHRoZSBmaXJzdCBib2R5J3MgY29vcmRpbmF0ZSBzeXN0ZW0uXHJcbiAgICAvLyBoaXMgcHJvcGVydHkgaXMgYXZhaWxhYmxlIGluIHNvbWUgam9pbnRzLlxyXG4gICAgdGhpcy5sb2NhbEF4aXMxID0gbmV3IFZlYzMoKTtcclxuICAgIC8vIFRoZSBheGlzIGluIHRoZSBzZWNvbmQgYm9keSdzIGNvb3JkaW5hdGUgc3lzdGVtLlxyXG4gICAgLy8gVGhpcyBwcm9wZXJ0eSBpcyBhdmFpbGFibGUgaW4gc29tZSBqb2ludHMuXHJcbiAgICB0aGlzLmxvY2FsQXhpczIgPSBuZXcgVmVjMygpO1xyXG4gICAgLy8gIFdoZXRoZXIgYWxsb3cgY29sbGlzaW9uIGJldHdlZW4gY29ubmVjdGVkIHJpZ2lkIGJvZGllcyBvciBub3QuXHJcbiAgICB0aGlzLmFsbG93Q29sbGlzaW9uID0gZmFsc2U7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBjbGFzcyBob2xkcyBtYXNzIGluZm9ybWF0aW9uIG9mIGEgc2hhcGUuXHJcbiAgICogQGF1dGhvciBsby10aFxyXG4gICAqIEBhdXRob3Igc2FoYXJhblxyXG4gICAqL1xyXG5cclxuICBmdW5jdGlvbiBNYXNzSW5mbygpIHtcclxuXHJcbiAgICAvLyBNYXNzIG9mIHRoZSBzaGFwZS5cclxuICAgIHRoaXMubWFzcyA9IDA7XHJcblxyXG4gICAgLy8gVGhlIG1vbWVudCBpbmVydGlhIG9mIHRoZSBzaGFwZS5cclxuICAgIHRoaXMuaW5lcnRpYSA9IG5ldyBNYXQzMygpO1xyXG5cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICogQSBsaW5rIGxpc3Qgb2YgY29udGFjdHMuXHJcbiAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAqL1xyXG4gIGZ1bmN0aW9uIENvbnRhY3RMaW5rKGNvbnRhY3QpIHtcclxuXHJcbiAgICAvLyBUaGUgcHJldmlvdXMgY29udGFjdCBsaW5rLlxyXG4gICAgdGhpcy5wcmV2ID0gbnVsbDtcclxuICAgIC8vIFRoZSBuZXh0IGNvbnRhY3QgbGluay5cclxuICAgIHRoaXMubmV4dCA9IG51bGw7XHJcbiAgICAvLyBUaGUgc2hhcGUgb2YgdGhlIGNvbnRhY3QuXHJcbiAgICB0aGlzLnNoYXBlID0gbnVsbDtcclxuICAgIC8vIFRoZSBvdGhlciByaWdpZCBib2R5LlxyXG4gICAgdGhpcy5ib2R5ID0gbnVsbDtcclxuICAgIC8vIFRoZSBjb250YWN0IG9mIHRoZSBsaW5rLlxyXG4gICAgdGhpcy5jb250YWN0ID0gY29udGFjdDtcclxuXHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBJbXB1bHNlRGF0YUJ1ZmZlcigpIHtcclxuXHJcbiAgICB0aGlzLmxwMVggPSBOYU47XHJcbiAgICB0aGlzLmxwMVkgPSBOYU47XHJcbiAgICB0aGlzLmxwMVogPSBOYU47XHJcbiAgICB0aGlzLmxwMlggPSBOYU47XHJcbiAgICB0aGlzLmxwMlkgPSBOYU47XHJcbiAgICB0aGlzLmxwMlogPSBOYU47XHJcbiAgICB0aGlzLmltcHVsc2UgPSBOYU47XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBUaGUgY2xhc3MgaG9sZHMgZGV0YWlscyBvZiB0aGUgY29udGFjdCBwb2ludC5cclxuICAqIEBhdXRob3Igc2FoYXJhblxyXG4gICovXHJcblxyXG4gIGZ1bmN0aW9uIE1hbmlmb2xkUG9pbnQoKSB7XHJcblxyXG4gICAgLy8gV2hldGhlciB0aGlzIG1hbmlmb2xkIHBvaW50IGlzIHBlcnNpc3Rpbmcgb3Igbm90LlxyXG4gICAgdGhpcy53YXJtU3RhcnRlZCA9IGZhbHNlO1xyXG4gICAgLy8gIFRoZSBwb3NpdGlvbiBvZiB0aGlzIG1hbmlmb2xkIHBvaW50LlxyXG4gICAgdGhpcy5wb3NpdGlvbiA9IG5ldyBWZWMzKCk7XHJcbiAgICAvLyBUaGUgcG9zaXRpb24gaW4gdGhlIGZpcnN0IHNoYXBlJ3MgY29vcmRpbmF0ZS5cclxuICAgIHRoaXMubG9jYWxQb2ludDEgPSBuZXcgVmVjMygpO1xyXG4gICAgLy8gIFRoZSBwb3NpdGlvbiBpbiB0aGUgc2Vjb25kIHNoYXBlJ3MgY29vcmRpbmF0ZS5cclxuICAgIHRoaXMubG9jYWxQb2ludDIgPSBuZXcgVmVjMygpO1xyXG4gICAgLy8gVGhlIG5vcm1hbCB2ZWN0b3Igb2YgdGhpcyBtYW5pZm9sZCBwb2ludC5cclxuICAgIHRoaXMubm9ybWFsID0gbmV3IFZlYzMoKTtcclxuICAgIC8vIFRoZSB0YW5nZW50IHZlY3RvciBvZiB0aGlzIG1hbmlmb2xkIHBvaW50LlxyXG4gICAgdGhpcy50YW5nZW50ID0gbmV3IFZlYzMoKTtcclxuICAgIC8vIFRoZSBiaW5vcm1hbCB2ZWN0b3Igb2YgdGhpcyBtYW5pZm9sZCBwb2ludC5cclxuICAgIHRoaXMuYmlub3JtYWwgPSBuZXcgVmVjMygpO1xyXG4gICAgLy8gVGhlIGltcHVsc2UgaW4gbm9ybWFsIGRpcmVjdGlvbi5cclxuICAgIHRoaXMubm9ybWFsSW1wdWxzZSA9IDA7XHJcbiAgICAvLyBUaGUgaW1wdWxzZSBpbiB0YW5nZW50IGRpcmVjdGlvbi5cclxuICAgIHRoaXMudGFuZ2VudEltcHVsc2UgPSAwO1xyXG4gICAgLy8gVGhlIGltcHVsc2UgaW4gYmlub3JtYWwgZGlyZWN0aW9uLlxyXG4gICAgdGhpcy5iaW5vcm1hbEltcHVsc2UgPSAwO1xyXG4gICAgLy8gVGhlIGRlbm9taW5hdG9yIGluIG5vcm1hbCBkaXJlY3Rpb24uXHJcbiAgICB0aGlzLm5vcm1hbERlbm9taW5hdG9yID0gMDtcclxuICAgIC8vIFRoZSBkZW5vbWluYXRvciBpbiB0YW5nZW50IGRpcmVjdGlvbi5cclxuICAgIHRoaXMudGFuZ2VudERlbm9taW5hdG9yID0gMDtcclxuICAgIC8vIFRoZSBkZW5vbWluYXRvciBpbiBiaW5vcm1hbCBkaXJlY3Rpb24uXHJcbiAgICB0aGlzLmJpbm9ybWFsRGVub21pbmF0b3IgPSAwO1xyXG4gICAgLy8gVGhlIGRlcHRoIG9mIHBlbmV0cmF0aW9uLlxyXG4gICAgdGhpcy5wZW5ldHJhdGlvbiA9IDA7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgKiBBIGNvbnRhY3QgbWFuaWZvbGQgYmV0d2VlbiB0d28gc2hhcGVzLlxyXG4gICogQGF1dGhvciBzYWhhcmFuXHJcbiAgKiBAYXV0aG9yIGxvLXRoXHJcbiAgKi9cclxuXHJcbiAgZnVuY3Rpb24gQ29udGFjdE1hbmlmb2xkKCkge1xyXG5cclxuICAgIC8vIFRoZSBmaXJzdCByaWdpZCBib2R5LlxyXG4gICAgdGhpcy5ib2R5MSA9IG51bGw7XHJcbiAgICAvLyBUaGUgc2Vjb25kIHJpZ2lkIGJvZHkuXHJcbiAgICB0aGlzLmJvZHkyID0gbnVsbDtcclxuICAgIC8vIFRoZSBudW1iZXIgb2YgbWFuaWZvbGQgcG9pbnRzLlxyXG4gICAgdGhpcy5udW1Qb2ludHMgPSAwO1xyXG4gICAgLy8gVGhlIG1hbmlmb2xkIHBvaW50cy5cclxuICAgIHRoaXMucG9pbnRzID0gW1xyXG4gICAgICBuZXcgTWFuaWZvbGRQb2ludCgpLFxyXG4gICAgICBuZXcgTWFuaWZvbGRQb2ludCgpLFxyXG4gICAgICBuZXcgTWFuaWZvbGRQb2ludCgpLFxyXG4gICAgICBuZXcgTWFuaWZvbGRQb2ludCgpXHJcbiAgICBdO1xyXG5cclxuICB9XHJcblxyXG4gIENvbnRhY3RNYW5pZm9sZC5wcm90b3R5cGUgPSB7XHJcblxyXG4gICAgY29uc3RydWN0b3I6IENvbnRhY3RNYW5pZm9sZCxcclxuXHJcbiAgICAvL1Jlc2V0IHRoZSBtYW5pZm9sZC5cclxuICAgIHJlc2V0OiBmdW5jdGlvbiAoc2hhcGUxLCBzaGFwZTIpIHtcclxuXHJcbiAgICAgIHRoaXMuYm9keTEgPSBzaGFwZTEucGFyZW50O1xyXG4gICAgICB0aGlzLmJvZHkyID0gc2hhcGUyLnBhcmVudDtcclxuICAgICAgdGhpcy5udW1Qb2ludHMgPSAwO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gIEFkZCBhIHBvaW50IGludG8gdGhpcyBtYW5pZm9sZC5cclxuICAgIGFkZFBvaW50VmVjOiBmdW5jdGlvbiAocG9zLCBub3JtLCBwZW5ldHJhdGlvbiwgZmxpcCkge1xyXG5cclxuICAgICAgdmFyIHAgPSB0aGlzLnBvaW50c1t0aGlzLm51bVBvaW50cysrXTtcclxuXHJcbiAgICAgIHAucG9zaXRpb24uY29weShwb3MpO1xyXG4gICAgICBwLmxvY2FsUG9pbnQxLnN1Yihwb3MsIHRoaXMuYm9keTEucG9zaXRpb24pLmFwcGx5TWF0cml4Myh0aGlzLmJvZHkxLnJvdGF0aW9uKTtcclxuICAgICAgcC5sb2NhbFBvaW50Mi5zdWIocG9zLCB0aGlzLmJvZHkyLnBvc2l0aW9uKS5hcHBseU1hdHJpeDModGhpcy5ib2R5Mi5yb3RhdGlvbik7XHJcblxyXG4gICAgICBwLm5vcm1hbC5jb3B5KG5vcm0pO1xyXG4gICAgICBpZiAoZmxpcCkgcC5ub3JtYWwubmVnYXRlKCk7XHJcblxyXG4gICAgICBwLm5vcm1hbEltcHVsc2UgPSAwO1xyXG4gICAgICBwLnBlbmV0cmF0aW9uID0gcGVuZXRyYXRpb247XHJcbiAgICAgIHAud2FybVN0YXJ0ZWQgPSBmYWxzZTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vICBBZGQgYSBwb2ludCBpbnRvIHRoaXMgbWFuaWZvbGQuXHJcbiAgICBhZGRQb2ludDogZnVuY3Rpb24gKHgsIHksIHosIG54LCBueSwgbnosIHBlbmV0cmF0aW9uLCBmbGlwKSB7XHJcblxyXG4gICAgICB2YXIgcCA9IHRoaXMucG9pbnRzW3RoaXMubnVtUG9pbnRzKytdO1xyXG5cclxuICAgICAgcC5wb3NpdGlvbi5zZXQoeCwgeSwgeik7XHJcbiAgICAgIHAubG9jYWxQb2ludDEuc3ViKHAucG9zaXRpb24sIHRoaXMuYm9keTEucG9zaXRpb24pLmFwcGx5TWF0cml4Myh0aGlzLmJvZHkxLnJvdGF0aW9uKTtcclxuICAgICAgcC5sb2NhbFBvaW50Mi5zdWIocC5wb3NpdGlvbiwgdGhpcy5ib2R5Mi5wb3NpdGlvbikuYXBwbHlNYXRyaXgzKHRoaXMuYm9keTIucm90YXRpb24pO1xyXG5cclxuICAgICAgcC5ub3JtYWxJbXB1bHNlID0gMDtcclxuXHJcbiAgICAgIHAubm9ybWFsLnNldChueCwgbnksIG56KTtcclxuICAgICAgaWYgKGZsaXApIHAubm9ybWFsLm5lZ2F0ZSgpO1xyXG5cclxuICAgICAgcC5wZW5ldHJhdGlvbiA9IHBlbmV0cmF0aW9uO1xyXG4gICAgICBwLndhcm1TdGFydGVkID0gZmFsc2U7XHJcblxyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGZ1bmN0aW9uIENvbnRhY3RQb2ludERhdGFCdWZmZXIoKSB7XHJcblxyXG4gICAgdGhpcy5ub3IgPSBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy50YW4gPSBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy5iaW4gPSBuZXcgVmVjMygpO1xyXG5cclxuICAgIHRoaXMubm9yVTEgPSBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy50YW5VMSA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLmJpblUxID0gbmV3IFZlYzMoKTtcclxuXHJcbiAgICB0aGlzLm5vclUyID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMudGFuVTIgPSBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy5iaW5VMiA9IG5ldyBWZWMzKCk7XHJcblxyXG4gICAgdGhpcy5ub3JUMSA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLnRhblQxID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMuYmluVDEgPSBuZXcgVmVjMygpO1xyXG5cclxuICAgIHRoaXMubm9yVDIgPSBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy50YW5UMiA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLmJpblQyID0gbmV3IFZlYzMoKTtcclxuXHJcbiAgICB0aGlzLm5vclRVMSA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLnRhblRVMSA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLmJpblRVMSA9IG5ldyBWZWMzKCk7XHJcblxyXG4gICAgdGhpcy5ub3JUVTIgPSBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy50YW5UVTIgPSBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy5iaW5UVTIgPSBuZXcgVmVjMygpO1xyXG5cclxuICAgIHRoaXMubm9ySW1wID0gMDtcclxuICAgIHRoaXMudGFuSW1wID0gMDtcclxuICAgIHRoaXMuYmluSW1wID0gMDtcclxuXHJcbiAgICB0aGlzLm5vckRlbiA9IDA7XHJcbiAgICB0aGlzLnRhbkRlbiA9IDA7XHJcbiAgICB0aGlzLmJpbkRlbiA9IDA7XHJcblxyXG4gICAgdGhpcy5ub3JUYXIgPSAwO1xyXG5cclxuICAgIHRoaXMubmV4dCA9IG51bGw7XHJcbiAgICB0aGlzLmxhc3QgPSBmYWxzZTtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIC4uLlxyXG4gICogQGF1dGhvciBzYWhhcmFuXHJcbiAgKi9cclxuICBmdW5jdGlvbiBDb250YWN0Q29uc3RyYWludChtYW5pZm9sZCkge1xyXG5cclxuICAgIENvbnN0cmFpbnQuY2FsbCh0aGlzKTtcclxuICAgIC8vIFRoZSBjb250YWN0IG1hbmlmb2xkIG9mIHRoZSBjb25zdHJhaW50LlxyXG4gICAgdGhpcy5tYW5pZm9sZCA9IG1hbmlmb2xkO1xyXG4gICAgLy8gVGhlIGNvZWZmaWNpZW50IG9mIHJlc3RpdHV0aW9uIG9mIHRoZSBjb25zdHJhaW50LlxyXG4gICAgdGhpcy5yZXN0aXR1dGlvbiA9IE5hTjtcclxuICAgIC8vIFRoZSBjb2VmZmljaWVudCBvZiBmcmljdGlvbiBvZiB0aGUgY29uc3RyYWludC5cclxuICAgIHRoaXMuZnJpY3Rpb24gPSBOYU47XHJcbiAgICB0aGlzLnAxID0gbnVsbDtcclxuICAgIHRoaXMucDIgPSBudWxsO1xyXG4gICAgdGhpcy5sdjEgPSBudWxsO1xyXG4gICAgdGhpcy5sdjIgPSBudWxsO1xyXG4gICAgdGhpcy5hdjEgPSBudWxsO1xyXG4gICAgdGhpcy5hdjIgPSBudWxsO1xyXG4gICAgdGhpcy5pMSA9IG51bGw7XHJcbiAgICB0aGlzLmkyID0gbnVsbDtcclxuXHJcbiAgICAvL3RoaXMuaWkxID0gbnVsbDtcclxuICAgIC8vdGhpcy5paTIgPSBudWxsO1xyXG5cclxuICAgIHRoaXMudG1wID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMudG1wQzEgPSBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy50bXBDMiA9IG5ldyBWZWMzKCk7XHJcblxyXG4gICAgdGhpcy50bXBQMSA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLnRtcFAyID0gbmV3IFZlYzMoKTtcclxuXHJcbiAgICB0aGlzLnRtcGx2MSA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLnRtcGx2MiA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLnRtcGF2MSA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLnRtcGF2MiA9IG5ldyBWZWMzKCk7XHJcblxyXG4gICAgdGhpcy5tMSA9IE5hTjtcclxuICAgIHRoaXMubTIgPSBOYU47XHJcbiAgICB0aGlzLm51bSA9IDA7XHJcblxyXG4gICAgdGhpcy5wcyA9IG1hbmlmb2xkLnBvaW50cztcclxuICAgIHRoaXMuY3MgPSBuZXcgQ29udGFjdFBvaW50RGF0YUJ1ZmZlcigpO1xyXG4gICAgdGhpcy5jcy5uZXh0ID0gbmV3IENvbnRhY3RQb2ludERhdGFCdWZmZXIoKTtcclxuICAgIHRoaXMuY3MubmV4dC5uZXh0ID0gbmV3IENvbnRhY3RQb2ludERhdGFCdWZmZXIoKTtcclxuICAgIHRoaXMuY3MubmV4dC5uZXh0Lm5leHQgPSBuZXcgQ29udGFjdFBvaW50RGF0YUJ1ZmZlcigpO1xyXG4gIH1cclxuXHJcbiAgQ29udGFjdENvbnN0cmFpbnQucHJvdG90eXBlID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKENvbnN0cmFpbnQucHJvdG90eXBlKSwge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yOiBDb250YWN0Q29uc3RyYWludCxcclxuXHJcbiAgICAvLyBBdHRhY2ggdGhlIGNvbnN0cmFpbnQgdG8gdGhlIGJvZGllcy5cclxuICAgIGF0dGFjaDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdGhpcy5wMSA9IHRoaXMuYm9keTEucG9zaXRpb247XHJcbiAgICAgIHRoaXMucDIgPSB0aGlzLmJvZHkyLnBvc2l0aW9uO1xyXG4gICAgICB0aGlzLmx2MSA9IHRoaXMuYm9keTEubGluZWFyVmVsb2NpdHk7XHJcbiAgICAgIHRoaXMuYXYxID0gdGhpcy5ib2R5MS5hbmd1bGFyVmVsb2NpdHk7XHJcbiAgICAgIHRoaXMubHYyID0gdGhpcy5ib2R5Mi5saW5lYXJWZWxvY2l0eTtcclxuICAgICAgdGhpcy5hdjIgPSB0aGlzLmJvZHkyLmFuZ3VsYXJWZWxvY2l0eTtcclxuICAgICAgdGhpcy5pMSA9IHRoaXMuYm9keTEuaW52ZXJzZUluZXJ0aWE7XHJcbiAgICAgIHRoaXMuaTIgPSB0aGlzLmJvZHkyLmludmVyc2VJbmVydGlhO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gRGV0YWNoIHRoZSBjb25zdHJhaW50IGZyb20gdGhlIGJvZGllcy5cclxuICAgIGRldGFjaDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdGhpcy5wMSA9IG51bGw7XHJcbiAgICAgIHRoaXMucDIgPSBudWxsO1xyXG4gICAgICB0aGlzLmx2MSA9IG51bGw7XHJcbiAgICAgIHRoaXMubHYyID0gbnVsbDtcclxuICAgICAgdGhpcy5hdjEgPSBudWxsO1xyXG4gICAgICB0aGlzLmF2MiA9IG51bGw7XHJcbiAgICAgIHRoaXMuaTEgPSBudWxsO1xyXG4gICAgICB0aGlzLmkyID0gbnVsbDtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHByZVNvbHZlOiBmdW5jdGlvbiAodGltZVN0ZXAsIGludlRpbWVTdGVwKSB7XHJcblxyXG4gICAgICB0aGlzLm0xID0gdGhpcy5ib2R5MS5pbnZlcnNlTWFzcztcclxuICAgICAgdGhpcy5tMiA9IHRoaXMuYm9keTIuaW52ZXJzZU1hc3M7XHJcblxyXG4gICAgICB2YXIgbTFtMiA9IHRoaXMubTEgKyB0aGlzLm0yO1xyXG5cclxuICAgICAgdGhpcy5udW0gPSB0aGlzLm1hbmlmb2xkLm51bVBvaW50cztcclxuXHJcbiAgICAgIHZhciBjID0gdGhpcy5jcztcclxuICAgICAgdmFyIHAsIHJ2biwgbGVuLCBub3JJbXAsIG5vclRhciwgc2VwViwgaTEsIGkyO1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubnVtOyBpKyspIHtcclxuXHJcbiAgICAgICAgcCA9IHRoaXMucHNbaV07XHJcblxyXG4gICAgICAgIHRoaXMudG1wUDEuc3ViKHAucG9zaXRpb24sIHRoaXMucDEpO1xyXG4gICAgICAgIHRoaXMudG1wUDIuc3ViKHAucG9zaXRpb24sIHRoaXMucDIpO1xyXG5cclxuICAgICAgICB0aGlzLnRtcEMxLmNyb3NzVmVjdG9ycyh0aGlzLmF2MSwgdGhpcy50bXBQMSk7XHJcbiAgICAgICAgdGhpcy50bXBDMi5jcm9zc1ZlY3RvcnModGhpcy5hdjIsIHRoaXMudG1wUDIpO1xyXG5cclxuICAgICAgICBjLm5vckltcCA9IHAubm9ybWFsSW1wdWxzZTtcclxuICAgICAgICBjLnRhbkltcCA9IHAudGFuZ2VudEltcHVsc2U7XHJcbiAgICAgICAgYy5iaW5JbXAgPSBwLmJpbm9ybWFsSW1wdWxzZTtcclxuXHJcbiAgICAgICAgYy5ub3IuY29weShwLm5vcm1hbCk7XHJcblxyXG4gICAgICAgIHRoaXMudG1wLnNldChcclxuXHJcbiAgICAgICAgICAodGhpcy5sdjIueCArIHRoaXMudG1wQzIueCkgLSAodGhpcy5sdjEueCArIHRoaXMudG1wQzEueCksXHJcbiAgICAgICAgICAodGhpcy5sdjIueSArIHRoaXMudG1wQzIueSkgLSAodGhpcy5sdjEueSArIHRoaXMudG1wQzEueSksXHJcbiAgICAgICAgICAodGhpcy5sdjIueiArIHRoaXMudG1wQzIueikgLSAodGhpcy5sdjEueiArIHRoaXMudG1wQzEueilcclxuXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcnZuID0gX01hdGguZG90VmVjdG9ycyhjLm5vciwgdGhpcy50bXApO1xyXG5cclxuICAgICAgICBjLnRhbi5zZXQoXHJcbiAgICAgICAgICB0aGlzLnRtcC54IC0gcnZuICogYy5ub3IueCxcclxuICAgICAgICAgIHRoaXMudG1wLnkgLSBydm4gKiBjLm5vci55LFxyXG4gICAgICAgICAgdGhpcy50bXAueiAtIHJ2biAqIGMubm9yLnpcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBsZW4gPSBfTWF0aC5kb3RWZWN0b3JzKGMudGFuLCBjLnRhbik7XHJcblxyXG4gICAgICAgIGlmIChsZW4gPD0gMC4wNCkge1xyXG4gICAgICAgICAgYy50YW4udGFuZ2VudChjLm5vcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjLnRhbi5ub3JtYWxpemUoKTtcclxuXHJcbiAgICAgICAgYy5iaW4uY3Jvc3NWZWN0b3JzKGMubm9yLCBjLnRhbik7XHJcblxyXG4gICAgICAgIGMubm9yVTEuc2NhbGUoYy5ub3IsIHRoaXMubTEpO1xyXG4gICAgICAgIGMubm9yVTIuc2NhbGUoYy5ub3IsIHRoaXMubTIpO1xyXG5cclxuICAgICAgICBjLnRhblUxLnNjYWxlKGMudGFuLCB0aGlzLm0xKTtcclxuICAgICAgICBjLnRhblUyLnNjYWxlKGMudGFuLCB0aGlzLm0yKTtcclxuXHJcbiAgICAgICAgYy5iaW5VMS5zY2FsZShjLmJpbiwgdGhpcy5tMSk7XHJcbiAgICAgICAgYy5iaW5VMi5zY2FsZShjLmJpbiwgdGhpcy5tMik7XHJcblxyXG4gICAgICAgIGMubm9yVDEuY3Jvc3NWZWN0b3JzKHRoaXMudG1wUDEsIGMubm9yKTtcclxuICAgICAgICBjLnRhblQxLmNyb3NzVmVjdG9ycyh0aGlzLnRtcFAxLCBjLnRhbik7XHJcbiAgICAgICAgYy5iaW5UMS5jcm9zc1ZlY3RvcnModGhpcy50bXBQMSwgYy5iaW4pO1xyXG5cclxuICAgICAgICBjLm5vclQyLmNyb3NzVmVjdG9ycyh0aGlzLnRtcFAyLCBjLm5vcik7XHJcbiAgICAgICAgYy50YW5UMi5jcm9zc1ZlY3RvcnModGhpcy50bXBQMiwgYy50YW4pO1xyXG4gICAgICAgIGMuYmluVDIuY3Jvc3NWZWN0b3JzKHRoaXMudG1wUDIsIGMuYmluKTtcclxuXHJcbiAgICAgICAgaTEgPSB0aGlzLmkxO1xyXG4gICAgICAgIGkyID0gdGhpcy5pMjtcclxuXHJcbiAgICAgICAgYy5ub3JUVTEuY29weShjLm5vclQxKS5hcHBseU1hdHJpeDMoaTEsIHRydWUpO1xyXG4gICAgICAgIGMudGFuVFUxLmNvcHkoYy50YW5UMSkuYXBwbHlNYXRyaXgzKGkxLCB0cnVlKTtcclxuICAgICAgICBjLmJpblRVMS5jb3B5KGMuYmluVDEpLmFwcGx5TWF0cml4MyhpMSwgdHJ1ZSk7XHJcblxyXG4gICAgICAgIGMubm9yVFUyLmNvcHkoYy5ub3JUMikuYXBwbHlNYXRyaXgzKGkyLCB0cnVlKTtcclxuICAgICAgICBjLnRhblRVMi5jb3B5KGMudGFuVDIpLmFwcGx5TWF0cml4MyhpMiwgdHJ1ZSk7XHJcbiAgICAgICAgYy5iaW5UVTIuY29weShjLmJpblQyKS5hcHBseU1hdHJpeDMoaTIsIHRydWUpO1xyXG5cclxuICAgICAgICAvKmMubm9yVFUxLm11bE1hdCggdGhpcy5pMSwgYy5ub3JUMSApO1xyXG4gICAgICAgIGMudGFuVFUxLm11bE1hdCggdGhpcy5pMSwgYy50YW5UMSApO1xyXG4gICAgICAgIGMuYmluVFUxLm11bE1hdCggdGhpcy5pMSwgYy5iaW5UMSApO1xyXG5cclxuICAgICAgICBjLm5vclRVMi5tdWxNYXQoIHRoaXMuaTIsIGMubm9yVDIgKTtcclxuICAgICAgICBjLnRhblRVMi5tdWxNYXQoIHRoaXMuaTIsIGMudGFuVDIgKTtcclxuICAgICAgICBjLmJpblRVMi5tdWxNYXQoIHRoaXMuaTIsIGMuYmluVDIgKTsqL1xyXG5cclxuICAgICAgICB0aGlzLnRtcEMxLmNyb3NzVmVjdG9ycyhjLm5vclRVMSwgdGhpcy50bXBQMSk7XHJcbiAgICAgICAgdGhpcy50bXBDMi5jcm9zc1ZlY3RvcnMoYy5ub3JUVTIsIHRoaXMudG1wUDIpO1xyXG4gICAgICAgIHRoaXMudG1wLmFkZCh0aGlzLnRtcEMxLCB0aGlzLnRtcEMyKTtcclxuICAgICAgICBjLm5vckRlbiA9IDEgLyAobTFtMiArIF9NYXRoLmRvdFZlY3RvcnMoYy5ub3IsIHRoaXMudG1wKSk7XHJcblxyXG4gICAgICAgIHRoaXMudG1wQzEuY3Jvc3NWZWN0b3JzKGMudGFuVFUxLCB0aGlzLnRtcFAxKTtcclxuICAgICAgICB0aGlzLnRtcEMyLmNyb3NzVmVjdG9ycyhjLnRhblRVMiwgdGhpcy50bXBQMik7XHJcbiAgICAgICAgdGhpcy50bXAuYWRkKHRoaXMudG1wQzEsIHRoaXMudG1wQzIpO1xyXG4gICAgICAgIGMudGFuRGVuID0gMSAvIChtMW0yICsgX01hdGguZG90VmVjdG9ycyhjLnRhbiwgdGhpcy50bXApKTtcclxuXHJcbiAgICAgICAgdGhpcy50bXBDMS5jcm9zc1ZlY3RvcnMoYy5iaW5UVTEsIHRoaXMudG1wUDEpO1xyXG4gICAgICAgIHRoaXMudG1wQzIuY3Jvc3NWZWN0b3JzKGMuYmluVFUyLCB0aGlzLnRtcFAyKTtcclxuICAgICAgICB0aGlzLnRtcC5hZGQodGhpcy50bXBDMSwgdGhpcy50bXBDMik7XHJcbiAgICAgICAgYy5iaW5EZW4gPSAxIC8gKG0xbTIgKyBfTWF0aC5kb3RWZWN0b3JzKGMuYmluLCB0aGlzLnRtcCkpO1xyXG5cclxuICAgICAgICBpZiAocC53YXJtU3RhcnRlZCkge1xyXG5cclxuICAgICAgICAgIG5vckltcCA9IHAubm9ybWFsSW1wdWxzZTtcclxuXHJcbiAgICAgICAgICB0aGlzLmx2MS5hZGRTY2FsZWRWZWN0b3IoYy5ub3JVMSwgbm9ySW1wKTtcclxuICAgICAgICAgIHRoaXMuYXYxLmFkZFNjYWxlZFZlY3RvcihjLm5vclRVMSwgbm9ySW1wKTtcclxuXHJcbiAgICAgICAgICB0aGlzLmx2Mi5zdWJTY2FsZWRWZWN0b3IoYy5ub3JVMiwgbm9ySW1wKTtcclxuICAgICAgICAgIHRoaXMuYXYyLnN1YlNjYWxlZFZlY3RvcihjLm5vclRVMiwgbm9ySW1wKTtcclxuXHJcbiAgICAgICAgICBjLm5vckltcCA9IG5vckltcDtcclxuICAgICAgICAgIGMudGFuSW1wID0gMDtcclxuICAgICAgICAgIGMuYmluSW1wID0gMDtcclxuICAgICAgICAgIHJ2biA9IDA7IC8vIGRpc2FibGUgYm91bmNpbmdcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICBjLm5vckltcCA9IDA7XHJcbiAgICAgICAgICBjLnRhbkltcCA9IDA7XHJcbiAgICAgICAgICBjLmJpbkltcCA9IDA7XHJcblxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGlmIChydm4gPiAtMSkgcnZuID0gMDsgLy8gZGlzYWJsZSBib3VuY2luZ1xyXG5cclxuICAgICAgICBub3JUYXIgPSB0aGlzLnJlc3RpdHV0aW9uICogLXJ2bjtcclxuICAgICAgICBzZXBWID0gLShwLnBlbmV0cmF0aW9uICsgMC4wMDUpICogaW52VGltZVN0ZXAgKiAwLjA1OyAvLyBhbGxvdyAwLjVjbSBlcnJvclxyXG4gICAgICAgIGlmIChub3JUYXIgPCBzZXBWKSBub3JUYXIgPSBzZXBWO1xyXG4gICAgICAgIGMubm9yVGFyID0gbm9yVGFyO1xyXG4gICAgICAgIGMubGFzdCA9IGkgPT0gdGhpcy5udW0gLSAxO1xyXG4gICAgICAgIGMgPSBjLm5leHQ7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgc29sdmU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHRoaXMudG1wbHYxLmNvcHkodGhpcy5sdjEpO1xyXG4gICAgICB0aGlzLnRtcGx2Mi5jb3B5KHRoaXMubHYyKTtcclxuICAgICAgdGhpcy50bXBhdjEuY29weSh0aGlzLmF2MSk7XHJcbiAgICAgIHRoaXMudG1wYXYyLmNvcHkodGhpcy5hdjIpO1xyXG5cclxuICAgICAgdmFyIG9sZEltcDEsIG5ld0ltcDEsIG9sZEltcDIsIG5ld0ltcDIsIHJ2biwgbm9ySW1wLCB0YW5JbXAsIGJpbkltcCwgbWF4LCBsZW47XHJcblxyXG4gICAgICB2YXIgYyA9IHRoaXMuY3M7XHJcblxyXG4gICAgICB3aGlsZSAodHJ1ZSkge1xyXG5cclxuICAgICAgICBub3JJbXAgPSBjLm5vckltcDtcclxuICAgICAgICB0YW5JbXAgPSBjLnRhbkltcDtcclxuICAgICAgICBiaW5JbXAgPSBjLmJpbkltcDtcclxuICAgICAgICBtYXggPSAtbm9ySW1wICogdGhpcy5mcmljdGlvbjtcclxuXHJcbiAgICAgICAgdGhpcy50bXAuc3ViKHRoaXMudG1wbHYyLCB0aGlzLnRtcGx2MSk7XHJcblxyXG4gICAgICAgIHJ2biA9IF9NYXRoLmRvdFZlY3RvcnModGhpcy50bXAsIGMudGFuKSArIF9NYXRoLmRvdFZlY3RvcnModGhpcy50bXBhdjIsIGMudGFuVDIpIC0gX01hdGguZG90VmVjdG9ycyh0aGlzLnRtcGF2MSwgYy50YW5UMSk7XHJcblxyXG4gICAgICAgIG9sZEltcDEgPSB0YW5JbXA7XHJcbiAgICAgICAgbmV3SW1wMSA9IHJ2biAqIGMudGFuRGVuO1xyXG4gICAgICAgIHRhbkltcCArPSBuZXdJbXAxO1xyXG5cclxuICAgICAgICBydm4gPSBfTWF0aC5kb3RWZWN0b3JzKHRoaXMudG1wLCBjLmJpbikgKyBfTWF0aC5kb3RWZWN0b3JzKHRoaXMudG1wYXYyLCBjLmJpblQyKSAtIF9NYXRoLmRvdFZlY3RvcnModGhpcy50bXBhdjEsIGMuYmluVDEpO1xyXG5cclxuICAgICAgICBvbGRJbXAyID0gYmluSW1wO1xyXG4gICAgICAgIG5ld0ltcDIgPSBydm4gKiBjLmJpbkRlbjtcclxuICAgICAgICBiaW5JbXAgKz0gbmV3SW1wMjtcclxuXHJcbiAgICAgICAgLy8gY29uZSBmcmljdGlvbiBjbGFtcFxyXG4gICAgICAgIGxlbiA9IHRhbkltcCAqIHRhbkltcCArIGJpbkltcCAqIGJpbkltcDtcclxuICAgICAgICBpZiAobGVuID4gbWF4ICogbWF4KSB7XHJcbiAgICAgICAgICBsZW4gPSBtYXggLyBfTWF0aC5zcXJ0KGxlbik7XHJcbiAgICAgICAgICB0YW5JbXAgKj0gbGVuO1xyXG4gICAgICAgICAgYmluSW1wICo9IGxlbjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG5ld0ltcDEgPSB0YW5JbXAgLSBvbGRJbXAxO1xyXG4gICAgICAgIG5ld0ltcDIgPSBiaW5JbXAgLSBvbGRJbXAyO1xyXG5cclxuICAgICAgICAvL1xyXG5cclxuICAgICAgICB0aGlzLnRtcC5zZXQoXHJcbiAgICAgICAgICBjLnRhblUxLnggKiBuZXdJbXAxICsgYy5iaW5VMS54ICogbmV3SW1wMixcclxuICAgICAgICAgIGMudGFuVTEueSAqIG5ld0ltcDEgKyBjLmJpblUxLnkgKiBuZXdJbXAyLFxyXG4gICAgICAgICAgYy50YW5VMS56ICogbmV3SW1wMSArIGMuYmluVTEueiAqIG5ld0ltcDJcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICB0aGlzLnRtcGx2MS5hZGRFcXVhbCh0aGlzLnRtcCk7XHJcblxyXG4gICAgICAgIHRoaXMudG1wLnNldChcclxuICAgICAgICAgIGMudGFuVFUxLnggKiBuZXdJbXAxICsgYy5iaW5UVTEueCAqIG5ld0ltcDIsXHJcbiAgICAgICAgICBjLnRhblRVMS55ICogbmV3SW1wMSArIGMuYmluVFUxLnkgKiBuZXdJbXAyLFxyXG4gICAgICAgICAgYy50YW5UVTEueiAqIG5ld0ltcDEgKyBjLmJpblRVMS56ICogbmV3SW1wMlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHRoaXMudG1wYXYxLmFkZEVxdWFsKHRoaXMudG1wKTtcclxuXHJcbiAgICAgICAgdGhpcy50bXAuc2V0KFxyXG4gICAgICAgICAgYy50YW5VMi54ICogbmV3SW1wMSArIGMuYmluVTIueCAqIG5ld0ltcDIsXHJcbiAgICAgICAgICBjLnRhblUyLnkgKiBuZXdJbXAxICsgYy5iaW5VMi55ICogbmV3SW1wMixcclxuICAgICAgICAgIGMudGFuVTIueiAqIG5ld0ltcDEgKyBjLmJpblUyLnogKiBuZXdJbXAyXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgdGhpcy50bXBsdjIuc3ViRXF1YWwodGhpcy50bXApO1xyXG5cclxuICAgICAgICB0aGlzLnRtcC5zZXQoXHJcbiAgICAgICAgICBjLnRhblRVMi54ICogbmV3SW1wMSArIGMuYmluVFUyLnggKiBuZXdJbXAyLFxyXG4gICAgICAgICAgYy50YW5UVTIueSAqIG5ld0ltcDEgKyBjLmJpblRVMi55ICogbmV3SW1wMixcclxuICAgICAgICAgIGMudGFuVFUyLnogKiBuZXdJbXAxICsgYy5iaW5UVTIueiAqIG5ld0ltcDJcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICB0aGlzLnRtcGF2Mi5zdWJFcXVhbCh0aGlzLnRtcCk7XHJcblxyXG4gICAgICAgIC8vIHJlc3RpdHV0aW9uIHBhcnRcclxuXHJcbiAgICAgICAgdGhpcy50bXAuc3ViKHRoaXMudG1wbHYyLCB0aGlzLnRtcGx2MSk7XHJcblxyXG4gICAgICAgIHJ2biA9IF9NYXRoLmRvdFZlY3RvcnModGhpcy50bXAsIGMubm9yKSArIF9NYXRoLmRvdFZlY3RvcnModGhpcy50bXBhdjIsIGMubm9yVDIpIC0gX01hdGguZG90VmVjdG9ycyh0aGlzLnRtcGF2MSwgYy5ub3JUMSk7XHJcblxyXG4gICAgICAgIG9sZEltcDEgPSBub3JJbXA7XHJcbiAgICAgICAgbmV3SW1wMSA9IChydm4gLSBjLm5vclRhcikgKiBjLm5vckRlbjtcclxuICAgICAgICBub3JJbXAgKz0gbmV3SW1wMTtcclxuICAgICAgICBpZiAobm9ySW1wID4gMCkgbm9ySW1wID0gMDtcclxuXHJcbiAgICAgICAgbmV3SW1wMSA9IG5vckltcCAtIG9sZEltcDE7XHJcblxyXG4gICAgICAgIHRoaXMudG1wbHYxLmFkZFNjYWxlZFZlY3RvcihjLm5vclUxLCBuZXdJbXAxKTtcclxuICAgICAgICB0aGlzLnRtcGF2MS5hZGRTY2FsZWRWZWN0b3IoYy5ub3JUVTEsIG5ld0ltcDEpO1xyXG4gICAgICAgIHRoaXMudG1wbHYyLnN1YlNjYWxlZFZlY3RvcihjLm5vclUyLCBuZXdJbXAxKTtcclxuICAgICAgICB0aGlzLnRtcGF2Mi5zdWJTY2FsZWRWZWN0b3IoYy5ub3JUVTIsIG5ld0ltcDEpO1xyXG5cclxuICAgICAgICBjLm5vckltcCA9IG5vckltcDtcclxuICAgICAgICBjLnRhbkltcCA9IHRhbkltcDtcclxuICAgICAgICBjLmJpbkltcCA9IGJpbkltcDtcclxuXHJcbiAgICAgICAgaWYgKGMubGFzdCkgYnJlYWs7XHJcbiAgICAgICAgYyA9IGMubmV4dDtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5sdjEuY29weSh0aGlzLnRtcGx2MSk7XHJcbiAgICAgIHRoaXMubHYyLmNvcHkodGhpcy50bXBsdjIpO1xyXG4gICAgICB0aGlzLmF2MS5jb3B5KHRoaXMudG1wYXYxKTtcclxuICAgICAgdGhpcy5hdjIuY29weSh0aGlzLnRtcGF2Mik7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBwb3N0U29sdmU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHZhciBjID0gdGhpcy5jcywgcDtcclxuICAgICAgdmFyIGkgPSB0aGlzLm51bTtcclxuICAgICAgd2hpbGUgKGktLSkge1xyXG4gICAgICAgIC8vZm9yKHZhciBpPTA7aTx0aGlzLm51bTtpKyspe1xyXG4gICAgICAgIHAgPSB0aGlzLnBzW2ldO1xyXG4gICAgICAgIHAubm9ybWFsLmNvcHkoYy5ub3IpO1xyXG4gICAgICAgIHAudGFuZ2VudC5jb3B5KGMudGFuKTtcclxuICAgICAgICBwLmJpbm9ybWFsLmNvcHkoYy5iaW4pO1xyXG5cclxuICAgICAgICBwLm5vcm1hbEltcHVsc2UgPSBjLm5vckltcDtcclxuICAgICAgICBwLnRhbmdlbnRJbXB1bHNlID0gYy50YW5JbXA7XHJcbiAgICAgICAgcC5iaW5vcm1hbEltcHVsc2UgPSBjLmJpbkltcDtcclxuICAgICAgICBwLm5vcm1hbERlbm9taW5hdG9yID0gYy5ub3JEZW47XHJcbiAgICAgICAgcC50YW5nZW50RGVub21pbmF0b3IgPSBjLnRhbkRlbjtcclxuICAgICAgICBwLmJpbm9ybWFsRGVub21pbmF0b3IgPSBjLmJpbkRlbjtcclxuICAgICAgICBjID0gYy5uZXh0O1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAvKipcclxuICAqIEEgY29udGFjdCBpcyBhIHBhaXIgb2Ygc2hhcGVzIHdob3NlIGF4aXMtYWxpZ25lZCBib3VuZGluZyBib3hlcyBhcmUgb3ZlcmxhcHBpbmcuXHJcbiAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAqL1xyXG5cclxuICBmdW5jdGlvbiBDb250YWN0KCkge1xyXG5cclxuICAgIC8vIFRoZSBmaXJzdCBzaGFwZS5cclxuICAgIHRoaXMuc2hhcGUxID0gbnVsbDtcclxuICAgIC8vIFRoZSBzZWNvbmQgc2hhcGUuXHJcbiAgICB0aGlzLnNoYXBlMiA9IG51bGw7XHJcbiAgICAvLyBUaGUgZmlyc3QgcmlnaWQgYm9keS5cclxuICAgIHRoaXMuYm9keTEgPSBudWxsO1xyXG4gICAgLy8gVGhlIHNlY29uZCByaWdpZCBib2R5LlxyXG4gICAgdGhpcy5ib2R5MiA9IG51bGw7XHJcbiAgICAvLyBUaGUgcHJldmlvdXMgY29udGFjdCBpbiB0aGUgd29ybGQuXHJcbiAgICB0aGlzLnByZXYgPSBudWxsO1xyXG4gICAgLy8gVGhlIG5leHQgY29udGFjdCBpbiB0aGUgd29ybGQuXHJcbiAgICB0aGlzLm5leHQgPSBudWxsO1xyXG4gICAgLy8gSW50ZXJuYWxcclxuICAgIHRoaXMucGVyc2lzdGluZyA9IGZhbHNlO1xyXG4gICAgLy8gV2hldGhlciBib3RoIHRoZSByaWdpZCBib2RpZXMgYXJlIHNsZWVwaW5nIG9yIG5vdC5cclxuICAgIHRoaXMuc2xlZXBpbmcgPSBmYWxzZTtcclxuICAgIC8vIFRoZSBjb2xsaXNpb24gZGV0ZWN0b3IgYmV0d2VlbiB0d28gc2hhcGVzLlxyXG4gICAgdGhpcy5kZXRlY3RvciA9IG51bGw7XHJcbiAgICAvLyBUaGUgY29udGFjdCBjb25zdHJhaW50IG9mIHRoZSBjb250YWN0LlxyXG4gICAgdGhpcy5jb25zdHJhaW50ID0gbnVsbDtcclxuICAgIC8vIFdoZXRoZXIgdGhlIHNoYXBlcyBhcmUgdG91Y2hpbmcgb3Igbm90LlxyXG4gICAgdGhpcy50b3VjaGluZyA9IGZhbHNlO1xyXG4gICAgLy8gc2hhcGVzIGlzIHZlcnkgY2xvc2UgYW5kIHRvdWNoaW5nIFxyXG4gICAgdGhpcy5jbG9zZSA9IGZhbHNlO1xyXG5cclxuICAgIHRoaXMuZGlzdCA9IF9NYXRoLklORjtcclxuXHJcbiAgICB0aGlzLmIxTGluayA9IG5ldyBDb250YWN0TGluayh0aGlzKTtcclxuICAgIHRoaXMuYjJMaW5rID0gbmV3IENvbnRhY3RMaW5rKHRoaXMpO1xyXG4gICAgdGhpcy5zMUxpbmsgPSBuZXcgQ29udGFjdExpbmsodGhpcyk7XHJcbiAgICB0aGlzLnMyTGluayA9IG5ldyBDb250YWN0TGluayh0aGlzKTtcclxuXHJcbiAgICAvLyBUaGUgY29udGFjdCBtYW5pZm9sZCBvZiB0aGUgY29udGFjdC5cclxuICAgIHRoaXMubWFuaWZvbGQgPSBuZXcgQ29udGFjdE1hbmlmb2xkKCk7XHJcblxyXG4gICAgdGhpcy5idWZmZXIgPSBbXHJcblxyXG4gICAgICBuZXcgSW1wdWxzZURhdGFCdWZmZXIoKSxcclxuICAgICAgbmV3IEltcHVsc2VEYXRhQnVmZmVyKCksXHJcbiAgICAgIG5ldyBJbXB1bHNlRGF0YUJ1ZmZlcigpLFxyXG4gICAgICBuZXcgSW1wdWxzZURhdGFCdWZmZXIoKVxyXG5cclxuICAgIF07XHJcblxyXG4gICAgdGhpcy5wb2ludHMgPSB0aGlzLm1hbmlmb2xkLnBvaW50cztcclxuICAgIHRoaXMuY29uc3RyYWludCA9IG5ldyBDb250YWN0Q29uc3RyYWludCh0aGlzLm1hbmlmb2xkKTtcclxuXHJcbiAgfVxyXG5cclxuICBPYmplY3QuYXNzaWduKENvbnRhY3QucHJvdG90eXBlLCB7XHJcblxyXG4gICAgQ29udGFjdDogdHJ1ZSxcclxuXHJcbiAgICBtaXhSZXN0aXR1dGlvbjogZnVuY3Rpb24gKHJlc3RpdHV0aW9uMSwgcmVzdGl0dXRpb24yKSB7XHJcblxyXG4gICAgICByZXR1cm4gX01hdGguc3FydChyZXN0aXR1dGlvbjEgKiByZXN0aXR1dGlvbjIpO1xyXG5cclxuICAgIH0sXHJcbiAgICBtaXhGcmljdGlvbjogZnVuY3Rpb24gKGZyaWN0aW9uMSwgZnJpY3Rpb24yKSB7XHJcblxyXG4gICAgICByZXR1cm4gX01hdGguc3FydChmcmljdGlvbjEgKiBmcmljdGlvbjIpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAqIFVwZGF0ZSB0aGUgY29udGFjdCBtYW5pZm9sZC5cclxuICAgICovXHJcbiAgICB1cGRhdGVNYW5pZm9sZDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdGhpcy5jb25zdHJhaW50LnJlc3RpdHV0aW9uID0gdGhpcy5taXhSZXN0aXR1dGlvbih0aGlzLnNoYXBlMS5yZXN0aXR1dGlvbiwgdGhpcy5zaGFwZTIucmVzdGl0dXRpb24pO1xyXG4gICAgICB0aGlzLmNvbnN0cmFpbnQuZnJpY3Rpb24gPSB0aGlzLm1peEZyaWN0aW9uKHRoaXMuc2hhcGUxLmZyaWN0aW9uLCB0aGlzLnNoYXBlMi5mcmljdGlvbik7XHJcbiAgICAgIHZhciBudW1CdWZmZXJzID0gdGhpcy5tYW5pZm9sZC5udW1Qb2ludHM7XHJcbiAgICAgIHZhciBpID0gbnVtQnVmZmVycztcclxuICAgICAgd2hpbGUgKGktLSkge1xyXG4gICAgICAgIC8vZm9yKHZhciBpPTA7aTxudW1CdWZmZXJzO2krKyl7XHJcbiAgICAgICAgdmFyIGIgPSB0aGlzLmJ1ZmZlcltpXTtcclxuICAgICAgICB2YXIgcCA9IHRoaXMucG9pbnRzW2ldO1xyXG4gICAgICAgIGIubHAxWCA9IHAubG9jYWxQb2ludDEueDtcclxuICAgICAgICBiLmxwMVkgPSBwLmxvY2FsUG9pbnQxLnk7XHJcbiAgICAgICAgYi5scDFaID0gcC5sb2NhbFBvaW50MS56O1xyXG4gICAgICAgIGIubHAyWCA9IHAubG9jYWxQb2ludDIueDtcclxuICAgICAgICBiLmxwMlkgPSBwLmxvY2FsUG9pbnQyLnk7XHJcbiAgICAgICAgYi5scDJaID0gcC5sb2NhbFBvaW50Mi56O1xyXG4gICAgICAgIGIuaW1wdWxzZSA9IHAubm9ybWFsSW1wdWxzZTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLm1hbmlmb2xkLm51bVBvaW50cyA9IDA7XHJcbiAgICAgIHRoaXMuZGV0ZWN0b3IuZGV0ZWN0Q29sbGlzaW9uKHRoaXMuc2hhcGUxLCB0aGlzLnNoYXBlMiwgdGhpcy5tYW5pZm9sZCk7XHJcbiAgICAgIHZhciBudW0gPSB0aGlzLm1hbmlmb2xkLm51bVBvaW50cztcclxuICAgICAgaWYgKG51bSA9PSAwKSB7XHJcbiAgICAgICAgdGhpcy50b3VjaGluZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuY2xvc2UgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmRpc3QgPSBfTWF0aC5JTkY7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAodGhpcy50b3VjaGluZyB8fCB0aGlzLmRpc3QgPCAwLjAwMSkgdGhpcy5jbG9zZSA9IHRydWU7XHJcbiAgICAgIHRoaXMudG91Y2hpbmcgPSB0cnVlO1xyXG4gICAgICBpID0gbnVtO1xyXG4gICAgICB3aGlsZSAoaS0tKSB7XHJcbiAgICAgICAgLy9mb3IoaT0wOyBpPG51bTsgaSsrKXtcclxuICAgICAgICBwID0gdGhpcy5wb2ludHNbaV07XHJcbiAgICAgICAgdmFyIGxwMXggPSBwLmxvY2FsUG9pbnQxLng7XHJcbiAgICAgICAgdmFyIGxwMXkgPSBwLmxvY2FsUG9pbnQxLnk7XHJcbiAgICAgICAgdmFyIGxwMXogPSBwLmxvY2FsUG9pbnQxLno7XHJcbiAgICAgICAgdmFyIGxwMnggPSBwLmxvY2FsUG9pbnQyLng7XHJcbiAgICAgICAgdmFyIGxwMnkgPSBwLmxvY2FsUG9pbnQyLnk7XHJcbiAgICAgICAgdmFyIGxwMnogPSBwLmxvY2FsUG9pbnQyLno7XHJcbiAgICAgICAgdmFyIGluZGV4ID0gLTE7XHJcbiAgICAgICAgdmFyIG1pbkRpc3RhbmNlID0gMC4wMDA0O1xyXG4gICAgICAgIHZhciBqID0gbnVtQnVmZmVycztcclxuICAgICAgICB3aGlsZSAoai0tKSB7XHJcbiAgICAgICAgICAvL2Zvcih2YXIgaj0wO2o8bnVtQnVmZmVycztqKyspe1xyXG4gICAgICAgICAgYiA9IHRoaXMuYnVmZmVyW2pdO1xyXG4gICAgICAgICAgdmFyIGR4ID0gYi5scDFYIC0gbHAxeDtcclxuICAgICAgICAgIHZhciBkeSA9IGIubHAxWSAtIGxwMXk7XHJcbiAgICAgICAgICB2YXIgZHogPSBiLmxwMVogLSBscDF6O1xyXG4gICAgICAgICAgdmFyIGRpc3RhbmNlMSA9IGR4ICogZHggKyBkeSAqIGR5ICsgZHogKiBkejtcclxuICAgICAgICAgIGR4ID0gYi5scDJYIC0gbHAyeDtcclxuICAgICAgICAgIGR5ID0gYi5scDJZIC0gbHAyeTtcclxuICAgICAgICAgIGR6ID0gYi5scDJaIC0gbHAyejtcclxuICAgICAgICAgIHZhciBkaXN0YW5jZTIgPSBkeCAqIGR4ICsgZHkgKiBkeSArIGR6ICogZHo7XHJcbiAgICAgICAgICBpZiAoZGlzdGFuY2UxIDwgZGlzdGFuY2UyKSB7XHJcbiAgICAgICAgICAgIGlmIChkaXN0YW5jZTEgPCBtaW5EaXN0YW5jZSkge1xyXG4gICAgICAgICAgICAgIG1pbkRpc3RhbmNlID0gZGlzdGFuY2UxO1xyXG4gICAgICAgICAgICAgIGluZGV4ID0gajtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGRpc3RhbmNlMiA8IG1pbkRpc3RhbmNlKSB7XHJcbiAgICAgICAgICAgICAgbWluRGlzdGFuY2UgPSBkaXN0YW5jZTI7XHJcbiAgICAgICAgICAgICAgaW5kZXggPSBqO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgaWYgKG1pbkRpc3RhbmNlIDwgdGhpcy5kaXN0KSB0aGlzLmRpc3QgPSBtaW5EaXN0YW5jZTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpbmRleCAhPSAtMSkge1xyXG4gICAgICAgICAgdmFyIHRtcCA9IHRoaXMuYnVmZmVyW2luZGV4XTtcclxuICAgICAgICAgIHRoaXMuYnVmZmVyW2luZGV4XSA9IHRoaXMuYnVmZmVyWy0tbnVtQnVmZmVyc107XHJcbiAgICAgICAgICB0aGlzLmJ1ZmZlcltudW1CdWZmZXJzXSA9IHRtcDtcclxuICAgICAgICAgIHAubm9ybWFsSW1wdWxzZSA9IHRtcC5pbXB1bHNlO1xyXG4gICAgICAgICAgcC53YXJtU3RhcnRlZCA9IHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHAubm9ybWFsSW1wdWxzZSA9IDA7XHJcbiAgICAgICAgICBwLndhcm1TdGFydGVkID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAqIEF0dGFjaCB0aGUgY29udGFjdCB0byB0aGUgc2hhcGVzLlxyXG4gICAgKiBAcGFyYW0gICBzaGFwZTFcclxuICAgICogQHBhcmFtICAgc2hhcGUyXHJcbiAgICAqL1xyXG4gICAgYXR0YWNoOiBmdW5jdGlvbiAoc2hhcGUxLCBzaGFwZTIpIHtcclxuICAgICAgdGhpcy5zaGFwZTEgPSBzaGFwZTE7XHJcbiAgICAgIHRoaXMuc2hhcGUyID0gc2hhcGUyO1xyXG4gICAgICB0aGlzLmJvZHkxID0gc2hhcGUxLnBhcmVudDtcclxuICAgICAgdGhpcy5ib2R5MiA9IHNoYXBlMi5wYXJlbnQ7XHJcblxyXG4gICAgICB0aGlzLm1hbmlmb2xkLmJvZHkxID0gdGhpcy5ib2R5MTtcclxuICAgICAgdGhpcy5tYW5pZm9sZC5ib2R5MiA9IHRoaXMuYm9keTI7XHJcbiAgICAgIHRoaXMuY29uc3RyYWludC5ib2R5MSA9IHRoaXMuYm9keTE7XHJcbiAgICAgIHRoaXMuY29uc3RyYWludC5ib2R5MiA9IHRoaXMuYm9keTI7XHJcbiAgICAgIHRoaXMuY29uc3RyYWludC5hdHRhY2goKTtcclxuXHJcbiAgICAgIHRoaXMuczFMaW5rLnNoYXBlID0gc2hhcGUyO1xyXG4gICAgICB0aGlzLnMxTGluay5ib2R5ID0gdGhpcy5ib2R5MjtcclxuICAgICAgdGhpcy5zMkxpbmsuc2hhcGUgPSBzaGFwZTE7XHJcbiAgICAgIHRoaXMuczJMaW5rLmJvZHkgPSB0aGlzLmJvZHkxO1xyXG5cclxuICAgICAgaWYgKHNoYXBlMS5jb250YWN0TGluayAhPSBudWxsKSAodGhpcy5zMUxpbmsubmV4dCA9IHNoYXBlMS5jb250YWN0TGluaykucHJldiA9IHRoaXMuczFMaW5rO1xyXG4gICAgICBlbHNlIHRoaXMuczFMaW5rLm5leHQgPSBudWxsO1xyXG4gICAgICBzaGFwZTEuY29udGFjdExpbmsgPSB0aGlzLnMxTGluaztcclxuICAgICAgc2hhcGUxLm51bUNvbnRhY3RzKys7XHJcblxyXG4gICAgICBpZiAoc2hhcGUyLmNvbnRhY3RMaW5rICE9IG51bGwpICh0aGlzLnMyTGluay5uZXh0ID0gc2hhcGUyLmNvbnRhY3RMaW5rKS5wcmV2ID0gdGhpcy5zMkxpbms7XHJcbiAgICAgIGVsc2UgdGhpcy5zMkxpbmsubmV4dCA9IG51bGw7XHJcbiAgICAgIHNoYXBlMi5jb250YWN0TGluayA9IHRoaXMuczJMaW5rO1xyXG4gICAgICBzaGFwZTIubnVtQ29udGFjdHMrKztcclxuXHJcbiAgICAgIHRoaXMuYjFMaW5rLnNoYXBlID0gc2hhcGUyO1xyXG4gICAgICB0aGlzLmIxTGluay5ib2R5ID0gdGhpcy5ib2R5MjtcclxuICAgICAgdGhpcy5iMkxpbmsuc2hhcGUgPSBzaGFwZTE7XHJcbiAgICAgIHRoaXMuYjJMaW5rLmJvZHkgPSB0aGlzLmJvZHkxO1xyXG5cclxuICAgICAgaWYgKHRoaXMuYm9keTEuY29udGFjdExpbmsgIT0gbnVsbCkgKHRoaXMuYjFMaW5rLm5leHQgPSB0aGlzLmJvZHkxLmNvbnRhY3RMaW5rKS5wcmV2ID0gdGhpcy5iMUxpbms7XHJcbiAgICAgIGVsc2UgdGhpcy5iMUxpbmsubmV4dCA9IG51bGw7XHJcbiAgICAgIHRoaXMuYm9keTEuY29udGFjdExpbmsgPSB0aGlzLmIxTGluaztcclxuICAgICAgdGhpcy5ib2R5MS5udW1Db250YWN0cysrO1xyXG5cclxuICAgICAgaWYgKHRoaXMuYm9keTIuY29udGFjdExpbmsgIT0gbnVsbCkgKHRoaXMuYjJMaW5rLm5leHQgPSB0aGlzLmJvZHkyLmNvbnRhY3RMaW5rKS5wcmV2ID0gdGhpcy5iMkxpbms7XHJcbiAgICAgIGVsc2UgdGhpcy5iMkxpbmsubmV4dCA9IG51bGw7XHJcbiAgICAgIHRoaXMuYm9keTIuY29udGFjdExpbmsgPSB0aGlzLmIyTGluaztcclxuICAgICAgdGhpcy5ib2R5Mi5udW1Db250YWN0cysrO1xyXG5cclxuICAgICAgdGhpcy5wcmV2ID0gbnVsbDtcclxuICAgICAgdGhpcy5uZXh0ID0gbnVsbDtcclxuXHJcbiAgICAgIHRoaXMucGVyc2lzdGluZyA9IHRydWU7XHJcbiAgICAgIHRoaXMuc2xlZXBpbmcgPSB0aGlzLmJvZHkxLnNsZWVwaW5nICYmIHRoaXMuYm9keTIuc2xlZXBpbmc7XHJcbiAgICAgIHRoaXMubWFuaWZvbGQubnVtUG9pbnRzID0gMDtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICogRGV0YWNoIHRoZSBjb250YWN0IGZyb20gdGhlIHNoYXBlcy5cclxuICAgICovXHJcbiAgICBkZXRhY2g6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdmFyIHByZXYgPSB0aGlzLnMxTGluay5wcmV2O1xyXG4gICAgICB2YXIgbmV4dCA9IHRoaXMuczFMaW5rLm5leHQ7XHJcbiAgICAgIGlmIChwcmV2ICE9PSBudWxsKSBwcmV2Lm5leHQgPSBuZXh0O1xyXG4gICAgICBpZiAobmV4dCAhPT0gbnVsbCkgbmV4dC5wcmV2ID0gcHJldjtcclxuICAgICAgaWYgKHRoaXMuc2hhcGUxLmNvbnRhY3RMaW5rID09IHRoaXMuczFMaW5rKSB0aGlzLnNoYXBlMS5jb250YWN0TGluayA9IG5leHQ7XHJcbiAgICAgIHRoaXMuczFMaW5rLnByZXYgPSBudWxsO1xyXG4gICAgICB0aGlzLnMxTGluay5uZXh0ID0gbnVsbDtcclxuICAgICAgdGhpcy5zMUxpbmsuc2hhcGUgPSBudWxsO1xyXG4gICAgICB0aGlzLnMxTGluay5ib2R5ID0gbnVsbDtcclxuICAgICAgdGhpcy5zaGFwZTEubnVtQ29udGFjdHMtLTtcclxuXHJcbiAgICAgIHByZXYgPSB0aGlzLnMyTGluay5wcmV2O1xyXG4gICAgICBuZXh0ID0gdGhpcy5zMkxpbmsubmV4dDtcclxuICAgICAgaWYgKHByZXYgIT09IG51bGwpIHByZXYubmV4dCA9IG5leHQ7XHJcbiAgICAgIGlmIChuZXh0ICE9PSBudWxsKSBuZXh0LnByZXYgPSBwcmV2O1xyXG4gICAgICBpZiAodGhpcy5zaGFwZTIuY29udGFjdExpbmsgPT0gdGhpcy5zMkxpbmspIHRoaXMuc2hhcGUyLmNvbnRhY3RMaW5rID0gbmV4dDtcclxuICAgICAgdGhpcy5zMkxpbmsucHJldiA9IG51bGw7XHJcbiAgICAgIHRoaXMuczJMaW5rLm5leHQgPSBudWxsO1xyXG4gICAgICB0aGlzLnMyTGluay5zaGFwZSA9IG51bGw7XHJcbiAgICAgIHRoaXMuczJMaW5rLmJvZHkgPSBudWxsO1xyXG4gICAgICB0aGlzLnNoYXBlMi5udW1Db250YWN0cy0tO1xyXG5cclxuICAgICAgcHJldiA9IHRoaXMuYjFMaW5rLnByZXY7XHJcbiAgICAgIG5leHQgPSB0aGlzLmIxTGluay5uZXh0O1xyXG4gICAgICBpZiAocHJldiAhPT0gbnVsbCkgcHJldi5uZXh0ID0gbmV4dDtcclxuICAgICAgaWYgKG5leHQgIT09IG51bGwpIG5leHQucHJldiA9IHByZXY7XHJcbiAgICAgIGlmICh0aGlzLmJvZHkxLmNvbnRhY3RMaW5rID09IHRoaXMuYjFMaW5rKSB0aGlzLmJvZHkxLmNvbnRhY3RMaW5rID0gbmV4dDtcclxuICAgICAgdGhpcy5iMUxpbmsucHJldiA9IG51bGw7XHJcbiAgICAgIHRoaXMuYjFMaW5rLm5leHQgPSBudWxsO1xyXG4gICAgICB0aGlzLmIxTGluay5zaGFwZSA9IG51bGw7XHJcbiAgICAgIHRoaXMuYjFMaW5rLmJvZHkgPSBudWxsO1xyXG4gICAgICB0aGlzLmJvZHkxLm51bUNvbnRhY3RzLS07XHJcblxyXG4gICAgICBwcmV2ID0gdGhpcy5iMkxpbmsucHJldjtcclxuICAgICAgbmV4dCA9IHRoaXMuYjJMaW5rLm5leHQ7XHJcbiAgICAgIGlmIChwcmV2ICE9PSBudWxsKSBwcmV2Lm5leHQgPSBuZXh0O1xyXG4gICAgICBpZiAobmV4dCAhPT0gbnVsbCkgbmV4dC5wcmV2ID0gcHJldjtcclxuICAgICAgaWYgKHRoaXMuYm9keTIuY29udGFjdExpbmsgPT0gdGhpcy5iMkxpbmspIHRoaXMuYm9keTIuY29udGFjdExpbmsgPSBuZXh0O1xyXG4gICAgICB0aGlzLmIyTGluay5wcmV2ID0gbnVsbDtcclxuICAgICAgdGhpcy5iMkxpbmsubmV4dCA9IG51bGw7XHJcbiAgICAgIHRoaXMuYjJMaW5rLnNoYXBlID0gbnVsbDtcclxuICAgICAgdGhpcy5iMkxpbmsuYm9keSA9IG51bGw7XHJcbiAgICAgIHRoaXMuYm9keTIubnVtQ29udGFjdHMtLTtcclxuXHJcbiAgICAgIHRoaXMubWFuaWZvbGQuYm9keTEgPSBudWxsO1xyXG4gICAgICB0aGlzLm1hbmlmb2xkLmJvZHkyID0gbnVsbDtcclxuICAgICAgdGhpcy5jb25zdHJhaW50LmJvZHkxID0gbnVsbDtcclxuICAgICAgdGhpcy5jb25zdHJhaW50LmJvZHkyID0gbnVsbDtcclxuICAgICAgdGhpcy5jb25zdHJhaW50LmRldGFjaCgpO1xyXG5cclxuICAgICAgdGhpcy5zaGFwZTEgPSBudWxsO1xyXG4gICAgICB0aGlzLnNoYXBlMiA9IG51bGw7XHJcbiAgICAgIHRoaXMuYm9keTEgPSBudWxsO1xyXG4gICAgICB0aGlzLmJvZHkyID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIC8qKlxyXG4gICogVGhlIGNsYXNzIG9mIHJpZ2lkIGJvZHkuXHJcbiAgKiBSaWdpZCBib2R5IGhhcyB0aGUgc2hhcGUgb2YgYSBzaW5nbGUgb3IgbXVsdGlwbGUgY29sbGlzaW9uIHByb2Nlc3NpbmcsXHJcbiAgKiBJIGNhbiBzZXQgdGhlIHBhcmFtZXRlcnMgaW5kaXZpZHVhbGx5LlxyXG4gICogQGF1dGhvciBzYWhhcmFuXHJcbiAgKiBAYXV0aG9yIGxvLXRoXHJcbiAgKi9cclxuXHJcbiAgZnVuY3Rpb24gUmlnaWRCb2R5KFBvc2l0aW9uLCBSb3RhdGlvbikge1xyXG5cclxuICAgIHRoaXMucG9zaXRpb24gPSBQb3NpdGlvbiB8fCBuZXcgVmVjMygpO1xyXG4gICAgdGhpcy5vcmllbnRhdGlvbiA9IFJvdGF0aW9uIHx8IG5ldyBRdWF0KCk7XHJcblxyXG4gICAgdGhpcy5zY2FsZSA9IDE7XHJcbiAgICB0aGlzLmludlNjYWxlID0gMTtcclxuXHJcbiAgICAvLyBwb3NzaWJsZSBsaW5rIHRvIHRocmVlIE1lc2g7XHJcbiAgICB0aGlzLm1lc2ggPSBudWxsO1xyXG5cclxuICAgIHRoaXMuaWQgPSBOYU47XHJcbiAgICB0aGlzLm5hbWUgPSBcIlwiO1xyXG4gICAgLy8gVGhlIG1heGltdW0gbnVtYmVyIG9mIHNoYXBlcyB0aGF0IGNhbiBiZSBhZGRlZCB0byBhIG9uZSByaWdpZC5cclxuICAgIC8vdGhpcy5NQVhfU0hBUEVTID0gNjQ7Ly82NDtcclxuXHJcbiAgICB0aGlzLnByZXYgPSBudWxsO1xyXG4gICAgdGhpcy5uZXh0ID0gbnVsbDtcclxuXHJcbiAgICAvLyBJIHJlcHJlc2VudCB0aGUga2luZCBvZiByaWdpZCBib2R5LlxyXG4gICAgLy8gUGxlYXNlIGRvIG5vdCBjaGFuZ2UgZnJvbSB0aGUgb3V0c2lkZSB0aGlzIHZhcmlhYmxlLlxyXG4gICAgLy8gSWYgeW91IHdhbnQgdG8gY2hhbmdlIHRoZSB0eXBlIG9mIHJpZ2lkIGJvZHksIGFsd2F5c1xyXG4gICAgLy8gUGxlYXNlIHNwZWNpZnkgdGhlIHR5cGUgeW91IHdhbnQgdG8gc2V0IHRoZSBhcmd1bWVudHMgb2Ygc2V0dXBNYXNzIG1ldGhvZC5cclxuICAgIHRoaXMudHlwZSA9IEJPRFlfTlVMTDtcclxuXHJcbiAgICB0aGlzLm1hc3NJbmZvID0gbmV3IE1hc3NJbmZvKCk7XHJcblxyXG4gICAgdGhpcy5uZXdQb3NpdGlvbiA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLmNvbnRyb2xQb3MgPSBmYWxzZTtcclxuICAgIHRoaXMubmV3T3JpZW50YXRpb24gPSBuZXcgUXVhdCgpO1xyXG4gICAgdGhpcy5uZXdSb3RhdGlvbiA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLmN1cnJlbnRSb3RhdGlvbiA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLmNvbnRyb2xSb3QgPSBmYWxzZTtcclxuICAgIHRoaXMuY29udHJvbFJvdEluVGltZSA9IGZhbHNlO1xyXG5cclxuICAgIHRoaXMucXVhdGVybmlvbiA9IG5ldyBRdWF0KCk7XHJcbiAgICB0aGlzLnBvcyA9IG5ldyBWZWMzKCk7XHJcblxyXG5cclxuXHJcbiAgICAvLyBJcyB0aGUgdHJhbnNsYXRpb25hbCB2ZWxvY2l0eS5cclxuICAgIHRoaXMubGluZWFyVmVsb2NpdHkgPSBuZXcgVmVjMygpO1xyXG4gICAgLy8gSXMgdGhlIGFuZ3VsYXIgdmVsb2NpdHkuXHJcbiAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IG5ldyBWZWMzKCk7XHJcblxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gIFBsZWFzZSBkbyBub3QgY2hhbmdlIGZyb20gdGhlIG91dHNpZGUgdGhpcyB2YXJpYWJsZXMuXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgLy8gSXQgaXMgYSB3b3JsZCB0aGF0IHJpZ2lkIGJvZHkgaGFzIGJlZW4gYWRkZWQuXHJcbiAgICB0aGlzLnBhcmVudCA9IG51bGw7XHJcbiAgICB0aGlzLmNvbnRhY3RMaW5rID0gbnVsbDtcclxuICAgIHRoaXMubnVtQ29udGFjdHMgPSAwO1xyXG5cclxuICAgIC8vIEFuIGFycmF5IG9mIHNoYXBlcyB0aGF0IGFyZSBpbmNsdWRlZCBpbiB0aGUgcmlnaWQgYm9keS5cclxuICAgIHRoaXMuc2hhcGVzID0gbnVsbDtcclxuICAgIC8vIFRoZSBudW1iZXIgb2Ygc2hhcGVzIHRoYXQgYXJlIGluY2x1ZGVkIGluIHRoZSByaWdpZCBib2R5LlxyXG4gICAgdGhpcy5udW1TaGFwZXMgPSAwO1xyXG5cclxuICAgIC8vIEl0IGlzIHRoZSBsaW5rIGFycmF5IG9mIGpvaW50IHRoYXQgaXMgY29ubmVjdGVkIHRvIHRoZSByaWdpZCBib2R5LlxyXG4gICAgdGhpcy5qb2ludExpbmsgPSBudWxsO1xyXG4gICAgLy8gVGhlIG51bWJlciBvZiBqb2ludHMgdGhhdCBhcmUgY29ubmVjdGVkIHRvIHRoZSByaWdpZCBib2R5LlxyXG4gICAgdGhpcy5udW1Kb2ludHMgPSAwO1xyXG5cclxuICAgIC8vIEl0IGlzIHRoZSB3b3JsZCBjb29yZGluYXRlIG9mIHRoZSBjZW50ZXIgb2YgZ3Jhdml0eSBpbiB0aGUgc2xlZXAganVzdCBiZWZvcmUuXHJcbiAgICB0aGlzLnNsZWVwUG9zaXRpb24gPSBuZXcgVmVjMygpO1xyXG4gICAgLy8gSXQgaXMgYSBxdWF0ZXJuaW9uIHRoYXQgcmVwcmVzZW50cyB0aGUgYXR0aXR1ZGUgb2Ygc2xlZXAganVzdCBiZWZvcmUuXHJcbiAgICB0aGlzLnNsZWVwT3JpZW50YXRpb24gPSBuZXcgUXVhdCgpO1xyXG4gICAgLy8gSSB3aWxsIHNob3cgdGhpcyByaWdpZCBib2R5IHRvIGRldGVybWluZSB3aGV0aGVyIGl0IGlzIGEgcmlnaWQgYm9keSBzdGF0aWMuXHJcbiAgICB0aGlzLmlzU3RhdGljID0gZmFsc2U7XHJcbiAgICAvLyBJIGluZGljYXRlcyB0aGF0IHRoaXMgcmlnaWQgYm9keSB0byBkZXRlcm1pbmUgd2hldGhlciBpdCBpcyBhIHJpZ2lkIGJvZHkgZHluYW1pYy5cclxuICAgIHRoaXMuaXNEeW5hbWljID0gZmFsc2U7XHJcblxyXG4gICAgdGhpcy5pc0tpbmVtYXRpYyA9IGZhbHNlO1xyXG5cclxuICAgIC8vIEl0IGlzIGEgcm90YXRpb24gbWF0cml4IHJlcHJlc2VudGluZyB0aGUgb3JpZW50YXRpb24uXHJcbiAgICB0aGlzLnJvdGF0aW9uID0gbmV3IE1hdDMzKCk7XHJcblxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gSXQgd2lsbCBiZSByZWNhbGN1bGF0ZWQgYXV0b21hdGljYWxseSBmcm9tIHRoZSBzaGFwZSwgd2hpY2ggaXMgaW5jbHVkZWQuXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgLy8gVGhpcyBpcyB0aGUgd2VpZ2h0LlxyXG4gICAgdGhpcy5tYXNzID0gMDtcclxuICAgIC8vIEl0IGlzIHRoZSByZWNpcHJvY2FsIG9mIHRoZSBtYXNzLlxyXG4gICAgdGhpcy5pbnZlcnNlTWFzcyA9IDA7XHJcbiAgICAvLyBJdCBpcyB0aGUgaW52ZXJzZSBvZiB0aGUgaW5lcnRpYSB0ZW5zb3IgaW4gdGhlIHdvcmxkIHN5c3RlbS5cclxuICAgIHRoaXMuaW52ZXJzZUluZXJ0aWEgPSBuZXcgTWF0MzMoKTtcclxuICAgIC8vIEl0IGlzIHRoZSBpbmVydGlhIHRlbnNvciBpbiB0aGUgaW5pdGlhbCBzdGF0ZS5cclxuICAgIHRoaXMubG9jYWxJbmVydGlhID0gbmV3IE1hdDMzKCk7XHJcbiAgICAvLyBJdCBpcyB0aGUgaW52ZXJzZSBvZiB0aGUgaW5lcnRpYSB0ZW5zb3IgaW4gdGhlIGluaXRpYWwgc3RhdGUuXHJcbiAgICB0aGlzLmludmVyc2VMb2NhbEluZXJ0aWEgPSBuZXcgTWF0MzMoKTtcclxuXHJcbiAgICB0aGlzLnRtcEluZXJ0aWEgPSBuZXcgTWF0MzMoKTtcclxuXHJcblxyXG4gICAgLy8gSSBpbmRpY2F0ZXMgcmlnaWQgYm9keSB3aGV0aGVyIGl0IGhhcyBiZWVuIGFkZGVkIHRvIHRoZSBzaW11bGF0aW9uIElzbGFuZC5cclxuICAgIHRoaXMuYWRkZWRUb0lzbGFuZCA9IGZhbHNlO1xyXG4gICAgLy8gSXQgc2hvd3MgaG93IHRvIHNsZWVwIHJpZ2lkIGJvZHkuXHJcbiAgICB0aGlzLmFsbG93U2xlZXAgPSB0cnVlO1xyXG4gICAgLy8gVGhpcyBpcyB0aGUgdGltZSBmcm9tIHdoZW4gdGhlIHJpZ2lkIGJvZHkgYXQgcmVzdC5cclxuICAgIHRoaXMuc2xlZXBUaW1lID0gMDtcclxuICAgIC8vIEkgc2hvd3MgcmlnaWQgYm9keSB0byBkZXRlcm1pbmUgd2hldGhlciBpdCBpcyBhIHNsZWVwIHN0YXRlLlxyXG4gICAgdGhpcy5zbGVlcGluZyA9IGZhbHNlO1xyXG5cclxuICB9XHJcblxyXG4gIE9iamVjdC5hc3NpZ24oUmlnaWRCb2R5LnByb3RvdHlwZSwge1xyXG5cclxuICAgIHNldFBhcmVudDogZnVuY3Rpb24gKHdvcmxkKSB7XHJcblxyXG4gICAgICB0aGlzLnBhcmVudCA9IHdvcmxkO1xyXG4gICAgICB0aGlzLnNjYWxlID0gdGhpcy5wYXJlbnQuc2NhbGU7XHJcbiAgICAgIHRoaXMuaW52U2NhbGUgPSB0aGlzLnBhcmVudC5pbnZTY2FsZTtcclxuICAgICAgdGhpcy5pZCA9IHRoaXMucGFyZW50Lm51bVJpZ2lkQm9kaWVzO1xyXG4gICAgICBpZiAoIXRoaXMubmFtZSkgdGhpcy5uYW1lID0gdGhpcy5pZDtcclxuXHJcbiAgICAgIHRoaXMudXBkYXRlTWVzaCgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBJJ2xsIGFkZCBhIHNoYXBlIHRvIHJpZ2lkIGJvZHkuXHJcbiAgICAgKiBJZiB5b3UgYWRkIGEgc2hhcGUsIHBsZWFzZSBjYWxsIHRoZSBzZXR1cE1hc3MgbWV0aG9kIHRvIHN0ZXAgdXAgdG8gdGhlIHN0YXJ0IG9mIHRoZSBuZXh0LlxyXG4gICAgICogQHBhcmFtICAgc2hhcGUgc2hhcGUgdG8gQWRkXHJcbiAgICAgKi9cclxuICAgIGFkZFNoYXBlOiBmdW5jdGlvbiAoc2hhcGUpIHtcclxuXHJcbiAgICAgIGlmIChzaGFwZS5wYXJlbnQpIHtcclxuICAgICAgICBwcmludEVycm9yKFwiUmlnaWRCb2R5XCIsIFwiSXQgaXMgbm90IHBvc3NpYmxlIHRoYXQgeW91IGFkZCBhIHNoYXBlIHdoaWNoIGFscmVhZHkgaGFzIGFuIGFzc29jaWF0ZWQgYm9keS5cIik7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh0aGlzLnNoYXBlcyAhPSBudWxsKSAodGhpcy5zaGFwZXMucHJldiA9IHNoYXBlKS5uZXh0ID0gdGhpcy5zaGFwZXM7XHJcbiAgICAgIHRoaXMuc2hhcGVzID0gc2hhcGU7XHJcbiAgICAgIHNoYXBlLnBhcmVudCA9IHRoaXM7XHJcbiAgICAgIGlmICh0aGlzLnBhcmVudCkgdGhpcy5wYXJlbnQuYWRkU2hhcGUoc2hhcGUpO1xyXG4gICAgICB0aGlzLm51bVNoYXBlcysrO1xyXG5cclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEkgd2lsbCBkZWxldGUgdGhlIHNoYXBlIGZyb20gdGhlIHJpZ2lkIGJvZHkuXHJcbiAgICAgKiBJZiB5b3UgZGVsZXRlIGEgc2hhcGUsIHBsZWFzZSBjYWxsIHRoZSBzZXR1cE1hc3MgbWV0aG9kIHRvIHN0ZXAgdXAgdG8gdGhlIHN0YXJ0IG9mIHRoZSBuZXh0LlxyXG4gICAgICogQHBhcmFtIHNoYXBlIHtTaGFwZX0gdG8gZGVsZXRlXHJcbiAgICAgKiBAcmV0dXJuIHZvaWRcclxuICAgICAqL1xyXG4gICAgcmVtb3ZlU2hhcGU6IGZ1bmN0aW9uIChzaGFwZSkge1xyXG5cclxuICAgICAgdmFyIHJlbW92ZSA9IHNoYXBlO1xyXG4gICAgICBpZiAocmVtb3ZlLnBhcmVudCAhPSB0aGlzKSByZXR1cm47XHJcbiAgICAgIHZhciBwcmV2ID0gcmVtb3ZlLnByZXY7XHJcbiAgICAgIHZhciBuZXh0ID0gcmVtb3ZlLm5leHQ7XHJcbiAgICAgIGlmIChwcmV2ICE9IG51bGwpIHByZXYubmV4dCA9IG5leHQ7XHJcbiAgICAgIGlmIChuZXh0ICE9IG51bGwpIG5leHQucHJldiA9IHByZXY7XHJcbiAgICAgIGlmICh0aGlzLnNoYXBlcyA9PSByZW1vdmUpIHRoaXMuc2hhcGVzID0gbmV4dDtcclxuICAgICAgcmVtb3ZlLnByZXYgPSBudWxsO1xyXG4gICAgICByZW1vdmUubmV4dCA9IG51bGw7XHJcbiAgICAgIHJlbW92ZS5wYXJlbnQgPSBudWxsO1xyXG4gICAgICBpZiAodGhpcy5wYXJlbnQpIHRoaXMucGFyZW50LnJlbW92ZVNoYXBlKHJlbW92ZSk7XHJcbiAgICAgIHRoaXMubnVtU2hhcGVzLS07XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICByZW1vdmU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHRoaXMuZGlzcG9zZSgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgZGlzcG9zZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdGhpcy5wYXJlbnQucmVtb3ZlUmlnaWRCb2R5KHRoaXMpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2hlY2tDb250YWN0OiBmdW5jdGlvbiAobmFtZSkge1xyXG5cclxuICAgICAgdGhpcy5wYXJlbnQuY2hlY2tDb250YWN0KHRoaXMubmFtZSwgbmFtZSk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbHVsYXRlcyBtYXNzIGRhdGFzKGNlbnRlciBvZiBncmF2aXR5LCBtYXNzLCBtb21lbnQgaW5lcnRpYSwgZXRjLi4uKS5cclxuICAgICAqIElmIHRoZSBwYXJhbWV0ZXIgdHlwZSBpcyBzZXQgdG8gQk9EWV9TVEFUSUMsIHRoZSByaWdpZCBib2R5IHdpbGwgYmUgZml4ZWQgdG8gdGhlIHNwYWNlLlxyXG4gICAgICogSWYgdGhlIHBhcmFtZXRlciBhZGp1c3RQb3NpdGlvbiBpcyBzZXQgdG8gdHJ1ZSwgdGhlIHNoYXBlcycgcmVsYXRpdmUgcG9zaXRpb25zIGFuZFxyXG4gICAgICogdGhlIHJpZ2lkIGJvZHkncyBwb3NpdGlvbiB3aWxsIGJlIGFkanVzdGVkIHRvIHRoZSBjZW50ZXIgb2YgZ3Jhdml0eS5cclxuICAgICAqIEBwYXJhbSB0eXBlXHJcbiAgICAgKiBAcGFyYW0gYWRqdXN0UG9zaXRpb25cclxuICAgICAqIEByZXR1cm4gdm9pZFxyXG4gICAgICovXHJcbiAgICBzZXR1cE1hc3M6IGZ1bmN0aW9uICh0eXBlLCBBZGp1c3RQb3NpdGlvbikge1xyXG5cclxuICAgICAgdmFyIGFkanVzdFBvc2l0aW9uID0gKEFkanVzdFBvc2l0aW9uICE9PSB1bmRlZmluZWQpID8gQWRqdXN0UG9zaXRpb24gOiB0cnVlO1xyXG5cclxuICAgICAgdGhpcy50eXBlID0gdHlwZSB8fCBCT0RZX1NUQVRJQztcclxuICAgICAgdGhpcy5pc0R5bmFtaWMgPSB0aGlzLnR5cGUgPT09IEJPRFlfRFlOQU1JQztcclxuICAgICAgdGhpcy5pc1N0YXRpYyA9IHRoaXMudHlwZSA9PT0gQk9EWV9TVEFUSUM7XHJcblxyXG4gICAgICB0aGlzLm1hc3MgPSAwO1xyXG4gICAgICB0aGlzLmxvY2FsSW5lcnRpYS5zZXQoMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCk7XHJcblxyXG5cclxuICAgICAgdmFyIHRtcE0gPSBuZXcgTWF0MzMoKTtcclxuICAgICAgdmFyIHRtcFYgPSBuZXcgVmVjMygpO1xyXG5cclxuICAgICAgZm9yICh2YXIgc2hhcGUgPSB0aGlzLnNoYXBlczsgc2hhcGUgIT09IG51bGw7IHNoYXBlID0gc2hhcGUubmV4dCkge1xyXG5cclxuICAgICAgICBzaGFwZS5jYWxjdWxhdGVNYXNzSW5mbyh0aGlzLm1hc3NJbmZvKTtcclxuICAgICAgICB2YXIgc2hhcGVNYXNzID0gdGhpcy5tYXNzSW5mby5tYXNzO1xyXG4gICAgICAgIHRtcFYuYWRkU2NhbGVkVmVjdG9yKHNoYXBlLnJlbGF0aXZlUG9zaXRpb24sIHNoYXBlTWFzcyk7XHJcbiAgICAgICAgdGhpcy5tYXNzICs9IHNoYXBlTWFzcztcclxuICAgICAgICB0aGlzLnJvdGF0ZUluZXJ0aWEoc2hhcGUucmVsYXRpdmVSb3RhdGlvbiwgdGhpcy5tYXNzSW5mby5pbmVydGlhLCB0bXBNKTtcclxuICAgICAgICB0aGlzLmxvY2FsSW5lcnRpYS5hZGQodG1wTSk7XHJcblxyXG4gICAgICAgIC8vIGFkZCBvZmZzZXQgaW5lcnRpYVxyXG4gICAgICAgIHRoaXMubG9jYWxJbmVydGlhLmFkZE9mZnNldChzaGFwZU1hc3MsIHNoYXBlLnJlbGF0aXZlUG9zaXRpb24pO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5pbnZlcnNlTWFzcyA9IDEgLyB0aGlzLm1hc3M7XHJcbiAgICAgIHRtcFYuc2NhbGVFcXVhbCh0aGlzLmludmVyc2VNYXNzKTtcclxuXHJcbiAgICAgIGlmIChhZGp1c3RQb3NpdGlvbikge1xyXG4gICAgICAgIHRoaXMucG9zaXRpb24uYWRkKHRtcFYpO1xyXG4gICAgICAgIGZvciAoc2hhcGUgPSB0aGlzLnNoYXBlczsgc2hhcGUgIT09IG51bGw7IHNoYXBlID0gc2hhcGUubmV4dCkge1xyXG4gICAgICAgICAgc2hhcGUucmVsYXRpdmVQb3NpdGlvbi5zdWJFcXVhbCh0bXBWKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHN1YnRyYWN0IG9mZnNldCBpbmVydGlhXHJcbiAgICAgICAgdGhpcy5sb2NhbEluZXJ0aWEuc3ViT2Zmc2V0KHRoaXMubWFzcywgdG1wVik7XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLmludmVyc2VMb2NhbEluZXJ0aWEuaW52ZXJ0KHRoaXMubG9jYWxJbmVydGlhKTtcclxuXHJcbiAgICAgIC8vfVxyXG5cclxuICAgICAgaWYgKHRoaXMudHlwZSA9PT0gQk9EWV9TVEFUSUMpIHtcclxuICAgICAgICB0aGlzLmludmVyc2VNYXNzID0gMDtcclxuICAgICAgICB0aGlzLmludmVyc2VMb2NhbEluZXJ0aWEuc2V0KDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICB0aGlzLnN5bmNTaGFwZXMoKTtcclxuICAgICAgdGhpcy5hd2FrZSgpO1xyXG5cclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEF3YWtlIHRoZSByaWdpZCBib2R5LlxyXG4gICAgICovXHJcbiAgICBhd2FrZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgaWYgKCF0aGlzLmFsbG93U2xlZXAgfHwgIXRoaXMuc2xlZXBpbmcpIHJldHVybjtcclxuICAgICAgdGhpcy5zbGVlcGluZyA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnNsZWVwVGltZSA9IDA7XHJcbiAgICAgIC8vIGF3YWtlIGNvbm5lY3RlZCBjb25zdHJhaW50c1xyXG4gICAgICB2YXIgY3MgPSB0aGlzLmNvbnRhY3RMaW5rO1xyXG4gICAgICB3aGlsZSAoY3MgIT0gbnVsbCkge1xyXG4gICAgICAgIGNzLmJvZHkuc2xlZXBUaW1lID0gMDtcclxuICAgICAgICBjcy5ib2R5LnNsZWVwaW5nID0gZmFsc2U7XHJcbiAgICAgICAgY3MgPSBjcy5uZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBqcyA9IHRoaXMuam9pbnRMaW5rO1xyXG4gICAgICB3aGlsZSAoanMgIT0gbnVsbCkge1xyXG4gICAgICAgIGpzLmJvZHkuc2xlZXBUaW1lID0gMDtcclxuICAgICAgICBqcy5ib2R5LnNsZWVwaW5nID0gZmFsc2U7XHJcbiAgICAgICAganMgPSBqcy5uZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIGZvciAodmFyIHNoYXBlID0gdGhpcy5zaGFwZXM7IHNoYXBlICE9IG51bGw7IHNoYXBlID0gc2hhcGUubmV4dCkge1xyXG4gICAgICAgIHNoYXBlLnVwZGF0ZVByb3h5KCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBTbGVlcCB0aGUgcmlnaWQgYm9keS5cclxuICAgICAqL1xyXG4gICAgc2xlZXA6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIGlmICghdGhpcy5hbGxvd1NsZWVwIHx8IHRoaXMuc2xlZXBpbmcpIHJldHVybjtcclxuXHJcbiAgICAgIHRoaXMubGluZWFyVmVsb2NpdHkuc2V0KDAsIDAsIDApO1xyXG4gICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5zZXQoMCwgMCwgMCk7XHJcbiAgICAgIHRoaXMuc2xlZXBQb3NpdGlvbi5jb3B5KHRoaXMucG9zaXRpb24pO1xyXG4gICAgICB0aGlzLnNsZWVwT3JpZW50YXRpb24uY29weSh0aGlzLm9yaWVudGF0aW9uKTtcclxuXHJcbiAgICAgIHRoaXMuc2xlZXBUaW1lID0gMDtcclxuICAgICAgdGhpcy5zbGVlcGluZyA9IHRydWU7XHJcbiAgICAgIGZvciAodmFyIHNoYXBlID0gdGhpcy5zaGFwZXM7IHNoYXBlICE9IG51bGw7IHNoYXBlID0gc2hhcGUubmV4dCkge1xyXG4gICAgICAgIHNoYXBlLnVwZGF0ZVByb3h5KCk7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgdGVzdFdha2VVcDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgaWYgKHRoaXMubGluZWFyVmVsb2NpdHkudGVzdFplcm8oKSB8fCB0aGlzLmFuZ3VsYXJWZWxvY2l0eS50ZXN0WmVybygpIHx8IHRoaXMucG9zaXRpb24udGVzdERpZmYodGhpcy5zbGVlcFBvc2l0aW9uKSB8fCB0aGlzLm9yaWVudGF0aW9uLnRlc3REaWZmKHRoaXMuc2xlZXBPcmllbnRhdGlvbikpIHRoaXMuYXdha2UoKTsgLy8gYXdha2UgdGhlIGJvZHlcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHdoZXRoZXIgdGhlIHJpZ2lkIGJvZHkgaGFzIG5vdCBhbnkgY29ubmVjdGlvbiB3aXRoIG90aGVycy5cclxuICAgICAqIEByZXR1cm4ge3ZvaWR9XHJcbiAgICAgKi9cclxuICAgIGlzTG9uZWx5OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLm51bUpvaW50cyA9PSAwICYmIHRoaXMubnVtQ29udGFjdHMgPT0gMDtcclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgdGltZSBpbnRlZ3JhdGlvbiBvZiB0aGUgbW90aW9uIG9mIGEgcmlnaWQgYm9keSwgeW91IGNhbiB1cGRhdGUgdGhlIGluZm9ybWF0aW9uIHN1Y2ggYXMgdGhlIHNoYXBlLlxyXG4gICAgICogVGhpcyBtZXRob2QgaXMgaW52b2tlZCBhdXRvbWF0aWNhbGx5IHdoZW4gY2FsbGluZyB0aGUgc3RlcCBvZiB0aGUgV29ybGQsXHJcbiAgICAgKiBUaGVyZSBpcyBubyBuZWVkIHRvIGNhbGwgZnJvbSBvdXRzaWRlIHVzdWFsbHkuXHJcbiAgICAgKiBAcGFyYW0gIHRpbWVTdGVwIHRpbWVcclxuICAgICAqIEByZXR1cm4ge3ZvaWR9XHJcbiAgICAgKi9cclxuXHJcbiAgICB1cGRhdGVQb3NpdGlvbjogZnVuY3Rpb24gKHRpbWVTdGVwKSB7XHJcbiAgICAgIHN3aXRjaCAodGhpcy50eXBlKSB7XHJcbiAgICAgICAgY2FzZSBCT0RZX1NUQVRJQzpcclxuICAgICAgICAgIHRoaXMubGluZWFyVmVsb2NpdHkuc2V0KDAsIDAsIDApO1xyXG4gICAgICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkuc2V0KDAsIDAsIDApO1xyXG5cclxuICAgICAgICAgIC8vIE9OTFkgRk9SIFRFU1RcclxuICAgICAgICAgIGlmICh0aGlzLmNvbnRyb2xQb3MpIHtcclxuICAgICAgICAgICAgdGhpcy5wb3NpdGlvbi5jb3B5KHRoaXMubmV3UG9zaXRpb24pO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRyb2xQb3MgPSBmYWxzZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmICh0aGlzLmNvbnRyb2xSb3QpIHtcclxuICAgICAgICAgICAgdGhpcy5vcmllbnRhdGlvbi5jb3B5KHRoaXMubmV3T3JpZW50YXRpb24pO1xyXG4gICAgICAgICAgICB0aGlzLmNvbnRyb2xSb3QgPSBmYWxzZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIC8qdGhpcy5saW5lYXJWZWxvY2l0eS54PTA7XHJcbiAgICAgICAgICB0aGlzLmxpbmVhclZlbG9jaXR5Lnk9MDtcclxuICAgICAgICAgIHRoaXMubGluZWFyVmVsb2NpdHkuej0wO1xyXG4gICAgICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkueD0wO1xyXG4gICAgICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkueT0wO1xyXG4gICAgICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkuej0wOyovXHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIEJPRFlfRFlOQU1JQzpcclxuXHJcbiAgICAgICAgICBpZiAodGhpcy5pc0tpbmVtYXRpYykge1xyXG5cclxuICAgICAgICAgICAgdGhpcy5saW5lYXJWZWxvY2l0eS5zZXQoMCwgMCwgMCk7XHJcbiAgICAgICAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnNldCgwLCAwLCAwKTtcclxuXHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgaWYgKHRoaXMuY29udHJvbFBvcykge1xyXG5cclxuICAgICAgICAgICAgdGhpcy5saW5lYXJWZWxvY2l0eS5zdWJWZWN0b3JzKHRoaXMubmV3UG9zaXRpb24sIHRoaXMucG9zaXRpb24pLm11bHRpcGx5U2NhbGFyKDEgLyB0aW1lU3RlcCk7XHJcbiAgICAgICAgICAgIHRoaXMuY29udHJvbFBvcyA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmICh0aGlzLmNvbnRyb2xSb3QpIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LmNvcHkodGhpcy5nZXRBeGlzKCkpO1xyXG4gICAgICAgICAgICB0aGlzLm9yaWVudGF0aW9uLmNvcHkodGhpcy5uZXdPcmllbnRhdGlvbik7XHJcbiAgICAgICAgICAgIHRoaXMuY29udHJvbFJvdCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICB0aGlzLnBvc2l0aW9uLmFkZFNjYWxlZFZlY3Rvcih0aGlzLmxpbmVhclZlbG9jaXR5LCB0aW1lU3RlcCk7XHJcbiAgICAgICAgICB0aGlzLm9yaWVudGF0aW9uLmFkZFRpbWUodGhpcy5hbmd1bGFyVmVsb2NpdHksIHRpbWVTdGVwKTtcclxuXHJcbiAgICAgICAgICB0aGlzLnVwZGF0ZU1lc2goKTtcclxuXHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBkZWZhdWx0OiBwcmludEVycm9yKFwiUmlnaWRCb2R5XCIsIFwiSW52YWxpZCB0eXBlLlwiKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5zeW5jU2hhcGVzKCk7XHJcbiAgICAgIHRoaXMudXBkYXRlTWVzaCgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgZ2V0QXhpczogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgcmV0dXJuIG5ldyBWZWMzKDAsIDEsIDApLmFwcGx5TWF0cml4Myh0aGlzLmludmVyc2VMb2NhbEluZXJ0aWEsIHRydWUpLm5vcm1hbGl6ZSgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcm90YXRlSW5lcnRpYTogZnVuY3Rpb24gKHJvdCwgaW5lcnRpYSwgb3V0KSB7XHJcblxyXG4gICAgICB0aGlzLnRtcEluZXJ0aWEubXVsdGlwbHlNYXRyaWNlcyhyb3QsIGluZXJ0aWEpO1xyXG4gICAgICBvdXQubXVsdGlwbHlNYXRyaWNlcyh0aGlzLnRtcEluZXJ0aWEsIHJvdCwgdHJ1ZSk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzeW5jU2hhcGVzOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB0aGlzLnJvdGF0aW9uLnNldFF1YXQodGhpcy5vcmllbnRhdGlvbik7XHJcbiAgICAgIHRoaXMucm90YXRlSW5lcnRpYSh0aGlzLnJvdGF0aW9uLCB0aGlzLmludmVyc2VMb2NhbEluZXJ0aWEsIHRoaXMuaW52ZXJzZUluZXJ0aWEpO1xyXG5cclxuICAgICAgZm9yICh2YXIgc2hhcGUgPSB0aGlzLnNoYXBlczsgc2hhcGUgIT0gbnVsbDsgc2hhcGUgPSBzaGFwZS5uZXh0KSB7XHJcblxyXG4gICAgICAgIHNoYXBlLnBvc2l0aW9uLmNvcHkoc2hhcGUucmVsYXRpdmVQb3NpdGlvbikuYXBwbHlNYXRyaXgzKHRoaXMucm90YXRpb24sIHRydWUpLmFkZCh0aGlzLnBvc2l0aW9uKTtcclxuICAgICAgICAvLyBhZGQgYnkgUXVhemlLYlxyXG4gICAgICAgIHNoYXBlLnJvdGF0aW9uLm11bHRpcGx5TWF0cmljZXModGhpcy5yb3RhdGlvbiwgc2hhcGUucmVsYXRpdmVSb3RhdGlvbik7XHJcbiAgICAgICAgc2hhcGUudXBkYXRlUHJveHkoKTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcblxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIEFQUExZIElNUFVMU0UgRk9SQ0VcclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgYXBwbHlJbXB1bHNlOiBmdW5jdGlvbiAocG9zaXRpb24sIGZvcmNlKSB7XHJcbiAgICAgIHRoaXMubGluZWFyVmVsb2NpdHkuYWRkU2NhbGVkVmVjdG9yKGZvcmNlLCB0aGlzLmludmVyc2VNYXNzKTtcclxuICAgICAgdmFyIHJlbCA9IG5ldyBWZWMzKCkuY29weShwb3NpdGlvbikuc3ViKHRoaXMucG9zaXRpb24pLmNyb3NzKGZvcmNlKS5hcHBseU1hdHJpeDModGhpcy5pbnZlcnNlSW5lcnRpYSwgdHJ1ZSk7XHJcbiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LmFkZChyZWwpO1xyXG4gICAgfSxcclxuXHJcblxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIFNFVCBEWU5BTUlRVUUgUE9TSVRJT04gQU5EIFJPVEFUSU9OXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIHNldFBvc2l0aW9uOiBmdW5jdGlvbiAocG9zKSB7XHJcbiAgICAgIHRoaXMubmV3UG9zaXRpb24uY29weShwb3MpLm11bHRpcGx5U2NhbGFyKHRoaXMuaW52U2NhbGUpO1xyXG4gICAgICB0aGlzLmNvbnRyb2xQb3MgPSB0cnVlO1xyXG4gICAgICBpZiAoIXRoaXMuaXNLaW5lbWF0aWMpIHRoaXMuaXNLaW5lbWF0aWMgPSB0cnVlO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRRdWF0ZXJuaW9uOiBmdW5jdGlvbiAocSkge1xyXG4gICAgICB0aGlzLm5ld09yaWVudGF0aW9uLnNldChxLngsIHEueSwgcS56LCBxLncpO1xyXG4gICAgICB0aGlzLmNvbnRyb2xSb3QgPSB0cnVlO1xyXG4gICAgICBpZiAoIXRoaXMuaXNLaW5lbWF0aWMpIHRoaXMuaXNLaW5lbWF0aWMgPSB0cnVlO1xyXG4gICAgfSxcclxuXHJcbiAgICBzZXRSb3RhdGlvbjogZnVuY3Rpb24gKHJvdCkge1xyXG5cclxuICAgICAgdGhpcy5uZXdPcmllbnRhdGlvbiA9IG5ldyBRdWF0KCkuc2V0RnJvbUV1bGVyKHJvdC54ICogX01hdGguZGVndG9yYWQsIHJvdC55ICogX01hdGguZGVndG9yYWQsIHJvdC56ICogX01hdGguZGVndG9yYWQpOy8vdGhpcy5yb3RhdGlvblZlY3RUb1F1YWQoIHJvdCApO1xyXG4gICAgICB0aGlzLmNvbnRyb2xSb3QgPSB0cnVlO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIFJFU0VUIERZTkFNSVFVRSBQT1NJVElPTiBBTkQgUk9UQVRJT05cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgcmVzZXRQb3NpdGlvbjogZnVuY3Rpb24gKHgsIHksIHopIHtcclxuXHJcbiAgICAgIHRoaXMubGluZWFyVmVsb2NpdHkuc2V0KDAsIDAsIDApO1xyXG4gICAgICB0aGlzLmFuZ3VsYXJWZWxvY2l0eS5zZXQoMCwgMCwgMCk7XHJcbiAgICAgIHRoaXMucG9zaXRpb24uc2V0KHgsIHksIHopLm11bHRpcGx5U2NhbGFyKHRoaXMuaW52U2NhbGUpO1xyXG4gICAgICAvL3RoaXMucG9zaXRpb24uc2V0KCB4Kk9JTU8uV29ybGRTY2FsZS5pbnZTY2FsZSwgeSpPSU1PLldvcmxkU2NhbGUuaW52U2NhbGUsIHoqT0lNTy5Xb3JsZFNjYWxlLmludlNjYWxlICk7XHJcbiAgICAgIHRoaXMuYXdha2UoKTtcclxuICAgIH0sXHJcblxyXG4gICAgcmVzZXRRdWF0ZXJuaW9uOiBmdW5jdGlvbiAocSkge1xyXG5cclxuICAgICAgdGhpcy5hbmd1bGFyVmVsb2NpdHkuc2V0KDAsIDAsIDApO1xyXG4gICAgICB0aGlzLm9yaWVudGF0aW9uID0gbmV3IFF1YXQocS54LCBxLnksIHEueiwgcS53KTtcclxuICAgICAgdGhpcy5hd2FrZSgpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcmVzZXRSb3RhdGlvbjogZnVuY3Rpb24gKHgsIHksIHopIHtcclxuXHJcbiAgICAgIHRoaXMuYW5ndWxhclZlbG9jaXR5LnNldCgwLCAwLCAwKTtcclxuICAgICAgdGhpcy5vcmllbnRhdGlvbiA9IG5ldyBRdWF0KCkuc2V0RnJvbUV1bGVyKHggKiBfTWF0aC5kZWd0b3JhZCwgeSAqIF9NYXRoLmRlZ3RvcmFkLCB6ICogX01hdGguZGVndG9yYWQpOy8vdGhpcy5yb3RhdGlvblZlY3RUb1F1YWQoIG5ldyBWZWMzKHgseSx6KSApO1xyXG4gICAgICB0aGlzLmF3YWtlKCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy8gR0VUIFBPU0lUSU9OIEFORCBST1RBVElPTlxyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICBnZXRQb3NpdGlvbjogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXMucG9zO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgZ2V0UXVhdGVybmlvbjogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXMucXVhdGVybmlvbjtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBBVVRPIFVQREFURSBUSFJFRSBNRVNIXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgIGNvbm5lY3RNZXNoOiBmdW5jdGlvbiAobWVzaCkge1xyXG5cclxuICAgICAgdGhpcy5tZXNoID0gbWVzaDtcclxuICAgICAgdGhpcy51cGRhdGVNZXNoKCk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICB1cGRhdGVNZXNoOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB0aGlzLnBvcy5zY2FsZSh0aGlzLnBvc2l0aW9uLCB0aGlzLnNjYWxlKTtcclxuICAgICAgdGhpcy5xdWF0ZXJuaW9uLmNvcHkodGhpcy5vcmllbnRhdGlvbik7XHJcblxyXG4gICAgICBpZiAodGhpcy5tZXNoID09PSBudWxsKSByZXR1cm47XHJcblxyXG4gICAgICB0aGlzLm1lc2gucG9zaXRpb24uY29weSh0aGlzLmdldFBvc2l0aW9uKCkpO1xyXG4gICAgICB0aGlzLm1lc2gucXVhdGVybmlvbi5jb3B5KHRoaXMuZ2V0UXVhdGVybmlvbigpKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgKiBBIHBhaXIgb2Ygc2hhcGVzIHRoYXQgbWF5IGNvbGxpZGUuXHJcbiAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAqL1xyXG4gIGZ1bmN0aW9uIFBhaXIoczEsIHMyKSB7XHJcblxyXG4gICAgLy8gVGhlIGZpcnN0IHNoYXBlLlxyXG4gICAgdGhpcy5zaGFwZTEgPSBzMSB8fCBudWxsO1xyXG4gICAgLy8gVGhlIHNlY29uZCBzaGFwZS5cclxuICAgIHRoaXMuc2hhcGUyID0gczIgfHwgbnVsbDtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAqIFRoZSBicm9hZC1waGFzZSBpcyB1c2VkIGZvciBjb2xsZWN0aW5nIGFsbCBwb3NzaWJsZSBwYWlycyBmb3IgY29sbGlzaW9uLlxyXG4gICovXHJcblxyXG4gIGZ1bmN0aW9uIEJyb2FkUGhhc2UoKSB7XHJcblxyXG4gICAgdGhpcy50eXBlcyA9IEJSX05VTEw7XHJcbiAgICB0aGlzLm51bVBhaXJDaGVja3MgPSAwO1xyXG4gICAgdGhpcy5udW1QYWlycyA9IDA7XHJcbiAgICB0aGlzLnBhaXJzID0gW107XHJcblxyXG4gIH1cclxuICBPYmplY3QuYXNzaWduKEJyb2FkUGhhc2UucHJvdG90eXBlLCB7XHJcblxyXG4gICAgQnJvYWRQaGFzZTogdHJ1ZSxcclxuXHJcbiAgICAvLyBDcmVhdGUgYSBuZXcgcHJveHkuXHJcbiAgICBjcmVhdGVQcm94eTogZnVuY3Rpb24gKHNoYXBlKSB7XHJcblxyXG4gICAgICBwcmludEVycm9yKFwiQnJvYWRQaGFzZVwiLCBcIkluaGVyaXRhbmNlIGVycm9yLlwiKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIEFkZCB0aGUgcHJveHkgaW50byB0aGUgYnJvYWQtcGhhc2UuXHJcbiAgICBhZGRQcm94eTogZnVuY3Rpb24gKHByb3h5KSB7XHJcblxyXG4gICAgICBwcmludEVycm9yKFwiQnJvYWRQaGFzZVwiLCBcIkluaGVyaXRhbmNlIGVycm9yLlwiKTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gUmVtb3ZlIHRoZSBwcm94eSBmcm9tIHRoZSBicm9hZC1waGFzZS5cclxuICAgIHJlbW92ZVByb3h5OiBmdW5jdGlvbiAocHJveHkpIHtcclxuXHJcbiAgICAgIHByaW50RXJyb3IoXCJCcm9hZFBoYXNlXCIsIFwiSW5oZXJpdGFuY2UgZXJyb3IuXCIpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gUmV0dXJucyB3aGV0aGVyIHRoZSBwYWlyIGlzIGF2YWlsYWJsZSBvciBub3QuXHJcbiAgICBpc0F2YWlsYWJsZVBhaXI6IGZ1bmN0aW9uIChzMSwgczIpIHtcclxuXHJcbiAgICAgIHZhciBiMSA9IHMxLnBhcmVudDtcclxuICAgICAgdmFyIGIyID0gczIucGFyZW50O1xyXG4gICAgICBpZiAoYjEgPT0gYjIgfHwgLy8gc2FtZSBwYXJlbnRzXHJcbiAgICAgICAgKCFiMS5pc0R5bmFtaWMgJiYgIWIyLmlzRHluYW1pYykgfHwgLy8gc3RhdGljIG9yIGtpbmVtYXRpYyBvYmplY3RcclxuICAgICAgICAoczEuYmVsb25nc1RvICYgczIuY29sbGlkZXNXaXRoKSA9PSAwIHx8XHJcbiAgICAgICAgKHMyLmJlbG9uZ3NUbyAmIHMxLmNvbGxpZGVzV2l0aCkgPT0gMCAvLyBjb2xsaXNpb24gZmlsdGVyaW5nXHJcbiAgICAgICkgeyByZXR1cm4gZmFsc2U7IH1cclxuICAgICAgdmFyIGpzO1xyXG4gICAgICBpZiAoYjEubnVtSm9pbnRzIDwgYjIubnVtSm9pbnRzKSBqcyA9IGIxLmpvaW50TGluaztcclxuICAgICAgZWxzZSBqcyA9IGIyLmpvaW50TGluaztcclxuICAgICAgd2hpbGUgKGpzICE9PSBudWxsKSB7XHJcbiAgICAgICAgdmFyIGpvaW50ID0ganMuam9pbnQ7XHJcbiAgICAgICAgaWYgKCFqb2ludC5hbGxvd0NvbGxpc2lvbiAmJiAoKGpvaW50LmJvZHkxID09IGIxICYmIGpvaW50LmJvZHkyID09IGIyKSB8fCAoam9pbnQuYm9keTEgPT0gYjIgJiYgam9pbnQuYm9keTIgPT0gYjEpKSkgeyByZXR1cm4gZmFsc2U7IH1cclxuICAgICAgICBqcyA9IGpzLm5leHQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gRGV0ZWN0IG92ZXJsYXBwaW5nIHBhaXJzLlxyXG4gICAgZGV0ZWN0UGFpcnM6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIC8vIGNsZWFyIG9sZFxyXG4gICAgICB0aGlzLnBhaXJzID0gW107XHJcbiAgICAgIHRoaXMubnVtUGFpcnMgPSAwO1xyXG4gICAgICB0aGlzLm51bVBhaXJDaGVja3MgPSAwO1xyXG4gICAgICB0aGlzLmNvbGxlY3RQYWlycygpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY29sbGVjdFBhaXJzOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBhZGRQYWlyOiBmdW5jdGlvbiAoczEsIHMyKSB7XHJcblxyXG4gICAgICB2YXIgcGFpciA9IG5ldyBQYWlyKHMxLCBzMik7XHJcbiAgICAgIHRoaXMucGFpcnMucHVzaChwYWlyKTtcclxuICAgICAgdGhpcy5udW1QYWlycysrO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIHZhciBjb3VudCQxID0gMDtcclxuICBmdW5jdGlvbiBQcm94eUlkQ291bnQoKSB7IHJldHVybiBjb3VudCQxKys7IH1cclxuXHJcbiAgLyoqXHJcbiAgICogQSBwcm94eSBpcyB1c2VkIGZvciBicm9hZC1waGFzZSBjb2xsZWN0aW5nIHBhaXJzIHRoYXQgY2FuIGJlIGNvbGxpZGluZy5cclxuICAgKlxyXG4gICAqIEBhdXRob3IgbG8tdGhcclxuICAgKi9cclxuXHJcbiAgZnVuY3Rpb24gUHJveHkoc2hhcGUpIHtcclxuXHJcbiAgICAvL1RoZSBwYXJlbnQgc2hhcGUuXHJcbiAgICB0aGlzLnNoYXBlID0gc2hhcGU7XHJcblxyXG4gICAgLy9UaGUgYXhpcy1hbGlnbmVkIGJvdW5kaW5nIGJveC5cclxuICAgIHRoaXMuYWFiYiA9IHNoYXBlLmFhYmI7XHJcblxyXG4gIH1cclxuICBPYmplY3QuYXNzaWduKFByb3h5LnByb3RvdHlwZSwge1xyXG5cclxuICAgIFByb3h5OiB0cnVlLFxyXG5cclxuICAgIC8vIFVwZGF0ZSB0aGUgcHJveHkuIE11c3QgYmUgaW5oZXJpdGVkIGJ5IGEgY2hpbGQuXHJcblxyXG4gICAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICBwcmludEVycm9yKFwiUHJveHlcIiwgXCJJbmhlcml0YW5jZSBlcnJvci5cIik7XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgKiBBIGJhc2ljIGltcGxlbWVudGF0aW9uIG9mIHByb3hpZXMuXHJcbiAgKlxyXG4gICogQGF1dGhvciBzYWhhcmFuXHJcbiAgKi9cclxuXHJcbiAgZnVuY3Rpb24gQmFzaWNQcm94eShzaGFwZSkge1xyXG5cclxuICAgIFByb3h5LmNhbGwodGhpcywgc2hhcGUpO1xyXG5cclxuICAgIHRoaXMuaWQgPSBQcm94eUlkQ291bnQoKTtcclxuXHJcbiAgfVxyXG4gIEJhc2ljUHJveHkucHJvdG90eXBlID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKFByb3h5LnByb3RvdHlwZSksIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcjogQmFzaWNQcm94eSxcclxuXHJcbiAgICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAvKipcclxuICAqIEEgYnJvYWQtcGhhc2UgYWxnb3JpdGhtIHdpdGggYnJ1dGUtZm9yY2Ugc2VhcmNoLlxyXG4gICogVGhpcyBhbHdheXMgY2hlY2tzIGZvciBhbGwgcG9zc2libGUgcGFpcnMuXHJcbiAgKi9cclxuXHJcbiAgZnVuY3Rpb24gQnJ1dGVGb3JjZUJyb2FkUGhhc2UoKSB7XHJcblxyXG4gICAgQnJvYWRQaGFzZS5jYWxsKHRoaXMpO1xyXG4gICAgdGhpcy50eXBlcyA9IEJSX0JSVVRFX0ZPUkNFO1xyXG4gICAgLy90aGlzLm51bVByb3hpZXM9MDtcclxuICAgIC8vL3RoaXMubWF4UHJveGllcyA9IDI1NjtcclxuICAgIHRoaXMucHJveGllcyA9IFtdO1xyXG4gICAgLy90aGlzLnByb3hpZXMubGVuZ3RoID0gMjU2O1xyXG5cclxuICB9XHJcblxyXG4gIEJydXRlRm9yY2VCcm9hZFBoYXNlLnByb3RvdHlwZSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShCcm9hZFBoYXNlLnByb3RvdHlwZSksIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcjogQnJ1dGVGb3JjZUJyb2FkUGhhc2UsXHJcblxyXG4gICAgY3JlYXRlUHJveHk6IGZ1bmN0aW9uIChzaGFwZSkge1xyXG5cclxuICAgICAgcmV0dXJuIG5ldyBCYXNpY1Byb3h5KHNoYXBlKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGFkZFByb3h5OiBmdW5jdGlvbiAocHJveHkpIHtcclxuXHJcbiAgICAgIC8qaWYodGhpcy5udW1Qcm94aWVzPT10aGlzLm1heFByb3hpZXMpe1xyXG4gICAgICAgICAgLy90aGlzLm1heFByb3hpZXM8PD0xO1xyXG4gICAgICAgICAgdGhpcy5tYXhQcm94aWVzKj0yO1xyXG4gICAgICAgICAgdmFyIG5ld1Byb3hpZXM9W107XHJcbiAgICAgICAgICBuZXdQcm94aWVzLmxlbmd0aCA9IHRoaXMubWF4UHJveGllcztcclxuICAgICAgICAgIHZhciBpID0gdGhpcy5udW1Qcm94aWVzO1xyXG4gICAgICAgICAgd2hpbGUoaS0tKXtcclxuICAgICAgICAgIC8vZm9yKHZhciBpPTAsIGw9dGhpcy5udW1Qcm94aWVzO2k8bDtpKyspe1xyXG4gICAgICAgICAgICAgIG5ld1Byb3hpZXNbaV09dGhpcy5wcm94aWVzW2ldO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5wcm94aWVzPW5ld1Byb3hpZXM7XHJcbiAgICAgIH0qL1xyXG4gICAgICAvL3RoaXMucHJveGllc1t0aGlzLm51bVByb3hpZXMrK10gPSBwcm94eTtcclxuICAgICAgdGhpcy5wcm94aWVzLnB1c2gocHJveHkpO1xyXG4gICAgICAvL3RoaXMubnVtUHJveGllcysrO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcmVtb3ZlUHJveHk6IGZ1bmN0aW9uIChwcm94eSkge1xyXG5cclxuICAgICAgdmFyIG4gPSB0aGlzLnByb3hpZXMuaW5kZXhPZihwcm94eSk7XHJcbiAgICAgIGlmIChuID4gLTEpIHtcclxuICAgICAgICB0aGlzLnByb3hpZXMuc3BsaWNlKG4sIDEpO1xyXG4gICAgICAgIC8vdGhpcy5udW1Qcm94aWVzLS07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8qdmFyIGkgPSB0aGlzLm51bVByb3hpZXM7XHJcbiAgICAgIHdoaWxlKGktLSl7XHJcbiAgICAgIC8vZm9yKHZhciBpPTAsIGw9dGhpcy5udW1Qcm94aWVzO2k8bDtpKyspe1xyXG4gICAgICAgICAgaWYodGhpcy5wcm94aWVzW2ldID09IHByb3h5KXtcclxuICAgICAgICAgICAgICB0aGlzLnByb3hpZXNbaV0gPSB0aGlzLnByb3hpZXNbLS10aGlzLm51bVByb3hpZXNdO1xyXG4gICAgICAgICAgICAgIHRoaXMucHJveGllc1t0aGlzLm51bVByb3hpZXNdID0gbnVsbDtcclxuICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICB9XHJcbiAgICAgIH0qL1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY29sbGVjdFBhaXJzOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB2YXIgaSA9IDAsIGosIHAxLCBwMjtcclxuXHJcbiAgICAgIHZhciBweCA9IHRoaXMucHJveGllcztcclxuICAgICAgdmFyIGwgPSBweC5sZW5ndGg7Ly90aGlzLm51bVByb3hpZXM7XHJcbiAgICAgIC8vdmFyIGFyMSA9IFtdO1xyXG4gICAgICAvL3ZhciBhcjIgPSBbXTtcclxuXHJcbiAgICAgIC8vZm9yKCBpID0gcHgubGVuZ3RoIDsgaS0tIDsgYXIxWyBpIF0gPSBweFsgaSBdICl7fTtcclxuICAgICAgLy9mb3IoIGkgPSBweC5sZW5ndGggOyBpLS0gOyBhcjJbIGkgXSA9IHB4WyBpIF0gKXt9O1xyXG5cclxuICAgICAgLy92YXIgYXIxID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnByb3hpZXMpKVxyXG4gICAgICAvL3ZhciBhcjIgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMucHJveGllcykpXHJcblxyXG4gICAgICB0aGlzLm51bVBhaXJDaGVja3MgPSBsICogKGwgLSAxKSA+PiAxO1xyXG4gICAgICAvL3RoaXMubnVtUGFpckNoZWNrcz10aGlzLm51bVByb3hpZXMqKHRoaXMubnVtUHJveGllcy0xKSowLjU7XHJcblxyXG4gICAgICB3aGlsZSAoaSA8IGwpIHtcclxuICAgICAgICBwMSA9IHB4W2krK107XHJcbiAgICAgICAgaiA9IGkgKyAxO1xyXG4gICAgICAgIHdoaWxlIChqIDwgbCkge1xyXG4gICAgICAgICAgcDIgPSBweFtqKytdO1xyXG4gICAgICAgICAgaWYgKHAxLmFhYmIuaW50ZXJzZWN0VGVzdChwMi5hYWJiKSB8fCAhdGhpcy5pc0F2YWlsYWJsZVBhaXIocDEuc2hhcGUsIHAyLnNoYXBlKSkgY29udGludWU7XHJcbiAgICAgICAgICB0aGlzLmFkZFBhaXIocDEuc2hhcGUsIHAyLnNoYXBlKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAvKipcclxuICAgKiBBIHByb2plY3Rpb24gYXhpcyBmb3Igc3dlZXAgYW5kIHBydW5lIGJyb2FkLXBoYXNlLlxyXG4gICAqIEBhdXRob3Igc2FoYXJhblxyXG4gICAqL1xyXG5cclxuICBmdW5jdGlvbiBTQVBBeGlzKCkge1xyXG5cclxuICAgIHRoaXMubnVtRWxlbWVudHMgPSAwO1xyXG4gICAgdGhpcy5idWZmZXJTaXplID0gMjU2O1xyXG4gICAgdGhpcy5lbGVtZW50cyA9IFtdO1xyXG4gICAgdGhpcy5lbGVtZW50cy5sZW5ndGggPSB0aGlzLmJ1ZmZlclNpemU7XHJcbiAgICB0aGlzLnN0YWNrID0gbmV3IEZsb2F0MzJBcnJheSg2NCk7XHJcblxyXG4gIH1cclxuXHJcbiAgT2JqZWN0LmFzc2lnbihTQVBBeGlzLnByb3RvdHlwZSwge1xyXG5cclxuICAgIFNBUEF4aXM6IHRydWUsXHJcblxyXG4gICAgYWRkRWxlbWVudHM6IGZ1bmN0aW9uIChtaW4sIG1heCkge1xyXG5cclxuICAgICAgaWYgKHRoaXMubnVtRWxlbWVudHMgKyAyID49IHRoaXMuYnVmZmVyU2l6ZSkge1xyXG4gICAgICAgIC8vdGhpcy5idWZmZXJTaXplPDw9MTtcclxuICAgICAgICB0aGlzLmJ1ZmZlclNpemUgKj0gMjtcclxuICAgICAgICB2YXIgbmV3RWxlbWVudHMgPSBbXTtcclxuICAgICAgICB2YXIgaSA9IHRoaXMubnVtRWxlbWVudHM7XHJcbiAgICAgICAgd2hpbGUgKGktLSkge1xyXG4gICAgICAgICAgLy9mb3IodmFyIGk9MCwgbD10aGlzLm51bUVsZW1lbnRzOyBpPGw7IGkrKyl7XHJcbiAgICAgICAgICBuZXdFbGVtZW50c1tpXSA9IHRoaXMuZWxlbWVudHNbaV07XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuZWxlbWVudHNbdGhpcy5udW1FbGVtZW50cysrXSA9IG1pbjtcclxuICAgICAgdGhpcy5lbGVtZW50c1t0aGlzLm51bUVsZW1lbnRzKytdID0gbWF4O1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcmVtb3ZlRWxlbWVudHM6IGZ1bmN0aW9uIChtaW4sIG1heCkge1xyXG5cclxuICAgICAgdmFyIG1pbkluZGV4ID0gLTE7XHJcbiAgICAgIHZhciBtYXhJbmRleCA9IC0xO1xyXG4gICAgICBmb3IgKHZhciBpID0gMCwgbCA9IHRoaXMubnVtRWxlbWVudHM7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICB2YXIgZSA9IHRoaXMuZWxlbWVudHNbaV07XHJcbiAgICAgICAgaWYgKGUgPT0gbWluIHx8IGUgPT0gbWF4KSB7XHJcbiAgICAgICAgICBpZiAobWluSW5kZXggPT0gLTEpIHtcclxuICAgICAgICAgICAgbWluSW5kZXggPSBpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbWF4SW5kZXggPSBpO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZm9yIChpID0gbWluSW5kZXggKyAxLCBsID0gbWF4SW5kZXg7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnRzW2kgLSAxXSA9IHRoaXMuZWxlbWVudHNbaV07XHJcbiAgICAgIH1cclxuICAgICAgZm9yIChpID0gbWF4SW5kZXggKyAxLCBsID0gdGhpcy5udW1FbGVtZW50czsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudHNbaSAtIDJdID0gdGhpcy5lbGVtZW50c1tpXTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5lbGVtZW50c1stLXRoaXMubnVtRWxlbWVudHNdID0gbnVsbDtcclxuICAgICAgdGhpcy5lbGVtZW50c1stLXRoaXMubnVtRWxlbWVudHNdID0gbnVsbDtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHNvcnQ6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHZhciBjb3VudCA9IDA7XHJcbiAgICAgIHZhciB0aHJlc2hvbGQgPSAxO1xyXG4gICAgICB3aGlsZSAoKHRoaXMubnVtRWxlbWVudHMgPj4gdGhyZXNob2xkKSAhPSAwKSB0aHJlc2hvbGQrKztcclxuICAgICAgdGhyZXNob2xkID0gdGhyZXNob2xkICogdGhpcy5udW1FbGVtZW50cyA+PiAyO1xyXG4gICAgICBjb3VudCA9IDA7XHJcblxyXG4gICAgICB2YXIgZ2l2ZXVwID0gZmFsc2U7XHJcbiAgICAgIHZhciBlbGVtZW50cyA9IHRoaXMuZWxlbWVudHM7XHJcbiAgICAgIGZvciAodmFyIGkgPSAxLCBsID0gdGhpcy5udW1FbGVtZW50czsgaSA8IGw7IGkrKykgeyAvLyB0cnkgaW5zZXJ0aW9uIHNvcnRcclxuICAgICAgICB2YXIgdG1wID0gZWxlbWVudHNbaV07XHJcbiAgICAgICAgdmFyIHBpdm90ID0gdG1wLnZhbHVlO1xyXG4gICAgICAgIHZhciB0bXAyID0gZWxlbWVudHNbaSAtIDFdO1xyXG4gICAgICAgIGlmICh0bXAyLnZhbHVlID4gcGl2b3QpIHtcclxuICAgICAgICAgIHZhciBqID0gaTtcclxuICAgICAgICAgIGRvIHtcclxuICAgICAgICAgICAgZWxlbWVudHNbal0gPSB0bXAyO1xyXG4gICAgICAgICAgICBpZiAoLS1qID09IDApIGJyZWFrO1xyXG4gICAgICAgICAgICB0bXAyID0gZWxlbWVudHNbaiAtIDFdO1xyXG4gICAgICAgICAgfSB3aGlsZSAodG1wMi52YWx1ZSA+IHBpdm90KTtcclxuICAgICAgICAgIGVsZW1lbnRzW2pdID0gdG1wO1xyXG4gICAgICAgICAgY291bnQgKz0gaSAtIGo7XHJcbiAgICAgICAgICBpZiAoY291bnQgPiB0aHJlc2hvbGQpIHtcclxuICAgICAgICAgICAgZ2l2ZXVwID0gdHJ1ZTsgLy8gc3RvcCBhbmQgdXNlIHF1aWNrIHNvcnRcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGlmICghZ2l2ZXVwKSByZXR1cm47XHJcbiAgICAgIGNvdW50ID0gMjsgdmFyIHN0YWNrID0gdGhpcy5zdGFjaztcclxuICAgICAgc3RhY2tbMF0gPSAwO1xyXG4gICAgICBzdGFja1sxXSA9IHRoaXMubnVtRWxlbWVudHMgLSAxO1xyXG4gICAgICB3aGlsZSAoY291bnQgPiAwKSB7XHJcbiAgICAgICAgdmFyIHJpZ2h0ID0gc3RhY2tbLS1jb3VudF07XHJcbiAgICAgICAgdmFyIGxlZnQgPSBzdGFja1stLWNvdW50XTtcclxuICAgICAgICB2YXIgZGlmZiA9IHJpZ2h0IC0gbGVmdDtcclxuICAgICAgICBpZiAoZGlmZiA+IDE2KSB7ICAvLyBxdWljayBzb3J0XHJcbiAgICAgICAgICAvL3ZhciBtaWQ9bGVmdCsoZGlmZj4+MSk7XHJcbiAgICAgICAgICB2YXIgbWlkID0gbGVmdCArIChfTWF0aC5mbG9vcihkaWZmICogMC41KSk7XHJcbiAgICAgICAgICB0bXAgPSBlbGVtZW50c1ttaWRdO1xyXG4gICAgICAgICAgZWxlbWVudHNbbWlkXSA9IGVsZW1lbnRzW3JpZ2h0XTtcclxuICAgICAgICAgIGVsZW1lbnRzW3JpZ2h0XSA9IHRtcDtcclxuICAgICAgICAgIHBpdm90ID0gdG1wLnZhbHVlO1xyXG4gICAgICAgICAgaSA9IGxlZnQgLSAxO1xyXG4gICAgICAgICAgaiA9IHJpZ2h0O1xyXG4gICAgICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICAgICAgdmFyIGVpO1xyXG4gICAgICAgICAgICB2YXIgZWo7XHJcbiAgICAgICAgICAgIGRvIHsgZWkgPSBlbGVtZW50c1srK2ldOyB9IHdoaWxlIChlaS52YWx1ZSA8IHBpdm90KTtcclxuICAgICAgICAgICAgZG8geyBlaiA9IGVsZW1lbnRzWy0tal07IH0gd2hpbGUgKHBpdm90IDwgZWoudmFsdWUgJiYgaiAhPSBsZWZ0KTtcclxuICAgICAgICAgICAgaWYgKGkgPj0gaikgYnJlYWs7XHJcbiAgICAgICAgICAgIGVsZW1lbnRzW2ldID0gZWo7XHJcbiAgICAgICAgICAgIGVsZW1lbnRzW2pdID0gZWk7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgZWxlbWVudHNbcmlnaHRdID0gZWxlbWVudHNbaV07XHJcbiAgICAgICAgICBlbGVtZW50c1tpXSA9IHRtcDtcclxuICAgICAgICAgIGlmIChpIC0gbGVmdCA+IHJpZ2h0IC0gaSkge1xyXG4gICAgICAgICAgICBzdGFja1tjb3VudCsrXSA9IGxlZnQ7XHJcbiAgICAgICAgICAgIHN0YWNrW2NvdW50KytdID0gaSAtIDE7XHJcbiAgICAgICAgICAgIHN0YWNrW2NvdW50KytdID0gaSArIDE7XHJcbiAgICAgICAgICAgIHN0YWNrW2NvdW50KytdID0gcmlnaHQ7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzdGFja1tjb3VudCsrXSA9IGkgKyAxO1xyXG4gICAgICAgICAgICBzdGFja1tjb3VudCsrXSA9IHJpZ2h0O1xyXG4gICAgICAgICAgICBzdGFja1tjb3VudCsrXSA9IGxlZnQ7XHJcbiAgICAgICAgICAgIHN0YWNrW2NvdW50KytdID0gaSAtIDE7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGZvciAoaSA9IGxlZnQgKyAxOyBpIDw9IHJpZ2h0OyBpKyspIHtcclxuICAgICAgICAgICAgdG1wID0gZWxlbWVudHNbaV07XHJcbiAgICAgICAgICAgIHBpdm90ID0gdG1wLnZhbHVlO1xyXG4gICAgICAgICAgICB0bXAyID0gZWxlbWVudHNbaSAtIDFdO1xyXG4gICAgICAgICAgICBpZiAodG1wMi52YWx1ZSA+IHBpdm90KSB7XHJcbiAgICAgICAgICAgICAgaiA9IGk7XHJcbiAgICAgICAgICAgICAgZG8ge1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudHNbal0gPSB0bXAyO1xyXG4gICAgICAgICAgICAgICAgaWYgKC0taiA9PSAwKSBicmVhaztcclxuICAgICAgICAgICAgICAgIHRtcDIgPSBlbGVtZW50c1tqIC0gMV07XHJcbiAgICAgICAgICAgICAgfSB3aGlsZSAodG1wMi52YWx1ZSA+IHBpdm90KTtcclxuICAgICAgICAgICAgICBlbGVtZW50c1tqXSA9IHRtcDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2FsY3VsYXRlVGVzdENvdW50OiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB2YXIgbnVtID0gMTtcclxuICAgICAgdmFyIHN1bSA9IDA7XHJcbiAgICAgIGZvciAodmFyIGkgPSAxLCBsID0gdGhpcy5udW1FbGVtZW50czsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnRzW2ldLm1heCkge1xyXG4gICAgICAgICAgbnVtLS07XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHN1bSArPSBudW07XHJcbiAgICAgICAgICBudW0rKztcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHN1bTtcclxuXHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAvKipcclxuICAgKiBBbiBlbGVtZW50IG9mIHByb3hpZXMuXHJcbiAgICogQGF1dGhvciBzYWhhcmFuXHJcbiAgICovXHJcblxyXG4gIGZ1bmN0aW9uIFNBUEVsZW1lbnQocHJveHksIG1heCkge1xyXG5cclxuICAgIC8vIFRoZSBwYXJlbnQgcHJveHlcclxuICAgIHRoaXMucHJveHkgPSBwcm94eTtcclxuICAgIC8vIFRoZSBwYWlyIGVsZW1lbnQuXHJcbiAgICB0aGlzLnBhaXIgPSBudWxsO1xyXG4gICAgLy8gVGhlIG1pbmltdW0gZWxlbWVudCBvbiBvdGhlciBheGlzLlxyXG4gICAgdGhpcy5taW4xID0gbnVsbDtcclxuICAgIC8vIFRoZSBtYXhpbXVtIGVsZW1lbnQgb24gb3RoZXIgYXhpcy5cclxuICAgIHRoaXMubWF4MSA9IG51bGw7XHJcbiAgICAvLyBUaGUgbWluaW11bSBlbGVtZW50IG9uIG90aGVyIGF4aXMuXHJcbiAgICB0aGlzLm1pbjIgPSBudWxsO1xyXG4gICAgLy8gVGhlIG1heGltdW0gZWxlbWVudCBvbiBvdGhlciBheGlzLlxyXG4gICAgdGhpcy5tYXgyID0gbnVsbDtcclxuICAgIC8vIFdoZXRoZXIgdGhlIGVsZW1lbnQgaGFzIG1heGltdW0gdmFsdWUgb3Igbm90LlxyXG4gICAgdGhpcy5tYXggPSBtYXg7XHJcbiAgICAvLyBUaGUgdmFsdWUgb2YgdGhlIGVsZW1lbnQuXHJcbiAgICB0aGlzLnZhbHVlID0gMDtcclxuXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBBIHByb3h5IGZvciBzd2VlcCBhbmQgcHJ1bmUgYnJvYWQtcGhhc2UuXHJcbiAgICogQGF1dGhvciBzYWhhcmFuXHJcbiAgICogQGF1dGhvciBsby10aFxyXG4gICAqL1xyXG5cclxuICBmdW5jdGlvbiBTQVBQcm94eShzYXAsIHNoYXBlKSB7XHJcblxyXG4gICAgUHJveHkuY2FsbCh0aGlzLCBzaGFwZSk7XHJcbiAgICAvLyBUeXBlIG9mIHRoZSBheGlzIHRvIHdoaWNoIHRoZSBwcm94eSBiZWxvbmdzIHRvLiBbMDpub25lLCAxOmR5bmFtaWMsIDI6c3RhdGljXVxyXG4gICAgdGhpcy5iZWxvbmdzVG8gPSAwO1xyXG4gICAgLy8gVGhlIG1heGltdW0gZWxlbWVudHMgb24gZWFjaCBheGlzLlxyXG4gICAgdGhpcy5tYXggPSBbXTtcclxuICAgIC8vIFRoZSBtaW5pbXVtIGVsZW1lbnRzIG9uIGVhY2ggYXhpcy5cclxuICAgIHRoaXMubWluID0gW107XHJcblxyXG4gICAgdGhpcy5zYXAgPSBzYXA7XHJcbiAgICB0aGlzLm1pblswXSA9IG5ldyBTQVBFbGVtZW50KHRoaXMsIGZhbHNlKTtcclxuICAgIHRoaXMubWF4WzBdID0gbmV3IFNBUEVsZW1lbnQodGhpcywgdHJ1ZSk7XHJcbiAgICB0aGlzLm1pblsxXSA9IG5ldyBTQVBFbGVtZW50KHRoaXMsIGZhbHNlKTtcclxuICAgIHRoaXMubWF4WzFdID0gbmV3IFNBUEVsZW1lbnQodGhpcywgdHJ1ZSk7XHJcbiAgICB0aGlzLm1pblsyXSA9IG5ldyBTQVBFbGVtZW50KHRoaXMsIGZhbHNlKTtcclxuICAgIHRoaXMubWF4WzJdID0gbmV3IFNBUEVsZW1lbnQodGhpcywgdHJ1ZSk7XHJcbiAgICB0aGlzLm1heFswXS5wYWlyID0gdGhpcy5taW5bMF07XHJcbiAgICB0aGlzLm1heFsxXS5wYWlyID0gdGhpcy5taW5bMV07XHJcbiAgICB0aGlzLm1heFsyXS5wYWlyID0gdGhpcy5taW5bMl07XHJcbiAgICB0aGlzLm1pblswXS5taW4xID0gdGhpcy5taW5bMV07XHJcbiAgICB0aGlzLm1pblswXS5tYXgxID0gdGhpcy5tYXhbMV07XHJcbiAgICB0aGlzLm1pblswXS5taW4yID0gdGhpcy5taW5bMl07XHJcbiAgICB0aGlzLm1pblswXS5tYXgyID0gdGhpcy5tYXhbMl07XHJcbiAgICB0aGlzLm1pblsxXS5taW4xID0gdGhpcy5taW5bMF07XHJcbiAgICB0aGlzLm1pblsxXS5tYXgxID0gdGhpcy5tYXhbMF07XHJcbiAgICB0aGlzLm1pblsxXS5taW4yID0gdGhpcy5taW5bMl07XHJcbiAgICB0aGlzLm1pblsxXS5tYXgyID0gdGhpcy5tYXhbMl07XHJcbiAgICB0aGlzLm1pblsyXS5taW4xID0gdGhpcy5taW5bMF07XHJcbiAgICB0aGlzLm1pblsyXS5tYXgxID0gdGhpcy5tYXhbMF07XHJcbiAgICB0aGlzLm1pblsyXS5taW4yID0gdGhpcy5taW5bMV07XHJcbiAgICB0aGlzLm1pblsyXS5tYXgyID0gdGhpcy5tYXhbMV07XHJcblxyXG4gIH1cclxuICBTQVBQcm94eS5wcm90b3R5cGUgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoUHJveHkucHJvdG90eXBlKSwge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yOiBTQVBQcm94eSxcclxuXHJcblxyXG4gICAgLy8gUmV0dXJucyB3aGV0aGVyIHRoZSBwcm94eSBpcyBkeW5hbWljIG9yIG5vdC5cclxuICAgIGlzRHluYW1pYzogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgdmFyIGJvZHkgPSB0aGlzLnNoYXBlLnBhcmVudDtcclxuICAgICAgcmV0dXJuIGJvZHkuaXNEeW5hbWljICYmICFib2R5LnNsZWVwaW5nO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB2YXIgdGUgPSB0aGlzLmFhYmIuZWxlbWVudHM7XHJcbiAgICAgIHRoaXMubWluWzBdLnZhbHVlID0gdGVbMF07XHJcbiAgICAgIHRoaXMubWluWzFdLnZhbHVlID0gdGVbMV07XHJcbiAgICAgIHRoaXMubWluWzJdLnZhbHVlID0gdGVbMl07XHJcbiAgICAgIHRoaXMubWF4WzBdLnZhbHVlID0gdGVbM107XHJcbiAgICAgIHRoaXMubWF4WzFdLnZhbHVlID0gdGVbNF07XHJcbiAgICAgIHRoaXMubWF4WzJdLnZhbHVlID0gdGVbNV07XHJcblxyXG4gICAgICBpZiAodGhpcy5iZWxvbmdzVG8gPT0gMSAmJiAhdGhpcy5pc0R5bmFtaWMoKSB8fCB0aGlzLmJlbG9uZ3NUbyA9PSAyICYmIHRoaXMuaXNEeW5hbWljKCkpIHtcclxuICAgICAgICB0aGlzLnNhcC5yZW1vdmVQcm94eSh0aGlzKTtcclxuICAgICAgICB0aGlzLnNhcC5hZGRQcm94eSh0aGlzKTtcclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIEEgYnJvYWQtcGhhc2UgY29sbGlzaW9uIGRldGVjdGlvbiBhbGdvcml0aG0gdXNpbmcgc3dlZXAgYW5kIHBydW5lLlxyXG4gICAqIEBhdXRob3Igc2FoYXJhblxyXG4gICAqIEBhdXRob3IgbG8tdGhcclxuICAgKi9cclxuXHJcbiAgZnVuY3Rpb24gU0FQQnJvYWRQaGFzZSgpIHtcclxuXHJcbiAgICBCcm9hZFBoYXNlLmNhbGwodGhpcyk7XHJcbiAgICB0aGlzLnR5cGVzID0gQlJfU1dFRVBfQU5EX1BSVU5FO1xyXG5cclxuICAgIHRoaXMubnVtRWxlbWVudHNEID0gMDtcclxuICAgIHRoaXMubnVtRWxlbWVudHNTID0gMDtcclxuICAgIC8vIGR5bmFtaWMgcHJveGllc1xyXG4gICAgdGhpcy5heGVzRCA9IFtcclxuICAgICAgbmV3IFNBUEF4aXMoKSxcclxuICAgICAgbmV3IFNBUEF4aXMoKSxcclxuICAgICAgbmV3IFNBUEF4aXMoKVxyXG4gICAgXTtcclxuICAgIC8vIHN0YXRpYyBvciBzbGVlcGluZyBwcm94aWVzXHJcbiAgICB0aGlzLmF4ZXNTID0gW1xyXG4gICAgICBuZXcgU0FQQXhpcygpLFxyXG4gICAgICBuZXcgU0FQQXhpcygpLFxyXG4gICAgICBuZXcgU0FQQXhpcygpXHJcbiAgICBdO1xyXG5cclxuICAgIHRoaXMuaW5kZXgxID0gMDtcclxuICAgIHRoaXMuaW5kZXgyID0gMTtcclxuXHJcbiAgfVxyXG4gIFNBUEJyb2FkUGhhc2UucHJvdG90eXBlID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKEJyb2FkUGhhc2UucHJvdG90eXBlKSwge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yOiBTQVBCcm9hZFBoYXNlLFxyXG5cclxuICAgIGNyZWF0ZVByb3h5OiBmdW5jdGlvbiAoc2hhcGUpIHtcclxuXHJcbiAgICAgIHJldHVybiBuZXcgU0FQUHJveHkodGhpcywgc2hhcGUpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgYWRkUHJveHk6IGZ1bmN0aW9uIChwcm94eSkge1xyXG5cclxuICAgICAgdmFyIHAgPSBwcm94eTtcclxuICAgICAgaWYgKHAuaXNEeW5hbWljKCkpIHtcclxuICAgICAgICB0aGlzLmF4ZXNEWzBdLmFkZEVsZW1lbnRzKHAubWluWzBdLCBwLm1heFswXSk7XHJcbiAgICAgICAgdGhpcy5heGVzRFsxXS5hZGRFbGVtZW50cyhwLm1pblsxXSwgcC5tYXhbMV0pO1xyXG4gICAgICAgIHRoaXMuYXhlc0RbMl0uYWRkRWxlbWVudHMocC5taW5bMl0sIHAubWF4WzJdKTtcclxuICAgICAgICBwLmJlbG9uZ3NUbyA9IDE7XHJcbiAgICAgICAgdGhpcy5udW1FbGVtZW50c0QgKz0gMjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLmF4ZXNTWzBdLmFkZEVsZW1lbnRzKHAubWluWzBdLCBwLm1heFswXSk7XHJcbiAgICAgICAgdGhpcy5heGVzU1sxXS5hZGRFbGVtZW50cyhwLm1pblsxXSwgcC5tYXhbMV0pO1xyXG4gICAgICAgIHRoaXMuYXhlc1NbMl0uYWRkRWxlbWVudHMocC5taW5bMl0sIHAubWF4WzJdKTtcclxuICAgICAgICBwLmJlbG9uZ3NUbyA9IDI7XHJcbiAgICAgICAgdGhpcy5udW1FbGVtZW50c1MgKz0gMjtcclxuICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcmVtb3ZlUHJveHk6IGZ1bmN0aW9uIChwcm94eSkge1xyXG5cclxuICAgICAgdmFyIHAgPSBwcm94eTtcclxuICAgICAgaWYgKHAuYmVsb25nc1RvID09IDApIHJldHVybjtcclxuXHJcbiAgICAgIC8qZWxzZSBpZiAoIHAuYmVsb25nc1RvID09IDEgKSB7XHJcbiAgICAgICAgICB0aGlzLmF4ZXNEWzBdLnJlbW92ZUVsZW1lbnRzKCBwLm1pblswXSwgcC5tYXhbMF0gKTtcclxuICAgICAgICAgIHRoaXMuYXhlc0RbMV0ucmVtb3ZlRWxlbWVudHMoIHAubWluWzFdLCBwLm1heFsxXSApO1xyXG4gICAgICAgICAgdGhpcy5heGVzRFsyXS5yZW1vdmVFbGVtZW50cyggcC5taW5bMl0sIHAubWF4WzJdICk7XHJcbiAgICAgICAgICB0aGlzLm51bUVsZW1lbnRzRCAtPSAyO1xyXG4gICAgICB9IGVsc2UgaWYgKCBwLmJlbG9uZ3NUbyA9PSAyICkge1xyXG4gICAgICAgICAgdGhpcy5heGVzU1swXS5yZW1vdmVFbGVtZW50cyggcC5taW5bMF0sIHAubWF4WzBdICk7XHJcbiAgICAgICAgICB0aGlzLmF4ZXNTWzFdLnJlbW92ZUVsZW1lbnRzKCBwLm1pblsxXSwgcC5tYXhbMV0gKTtcclxuICAgICAgICAgIHRoaXMuYXhlc1NbMl0ucmVtb3ZlRWxlbWVudHMoIHAubWluWzJdLCBwLm1heFsyXSApO1xyXG4gICAgICAgICAgdGhpcy5udW1FbGVtZW50c1MgLT0gMjtcclxuICAgICAgfSovXHJcblxyXG4gICAgICBzd2l0Y2ggKHAuYmVsb25nc1RvKSB7XHJcbiAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgdGhpcy5heGVzRFswXS5yZW1vdmVFbGVtZW50cyhwLm1pblswXSwgcC5tYXhbMF0pO1xyXG4gICAgICAgICAgdGhpcy5heGVzRFsxXS5yZW1vdmVFbGVtZW50cyhwLm1pblsxXSwgcC5tYXhbMV0pO1xyXG4gICAgICAgICAgdGhpcy5heGVzRFsyXS5yZW1vdmVFbGVtZW50cyhwLm1pblsyXSwgcC5tYXhbMl0pO1xyXG4gICAgICAgICAgdGhpcy5udW1FbGVtZW50c0QgLT0gMjtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgIHRoaXMuYXhlc1NbMF0ucmVtb3ZlRWxlbWVudHMocC5taW5bMF0sIHAubWF4WzBdKTtcclxuICAgICAgICAgIHRoaXMuYXhlc1NbMV0ucmVtb3ZlRWxlbWVudHMocC5taW5bMV0sIHAubWF4WzFdKTtcclxuICAgICAgICAgIHRoaXMuYXhlc1NbMl0ucmVtb3ZlRWxlbWVudHMocC5taW5bMl0sIHAubWF4WzJdKTtcclxuICAgICAgICAgIHRoaXMubnVtRWxlbWVudHNTIC09IDI7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG5cclxuICAgICAgcC5iZWxvbmdzVG8gPSAwO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY29sbGVjdFBhaXJzOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICBpZiAodGhpcy5udW1FbGVtZW50c0QgPT0gMCkgcmV0dXJuO1xyXG5cclxuICAgICAgdmFyIGF4aXMxID0gdGhpcy5heGVzRFt0aGlzLmluZGV4MV07XHJcbiAgICAgIHZhciBheGlzMiA9IHRoaXMuYXhlc0RbdGhpcy5pbmRleDJdO1xyXG5cclxuICAgICAgYXhpczEuc29ydCgpO1xyXG4gICAgICBheGlzMi5zb3J0KCk7XHJcblxyXG4gICAgICB2YXIgY291bnQxID0gYXhpczEuY2FsY3VsYXRlVGVzdENvdW50KCk7XHJcbiAgICAgIHZhciBjb3VudDIgPSBheGlzMi5jYWxjdWxhdGVUZXN0Q291bnQoKTtcclxuICAgICAgdmFyIGVsZW1lbnRzRDtcclxuICAgICAgdmFyIGVsZW1lbnRzUztcclxuICAgICAgaWYgKGNvdW50MSA8PSBjb3VudDIpIHsvLyBzZWxlY3QgdGhlIGJlc3QgYXhpc1xyXG4gICAgICAgIGF4aXMyID0gdGhpcy5heGVzU1t0aGlzLmluZGV4MV07XHJcbiAgICAgICAgYXhpczIuc29ydCgpO1xyXG4gICAgICAgIGVsZW1lbnRzRCA9IGF4aXMxLmVsZW1lbnRzO1xyXG4gICAgICAgIGVsZW1lbnRzUyA9IGF4aXMyLmVsZW1lbnRzO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGF4aXMxID0gdGhpcy5heGVzU1t0aGlzLmluZGV4Ml07XHJcbiAgICAgICAgYXhpczEuc29ydCgpO1xyXG4gICAgICAgIGVsZW1lbnRzRCA9IGF4aXMyLmVsZW1lbnRzO1xyXG4gICAgICAgIGVsZW1lbnRzUyA9IGF4aXMxLmVsZW1lbnRzO1xyXG4gICAgICAgIHRoaXMuaW5kZXgxIF49IHRoaXMuaW5kZXgyO1xyXG4gICAgICAgIHRoaXMuaW5kZXgyIF49IHRoaXMuaW5kZXgxO1xyXG4gICAgICAgIHRoaXMuaW5kZXgxIF49IHRoaXMuaW5kZXgyO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBhY3RpdmVEO1xyXG4gICAgICB2YXIgYWN0aXZlUztcclxuICAgICAgdmFyIHAgPSAwO1xyXG4gICAgICB2YXIgcSA9IDA7XHJcbiAgICAgIHdoaWxlIChwIDwgdGhpcy5udW1FbGVtZW50c0QpIHtcclxuICAgICAgICB2YXIgZTE7XHJcbiAgICAgICAgdmFyIGR5bjtcclxuICAgICAgICBpZiAocSA9PSB0aGlzLm51bUVsZW1lbnRzUykge1xyXG4gICAgICAgICAgZTEgPSBlbGVtZW50c0RbcF07XHJcbiAgICAgICAgICBkeW4gPSB0cnVlO1xyXG4gICAgICAgICAgcCsrO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICB2YXIgZCA9IGVsZW1lbnRzRFtwXTtcclxuICAgICAgICAgIHZhciBzID0gZWxlbWVudHNTW3FdO1xyXG4gICAgICAgICAgaWYgKGQudmFsdWUgPCBzLnZhbHVlKSB7XHJcbiAgICAgICAgICAgIGUxID0gZDtcclxuICAgICAgICAgICAgZHluID0gdHJ1ZTtcclxuICAgICAgICAgICAgcCsrO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZTEgPSBzO1xyXG4gICAgICAgICAgICBkeW4gPSBmYWxzZTtcclxuICAgICAgICAgICAgcSsrO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWUxLm1heCkge1xyXG4gICAgICAgICAgdmFyIHMxID0gZTEucHJveHkuc2hhcGU7XHJcbiAgICAgICAgICB2YXIgbWluMSA9IGUxLm1pbjEudmFsdWU7XHJcbiAgICAgICAgICB2YXIgbWF4MSA9IGUxLm1heDEudmFsdWU7XHJcbiAgICAgICAgICB2YXIgbWluMiA9IGUxLm1pbjIudmFsdWU7XHJcbiAgICAgICAgICB2YXIgbWF4MiA9IGUxLm1heDIudmFsdWU7XHJcblxyXG4gICAgICAgICAgZm9yICh2YXIgZTIgPSBhY3RpdmVEOyBlMiAhPSBudWxsOyBlMiA9IGUyLnBhaXIpIHsvLyB0ZXN0IGZvciBkeW5hbWljXHJcbiAgICAgICAgICAgIHZhciBzMiA9IGUyLnByb3h5LnNoYXBlO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5udW1QYWlyQ2hlY2tzKys7XHJcbiAgICAgICAgICAgIGlmIChtaW4xID4gZTIubWF4MS52YWx1ZSB8fCBtYXgxIDwgZTIubWluMS52YWx1ZSB8fCBtaW4yID4gZTIubWF4Mi52YWx1ZSB8fCBtYXgyIDwgZTIubWluMi52YWx1ZSB8fCAhdGhpcy5pc0F2YWlsYWJsZVBhaXIoczEsIHMyKSkgY29udGludWU7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkUGFpcihzMSwgczIpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKGR5bikge1xyXG4gICAgICAgICAgICBmb3IgKGUyID0gYWN0aXZlUzsgZTIgIT0gbnVsbDsgZTIgPSBlMi5wYWlyKSB7Ly8gdGVzdCBmb3Igc3RhdGljXHJcbiAgICAgICAgICAgICAgczIgPSBlMi5wcm94eS5zaGFwZTtcclxuXHJcbiAgICAgICAgICAgICAgdGhpcy5udW1QYWlyQ2hlY2tzKys7XHJcblxyXG4gICAgICAgICAgICAgIGlmIChtaW4xID4gZTIubWF4MS52YWx1ZSB8fCBtYXgxIDwgZTIubWluMS52YWx1ZSB8fCBtaW4yID4gZTIubWF4Mi52YWx1ZSB8fCBtYXgyIDwgZTIubWluMi52YWx1ZSB8fCAhdGhpcy5pc0F2YWlsYWJsZVBhaXIoczEsIHMyKSkgY29udGludWU7XHJcbiAgICAgICAgICAgICAgdGhpcy5hZGRQYWlyKHMxLCBzMik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZTEucGFpciA9IGFjdGl2ZUQ7XHJcbiAgICAgICAgICAgIGFjdGl2ZUQgPSBlMTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGUxLnBhaXIgPSBhY3RpdmVTO1xyXG4gICAgICAgICAgICBhY3RpdmVTID0gZTE7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHZhciBtaW4gPSBlMS5wYWlyO1xyXG4gICAgICAgICAgaWYgKGR5bikge1xyXG4gICAgICAgICAgICBpZiAobWluID09IGFjdGl2ZUQpIHtcclxuICAgICAgICAgICAgICBhY3RpdmVEID0gYWN0aXZlRC5wYWlyO1xyXG4gICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGUxID0gYWN0aXZlRDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKG1pbiA9PSBhY3RpdmVTKSB7XHJcbiAgICAgICAgICAgICAgYWN0aXZlUyA9IGFjdGl2ZVMucGFpcjtcclxuICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBlMSA9IGFjdGl2ZVM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHdoaWxlIChlMSkge1xyXG4gICAgICAgICAgICBlMiA9IGUxLnBhaXI7XHJcbiAgICAgICAgICAgIGlmIChlMiA9PSBtaW4pIHtcclxuICAgICAgICAgICAgICBlMS5wYWlyID0gZTIucGFpcjtcclxuICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlMSA9IGUyO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB0aGlzLmluZGV4MiA9ICh0aGlzLmluZGV4MSB8IHRoaXMuaW5kZXgyKSBeIDM7XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgKiBBIG5vZGUgb2YgdGhlIGR5bmFtaWMgYm91bmRpbmcgdm9sdW1lIHRyZWUuXHJcbiAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAqL1xyXG5cclxuICBmdW5jdGlvbiBEQlZUTm9kZSgpIHtcclxuXHJcbiAgICAvLyBUaGUgZmlyc3QgY2hpbGQgbm9kZSBvZiB0aGlzIG5vZGUuXHJcbiAgICB0aGlzLmNoaWxkMSA9IG51bGw7XHJcbiAgICAvLyBUaGUgc2Vjb25kIGNoaWxkIG5vZGUgb2YgdGhpcyBub2RlLlxyXG4gICAgdGhpcy5jaGlsZDIgPSBudWxsO1xyXG4gICAgLy8gIFRoZSBwYXJlbnQgbm9kZSBvZiB0aGlzIHRyZWUuXHJcbiAgICB0aGlzLnBhcmVudCA9IG51bGw7XHJcbiAgICAvLyBUaGUgcHJveHkgb2YgdGhpcyBub2RlLiBUaGlzIGhhcyBubyB2YWx1ZSBpZiB0aGlzIG5vZGUgaXMgbm90IGxlYWYuXHJcbiAgICB0aGlzLnByb3h5ID0gbnVsbDtcclxuICAgIC8vIFRoZSBtYXhpbXVtIGRpc3RhbmNlIGZyb20gbGVhZiBub2Rlcy5cclxuICAgIHRoaXMuaGVpZ2h0ID0gMDtcclxuICAgIC8vIFRoZSBBQUJCIG9mIHRoaXMgbm9kZS5cclxuICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7XHJcblxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQSBkeW5hbWljIGJvdW5kaW5nIHZvbHVtZSB0cmVlIGZvciB0aGUgYnJvYWQtcGhhc2UgYWxnb3JpdGhtLlxyXG4gICAqXHJcbiAgICogQGF1dGhvciBzYWhhcmFuXHJcbiAgICogQGF1dGhvciBsby10aFxyXG4gICAqL1xyXG5cclxuICBmdW5jdGlvbiBEQlZUKCkge1xyXG5cclxuICAgIC8vIFRoZSByb290IG9mIHRoZSB0cmVlLlxyXG4gICAgdGhpcy5yb290ID0gbnVsbDtcclxuICAgIHRoaXMuZnJlZU5vZGVzID0gW107XHJcbiAgICB0aGlzLmZyZWVOb2Rlcy5sZW5ndGggPSAxNjM4NDtcclxuICAgIHRoaXMubnVtRnJlZU5vZGVzID0gMDtcclxuICAgIHRoaXMuYWFiYiA9IG5ldyBBQUJCKCk7XHJcblxyXG4gIH1cclxuICBPYmplY3QuYXNzaWduKERCVlQucHJvdG90eXBlLCB7XHJcblxyXG4gICAgREJWVDogdHJ1ZSxcclxuXHJcbiAgICBtb3ZlTGVhZjogZnVuY3Rpb24gKGxlYWYpIHtcclxuXHJcbiAgICAgIHRoaXMuZGVsZXRlTGVhZihsZWFmKTtcclxuICAgICAgdGhpcy5pbnNlcnRMZWFmKGxlYWYpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgaW5zZXJ0TGVhZjogZnVuY3Rpb24gKGxlYWYpIHtcclxuXHJcbiAgICAgIGlmICh0aGlzLnJvb3QgPT0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMucm9vdCA9IGxlYWY7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBsYiA9IGxlYWYuYWFiYjtcclxuICAgICAgdmFyIHNpYmxpbmcgPSB0aGlzLnJvb3Q7XHJcbiAgICAgIHZhciBvbGRBcmVhO1xyXG4gICAgICB2YXIgbmV3QXJlYTtcclxuICAgICAgd2hpbGUgKHNpYmxpbmcucHJveHkgPT0gbnVsbCkgeyAvLyBkZXNjZW5kIHRoZSBub2RlIHRvIHNlYXJjaCB0aGUgYmVzdCBwYWlyXHJcbiAgICAgICAgdmFyIGMxID0gc2libGluZy5jaGlsZDE7XHJcbiAgICAgICAgdmFyIGMyID0gc2libGluZy5jaGlsZDI7XHJcbiAgICAgICAgdmFyIGIgPSBzaWJsaW5nLmFhYmI7XHJcbiAgICAgICAgdmFyIGMxYiA9IGMxLmFhYmI7XHJcbiAgICAgICAgdmFyIGMyYiA9IGMyLmFhYmI7XHJcbiAgICAgICAgb2xkQXJlYSA9IGIuc3VyZmFjZUFyZWEoKTtcclxuICAgICAgICB0aGlzLmFhYmIuY29tYmluZShsYiwgYik7XHJcbiAgICAgICAgbmV3QXJlYSA9IHRoaXMuYWFiYi5zdXJmYWNlQXJlYSgpO1xyXG4gICAgICAgIHZhciBjcmVhdGluZ0Nvc3QgPSBuZXdBcmVhICogMjtcclxuICAgICAgICB2YXIgaW5jcmVtZW50YWxDb3N0ID0gKG5ld0FyZWEgLSBvbGRBcmVhKSAqIDI7IC8vIGNvc3Qgb2YgY3JlYXRpbmcgYSBuZXcgcGFpciB3aXRoIHRoZSBub2RlXHJcbiAgICAgICAgdmFyIGRpc2NlbmRpbmdDb3N0MSA9IGluY3JlbWVudGFsQ29zdDtcclxuICAgICAgICB0aGlzLmFhYmIuY29tYmluZShsYiwgYzFiKTtcclxuICAgICAgICBpZiAoYzEucHJveHkgIT0gbnVsbCkge1xyXG4gICAgICAgICAgLy8gbGVhZiBjb3N0ID0gYXJlYShjb21iaW5lZCBhYWJiKVxyXG4gICAgICAgICAgZGlzY2VuZGluZ0Nvc3QxICs9IHRoaXMuYWFiYi5zdXJmYWNlQXJlYSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvLyBub2RlIGNvc3QgPSBhcmVhKGNvbWJpbmVkIGFhYmIpIC0gYXJlYShvbGQgYWFiYilcclxuICAgICAgICAgIGRpc2NlbmRpbmdDb3N0MSArPSB0aGlzLmFhYmIuc3VyZmFjZUFyZWEoKSAtIGMxYi5zdXJmYWNlQXJlYSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgZGlzY2VuZGluZ0Nvc3QyID0gaW5jcmVtZW50YWxDb3N0O1xyXG4gICAgICAgIHRoaXMuYWFiYi5jb21iaW5lKGxiLCBjMmIpO1xyXG4gICAgICAgIGlmIChjMi5wcm94eSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAvLyBsZWFmIGNvc3QgPSBhcmVhKGNvbWJpbmVkIGFhYmIpXHJcbiAgICAgICAgICBkaXNjZW5kaW5nQ29zdDIgKz0gdGhpcy5hYWJiLnN1cmZhY2VBcmVhKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIC8vIG5vZGUgY29zdCA9IGFyZWEoY29tYmluZWQgYWFiYikgLSBhcmVhKG9sZCBhYWJiKVxyXG4gICAgICAgICAgZGlzY2VuZGluZ0Nvc3QyICs9IHRoaXMuYWFiYi5zdXJmYWNlQXJlYSgpIC0gYzJiLnN1cmZhY2VBcmVhKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkaXNjZW5kaW5nQ29zdDEgPCBkaXNjZW5kaW5nQ29zdDIpIHtcclxuICAgICAgICAgIGlmIChjcmVhdGluZ0Nvc3QgPCBkaXNjZW5kaW5nQ29zdDEpIHtcclxuICAgICAgICAgICAgYnJlYWs7Ly8gc3RvcCBkZXNjZW5kaW5nXHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzaWJsaW5nID0gYzE7Ly8gZGVzY2VuZCBpbnRvIGZpcnN0IGNoaWxkXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChjcmVhdGluZ0Nvc3QgPCBkaXNjZW5kaW5nQ29zdDIpIHtcclxuICAgICAgICAgICAgYnJlYWs7Ly8gc3RvcCBkZXNjZW5kaW5nXHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzaWJsaW5nID0gYzI7Ly8gZGVzY2VuZCBpbnRvIHNlY29uZCBjaGlsZFxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICB2YXIgb2xkUGFyZW50ID0gc2libGluZy5wYXJlbnQ7XHJcbiAgICAgIHZhciBuZXdQYXJlbnQ7XHJcbiAgICAgIGlmICh0aGlzLm51bUZyZWVOb2RlcyA+IDApIHtcclxuICAgICAgICBuZXdQYXJlbnQgPSB0aGlzLmZyZWVOb2Rlc1stLXRoaXMubnVtRnJlZU5vZGVzXTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBuZXdQYXJlbnQgPSBuZXcgREJWVE5vZGUoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgbmV3UGFyZW50LnBhcmVudCA9IG9sZFBhcmVudDtcclxuICAgICAgbmV3UGFyZW50LmNoaWxkMSA9IGxlYWY7XHJcbiAgICAgIG5ld1BhcmVudC5jaGlsZDIgPSBzaWJsaW5nO1xyXG4gICAgICBuZXdQYXJlbnQuYWFiYi5jb21iaW5lKGxlYWYuYWFiYiwgc2libGluZy5hYWJiKTtcclxuICAgICAgbmV3UGFyZW50LmhlaWdodCA9IHNpYmxpbmcuaGVpZ2h0ICsgMTtcclxuICAgICAgc2libGluZy5wYXJlbnQgPSBuZXdQYXJlbnQ7XHJcbiAgICAgIGxlYWYucGFyZW50ID0gbmV3UGFyZW50O1xyXG4gICAgICBpZiAoc2libGluZyA9PSB0aGlzLnJvb3QpIHtcclxuICAgICAgICAvLyByZXBsYWNlIHJvb3RcclxuICAgICAgICB0aGlzLnJvb3QgPSBuZXdQYXJlbnQ7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gcmVwbGFjZSBjaGlsZFxyXG4gICAgICAgIGlmIChvbGRQYXJlbnQuY2hpbGQxID09IHNpYmxpbmcpIHtcclxuICAgICAgICAgIG9sZFBhcmVudC5jaGlsZDEgPSBuZXdQYXJlbnQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIG9sZFBhcmVudC5jaGlsZDIgPSBuZXdQYXJlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8vIHVwZGF0ZSB3aG9sZSB0cmVlXHJcbiAgICAgIGRvIHtcclxuICAgICAgICBuZXdQYXJlbnQgPSB0aGlzLmJhbGFuY2UobmV3UGFyZW50KTtcclxuICAgICAgICB0aGlzLmZpeChuZXdQYXJlbnQpO1xyXG4gICAgICAgIG5ld1BhcmVudCA9IG5ld1BhcmVudC5wYXJlbnQ7XHJcbiAgICAgIH0gd2hpbGUgKG5ld1BhcmVudCAhPSBudWxsKTtcclxuICAgIH0sXHJcblxyXG4gICAgZ2V0QmFsYW5jZTogZnVuY3Rpb24gKG5vZGUpIHtcclxuXHJcbiAgICAgIGlmIChub2RlLnByb3h5ICE9IG51bGwpIHJldHVybiAwO1xyXG4gICAgICByZXR1cm4gbm9kZS5jaGlsZDEuaGVpZ2h0IC0gbm9kZS5jaGlsZDIuaGVpZ2h0O1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgZGVsZXRlTGVhZjogZnVuY3Rpb24gKGxlYWYpIHtcclxuXHJcbiAgICAgIGlmIChsZWFmID09IHRoaXMucm9vdCkge1xyXG4gICAgICAgIHRoaXMucm9vdCA9IG51bGw7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBwYXJlbnQgPSBsZWFmLnBhcmVudDtcclxuICAgICAgdmFyIHNpYmxpbmc7XHJcbiAgICAgIGlmIChwYXJlbnQuY2hpbGQxID09IGxlYWYpIHtcclxuICAgICAgICBzaWJsaW5nID0gcGFyZW50LmNoaWxkMjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBzaWJsaW5nID0gcGFyZW50LmNoaWxkMTtcclxuICAgICAgfVxyXG4gICAgICBpZiAocGFyZW50ID09IHRoaXMucm9vdCkge1xyXG4gICAgICAgIHRoaXMucm9vdCA9IHNpYmxpbmc7XHJcbiAgICAgICAgc2libGluZy5wYXJlbnQgPSBudWxsO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICB2YXIgZ3JhbmRQYXJlbnQgPSBwYXJlbnQucGFyZW50O1xyXG4gICAgICBzaWJsaW5nLnBhcmVudCA9IGdyYW5kUGFyZW50O1xyXG4gICAgICBpZiAoZ3JhbmRQYXJlbnQuY2hpbGQxID09IHBhcmVudCkge1xyXG4gICAgICAgIGdyYW5kUGFyZW50LmNoaWxkMSA9IHNpYmxpbmc7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZ3JhbmRQYXJlbnQuY2hpbGQyID0gc2libGluZztcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5udW1GcmVlTm9kZXMgPCAxNjM4NCkge1xyXG4gICAgICAgIHRoaXMuZnJlZU5vZGVzW3RoaXMubnVtRnJlZU5vZGVzKytdID0gcGFyZW50O1xyXG4gICAgICB9XHJcbiAgICAgIGRvIHtcclxuICAgICAgICBncmFuZFBhcmVudCA9IHRoaXMuYmFsYW5jZShncmFuZFBhcmVudCk7XHJcbiAgICAgICAgdGhpcy5maXgoZ3JhbmRQYXJlbnQpO1xyXG4gICAgICAgIGdyYW5kUGFyZW50ID0gZ3JhbmRQYXJlbnQucGFyZW50O1xyXG4gICAgICB9IHdoaWxlIChncmFuZFBhcmVudCAhPSBudWxsKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGJhbGFuY2U6IGZ1bmN0aW9uIChub2RlKSB7XHJcblxyXG4gICAgICB2YXIgbmggPSBub2RlLmhlaWdodDtcclxuICAgICAgaWYgKG5oIDwgMikge1xyXG4gICAgICAgIHJldHVybiBub2RlO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBwID0gbm9kZS5wYXJlbnQ7XHJcbiAgICAgIHZhciBsID0gbm9kZS5jaGlsZDE7XHJcbiAgICAgIHZhciByID0gbm9kZS5jaGlsZDI7XHJcbiAgICAgIHZhciBsaCA9IGwuaGVpZ2h0O1xyXG4gICAgICB2YXIgcmggPSByLmhlaWdodDtcclxuICAgICAgdmFyIGJhbGFuY2UgPSBsaCAtIHJoO1xyXG4gICAgICB2YXIgdDsvLyBmb3IgYml0IG9wZXJhdGlvblxyXG5cclxuICAgICAgLy8gICAgICAgICAgWyBOIF1cclxuICAgICAgLy8gICAgICAgICAvICAgICBcXFxyXG4gICAgICAvLyAgICBbIEwgXSAgICAgICBbIFIgXVxyXG4gICAgICAvLyAgICAgLyBcXCAgICAgICAgIC8gXFxcclxuICAgICAgLy8gW0wtTF0gW0wtUl0gW1ItTF0gW1ItUl1cclxuXHJcbiAgICAgIC8vIElzIHRoZSB0cmVlIGJhbGFuY2VkP1xyXG4gICAgICBpZiAoYmFsYW5jZSA+IDEpIHtcclxuICAgICAgICB2YXIgbGwgPSBsLmNoaWxkMTtcclxuICAgICAgICB2YXIgbHIgPSBsLmNoaWxkMjtcclxuICAgICAgICB2YXIgbGxoID0gbGwuaGVpZ2h0O1xyXG4gICAgICAgIHZhciBscmggPSBsci5oZWlnaHQ7XHJcblxyXG4gICAgICAgIC8vIElzIEwtTCBoaWdoZXIgdGhhbiBMLVI/XHJcbiAgICAgICAgaWYgKGxsaCA+IGxyaCkge1xyXG4gICAgICAgICAgLy8gc2V0IE4gdG8gTC1SXHJcbiAgICAgICAgICBsLmNoaWxkMiA9IG5vZGU7XHJcbiAgICAgICAgICBub2RlLnBhcmVudCA9IGw7XHJcblxyXG4gICAgICAgICAgLy8gICAgICAgICAgWyBMIF1cclxuICAgICAgICAgIC8vICAgICAgICAgLyAgICAgXFxcclxuICAgICAgICAgIC8vICAgIFtMLUxdICAgICAgIFsgTiBdXHJcbiAgICAgICAgICAvLyAgICAgLyBcXCAgICAgICAgIC8gXFxcclxuICAgICAgICAgIC8vIFsuLi5dIFsuLi5dIFsgTCBdIFsgUiBdXHJcblxyXG4gICAgICAgICAgLy8gc2V0IEwtUlxyXG4gICAgICAgICAgbm9kZS5jaGlsZDEgPSBscjtcclxuICAgICAgICAgIGxyLnBhcmVudCA9IG5vZGU7XHJcblxyXG4gICAgICAgICAgLy8gICAgICAgICAgWyBMIF1cclxuICAgICAgICAgIC8vICAgICAgICAgLyAgICAgXFxcclxuICAgICAgICAgIC8vICAgIFtMLUxdICAgICAgIFsgTiBdXHJcbiAgICAgICAgICAvLyAgICAgLyBcXCAgICAgICAgIC8gXFxcclxuICAgICAgICAgIC8vIFsuLi5dIFsuLi5dIFtMLVJdIFsgUiBdXHJcblxyXG4gICAgICAgICAgLy8gZml4IGJvdW5kcyBhbmQgaGVpZ2h0c1xyXG4gICAgICAgICAgbm9kZS5hYWJiLmNvbWJpbmUobHIuYWFiYiwgci5hYWJiKTtcclxuICAgICAgICAgIHQgPSBscmggLSByaDtcclxuICAgICAgICAgIG5vZGUuaGVpZ2h0ID0gbHJoIC0gKHQgJiB0ID4+IDMxKSArIDE7XHJcbiAgICAgICAgICBsLmFhYmIuY29tYmluZShsbC5hYWJiLCBub2RlLmFhYmIpO1xyXG4gICAgICAgICAgdCA9IGxsaCAtIG5oO1xyXG4gICAgICAgICAgbC5oZWlnaHQgPSBsbGggLSAodCAmIHQgPj4gMzEpICsgMTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgLy8gc2V0IE4gdG8gTC1MXHJcbiAgICAgICAgICBsLmNoaWxkMSA9IG5vZGU7XHJcbiAgICAgICAgICBub2RlLnBhcmVudCA9IGw7XHJcblxyXG4gICAgICAgICAgLy8gICAgICAgICAgWyBMIF1cclxuICAgICAgICAgIC8vICAgICAgICAgLyAgICAgXFxcclxuICAgICAgICAgIC8vICAgIFsgTiBdICAgICAgIFtMLVJdXHJcbiAgICAgICAgICAvLyAgICAgLyBcXCAgICAgICAgIC8gXFxcclxuICAgICAgICAgIC8vIFsgTCBdIFsgUiBdIFsuLi5dIFsuLi5dXHJcblxyXG4gICAgICAgICAgLy8gc2V0IEwtTFxyXG4gICAgICAgICAgbm9kZS5jaGlsZDEgPSBsbDtcclxuICAgICAgICAgIGxsLnBhcmVudCA9IG5vZGU7XHJcblxyXG4gICAgICAgICAgLy8gICAgICAgICAgWyBMIF1cclxuICAgICAgICAgIC8vICAgICAgICAgLyAgICAgXFxcclxuICAgICAgICAgIC8vICAgIFsgTiBdICAgICAgIFtMLVJdXHJcbiAgICAgICAgICAvLyAgICAgLyBcXCAgICAgICAgIC8gXFxcclxuICAgICAgICAgIC8vIFtMLUxdIFsgUiBdIFsuLi5dIFsuLi5dXHJcblxyXG4gICAgICAgICAgLy8gZml4IGJvdW5kcyBhbmQgaGVpZ2h0c1xyXG4gICAgICAgICAgbm9kZS5hYWJiLmNvbWJpbmUobGwuYWFiYiwgci5hYWJiKTtcclxuICAgICAgICAgIHQgPSBsbGggLSByaDtcclxuICAgICAgICAgIG5vZGUuaGVpZ2h0ID0gbGxoIC0gKHQgJiB0ID4+IDMxKSArIDE7XHJcblxyXG4gICAgICAgICAgbC5hYWJiLmNvbWJpbmUobm9kZS5hYWJiLCBsci5hYWJiKTtcclxuICAgICAgICAgIHQgPSBuaCAtIGxyaDtcclxuICAgICAgICAgIGwuaGVpZ2h0ID0gbmggLSAodCAmIHQgPj4gMzEpICsgMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gc2V0IG5ldyBwYXJlbnQgb2YgTFxyXG4gICAgICAgIGlmIChwICE9IG51bGwpIHtcclxuICAgICAgICAgIGlmIChwLmNoaWxkMSA9PSBub2RlKSB7XHJcbiAgICAgICAgICAgIHAuY2hpbGQxID0gbDtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHAuY2hpbGQyID0gbDtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5yb290ID0gbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgbC5wYXJlbnQgPSBwO1xyXG4gICAgICAgIHJldHVybiBsO1xyXG4gICAgICB9IGVsc2UgaWYgKGJhbGFuY2UgPCAtMSkge1xyXG4gICAgICAgIHZhciBybCA9IHIuY2hpbGQxO1xyXG4gICAgICAgIHZhciByciA9IHIuY2hpbGQyO1xyXG4gICAgICAgIHZhciBybGggPSBybC5oZWlnaHQ7XHJcbiAgICAgICAgdmFyIHJyaCA9IHJyLmhlaWdodDtcclxuXHJcbiAgICAgICAgLy8gSXMgUi1MIGhpZ2hlciB0aGFuIFItUj9cclxuICAgICAgICBpZiAocmxoID4gcnJoKSB7XHJcbiAgICAgICAgICAvLyBzZXQgTiB0byBSLVJcclxuICAgICAgICAgIHIuY2hpbGQyID0gbm9kZTtcclxuICAgICAgICAgIG5vZGUucGFyZW50ID0gcjtcclxuXHJcbiAgICAgICAgICAvLyAgICAgICAgICBbIFIgXVxyXG4gICAgICAgICAgLy8gICAgICAgICAvICAgICBcXFxyXG4gICAgICAgICAgLy8gICAgW1ItTF0gICAgICAgWyBOIF1cclxuICAgICAgICAgIC8vICAgICAvIFxcICAgICAgICAgLyBcXFxyXG4gICAgICAgICAgLy8gWy4uLl0gWy4uLl0gWyBMIF0gWyBSIF1cclxuXHJcbiAgICAgICAgICAvLyBzZXQgUi1SXHJcbiAgICAgICAgICBub2RlLmNoaWxkMiA9IHJyO1xyXG4gICAgICAgICAgcnIucGFyZW50ID0gbm9kZTtcclxuXHJcbiAgICAgICAgICAvLyAgICAgICAgICBbIFIgXVxyXG4gICAgICAgICAgLy8gICAgICAgICAvICAgICBcXFxyXG4gICAgICAgICAgLy8gICAgW1ItTF0gICAgICAgWyBOIF1cclxuICAgICAgICAgIC8vICAgICAvIFxcICAgICAgICAgLyBcXFxyXG4gICAgICAgICAgLy8gWy4uLl0gWy4uLl0gWyBMIF0gW1ItUl1cclxuXHJcbiAgICAgICAgICAvLyBmaXggYm91bmRzIGFuZCBoZWlnaHRzXHJcbiAgICAgICAgICBub2RlLmFhYmIuY29tYmluZShsLmFhYmIsIHJyLmFhYmIpO1xyXG4gICAgICAgICAgdCA9IGxoIC0gcnJoO1xyXG4gICAgICAgICAgbm9kZS5oZWlnaHQgPSBsaCAtICh0ICYgdCA+PiAzMSkgKyAxO1xyXG4gICAgICAgICAgci5hYWJiLmNvbWJpbmUocmwuYWFiYiwgbm9kZS5hYWJiKTtcclxuICAgICAgICAgIHQgPSBybGggLSBuaDtcclxuICAgICAgICAgIHIuaGVpZ2h0ID0gcmxoIC0gKHQgJiB0ID4+IDMxKSArIDE7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIC8vIHNldCBOIHRvIFItTFxyXG4gICAgICAgICAgci5jaGlsZDEgPSBub2RlO1xyXG4gICAgICAgICAgbm9kZS5wYXJlbnQgPSByO1xyXG4gICAgICAgICAgLy8gICAgICAgICAgWyBSIF1cclxuICAgICAgICAgIC8vICAgICAgICAgLyAgICAgXFxcclxuICAgICAgICAgIC8vICAgIFsgTiBdICAgICAgIFtSLVJdXHJcbiAgICAgICAgICAvLyAgICAgLyBcXCAgICAgICAgIC8gXFxcclxuICAgICAgICAgIC8vIFsgTCBdIFsgUiBdIFsuLi5dIFsuLi5dXHJcblxyXG4gICAgICAgICAgLy8gc2V0IFItTFxyXG4gICAgICAgICAgbm9kZS5jaGlsZDIgPSBybDtcclxuICAgICAgICAgIHJsLnBhcmVudCA9IG5vZGU7XHJcblxyXG4gICAgICAgICAgLy8gICAgICAgICAgWyBSIF1cclxuICAgICAgICAgIC8vICAgICAgICAgLyAgICAgXFxcclxuICAgICAgICAgIC8vICAgIFsgTiBdICAgICAgIFtSLVJdXHJcbiAgICAgICAgICAvLyAgICAgLyBcXCAgICAgICAgIC8gXFxcclxuICAgICAgICAgIC8vIFsgTCBdIFtSLUxdIFsuLi5dIFsuLi5dXHJcblxyXG4gICAgICAgICAgLy8gZml4IGJvdW5kcyBhbmQgaGVpZ2h0c1xyXG4gICAgICAgICAgbm9kZS5hYWJiLmNvbWJpbmUobC5hYWJiLCBybC5hYWJiKTtcclxuICAgICAgICAgIHQgPSBsaCAtIHJsaDtcclxuICAgICAgICAgIG5vZGUuaGVpZ2h0ID0gbGggLSAodCAmIHQgPj4gMzEpICsgMTtcclxuICAgICAgICAgIHIuYWFiYi5jb21iaW5lKG5vZGUuYWFiYiwgcnIuYWFiYik7XHJcbiAgICAgICAgICB0ID0gbmggLSBycmg7XHJcbiAgICAgICAgICByLmhlaWdodCA9IG5oIC0gKHQgJiB0ID4+IDMxKSArIDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIHNldCBuZXcgcGFyZW50IG9mIFJcclxuICAgICAgICBpZiAocCAhPSBudWxsKSB7XHJcbiAgICAgICAgICBpZiAocC5jaGlsZDEgPT0gbm9kZSkge1xyXG4gICAgICAgICAgICBwLmNoaWxkMSA9IHI7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBwLmNoaWxkMiA9IHI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMucm9vdCA9IHI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHIucGFyZW50ID0gcDtcclxuICAgICAgICByZXR1cm4gcjtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbm9kZTtcclxuICAgIH0sXHJcblxyXG4gICAgZml4OiBmdW5jdGlvbiAobm9kZSkge1xyXG5cclxuICAgICAgdmFyIGMxID0gbm9kZS5jaGlsZDE7XHJcbiAgICAgIHZhciBjMiA9IG5vZGUuY2hpbGQyO1xyXG4gICAgICBub2RlLmFhYmIuY29tYmluZShjMS5hYWJiLCBjMi5hYWJiKTtcclxuICAgICAgbm9kZS5oZWlnaHQgPSBjMS5oZWlnaHQgPCBjMi5oZWlnaHQgPyBjMi5oZWlnaHQgKyAxIDogYzEuaGVpZ2h0ICsgMTtcclxuXHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAvKipcclxuICAqIEEgcHJveHkgZm9yIGR5bmFtaWMgYm91bmRpbmcgdm9sdW1lIHRyZWUgYnJvYWQtcGhhc2UuXHJcbiAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAqL1xyXG5cclxuICBmdW5jdGlvbiBEQlZUUHJveHkoc2hhcGUpIHtcclxuXHJcbiAgICBQcm94eS5jYWxsKHRoaXMsIHNoYXBlKTtcclxuICAgIC8vIFRoZSBsZWFmIG9mIHRoZSBwcm94eS5cclxuICAgIHRoaXMubGVhZiA9IG5ldyBEQlZUTm9kZSgpO1xyXG4gICAgdGhpcy5sZWFmLnByb3h5ID0gdGhpcztcclxuXHJcbiAgfVxyXG4gIERCVlRQcm94eS5wcm90b3R5cGUgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoUHJveHkucHJvdG90eXBlKSwge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yOiBEQlZUUHJveHksXHJcblxyXG4gICAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgICogQSBicm9hZC1waGFzZSBhbGdvcml0aG0gdXNpbmcgZHluYW1pYyBib3VuZGluZyB2b2x1bWUgdHJlZS5cclxuICAgKlxyXG4gICAqIEBhdXRob3Igc2FoYXJhblxyXG4gICAqIEBhdXRob3IgbG8tdGhcclxuICAgKi9cclxuXHJcbiAgZnVuY3Rpb24gREJWVEJyb2FkUGhhc2UoKSB7XHJcblxyXG4gICAgQnJvYWRQaGFzZS5jYWxsKHRoaXMpO1xyXG5cclxuICAgIHRoaXMudHlwZXMgPSBCUl9CT1VORElOR19WT0xVTUVfVFJFRTtcclxuXHJcbiAgICB0aGlzLnRyZWUgPSBuZXcgREJWVCgpO1xyXG4gICAgdGhpcy5zdGFjayA9IFtdO1xyXG4gICAgdGhpcy5sZWF2ZXMgPSBbXTtcclxuICAgIHRoaXMubnVtTGVhdmVzID0gMDtcclxuXHJcbiAgfVxyXG4gIERCVlRCcm9hZFBoYXNlLnByb3RvdHlwZSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShCcm9hZFBoYXNlLnByb3RvdHlwZSksIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcjogREJWVEJyb2FkUGhhc2UsXHJcblxyXG4gICAgY3JlYXRlUHJveHk6IGZ1bmN0aW9uIChzaGFwZSkge1xyXG5cclxuICAgICAgcmV0dXJuIG5ldyBEQlZUUHJveHkoc2hhcGUpO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgYWRkUHJveHk6IGZ1bmN0aW9uIChwcm94eSkge1xyXG5cclxuICAgICAgdGhpcy50cmVlLmluc2VydExlYWYocHJveHkubGVhZik7XHJcbiAgICAgIHRoaXMubGVhdmVzLnB1c2gocHJveHkubGVhZik7XHJcbiAgICAgIHRoaXMubnVtTGVhdmVzKys7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICByZW1vdmVQcm94eTogZnVuY3Rpb24gKHByb3h5KSB7XHJcblxyXG4gICAgICB0aGlzLnRyZWUuZGVsZXRlTGVhZihwcm94eS5sZWFmKTtcclxuICAgICAgdmFyIG4gPSB0aGlzLmxlYXZlcy5pbmRleE9mKHByb3h5LmxlYWYpO1xyXG4gICAgICBpZiAobiA+IC0xKSB7XHJcbiAgICAgICAgdGhpcy5sZWF2ZXMuc3BsaWNlKG4sIDEpO1xyXG4gICAgICAgIHRoaXMubnVtTGVhdmVzLS07XHJcbiAgICAgIH1cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGNvbGxlY3RQYWlyczogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgaWYgKHRoaXMubnVtTGVhdmVzIDwgMikgcmV0dXJuO1xyXG5cclxuICAgICAgdmFyIGxlYWYsIG1hcmdpbiA9IDAuMSwgaSA9IHRoaXMubnVtTGVhdmVzO1xyXG5cclxuICAgICAgd2hpbGUgKGktLSkge1xyXG5cclxuICAgICAgICBsZWFmID0gdGhpcy5sZWF2ZXNbaV07XHJcblxyXG4gICAgICAgIGlmIChsZWFmLnByb3h5LmFhYmIuaW50ZXJzZWN0VGVzdFR3byhsZWFmLmFhYmIpKSB7XHJcblxyXG4gICAgICAgICAgbGVhZi5hYWJiLmNvcHkobGVhZi5wcm94eS5hYWJiLCBtYXJnaW4pO1xyXG4gICAgICAgICAgdGhpcy50cmVlLmRlbGV0ZUxlYWYobGVhZik7XHJcbiAgICAgICAgICB0aGlzLnRyZWUuaW5zZXJ0TGVhZihsZWFmKTtcclxuICAgICAgICAgIHRoaXMuY29sbGlkZShsZWFmLCB0aGlzLnRyZWUucm9vdCk7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY29sbGlkZTogZnVuY3Rpb24gKG5vZGUxLCBub2RlMikge1xyXG5cclxuICAgICAgdmFyIHN0YWNrQ291bnQgPSAyO1xyXG4gICAgICB2YXIgczEsIHMyLCBuMSwgbjIsIGwxLCBsMjtcclxuICAgICAgdGhpcy5zdGFja1swXSA9IG5vZGUxO1xyXG4gICAgICB0aGlzLnN0YWNrWzFdID0gbm9kZTI7XHJcblxyXG4gICAgICB3aGlsZSAoc3RhY2tDb3VudCA+IDApIHtcclxuXHJcbiAgICAgICAgbjEgPSB0aGlzLnN0YWNrWy0tc3RhY2tDb3VudF07XHJcbiAgICAgICAgbjIgPSB0aGlzLnN0YWNrWy0tc3RhY2tDb3VudF07XHJcbiAgICAgICAgbDEgPSBuMS5wcm94eSAhPSBudWxsO1xyXG4gICAgICAgIGwyID0gbjIucHJveHkgIT0gbnVsbDtcclxuXHJcbiAgICAgICAgdGhpcy5udW1QYWlyQ2hlY2tzKys7XHJcblxyXG4gICAgICAgIGlmIChsMSAmJiBsMikge1xyXG4gICAgICAgICAgczEgPSBuMS5wcm94eS5zaGFwZTtcclxuICAgICAgICAgIHMyID0gbjIucHJveHkuc2hhcGU7XHJcbiAgICAgICAgICBpZiAoczEgPT0gczIgfHwgczEuYWFiYi5pbnRlcnNlY3RUZXN0KHMyLmFhYmIpIHx8ICF0aGlzLmlzQXZhaWxhYmxlUGFpcihzMSwgczIpKSBjb250aW51ZTtcclxuXHJcbiAgICAgICAgICB0aGlzLmFkZFBhaXIoczEsIHMyKTtcclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICBpZiAobjEuYWFiYi5pbnRlcnNlY3RUZXN0KG4yLmFhYmIpKSBjb250aW51ZTtcclxuXHJcbiAgICAgICAgICAvKmlmKHN0YWNrQ291bnQrND49dGhpcy5tYXhTdGFjayl7Ly8gZXhwYW5kIHRoZSBzdGFja1xyXG4gICAgICAgICAgICAgIC8vdGhpcy5tYXhTdGFjazw8PTE7XHJcbiAgICAgICAgICAgICAgdGhpcy5tYXhTdGFjayo9MjtcclxuICAgICAgICAgICAgICB2YXIgbmV3U3RhY2sgPSBbXTsvLyB2ZWN0b3JcclxuICAgICAgICAgICAgICBuZXdTdGFjay5sZW5ndGggPSB0aGlzLm1heFN0YWNrO1xyXG4gICAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8c3RhY2tDb3VudDtpKyspe1xyXG4gICAgICAgICAgICAgICAgICBuZXdTdGFja1tpXSA9IHRoaXMuc3RhY2tbaV07XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIHRoaXMuc3RhY2sgPSBuZXdTdGFjaztcclxuICAgICAgICAgIH0qL1xyXG5cclxuICAgICAgICAgIGlmIChsMiB8fCAhbDEgJiYgKG4xLmFhYmIuc3VyZmFjZUFyZWEoKSA+IG4yLmFhYmIuc3VyZmFjZUFyZWEoKSkpIHtcclxuICAgICAgICAgICAgdGhpcy5zdGFja1tzdGFja0NvdW50KytdID0gbjEuY2hpbGQxO1xyXG4gICAgICAgICAgICB0aGlzLnN0YWNrW3N0YWNrQ291bnQrK10gPSBuMjtcclxuICAgICAgICAgICAgdGhpcy5zdGFja1tzdGFja0NvdW50KytdID0gbjEuY2hpbGQyO1xyXG4gICAgICAgICAgICB0aGlzLnN0YWNrW3N0YWNrQ291bnQrK10gPSBuMjtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhY2tbc3RhY2tDb3VudCsrXSA9IG4xO1xyXG4gICAgICAgICAgICB0aGlzLnN0YWNrW3N0YWNrQ291bnQrK10gPSBuMi5jaGlsZDE7XHJcbiAgICAgICAgICAgIHRoaXMuc3RhY2tbc3RhY2tDb3VudCsrXSA9IG4xO1xyXG4gICAgICAgICAgICB0aGlzLnN0YWNrW3N0YWNrQ291bnQrK10gPSBuMi5jaGlsZDI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gQ29sbGlzaW9uRGV0ZWN0b3IoKSB7XHJcblxyXG4gICAgdGhpcy5mbGlwID0gZmFsc2U7XHJcblxyXG4gIH1cclxuICBPYmplY3QuYXNzaWduKENvbGxpc2lvbkRldGVjdG9yLnByb3RvdHlwZSwge1xyXG5cclxuICAgIENvbGxpc2lvbkRldGVjdG9yOiB0cnVlLFxyXG5cclxuICAgIGRldGVjdENvbGxpc2lvbjogZnVuY3Rpb24gKHNoYXBlMSwgc2hhcGUyLCBtYW5pZm9sZCkge1xyXG5cclxuICAgICAgcHJpbnRFcnJvcihcIkNvbGxpc2lvbkRldGVjdG9yXCIsIFwiSW5oZXJpdGFuY2UgZXJyb3IuXCIpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIEEgY29sbGlzaW9uIGRldGVjdG9yIHdoaWNoIGRldGVjdHMgY29sbGlzaW9ucyBiZXR3ZWVuIHR3byBib3hlcy5cclxuICAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAgKi9cclxuICBmdW5jdGlvbiBCb3hCb3hDb2xsaXNpb25EZXRlY3RvcigpIHtcclxuXHJcbiAgICBDb2xsaXNpb25EZXRlY3Rvci5jYWxsKHRoaXMpO1xyXG4gICAgdGhpcy5jbGlwVmVydGljZXMxID0gbmV3IEZsb2F0MzJBcnJheSgyNCk7IC8vIDggdmVydGljZXMgeCx5LHpcclxuICAgIHRoaXMuY2xpcFZlcnRpY2VzMiA9IG5ldyBGbG9hdDMyQXJyYXkoMjQpO1xyXG4gICAgdGhpcy51c2VkID0gbmV3IEZsb2F0MzJBcnJheSg4KTtcclxuXHJcbiAgICB0aGlzLklORiA9IDEgLyAwO1xyXG5cclxuICB9XHJcbiAgQm94Qm94Q29sbGlzaW9uRGV0ZWN0b3IucHJvdG90eXBlID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKENvbGxpc2lvbkRldGVjdG9yLnByb3RvdHlwZSksIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcjogQm94Qm94Q29sbGlzaW9uRGV0ZWN0b3IsXHJcblxyXG4gICAgZGV0ZWN0Q29sbGlzaW9uOiBmdW5jdGlvbiAoc2hhcGUxLCBzaGFwZTIsIG1hbmlmb2xkKSB7XHJcbiAgICAgIC8vIFdoYXQgeW91IGFyZSBkb2luZyBcclxuICAgICAgLy8gwrcgSSB0byBwcmVwYXJlIGEgc2VwYXJhdGUgYXhpcyBvZiB0aGUgZmlmdGVlbiBcclxuICAgICAgLy8tU2l4IGluIGVhY2ggb2YgdGhyZWUgbm9ybWFsIHZlY3RvcnMgb2YgdGhlIHh5eiBkaXJlY3Rpb24gb2YgdGhlIGJveCBib3RoIFxyXG4gICAgICAvLyDCtyBSZW1haW5pbmcgbmluZSAzeDMgYSB2ZWN0b3IgcGVycGVuZGljdWxhciB0byB0aGUgc2lkZSBvZiB0aGUgYm94IDIgYW5kIHRoZSBzaWRlIG9mIHRoZSBib3ggMSBcclxuICAgICAgLy8gwrcgQ2FsY3VsYXRlIHRoZSBkZXB0aCB0byB0aGUgc2VwYXJhdGlvbiBheGlzIFxyXG5cclxuICAgICAgLy8gQ2FsY3VsYXRlcyB0aGUgZGlzdGFuY2UgdXNpbmcgdGhlIGlubmVyIHByb2R1Y3QgYW5kIHB1dCB0aGUgYW1vdW50IG9mIGVtYmVkbWVudCBcclxuICAgICAgLy8gwrcgSG93ZXZlciBhIHZlcnRpY2FsIHNlcGFyYXRpb24gYXhpcyBhbmQgc2lkZSB0byB3ZWlnaHQgYSBsaXR0bGUgdG8gYXZvaWQgdmlicmF0aW9uIFxyXG4gICAgICAvLyBBbmQgZW5kIHdoZW4gdGhlcmUgaXMgYSBzZXBhcmF0ZSBheGlzIHRoYXQgaXMgcmVtb3RlIGV2ZW4gb25lIFxyXG4gICAgICAvLyDCtyBJIGxvb2sgZm9yIHNlcGFyYXRpb24gYXhpcyB3aXRoIGxpdHRsZSB0byBkZW50IG1vc3QgXHJcbiAgICAgIC8vIE1lbiBhbmQgaWYgc2VwYXJhdGlvbiBheGlzIG9mIHRoZSBmaXJzdCBzaXggLSBlbmQgY29sbGlzaW9uIFxyXG4gICAgICAvLyBIZW5nIElmIGl0IHNlcGFyYXRlIGF4aXMgb2YgbmluZSBvdGhlciAtIHNpZGUgY29sbGlzaW9uIFxyXG4gICAgICAvLyBIZW5nIC0gY2FzZSBvZiBhIHNpZGUgY29sbGlzaW9uIFxyXG4gICAgICAvLyDCtyBGaW5kIHBvaW50cyBvZiB0d28gc2lkZXMgb24gd2hpY2ggeW91IG1hZGUg4oCL4oCLdGhlIHNlcGFyYXRpb24gYXhpcyBcclxuXHJcbiAgICAgIC8vIENhbGN1bGF0ZXMgdGhlIHBvaW50IG9mIGNsb3Nlc3QgYXBwcm9hY2ggb2YgYSBzdHJhaWdodCBsaW5lIGNvbnNpc3Rpbmcgb2Ygc2VwYXJhdGUgYXhpcyBwb2ludHMgb2J0YWluZWQsIGFuZCB0aGUgY29sbGlzaW9uIHBvaW50IFxyXG4gICAgICAvLy1TdXJmYWNlIC0gdGhlIGNhc2Ugb2YgdGhlIHBsYW5lIGNyYXNoIFxyXG4gICAgICAvLy1Cb3ggQSwgYm94IEIgYW5kIHRoZSBvdGhlciBhIGJveCBvZiBiZXR0ZXIgbWFkZSDigIvigIthIHNlcGFyYXRlIGF4aXMgXHJcbiAgICAgIC8vIOKAoiBUaGUgc3VyZmFjZSBBIGFuZCB0aGUgcGxhbmUgdGhhdCBtYWRlIHRoZSBzZXBhcmF0aW9uIGF4aXMgb2YgdGhlIGJveCBBLCBhbmQgQiB0byB0aGUgc3VyZmFjZSB0aGUgZmFjZSBvZiB0aGUgYm94IEIgY2xvc2UgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbiB0byB0aGUgbW9zdCBpc29sYXRlZCBheGlzIFxyXG5cclxuICAgICAgLy8gV2hlbiB2aWV3ZWQgZnJvbSB0aGUgZnJvbnQgc3VyZmFjZSBBLCBhbmQgdGhlIGN1dCBwYXJ0IGV4Y2VlZGluZyB0aGUgYXJlYSBvZiB0aGUgc3VyZmFjZSBBIGlzIGEgc3VyZmFjZSBCIFxyXG4gICAgICAvLy1QbGFuZSBCIGJlY29tZXMgdGhlIDMtOCB0cmlhbmdsZSwgSSBhIGNhbmRpZGF0ZSBmb3IgdGhlIGNvbGxpc2lvbiBwb2ludCB0aGUgdmVydGV4IG9mIHN1cmZhY2UgQiBcclxuICAgICAgLy8g4oCiIElmIG1vcmUgdGhhbiBvbmUgY2FuZGlkYXRlIDUgZXhpc3RzLCBzY3JhcGluZyB1cCB0byBmb3VyIFxyXG5cclxuICAgICAgLy8gRm9yIHBvdGVudGlhbCBjb2xsaXNpb24gcG9pbnRzIG9mIGFsbCwgdG8gZXhhbWluZSB0aGUgZGlzdGFuY2UgYmV0d2VlbiB0aGUgc3VyZmFjZSBBIFxyXG4gICAgICAvLyDigKIgSWYgeW91IHdlcmUgb24gdGhlIGluc2lkZSBzdXJmYWNlIG9mIEEsIGFuZCB0aGUgY29sbGlzaW9uIHBvaW50XHJcblxyXG4gICAgICB2YXIgYjE7XHJcbiAgICAgIHZhciBiMjtcclxuICAgICAgaWYgKHNoYXBlMS5pZCA8IHNoYXBlMi5pZCkge1xyXG4gICAgICAgIGIxID0gKHNoYXBlMSk7XHJcbiAgICAgICAgYjIgPSAoc2hhcGUyKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBiMSA9IChzaGFwZTIpO1xyXG4gICAgICAgIGIyID0gKHNoYXBlMSk7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIFYxID0gYjEuZWxlbWVudHM7XHJcbiAgICAgIHZhciBWMiA9IGIyLmVsZW1lbnRzO1xyXG5cclxuICAgICAgdmFyIEQxID0gYjEuZGltZW50aW9ucztcclxuICAgICAgdmFyIEQyID0gYjIuZGltZW50aW9ucztcclxuXHJcbiAgICAgIHZhciBwMSA9IGIxLnBvc2l0aW9uO1xyXG4gICAgICB2YXIgcDIgPSBiMi5wb3NpdGlvbjtcclxuICAgICAgdmFyIHAxeCA9IHAxLng7XHJcbiAgICAgIHZhciBwMXkgPSBwMS55O1xyXG4gICAgICB2YXIgcDF6ID0gcDEuejtcclxuICAgICAgdmFyIHAyeCA9IHAyLng7XHJcbiAgICAgIHZhciBwMnkgPSBwMi55O1xyXG4gICAgICB2YXIgcDJ6ID0gcDIuejtcclxuICAgICAgLy8gZGlmZlxyXG4gICAgICB2YXIgZHggPSBwMnggLSBwMXg7XHJcbiAgICAgIHZhciBkeSA9IHAyeSAtIHAxeTtcclxuICAgICAgdmFyIGR6ID0gcDJ6IC0gcDF6O1xyXG4gICAgICAvLyBkaXN0YW5jZVxyXG4gICAgICB2YXIgdzEgPSBiMS5oYWxmV2lkdGg7XHJcbiAgICAgIHZhciBoMSA9IGIxLmhhbGZIZWlnaHQ7XHJcbiAgICAgIHZhciBkMSA9IGIxLmhhbGZEZXB0aDtcclxuICAgICAgdmFyIHcyID0gYjIuaGFsZldpZHRoO1xyXG4gICAgICB2YXIgaDIgPSBiMi5oYWxmSGVpZ2h0O1xyXG4gICAgICB2YXIgZDIgPSBiMi5oYWxmRGVwdGg7XHJcbiAgICAgIC8vIGRpcmVjdGlvblxyXG5cclxuICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAvLyAxNSBzZXBhcmF0aW5nIGF4ZXNcclxuICAgICAgLy8gMX42OiBmYWNlXHJcbiAgICAgIC8vIDd+ZjogZWRnZVxyXG4gICAgICAvLyBodHRwOi8vbWFydXBla2UyOTYuY29tL0NPTF8zRF9ObzEzX09CQnZzT0JCLmh0bWxcclxuICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgICAgdmFyIGExeCA9IEQxWzBdO1xyXG4gICAgICB2YXIgYTF5ID0gRDFbMV07XHJcbiAgICAgIHZhciBhMXogPSBEMVsyXTtcclxuICAgICAgdmFyIGEyeCA9IEQxWzNdO1xyXG4gICAgICB2YXIgYTJ5ID0gRDFbNF07XHJcbiAgICAgIHZhciBhMnogPSBEMVs1XTtcclxuICAgICAgdmFyIGEzeCA9IEQxWzZdO1xyXG4gICAgICB2YXIgYTN5ID0gRDFbN107XHJcbiAgICAgIHZhciBhM3ogPSBEMVs4XTtcclxuICAgICAgdmFyIGQxeCA9IEQxWzldO1xyXG4gICAgICB2YXIgZDF5ID0gRDFbMTBdO1xyXG4gICAgICB2YXIgZDF6ID0gRDFbMTFdO1xyXG4gICAgICB2YXIgZDJ4ID0gRDFbMTJdO1xyXG4gICAgICB2YXIgZDJ5ID0gRDFbMTNdO1xyXG4gICAgICB2YXIgZDJ6ID0gRDFbMTRdO1xyXG4gICAgICB2YXIgZDN4ID0gRDFbMTVdO1xyXG4gICAgICB2YXIgZDN5ID0gRDFbMTZdO1xyXG4gICAgICB2YXIgZDN6ID0gRDFbMTddO1xyXG5cclxuICAgICAgdmFyIGE0eCA9IEQyWzBdO1xyXG4gICAgICB2YXIgYTR5ID0gRDJbMV07XHJcbiAgICAgIHZhciBhNHogPSBEMlsyXTtcclxuICAgICAgdmFyIGE1eCA9IEQyWzNdO1xyXG4gICAgICB2YXIgYTV5ID0gRDJbNF07XHJcbiAgICAgIHZhciBhNXogPSBEMls1XTtcclxuICAgICAgdmFyIGE2eCA9IEQyWzZdO1xyXG4gICAgICB2YXIgYTZ5ID0gRDJbN107XHJcbiAgICAgIHZhciBhNnogPSBEMls4XTtcclxuICAgICAgdmFyIGQ0eCA9IEQyWzldO1xyXG4gICAgICB2YXIgZDR5ID0gRDJbMTBdO1xyXG4gICAgICB2YXIgZDR6ID0gRDJbMTFdO1xyXG4gICAgICB2YXIgZDV4ID0gRDJbMTJdO1xyXG4gICAgICB2YXIgZDV5ID0gRDJbMTNdO1xyXG4gICAgICB2YXIgZDV6ID0gRDJbMTRdO1xyXG4gICAgICB2YXIgZDZ4ID0gRDJbMTVdO1xyXG4gICAgICB2YXIgZDZ5ID0gRDJbMTZdO1xyXG4gICAgICB2YXIgZDZ6ID0gRDJbMTddO1xyXG5cclxuICAgICAgdmFyIGE3eCA9IGExeSAqIGE0eiAtIGExeiAqIGE0eTtcclxuICAgICAgdmFyIGE3eSA9IGExeiAqIGE0eCAtIGExeCAqIGE0ejtcclxuICAgICAgdmFyIGE3eiA9IGExeCAqIGE0eSAtIGExeSAqIGE0eDtcclxuICAgICAgdmFyIGE4eCA9IGExeSAqIGE1eiAtIGExeiAqIGE1eTtcclxuICAgICAgdmFyIGE4eSA9IGExeiAqIGE1eCAtIGExeCAqIGE1ejtcclxuICAgICAgdmFyIGE4eiA9IGExeCAqIGE1eSAtIGExeSAqIGE1eDtcclxuICAgICAgdmFyIGE5eCA9IGExeSAqIGE2eiAtIGExeiAqIGE2eTtcclxuICAgICAgdmFyIGE5eSA9IGExeiAqIGE2eCAtIGExeCAqIGE2ejtcclxuICAgICAgdmFyIGE5eiA9IGExeCAqIGE2eSAtIGExeSAqIGE2eDtcclxuICAgICAgdmFyIGFheCA9IGEyeSAqIGE0eiAtIGEyeiAqIGE0eTtcclxuICAgICAgdmFyIGFheSA9IGEyeiAqIGE0eCAtIGEyeCAqIGE0ejtcclxuICAgICAgdmFyIGFheiA9IGEyeCAqIGE0eSAtIGEyeSAqIGE0eDtcclxuICAgICAgdmFyIGFieCA9IGEyeSAqIGE1eiAtIGEyeiAqIGE1eTtcclxuICAgICAgdmFyIGFieSA9IGEyeiAqIGE1eCAtIGEyeCAqIGE1ejtcclxuICAgICAgdmFyIGFieiA9IGEyeCAqIGE1eSAtIGEyeSAqIGE1eDtcclxuICAgICAgdmFyIGFjeCA9IGEyeSAqIGE2eiAtIGEyeiAqIGE2eTtcclxuICAgICAgdmFyIGFjeSA9IGEyeiAqIGE2eCAtIGEyeCAqIGE2ejtcclxuICAgICAgdmFyIGFjeiA9IGEyeCAqIGE2eSAtIGEyeSAqIGE2eDtcclxuICAgICAgdmFyIGFkeCA9IGEzeSAqIGE0eiAtIGEzeiAqIGE0eTtcclxuICAgICAgdmFyIGFkeSA9IGEzeiAqIGE0eCAtIGEzeCAqIGE0ejtcclxuICAgICAgdmFyIGFkeiA9IGEzeCAqIGE0eSAtIGEzeSAqIGE0eDtcclxuICAgICAgdmFyIGFleCA9IGEzeSAqIGE1eiAtIGEzeiAqIGE1eTtcclxuICAgICAgdmFyIGFleSA9IGEzeiAqIGE1eCAtIGEzeCAqIGE1ejtcclxuICAgICAgdmFyIGFleiA9IGEzeCAqIGE1eSAtIGEzeSAqIGE1eDtcclxuICAgICAgdmFyIGFmeCA9IGEzeSAqIGE2eiAtIGEzeiAqIGE2eTtcclxuICAgICAgdmFyIGFmeSA9IGEzeiAqIGE2eCAtIGEzeCAqIGE2ejtcclxuICAgICAgdmFyIGFmeiA9IGEzeCAqIGE2eSAtIGEzeSAqIGE2eDtcclxuICAgICAgLy8gcmlnaHQgb3IgbGVmdCBmbGFnc1xyXG4gICAgICB2YXIgcmlnaHQxO1xyXG4gICAgICB2YXIgcmlnaHQyO1xyXG4gICAgICB2YXIgcmlnaHQzO1xyXG4gICAgICB2YXIgcmlnaHQ0O1xyXG4gICAgICB2YXIgcmlnaHQ1O1xyXG4gICAgICB2YXIgcmlnaHQ2O1xyXG4gICAgICB2YXIgcmlnaHQ3O1xyXG4gICAgICB2YXIgcmlnaHQ4O1xyXG4gICAgICB2YXIgcmlnaHQ5O1xyXG4gICAgICB2YXIgcmlnaHRhO1xyXG4gICAgICB2YXIgcmlnaHRiO1xyXG4gICAgICB2YXIgcmlnaHRjO1xyXG4gICAgICB2YXIgcmlnaHRkO1xyXG4gICAgICB2YXIgcmlnaHRlO1xyXG4gICAgICB2YXIgcmlnaHRmO1xyXG4gICAgICAvLyBvdmVybGFwcGluZyBkaXN0YW5jZXNcclxuICAgICAgdmFyIG92ZXJsYXAxO1xyXG4gICAgICB2YXIgb3ZlcmxhcDI7XHJcbiAgICAgIHZhciBvdmVybGFwMztcclxuICAgICAgdmFyIG92ZXJsYXA0O1xyXG4gICAgICB2YXIgb3ZlcmxhcDU7XHJcbiAgICAgIHZhciBvdmVybGFwNjtcclxuICAgICAgdmFyIG92ZXJsYXA3O1xyXG4gICAgICB2YXIgb3ZlcmxhcDg7XHJcbiAgICAgIHZhciBvdmVybGFwOTtcclxuICAgICAgdmFyIG92ZXJsYXBhO1xyXG4gICAgICB2YXIgb3ZlcmxhcGI7XHJcbiAgICAgIHZhciBvdmVybGFwYztcclxuICAgICAgdmFyIG92ZXJsYXBkO1xyXG4gICAgICB2YXIgb3ZlcmxhcGU7XHJcbiAgICAgIHZhciBvdmVybGFwZjtcclxuICAgICAgLy8gaW52YWxpZCBmbGFnc1xyXG4gICAgICB2YXIgaW52YWxpZDcgPSBmYWxzZTtcclxuICAgICAgdmFyIGludmFsaWQ4ID0gZmFsc2U7XHJcbiAgICAgIHZhciBpbnZhbGlkOSA9IGZhbHNlO1xyXG4gICAgICB2YXIgaW52YWxpZGEgPSBmYWxzZTtcclxuICAgICAgdmFyIGludmFsaWRiID0gZmFsc2U7XHJcbiAgICAgIHZhciBpbnZhbGlkYyA9IGZhbHNlO1xyXG4gICAgICB2YXIgaW52YWxpZGQgPSBmYWxzZTtcclxuICAgICAgdmFyIGludmFsaWRlID0gZmFsc2U7XHJcbiAgICAgIHZhciBpbnZhbGlkZiA9IGZhbHNlO1xyXG4gICAgICAvLyB0ZW1wb3JhcnkgdmFyaWFibGVzXHJcbiAgICAgIHZhciBsZW47XHJcbiAgICAgIHZhciBsZW4xO1xyXG4gICAgICB2YXIgbGVuMjtcclxuICAgICAgdmFyIGRvdDE7XHJcbiAgICAgIHZhciBkb3QyO1xyXG4gICAgICB2YXIgZG90MztcclxuICAgICAgLy8gdHJ5IGF4aXMgMVxyXG4gICAgICBsZW4gPSBhMXggKiBkeCArIGExeSAqIGR5ICsgYTF6ICogZHo7XHJcbiAgICAgIHJpZ2h0MSA9IGxlbiA+IDA7XHJcbiAgICAgIGlmICghcmlnaHQxKSBsZW4gPSAtbGVuO1xyXG4gICAgICBsZW4xID0gdzE7XHJcbiAgICAgIGRvdDEgPSBhMXggKiBhNHggKyBhMXkgKiBhNHkgKyBhMXogKiBhNHo7XHJcbiAgICAgIGRvdDIgPSBhMXggKiBhNXggKyBhMXkgKiBhNXkgKyBhMXogKiBhNXo7XHJcbiAgICAgIGRvdDMgPSBhMXggKiBhNnggKyBhMXkgKiBhNnkgKyBhMXogKiBhNno7XHJcbiAgICAgIGlmIChkb3QxIDwgMCkgZG90MSA9IC1kb3QxO1xyXG4gICAgICBpZiAoZG90MiA8IDApIGRvdDIgPSAtZG90MjtcclxuICAgICAgaWYgKGRvdDMgPCAwKSBkb3QzID0gLWRvdDM7XHJcbiAgICAgIGxlbjIgPSBkb3QxICogdzIgKyBkb3QyICogaDIgKyBkb3QzICogZDI7XHJcbiAgICAgIG92ZXJsYXAxID0gbGVuIC0gbGVuMSAtIGxlbjI7XHJcbiAgICAgIGlmIChvdmVybGFwMSA+IDApIHJldHVybjtcclxuICAgICAgLy8gdHJ5IGF4aXMgMlxyXG4gICAgICBsZW4gPSBhMnggKiBkeCArIGEyeSAqIGR5ICsgYTJ6ICogZHo7XHJcbiAgICAgIHJpZ2h0MiA9IGxlbiA+IDA7XHJcbiAgICAgIGlmICghcmlnaHQyKSBsZW4gPSAtbGVuO1xyXG4gICAgICBsZW4xID0gaDE7XHJcbiAgICAgIGRvdDEgPSBhMnggKiBhNHggKyBhMnkgKiBhNHkgKyBhMnogKiBhNHo7XHJcbiAgICAgIGRvdDIgPSBhMnggKiBhNXggKyBhMnkgKiBhNXkgKyBhMnogKiBhNXo7XHJcbiAgICAgIGRvdDMgPSBhMnggKiBhNnggKyBhMnkgKiBhNnkgKyBhMnogKiBhNno7XHJcbiAgICAgIGlmIChkb3QxIDwgMCkgZG90MSA9IC1kb3QxO1xyXG4gICAgICBpZiAoZG90MiA8IDApIGRvdDIgPSAtZG90MjtcclxuICAgICAgaWYgKGRvdDMgPCAwKSBkb3QzID0gLWRvdDM7XHJcbiAgICAgIGxlbjIgPSBkb3QxICogdzIgKyBkb3QyICogaDIgKyBkb3QzICogZDI7XHJcbiAgICAgIG92ZXJsYXAyID0gbGVuIC0gbGVuMSAtIGxlbjI7XHJcbiAgICAgIGlmIChvdmVybGFwMiA+IDApIHJldHVybjtcclxuICAgICAgLy8gdHJ5IGF4aXMgM1xyXG4gICAgICBsZW4gPSBhM3ggKiBkeCArIGEzeSAqIGR5ICsgYTN6ICogZHo7XHJcbiAgICAgIHJpZ2h0MyA9IGxlbiA+IDA7XHJcbiAgICAgIGlmICghcmlnaHQzKSBsZW4gPSAtbGVuO1xyXG4gICAgICBsZW4xID0gZDE7XHJcbiAgICAgIGRvdDEgPSBhM3ggKiBhNHggKyBhM3kgKiBhNHkgKyBhM3ogKiBhNHo7XHJcbiAgICAgIGRvdDIgPSBhM3ggKiBhNXggKyBhM3kgKiBhNXkgKyBhM3ogKiBhNXo7XHJcbiAgICAgIGRvdDMgPSBhM3ggKiBhNnggKyBhM3kgKiBhNnkgKyBhM3ogKiBhNno7XHJcbiAgICAgIGlmIChkb3QxIDwgMCkgZG90MSA9IC1kb3QxO1xyXG4gICAgICBpZiAoZG90MiA8IDApIGRvdDIgPSAtZG90MjtcclxuICAgICAgaWYgKGRvdDMgPCAwKSBkb3QzID0gLWRvdDM7XHJcbiAgICAgIGxlbjIgPSBkb3QxICogdzIgKyBkb3QyICogaDIgKyBkb3QzICogZDI7XHJcbiAgICAgIG92ZXJsYXAzID0gbGVuIC0gbGVuMSAtIGxlbjI7XHJcbiAgICAgIGlmIChvdmVybGFwMyA+IDApIHJldHVybjtcclxuICAgICAgLy8gdHJ5IGF4aXMgNFxyXG4gICAgICBsZW4gPSBhNHggKiBkeCArIGE0eSAqIGR5ICsgYTR6ICogZHo7XHJcbiAgICAgIHJpZ2h0NCA9IGxlbiA+IDA7XHJcbiAgICAgIGlmICghcmlnaHQ0KSBsZW4gPSAtbGVuO1xyXG4gICAgICBkb3QxID0gYTR4ICogYTF4ICsgYTR5ICogYTF5ICsgYTR6ICogYTF6O1xyXG4gICAgICBkb3QyID0gYTR4ICogYTJ4ICsgYTR5ICogYTJ5ICsgYTR6ICogYTJ6O1xyXG4gICAgICBkb3QzID0gYTR4ICogYTN4ICsgYTR5ICogYTN5ICsgYTR6ICogYTN6O1xyXG4gICAgICBpZiAoZG90MSA8IDApIGRvdDEgPSAtZG90MTtcclxuICAgICAgaWYgKGRvdDIgPCAwKSBkb3QyID0gLWRvdDI7XHJcbiAgICAgIGlmIChkb3QzIDwgMCkgZG90MyA9IC1kb3QzO1xyXG4gICAgICBsZW4xID0gZG90MSAqIHcxICsgZG90MiAqIGgxICsgZG90MyAqIGQxO1xyXG4gICAgICBsZW4yID0gdzI7XHJcbiAgICAgIG92ZXJsYXA0ID0gKGxlbiAtIGxlbjEgLSBsZW4yKSAqIDEuMDtcclxuICAgICAgaWYgKG92ZXJsYXA0ID4gMCkgcmV0dXJuO1xyXG4gICAgICAvLyB0cnkgYXhpcyA1XHJcbiAgICAgIGxlbiA9IGE1eCAqIGR4ICsgYTV5ICogZHkgKyBhNXogKiBkejtcclxuICAgICAgcmlnaHQ1ID0gbGVuID4gMDtcclxuICAgICAgaWYgKCFyaWdodDUpIGxlbiA9IC1sZW47XHJcbiAgICAgIGRvdDEgPSBhNXggKiBhMXggKyBhNXkgKiBhMXkgKyBhNXogKiBhMXo7XHJcbiAgICAgIGRvdDIgPSBhNXggKiBhMnggKyBhNXkgKiBhMnkgKyBhNXogKiBhMno7XHJcbiAgICAgIGRvdDMgPSBhNXggKiBhM3ggKyBhNXkgKiBhM3kgKyBhNXogKiBhM3o7XHJcbiAgICAgIGlmIChkb3QxIDwgMCkgZG90MSA9IC1kb3QxO1xyXG4gICAgICBpZiAoZG90MiA8IDApIGRvdDIgPSAtZG90MjtcclxuICAgICAgaWYgKGRvdDMgPCAwKSBkb3QzID0gLWRvdDM7XHJcbiAgICAgIGxlbjEgPSBkb3QxICogdzEgKyBkb3QyICogaDEgKyBkb3QzICogZDE7XHJcbiAgICAgIGxlbjIgPSBoMjtcclxuICAgICAgb3ZlcmxhcDUgPSAobGVuIC0gbGVuMSAtIGxlbjIpICogMS4wO1xyXG4gICAgICBpZiAob3ZlcmxhcDUgPiAwKSByZXR1cm47XHJcbiAgICAgIC8vIHRyeSBheGlzIDZcclxuICAgICAgbGVuID0gYTZ4ICogZHggKyBhNnkgKiBkeSArIGE2eiAqIGR6O1xyXG4gICAgICByaWdodDYgPSBsZW4gPiAwO1xyXG4gICAgICBpZiAoIXJpZ2h0NikgbGVuID0gLWxlbjtcclxuICAgICAgZG90MSA9IGE2eCAqIGExeCArIGE2eSAqIGExeSArIGE2eiAqIGExejtcclxuICAgICAgZG90MiA9IGE2eCAqIGEyeCArIGE2eSAqIGEyeSArIGE2eiAqIGEyejtcclxuICAgICAgZG90MyA9IGE2eCAqIGEzeCArIGE2eSAqIGEzeSArIGE2eiAqIGEzejtcclxuICAgICAgaWYgKGRvdDEgPCAwKSBkb3QxID0gLWRvdDE7XHJcbiAgICAgIGlmIChkb3QyIDwgMCkgZG90MiA9IC1kb3QyO1xyXG4gICAgICBpZiAoZG90MyA8IDApIGRvdDMgPSAtZG90MztcclxuICAgICAgbGVuMSA9IGRvdDEgKiB3MSArIGRvdDIgKiBoMSArIGRvdDMgKiBkMTtcclxuICAgICAgbGVuMiA9IGQyO1xyXG4gICAgICBvdmVybGFwNiA9IChsZW4gLSBsZW4xIC0gbGVuMikgKiAxLjA7XHJcbiAgICAgIGlmIChvdmVybGFwNiA+IDApIHJldHVybjtcclxuICAgICAgLy8gdHJ5IGF4aXMgN1xyXG4gICAgICBsZW4gPSBhN3ggKiBhN3ggKyBhN3kgKiBhN3kgKyBhN3ogKiBhN3o7XHJcbiAgICAgIGlmIChsZW4gPiAxZS01KSB7XHJcbiAgICAgICAgbGVuID0gMSAvIF9NYXRoLnNxcnQobGVuKTtcclxuICAgICAgICBhN3ggKj0gbGVuO1xyXG4gICAgICAgIGE3eSAqPSBsZW47XHJcbiAgICAgICAgYTd6ICo9IGxlbjtcclxuICAgICAgICBsZW4gPSBhN3ggKiBkeCArIGE3eSAqIGR5ICsgYTd6ICogZHo7XHJcbiAgICAgICAgcmlnaHQ3ID0gbGVuID4gMDtcclxuICAgICAgICBpZiAoIXJpZ2h0NykgbGVuID0gLWxlbjtcclxuICAgICAgICBkb3QxID0gYTd4ICogYTJ4ICsgYTd5ICogYTJ5ICsgYTd6ICogYTJ6O1xyXG4gICAgICAgIGRvdDIgPSBhN3ggKiBhM3ggKyBhN3kgKiBhM3kgKyBhN3ogKiBhM3o7XHJcbiAgICAgICAgaWYgKGRvdDEgPCAwKSBkb3QxID0gLWRvdDE7XHJcbiAgICAgICAgaWYgKGRvdDIgPCAwKSBkb3QyID0gLWRvdDI7XHJcbiAgICAgICAgbGVuMSA9IGRvdDEgKiBoMSArIGRvdDIgKiBkMTtcclxuICAgICAgICBkb3QxID0gYTd4ICogYTV4ICsgYTd5ICogYTV5ICsgYTd6ICogYTV6O1xyXG4gICAgICAgIGRvdDIgPSBhN3ggKiBhNnggKyBhN3kgKiBhNnkgKyBhN3ogKiBhNno7XHJcbiAgICAgICAgaWYgKGRvdDEgPCAwKSBkb3QxID0gLWRvdDE7XHJcbiAgICAgICAgaWYgKGRvdDIgPCAwKSBkb3QyID0gLWRvdDI7XHJcbiAgICAgICAgbGVuMiA9IGRvdDEgKiBoMiArIGRvdDIgKiBkMjtcclxuICAgICAgICBvdmVybGFwNyA9IGxlbiAtIGxlbjEgLSBsZW4yO1xyXG4gICAgICAgIGlmIChvdmVybGFwNyA+IDApIHJldHVybjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByaWdodDcgPSBmYWxzZTtcclxuICAgICAgICBvdmVybGFwNyA9IDA7XHJcbiAgICAgICAgaW52YWxpZDcgPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIHRyeSBheGlzIDhcclxuICAgICAgbGVuID0gYTh4ICogYTh4ICsgYTh5ICogYTh5ICsgYTh6ICogYTh6O1xyXG4gICAgICBpZiAobGVuID4gMWUtNSkge1xyXG4gICAgICAgIGxlbiA9IDEgLyBfTWF0aC5zcXJ0KGxlbik7XHJcbiAgICAgICAgYTh4ICo9IGxlbjtcclxuICAgICAgICBhOHkgKj0gbGVuO1xyXG4gICAgICAgIGE4eiAqPSBsZW47XHJcbiAgICAgICAgbGVuID0gYTh4ICogZHggKyBhOHkgKiBkeSArIGE4eiAqIGR6O1xyXG4gICAgICAgIHJpZ2h0OCA9IGxlbiA+IDA7XHJcbiAgICAgICAgaWYgKCFyaWdodDgpIGxlbiA9IC1sZW47XHJcbiAgICAgICAgZG90MSA9IGE4eCAqIGEyeCArIGE4eSAqIGEyeSArIGE4eiAqIGEyejtcclxuICAgICAgICBkb3QyID0gYTh4ICogYTN4ICsgYTh5ICogYTN5ICsgYTh6ICogYTN6O1xyXG4gICAgICAgIGlmIChkb3QxIDwgMCkgZG90MSA9IC1kb3QxO1xyXG4gICAgICAgIGlmIChkb3QyIDwgMCkgZG90MiA9IC1kb3QyO1xyXG4gICAgICAgIGxlbjEgPSBkb3QxICogaDEgKyBkb3QyICogZDE7XHJcbiAgICAgICAgZG90MSA9IGE4eCAqIGE0eCArIGE4eSAqIGE0eSArIGE4eiAqIGE0ejtcclxuICAgICAgICBkb3QyID0gYTh4ICogYTZ4ICsgYTh5ICogYTZ5ICsgYTh6ICogYTZ6O1xyXG4gICAgICAgIGlmIChkb3QxIDwgMCkgZG90MSA9IC1kb3QxO1xyXG4gICAgICAgIGlmIChkb3QyIDwgMCkgZG90MiA9IC1kb3QyO1xyXG4gICAgICAgIGxlbjIgPSBkb3QxICogdzIgKyBkb3QyICogZDI7XHJcbiAgICAgICAgb3ZlcmxhcDggPSBsZW4gLSBsZW4xIC0gbGVuMjtcclxuICAgICAgICBpZiAob3ZlcmxhcDggPiAwKSByZXR1cm47XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmlnaHQ4ID0gZmFsc2U7XHJcbiAgICAgICAgb3ZlcmxhcDggPSAwO1xyXG4gICAgICAgIGludmFsaWQ4ID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICAvLyB0cnkgYXhpcyA5XHJcbiAgICAgIGxlbiA9IGE5eCAqIGE5eCArIGE5eSAqIGE5eSArIGE5eiAqIGE5ejtcclxuICAgICAgaWYgKGxlbiA+IDFlLTUpIHtcclxuICAgICAgICBsZW4gPSAxIC8gX01hdGguc3FydChsZW4pO1xyXG4gICAgICAgIGE5eCAqPSBsZW47XHJcbiAgICAgICAgYTl5ICo9IGxlbjtcclxuICAgICAgICBhOXogKj0gbGVuO1xyXG4gICAgICAgIGxlbiA9IGE5eCAqIGR4ICsgYTl5ICogZHkgKyBhOXogKiBkejtcclxuICAgICAgICByaWdodDkgPSBsZW4gPiAwO1xyXG4gICAgICAgIGlmICghcmlnaHQ5KSBsZW4gPSAtbGVuO1xyXG4gICAgICAgIGRvdDEgPSBhOXggKiBhMnggKyBhOXkgKiBhMnkgKyBhOXogKiBhMno7XHJcbiAgICAgICAgZG90MiA9IGE5eCAqIGEzeCArIGE5eSAqIGEzeSArIGE5eiAqIGEzejtcclxuICAgICAgICBpZiAoZG90MSA8IDApIGRvdDEgPSAtZG90MTtcclxuICAgICAgICBpZiAoZG90MiA8IDApIGRvdDIgPSAtZG90MjtcclxuICAgICAgICBsZW4xID0gZG90MSAqIGgxICsgZG90MiAqIGQxO1xyXG4gICAgICAgIGRvdDEgPSBhOXggKiBhNHggKyBhOXkgKiBhNHkgKyBhOXogKiBhNHo7XHJcbiAgICAgICAgZG90MiA9IGE5eCAqIGE1eCArIGE5eSAqIGE1eSArIGE5eiAqIGE1ejtcclxuICAgICAgICBpZiAoZG90MSA8IDApIGRvdDEgPSAtZG90MTtcclxuICAgICAgICBpZiAoZG90MiA8IDApIGRvdDIgPSAtZG90MjtcclxuICAgICAgICBsZW4yID0gZG90MSAqIHcyICsgZG90MiAqIGgyO1xyXG4gICAgICAgIG92ZXJsYXA5ID0gbGVuIC0gbGVuMSAtIGxlbjI7XHJcbiAgICAgICAgaWYgKG92ZXJsYXA5ID4gMCkgcmV0dXJuO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJpZ2h0OSA9IGZhbHNlO1xyXG4gICAgICAgIG92ZXJsYXA5ID0gMDtcclxuICAgICAgICBpbnZhbGlkOSA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgLy8gdHJ5IGF4aXMgMTBcclxuICAgICAgbGVuID0gYWF4ICogYWF4ICsgYWF5ICogYWF5ICsgYWF6ICogYWF6O1xyXG4gICAgICBpZiAobGVuID4gMWUtNSkge1xyXG4gICAgICAgIGxlbiA9IDEgLyBfTWF0aC5zcXJ0KGxlbik7XHJcbiAgICAgICAgYWF4ICo9IGxlbjtcclxuICAgICAgICBhYXkgKj0gbGVuO1xyXG4gICAgICAgIGFheiAqPSBsZW47XHJcbiAgICAgICAgbGVuID0gYWF4ICogZHggKyBhYXkgKiBkeSArIGFheiAqIGR6O1xyXG4gICAgICAgIHJpZ2h0YSA9IGxlbiA+IDA7XHJcbiAgICAgICAgaWYgKCFyaWdodGEpIGxlbiA9IC1sZW47XHJcbiAgICAgICAgZG90MSA9IGFheCAqIGExeCArIGFheSAqIGExeSArIGFheiAqIGExejtcclxuICAgICAgICBkb3QyID0gYWF4ICogYTN4ICsgYWF5ICogYTN5ICsgYWF6ICogYTN6O1xyXG4gICAgICAgIGlmIChkb3QxIDwgMCkgZG90MSA9IC1kb3QxO1xyXG4gICAgICAgIGlmIChkb3QyIDwgMCkgZG90MiA9IC1kb3QyO1xyXG4gICAgICAgIGxlbjEgPSBkb3QxICogdzEgKyBkb3QyICogZDE7XHJcbiAgICAgICAgZG90MSA9IGFheCAqIGE1eCArIGFheSAqIGE1eSArIGFheiAqIGE1ejtcclxuICAgICAgICBkb3QyID0gYWF4ICogYTZ4ICsgYWF5ICogYTZ5ICsgYWF6ICogYTZ6O1xyXG4gICAgICAgIGlmIChkb3QxIDwgMCkgZG90MSA9IC1kb3QxO1xyXG4gICAgICAgIGlmIChkb3QyIDwgMCkgZG90MiA9IC1kb3QyO1xyXG4gICAgICAgIGxlbjIgPSBkb3QxICogaDIgKyBkb3QyICogZDI7XHJcbiAgICAgICAgb3ZlcmxhcGEgPSBsZW4gLSBsZW4xIC0gbGVuMjtcclxuICAgICAgICBpZiAob3ZlcmxhcGEgPiAwKSByZXR1cm47XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmlnaHRhID0gZmFsc2U7XHJcbiAgICAgICAgb3ZlcmxhcGEgPSAwO1xyXG4gICAgICAgIGludmFsaWRhID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICAvLyB0cnkgYXhpcyAxMVxyXG4gICAgICBsZW4gPSBhYnggKiBhYnggKyBhYnkgKiBhYnkgKyBhYnogKiBhYno7XHJcbiAgICAgIGlmIChsZW4gPiAxZS01KSB7XHJcbiAgICAgICAgbGVuID0gMSAvIF9NYXRoLnNxcnQobGVuKTtcclxuICAgICAgICBhYnggKj0gbGVuO1xyXG4gICAgICAgIGFieSAqPSBsZW47XHJcbiAgICAgICAgYWJ6ICo9IGxlbjtcclxuICAgICAgICBsZW4gPSBhYnggKiBkeCArIGFieSAqIGR5ICsgYWJ6ICogZHo7XHJcbiAgICAgICAgcmlnaHRiID0gbGVuID4gMDtcclxuICAgICAgICBpZiAoIXJpZ2h0YikgbGVuID0gLWxlbjtcclxuICAgICAgICBkb3QxID0gYWJ4ICogYTF4ICsgYWJ5ICogYTF5ICsgYWJ6ICogYTF6O1xyXG4gICAgICAgIGRvdDIgPSBhYnggKiBhM3ggKyBhYnkgKiBhM3kgKyBhYnogKiBhM3o7XHJcbiAgICAgICAgaWYgKGRvdDEgPCAwKSBkb3QxID0gLWRvdDE7XHJcbiAgICAgICAgaWYgKGRvdDIgPCAwKSBkb3QyID0gLWRvdDI7XHJcbiAgICAgICAgbGVuMSA9IGRvdDEgKiB3MSArIGRvdDIgKiBkMTtcclxuICAgICAgICBkb3QxID0gYWJ4ICogYTR4ICsgYWJ5ICogYTR5ICsgYWJ6ICogYTR6O1xyXG4gICAgICAgIGRvdDIgPSBhYnggKiBhNnggKyBhYnkgKiBhNnkgKyBhYnogKiBhNno7XHJcbiAgICAgICAgaWYgKGRvdDEgPCAwKSBkb3QxID0gLWRvdDE7XHJcbiAgICAgICAgaWYgKGRvdDIgPCAwKSBkb3QyID0gLWRvdDI7XHJcbiAgICAgICAgbGVuMiA9IGRvdDEgKiB3MiArIGRvdDIgKiBkMjtcclxuICAgICAgICBvdmVybGFwYiA9IGxlbiAtIGxlbjEgLSBsZW4yO1xyXG4gICAgICAgIGlmIChvdmVybGFwYiA+IDApIHJldHVybjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByaWdodGIgPSBmYWxzZTtcclxuICAgICAgICBvdmVybGFwYiA9IDA7XHJcbiAgICAgICAgaW52YWxpZGIgPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIHRyeSBheGlzIDEyXHJcbiAgICAgIGxlbiA9IGFjeCAqIGFjeCArIGFjeSAqIGFjeSArIGFjeiAqIGFjejtcclxuICAgICAgaWYgKGxlbiA+IDFlLTUpIHtcclxuICAgICAgICBsZW4gPSAxIC8gX01hdGguc3FydChsZW4pO1xyXG4gICAgICAgIGFjeCAqPSBsZW47XHJcbiAgICAgICAgYWN5ICo9IGxlbjtcclxuICAgICAgICBhY3ogKj0gbGVuO1xyXG4gICAgICAgIGxlbiA9IGFjeCAqIGR4ICsgYWN5ICogZHkgKyBhY3ogKiBkejtcclxuICAgICAgICByaWdodGMgPSBsZW4gPiAwO1xyXG4gICAgICAgIGlmICghcmlnaHRjKSBsZW4gPSAtbGVuO1xyXG4gICAgICAgIGRvdDEgPSBhY3ggKiBhMXggKyBhY3kgKiBhMXkgKyBhY3ogKiBhMXo7XHJcbiAgICAgICAgZG90MiA9IGFjeCAqIGEzeCArIGFjeSAqIGEzeSArIGFjeiAqIGEzejtcclxuICAgICAgICBpZiAoZG90MSA8IDApIGRvdDEgPSAtZG90MTtcclxuICAgICAgICBpZiAoZG90MiA8IDApIGRvdDIgPSAtZG90MjtcclxuICAgICAgICBsZW4xID0gZG90MSAqIHcxICsgZG90MiAqIGQxO1xyXG4gICAgICAgIGRvdDEgPSBhY3ggKiBhNHggKyBhY3kgKiBhNHkgKyBhY3ogKiBhNHo7XHJcbiAgICAgICAgZG90MiA9IGFjeCAqIGE1eCArIGFjeSAqIGE1eSArIGFjeiAqIGE1ejtcclxuICAgICAgICBpZiAoZG90MSA8IDApIGRvdDEgPSAtZG90MTtcclxuICAgICAgICBpZiAoZG90MiA8IDApIGRvdDIgPSAtZG90MjtcclxuICAgICAgICBsZW4yID0gZG90MSAqIHcyICsgZG90MiAqIGgyO1xyXG4gICAgICAgIG92ZXJsYXBjID0gbGVuIC0gbGVuMSAtIGxlbjI7XHJcbiAgICAgICAgaWYgKG92ZXJsYXBjID4gMCkgcmV0dXJuO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJpZ2h0YyA9IGZhbHNlO1xyXG4gICAgICAgIG92ZXJsYXBjID0gMDtcclxuICAgICAgICBpbnZhbGlkYyA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgLy8gdHJ5IGF4aXMgMTNcclxuICAgICAgbGVuID0gYWR4ICogYWR4ICsgYWR5ICogYWR5ICsgYWR6ICogYWR6O1xyXG4gICAgICBpZiAobGVuID4gMWUtNSkge1xyXG4gICAgICAgIGxlbiA9IDEgLyBfTWF0aC5zcXJ0KGxlbik7XHJcbiAgICAgICAgYWR4ICo9IGxlbjtcclxuICAgICAgICBhZHkgKj0gbGVuO1xyXG4gICAgICAgIGFkeiAqPSBsZW47XHJcbiAgICAgICAgbGVuID0gYWR4ICogZHggKyBhZHkgKiBkeSArIGFkeiAqIGR6O1xyXG4gICAgICAgIHJpZ2h0ZCA9IGxlbiA+IDA7XHJcbiAgICAgICAgaWYgKCFyaWdodGQpIGxlbiA9IC1sZW47XHJcbiAgICAgICAgZG90MSA9IGFkeCAqIGExeCArIGFkeSAqIGExeSArIGFkeiAqIGExejtcclxuICAgICAgICBkb3QyID0gYWR4ICogYTJ4ICsgYWR5ICogYTJ5ICsgYWR6ICogYTJ6O1xyXG4gICAgICAgIGlmIChkb3QxIDwgMCkgZG90MSA9IC1kb3QxO1xyXG4gICAgICAgIGlmIChkb3QyIDwgMCkgZG90MiA9IC1kb3QyO1xyXG4gICAgICAgIGxlbjEgPSBkb3QxICogdzEgKyBkb3QyICogaDE7XHJcbiAgICAgICAgZG90MSA9IGFkeCAqIGE1eCArIGFkeSAqIGE1eSArIGFkeiAqIGE1ejtcclxuICAgICAgICBkb3QyID0gYWR4ICogYTZ4ICsgYWR5ICogYTZ5ICsgYWR6ICogYTZ6O1xyXG4gICAgICAgIGlmIChkb3QxIDwgMCkgZG90MSA9IC1kb3QxO1xyXG4gICAgICAgIGlmIChkb3QyIDwgMCkgZG90MiA9IC1kb3QyO1xyXG4gICAgICAgIGxlbjIgPSBkb3QxICogaDIgKyBkb3QyICogZDI7XHJcbiAgICAgICAgb3ZlcmxhcGQgPSBsZW4gLSBsZW4xIC0gbGVuMjtcclxuICAgICAgICBpZiAob3ZlcmxhcGQgPiAwKSByZXR1cm47XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmlnaHRkID0gZmFsc2U7XHJcbiAgICAgICAgb3ZlcmxhcGQgPSAwO1xyXG4gICAgICAgIGludmFsaWRkID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICAvLyB0cnkgYXhpcyAxNFxyXG4gICAgICBsZW4gPSBhZXggKiBhZXggKyBhZXkgKiBhZXkgKyBhZXogKiBhZXo7XHJcbiAgICAgIGlmIChsZW4gPiAxZS01KSB7XHJcbiAgICAgICAgbGVuID0gMSAvIF9NYXRoLnNxcnQobGVuKTtcclxuICAgICAgICBhZXggKj0gbGVuO1xyXG4gICAgICAgIGFleSAqPSBsZW47XHJcbiAgICAgICAgYWV6ICo9IGxlbjtcclxuICAgICAgICBsZW4gPSBhZXggKiBkeCArIGFleSAqIGR5ICsgYWV6ICogZHo7XHJcbiAgICAgICAgcmlnaHRlID0gbGVuID4gMDtcclxuICAgICAgICBpZiAoIXJpZ2h0ZSkgbGVuID0gLWxlbjtcclxuICAgICAgICBkb3QxID0gYWV4ICogYTF4ICsgYWV5ICogYTF5ICsgYWV6ICogYTF6O1xyXG4gICAgICAgIGRvdDIgPSBhZXggKiBhMnggKyBhZXkgKiBhMnkgKyBhZXogKiBhMno7XHJcbiAgICAgICAgaWYgKGRvdDEgPCAwKSBkb3QxID0gLWRvdDE7XHJcbiAgICAgICAgaWYgKGRvdDIgPCAwKSBkb3QyID0gLWRvdDI7XHJcbiAgICAgICAgbGVuMSA9IGRvdDEgKiB3MSArIGRvdDIgKiBoMTtcclxuICAgICAgICBkb3QxID0gYWV4ICogYTR4ICsgYWV5ICogYTR5ICsgYWV6ICogYTR6O1xyXG4gICAgICAgIGRvdDIgPSBhZXggKiBhNnggKyBhZXkgKiBhNnkgKyBhZXogKiBhNno7XHJcbiAgICAgICAgaWYgKGRvdDEgPCAwKSBkb3QxID0gLWRvdDE7XHJcbiAgICAgICAgaWYgKGRvdDIgPCAwKSBkb3QyID0gLWRvdDI7XHJcbiAgICAgICAgbGVuMiA9IGRvdDEgKiB3MiArIGRvdDIgKiBkMjtcclxuICAgICAgICBvdmVybGFwZSA9IGxlbiAtIGxlbjEgLSBsZW4yO1xyXG4gICAgICAgIGlmIChvdmVybGFwZSA+IDApIHJldHVybjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByaWdodGUgPSBmYWxzZTtcclxuICAgICAgICBvdmVybGFwZSA9IDA7XHJcbiAgICAgICAgaW52YWxpZGUgPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIHRyeSBheGlzIDE1XHJcbiAgICAgIGxlbiA9IGFmeCAqIGFmeCArIGFmeSAqIGFmeSArIGFmeiAqIGFmejtcclxuICAgICAgaWYgKGxlbiA+IDFlLTUpIHtcclxuICAgICAgICBsZW4gPSAxIC8gX01hdGguc3FydChsZW4pO1xyXG4gICAgICAgIGFmeCAqPSBsZW47XHJcbiAgICAgICAgYWZ5ICo9IGxlbjtcclxuICAgICAgICBhZnogKj0gbGVuO1xyXG4gICAgICAgIGxlbiA9IGFmeCAqIGR4ICsgYWZ5ICogZHkgKyBhZnogKiBkejtcclxuICAgICAgICByaWdodGYgPSBsZW4gPiAwO1xyXG4gICAgICAgIGlmICghcmlnaHRmKSBsZW4gPSAtbGVuO1xyXG4gICAgICAgIGRvdDEgPSBhZnggKiBhMXggKyBhZnkgKiBhMXkgKyBhZnogKiBhMXo7XHJcbiAgICAgICAgZG90MiA9IGFmeCAqIGEyeCArIGFmeSAqIGEyeSArIGFmeiAqIGEyejtcclxuICAgICAgICBpZiAoZG90MSA8IDApIGRvdDEgPSAtZG90MTtcclxuICAgICAgICBpZiAoZG90MiA8IDApIGRvdDIgPSAtZG90MjtcclxuICAgICAgICBsZW4xID0gZG90MSAqIHcxICsgZG90MiAqIGgxO1xyXG4gICAgICAgIGRvdDEgPSBhZnggKiBhNHggKyBhZnkgKiBhNHkgKyBhZnogKiBhNHo7XHJcbiAgICAgICAgZG90MiA9IGFmeCAqIGE1eCArIGFmeSAqIGE1eSArIGFmeiAqIGE1ejtcclxuICAgICAgICBpZiAoZG90MSA8IDApIGRvdDEgPSAtZG90MTtcclxuICAgICAgICBpZiAoZG90MiA8IDApIGRvdDIgPSAtZG90MjtcclxuICAgICAgICBsZW4yID0gZG90MSAqIHcyICsgZG90MiAqIGgyO1xyXG4gICAgICAgIG92ZXJsYXBmID0gbGVuIC0gbGVuMSAtIGxlbjI7XHJcbiAgICAgICAgaWYgKG92ZXJsYXBmID4gMCkgcmV0dXJuO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHJpZ2h0ZiA9IGZhbHNlO1xyXG4gICAgICAgIG92ZXJsYXBmID0gMDtcclxuICAgICAgICBpbnZhbGlkZiA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgLy8gYm94ZXMgYXJlIG92ZXJsYXBwaW5nXHJcbiAgICAgIHZhciBkZXB0aCA9IG92ZXJsYXAxO1xyXG4gICAgICB2YXIgZGVwdGgyID0gb3ZlcmxhcDE7XHJcbiAgICAgIHZhciBtaW5JbmRleCA9IDA7XHJcbiAgICAgIHZhciByaWdodCA9IHJpZ2h0MTtcclxuICAgICAgaWYgKG92ZXJsYXAyID4gZGVwdGgyKSB7XHJcbiAgICAgICAgZGVwdGggPSBvdmVybGFwMjtcclxuICAgICAgICBkZXB0aDIgPSBvdmVybGFwMjtcclxuICAgICAgICBtaW5JbmRleCA9IDE7XHJcbiAgICAgICAgcmlnaHQgPSByaWdodDI7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG92ZXJsYXAzID4gZGVwdGgyKSB7XHJcbiAgICAgICAgZGVwdGggPSBvdmVybGFwMztcclxuICAgICAgICBkZXB0aDIgPSBvdmVybGFwMztcclxuICAgICAgICBtaW5JbmRleCA9IDI7XHJcbiAgICAgICAgcmlnaHQgPSByaWdodDM7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG92ZXJsYXA0ID4gZGVwdGgyKSB7XHJcbiAgICAgICAgZGVwdGggPSBvdmVybGFwNDtcclxuICAgICAgICBkZXB0aDIgPSBvdmVybGFwNDtcclxuICAgICAgICBtaW5JbmRleCA9IDM7XHJcbiAgICAgICAgcmlnaHQgPSByaWdodDQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG92ZXJsYXA1ID4gZGVwdGgyKSB7XHJcbiAgICAgICAgZGVwdGggPSBvdmVybGFwNTtcclxuICAgICAgICBkZXB0aDIgPSBvdmVybGFwNTtcclxuICAgICAgICBtaW5JbmRleCA9IDQ7XHJcbiAgICAgICAgcmlnaHQgPSByaWdodDU7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG92ZXJsYXA2ID4gZGVwdGgyKSB7XHJcbiAgICAgICAgZGVwdGggPSBvdmVybGFwNjtcclxuICAgICAgICBkZXB0aDIgPSBvdmVybGFwNjtcclxuICAgICAgICBtaW5JbmRleCA9IDU7XHJcbiAgICAgICAgcmlnaHQgPSByaWdodDY7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG92ZXJsYXA3IC0gMC4wMSA+IGRlcHRoMiAmJiAhaW52YWxpZDcpIHtcclxuICAgICAgICBkZXB0aCA9IG92ZXJsYXA3O1xyXG4gICAgICAgIGRlcHRoMiA9IG92ZXJsYXA3IC0gMC4wMTtcclxuICAgICAgICBtaW5JbmRleCA9IDY7XHJcbiAgICAgICAgcmlnaHQgPSByaWdodDc7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG92ZXJsYXA4IC0gMC4wMSA+IGRlcHRoMiAmJiAhaW52YWxpZDgpIHtcclxuICAgICAgICBkZXB0aCA9IG92ZXJsYXA4O1xyXG4gICAgICAgIGRlcHRoMiA9IG92ZXJsYXA4IC0gMC4wMTtcclxuICAgICAgICBtaW5JbmRleCA9IDc7XHJcbiAgICAgICAgcmlnaHQgPSByaWdodDg7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG92ZXJsYXA5IC0gMC4wMSA+IGRlcHRoMiAmJiAhaW52YWxpZDkpIHtcclxuICAgICAgICBkZXB0aCA9IG92ZXJsYXA5O1xyXG4gICAgICAgIGRlcHRoMiA9IG92ZXJsYXA5IC0gMC4wMTtcclxuICAgICAgICBtaW5JbmRleCA9IDg7XHJcbiAgICAgICAgcmlnaHQgPSByaWdodDk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG92ZXJsYXBhIC0gMC4wMSA+IGRlcHRoMiAmJiAhaW52YWxpZGEpIHtcclxuICAgICAgICBkZXB0aCA9IG92ZXJsYXBhO1xyXG4gICAgICAgIGRlcHRoMiA9IG92ZXJsYXBhIC0gMC4wMTtcclxuICAgICAgICBtaW5JbmRleCA9IDk7XHJcbiAgICAgICAgcmlnaHQgPSByaWdodGE7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG92ZXJsYXBiIC0gMC4wMSA+IGRlcHRoMiAmJiAhaW52YWxpZGIpIHtcclxuICAgICAgICBkZXB0aCA9IG92ZXJsYXBiO1xyXG4gICAgICAgIGRlcHRoMiA9IG92ZXJsYXBiIC0gMC4wMTtcclxuICAgICAgICBtaW5JbmRleCA9IDEwO1xyXG4gICAgICAgIHJpZ2h0ID0gcmlnaHRiO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChvdmVybGFwYyAtIDAuMDEgPiBkZXB0aDIgJiYgIWludmFsaWRjKSB7XHJcbiAgICAgICAgZGVwdGggPSBvdmVybGFwYztcclxuICAgICAgICBkZXB0aDIgPSBvdmVybGFwYyAtIDAuMDE7XHJcbiAgICAgICAgbWluSW5kZXggPSAxMTtcclxuICAgICAgICByaWdodCA9IHJpZ2h0YztcclxuICAgICAgfVxyXG4gICAgICBpZiAob3ZlcmxhcGQgLSAwLjAxID4gZGVwdGgyICYmICFpbnZhbGlkZCkge1xyXG4gICAgICAgIGRlcHRoID0gb3ZlcmxhcGQ7XHJcbiAgICAgICAgZGVwdGgyID0gb3ZlcmxhcGQgLSAwLjAxO1xyXG4gICAgICAgIG1pbkluZGV4ID0gMTI7XHJcbiAgICAgICAgcmlnaHQgPSByaWdodGQ7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG92ZXJsYXBlIC0gMC4wMSA+IGRlcHRoMiAmJiAhaW52YWxpZGUpIHtcclxuICAgICAgICBkZXB0aCA9IG92ZXJsYXBlO1xyXG4gICAgICAgIGRlcHRoMiA9IG92ZXJsYXBlIC0gMC4wMTtcclxuICAgICAgICBtaW5JbmRleCA9IDEzO1xyXG4gICAgICAgIHJpZ2h0ID0gcmlnaHRlO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChvdmVybGFwZiAtIDAuMDEgPiBkZXB0aDIgJiYgIWludmFsaWRmKSB7XHJcbiAgICAgICAgZGVwdGggPSBvdmVybGFwZjtcclxuICAgICAgICBtaW5JbmRleCA9IDE0O1xyXG4gICAgICAgIHJpZ2h0ID0gcmlnaHRmO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIG5vcm1hbFxyXG4gICAgICB2YXIgbnggPSAwO1xyXG4gICAgICB2YXIgbnkgPSAwO1xyXG4gICAgICB2YXIgbnogPSAwO1xyXG4gICAgICAvLyBlZGdlIGxpbmUgb3IgZmFjZSBzaWRlIG5vcm1hbFxyXG4gICAgICB2YXIgbjF4ID0gMDtcclxuICAgICAgdmFyIG4xeSA9IDA7XHJcbiAgICAgIHZhciBuMXogPSAwO1xyXG4gICAgICB2YXIgbjJ4ID0gMDtcclxuICAgICAgdmFyIG4yeSA9IDA7XHJcbiAgICAgIHZhciBuMnogPSAwO1xyXG4gICAgICAvLyBjZW50ZXIgb2YgY3VycmVudCBmYWNlXHJcbiAgICAgIHZhciBjeCA9IDA7XHJcbiAgICAgIHZhciBjeSA9IDA7XHJcbiAgICAgIHZhciBjeiA9IDA7XHJcbiAgICAgIC8vIGZhY2Ugc2lkZVxyXG4gICAgICB2YXIgczF4ID0gMDtcclxuICAgICAgdmFyIHMxeSA9IDA7XHJcbiAgICAgIHZhciBzMXogPSAwO1xyXG4gICAgICB2YXIgczJ4ID0gMDtcclxuICAgICAgdmFyIHMyeSA9IDA7XHJcbiAgICAgIHZhciBzMnogPSAwO1xyXG4gICAgICAvLyBzd2FwIGIxIGIyXHJcbiAgICAgIHZhciBzd2FwID0gZmFsc2U7XHJcblxyXG4gICAgICAvL19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX1xyXG5cclxuICAgICAgaWYgKG1pbkluZGV4ID09IDApIHsvLyBiMS54ICogYjJcclxuICAgICAgICBpZiAocmlnaHQpIHtcclxuICAgICAgICAgIGN4ID0gcDF4ICsgZDF4OyBjeSA9IHAxeSArIGQxeTsgY3ogPSBwMXogKyBkMXo7XHJcbiAgICAgICAgICBueCA9IGExeDsgbnkgPSBhMXk7IG56ID0gYTF6O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjeCA9IHAxeCAtIGQxeDsgY3kgPSBwMXkgLSBkMXk7IGN6ID0gcDF6IC0gZDF6O1xyXG4gICAgICAgICAgbnggPSAtYTF4OyBueSA9IC1hMXk7IG56ID0gLWExejtcclxuICAgICAgICB9XHJcbiAgICAgICAgczF4ID0gZDJ4OyBzMXkgPSBkMnk7IHMxeiA9IGQyejtcclxuICAgICAgICBuMXggPSAtYTJ4OyBuMXkgPSAtYTJ5OyBuMXogPSAtYTJ6O1xyXG4gICAgICAgIHMyeCA9IGQzeDsgczJ5ID0gZDN5OyBzMnogPSBkM3o7XHJcbiAgICAgICAgbjJ4ID0gLWEzeDsgbjJ5ID0gLWEzeTsgbjJ6ID0gLWEzejtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmIChtaW5JbmRleCA9PSAxKSB7Ly8gYjEueSAqIGIyXHJcbiAgICAgICAgaWYgKHJpZ2h0KSB7XHJcbiAgICAgICAgICBjeCA9IHAxeCArIGQyeDsgY3kgPSBwMXkgKyBkMnk7IGN6ID0gcDF6ICsgZDJ6O1xyXG4gICAgICAgICAgbnggPSBhMng7IG55ID0gYTJ5OyBueiA9IGEyejtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY3ggPSBwMXggLSBkMng7IGN5ID0gcDF5IC0gZDJ5OyBjeiA9IHAxeiAtIGQyejtcclxuICAgICAgICAgIG54ID0gLWEyeDsgbnkgPSAtYTJ5OyBueiA9IC1hMno7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHMxeCA9IGQxeDsgczF5ID0gZDF5OyBzMXogPSBkMXo7XHJcbiAgICAgICAgbjF4ID0gLWExeDsgbjF5ID0gLWExeTsgbjF6ID0gLWExejtcclxuICAgICAgICBzMnggPSBkM3g7IHMyeSA9IGQzeTsgczJ6ID0gZDN6O1xyXG4gICAgICAgIG4yeCA9IC1hM3g7IG4yeSA9IC1hM3k7IG4yeiA9IC1hM3o7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAobWluSW5kZXggPT0gMikgey8vIGIxLnogKiBiMlxyXG4gICAgICAgIGlmIChyaWdodCkge1xyXG4gICAgICAgICAgY3ggPSBwMXggKyBkM3g7IGN5ID0gcDF5ICsgZDN5OyBjeiA9IHAxeiArIGQzejtcclxuICAgICAgICAgIG54ID0gYTN4OyBueSA9IGEzeTsgbnogPSBhM3o7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGN4ID0gcDF4IC0gZDN4OyBjeSA9IHAxeSAtIGQzeTsgY3ogPSBwMXogLSBkM3o7XHJcbiAgICAgICAgICBueCA9IC1hM3g7IG55ID0gLWEzeTsgbnogPSAtYTN6O1xyXG4gICAgICAgIH1cclxuICAgICAgICBzMXggPSBkMXg7IHMxeSA9IGQxeTsgczF6ID0gZDF6O1xyXG4gICAgICAgIG4xeCA9IC1hMXg7IG4xeSA9IC1hMXk7IG4xeiA9IC1hMXo7XHJcbiAgICAgICAgczJ4ID0gZDJ4OyBzMnkgPSBkMnk7IHMyeiA9IGQyejtcclxuICAgICAgICBuMnggPSAtYTJ4OyBuMnkgPSAtYTJ5OyBuMnogPSAtYTJ6O1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKG1pbkluZGV4ID09IDMpIHsvLyBiMi54ICogYjFcclxuICAgICAgICBzd2FwID0gdHJ1ZTtcclxuICAgICAgICBpZiAoIXJpZ2h0KSB7XHJcbiAgICAgICAgICBjeCA9IHAyeCArIGQ0eDsgY3kgPSBwMnkgKyBkNHk7IGN6ID0gcDJ6ICsgZDR6O1xyXG4gICAgICAgICAgbnggPSBhNHg7IG55ID0gYTR5OyBueiA9IGE0ejtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY3ggPSBwMnggLSBkNHg7IGN5ID0gcDJ5IC0gZDR5OyBjeiA9IHAyeiAtIGQ0ejtcclxuICAgICAgICAgIG54ID0gLWE0eDsgbnkgPSAtYTR5OyBueiA9IC1hNHo7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHMxeCA9IGQ1eDsgczF5ID0gZDV5OyBzMXogPSBkNXo7XHJcbiAgICAgICAgbjF4ID0gLWE1eDsgbjF5ID0gLWE1eTsgbjF6ID0gLWE1ejtcclxuICAgICAgICBzMnggPSBkNng7IHMyeSA9IGQ2eTsgczJ6ID0gZDZ6O1xyXG4gICAgICAgIG4yeCA9IC1hNng7IG4yeSA9IC1hNnk7IG4yeiA9IC1hNno7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAobWluSW5kZXggPT0gNCkgey8vIGIyLnkgKiBiMVxyXG4gICAgICAgIHN3YXAgPSB0cnVlO1xyXG4gICAgICAgIGlmICghcmlnaHQpIHtcclxuICAgICAgICAgIGN4ID0gcDJ4ICsgZDV4OyBjeSA9IHAyeSArIGQ1eTsgY3ogPSBwMnogKyBkNXo7XHJcbiAgICAgICAgICBueCA9IGE1eDsgbnkgPSBhNXk7IG56ID0gYTV6O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBjeCA9IHAyeCAtIGQ1eDsgY3kgPSBwMnkgLSBkNXk7IGN6ID0gcDJ6IC0gZDV6O1xyXG4gICAgICAgICAgbnggPSAtYTV4OyBueSA9IC1hNXk7IG56ID0gLWE1ejtcclxuICAgICAgICB9XHJcbiAgICAgICAgczF4ID0gZDR4OyBzMXkgPSBkNHk7IHMxeiA9IGQ0ejtcclxuICAgICAgICBuMXggPSAtYTR4OyBuMXkgPSAtYTR5OyBuMXogPSAtYTR6O1xyXG4gICAgICAgIHMyeCA9IGQ2eDsgczJ5ID0gZDZ5OyBzMnogPSBkNno7XHJcbiAgICAgICAgbjJ4ID0gLWE2eDsgbjJ5ID0gLWE2eTsgbjJ6ID0gLWE2ejtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmIChtaW5JbmRleCA9PSA1KSB7Ly8gYjIueiAqIGIxXHJcbiAgICAgICAgc3dhcCA9IHRydWU7XHJcbiAgICAgICAgaWYgKCFyaWdodCkge1xyXG4gICAgICAgICAgY3ggPSBwMnggKyBkNng7IGN5ID0gcDJ5ICsgZDZ5OyBjeiA9IHAyeiArIGQ2ejtcclxuICAgICAgICAgIG54ID0gYTZ4OyBueSA9IGE2eTsgbnogPSBhNno7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGN4ID0gcDJ4IC0gZDZ4OyBjeSA9IHAyeSAtIGQ2eTsgY3ogPSBwMnogLSBkNno7XHJcbiAgICAgICAgICBueCA9IC1hNng7IG55ID0gLWE2eTsgbnogPSAtYTZ6O1xyXG4gICAgICAgIH1cclxuICAgICAgICBzMXggPSBkNHg7IHMxeSA9IGQ0eTsgczF6ID0gZDR6O1xyXG4gICAgICAgIG4xeCA9IC1hNHg7IG4xeSA9IC1hNHk7IG4xeiA9IC1hNHo7XHJcbiAgICAgICAgczJ4ID0gZDV4OyBzMnkgPSBkNXk7IHMyeiA9IGQ1ejtcclxuICAgICAgICBuMnggPSAtYTV4OyBuMnkgPSAtYTV5OyBuMnogPSAtYTV6O1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKG1pbkluZGV4ID09IDYpIHsvLyBiMS54ICogYjIueFxyXG4gICAgICAgIG54ID0gYTd4OyBueSA9IGE3eTsgbnogPSBhN3o7XHJcbiAgICAgICAgbjF4ID0gYTF4OyBuMXkgPSBhMXk7IG4xeiA9IGExejtcclxuICAgICAgICBuMnggPSBhNHg7IG4yeSA9IGE0eTsgbjJ6ID0gYTR6O1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKG1pbkluZGV4ID09IDcpIHsvLyBiMS54ICogYjIueVxyXG4gICAgICAgIG54ID0gYTh4OyBueSA9IGE4eTsgbnogPSBhOHo7XHJcbiAgICAgICAgbjF4ID0gYTF4OyBuMXkgPSBhMXk7IG4xeiA9IGExejtcclxuICAgICAgICBuMnggPSBhNXg7IG4yeSA9IGE1eTsgbjJ6ID0gYTV6O1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKG1pbkluZGV4ID09IDgpIHsvLyBiMS54ICogYjIuelxyXG4gICAgICAgIG54ID0gYTl4OyBueSA9IGE5eTsgbnogPSBhOXo7XHJcbiAgICAgICAgbjF4ID0gYTF4OyBuMXkgPSBhMXk7IG4xeiA9IGExejtcclxuICAgICAgICBuMnggPSBhNng7IG4yeSA9IGE2eTsgbjJ6ID0gYTZ6O1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKG1pbkluZGV4ID09IDkpIHsvLyBiMS55ICogYjIueFxyXG4gICAgICAgIG54ID0gYWF4OyBueSA9IGFheTsgbnogPSBhYXo7XHJcbiAgICAgICAgbjF4ID0gYTJ4OyBuMXkgPSBhMnk7IG4xeiA9IGEyejtcclxuICAgICAgICBuMnggPSBhNHg7IG4yeSA9IGE0eTsgbjJ6ID0gYTR6O1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKG1pbkluZGV4ID09IDEwKSB7Ly8gYjEueSAqIGIyLnlcclxuICAgICAgICBueCA9IGFieDsgbnkgPSBhYnk7IG56ID0gYWJ6O1xyXG4gICAgICAgIG4xeCA9IGEyeDsgbjF5ID0gYTJ5OyBuMXogPSBhMno7XHJcbiAgICAgICAgbjJ4ID0gYTV4OyBuMnkgPSBhNXk7IG4yeiA9IGE1ejtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmIChtaW5JbmRleCA9PSAxMSkgey8vIGIxLnkgKiBiMi56XHJcbiAgICAgICAgbnggPSBhY3g7IG55ID0gYWN5OyBueiA9IGFjejtcclxuICAgICAgICBuMXggPSBhMng7IG4xeSA9IGEyeTsgbjF6ID0gYTJ6O1xyXG4gICAgICAgIG4yeCA9IGE2eDsgbjJ5ID0gYTZ5OyBuMnogPSBhNno7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSBpZiAobWluSW5kZXggPT0gMTIpIHsvLyBiMS56ICogYjIueFxyXG4gICAgICAgIG54ID0gYWR4OyBueSA9IGFkeTsgbnogPSBhZHo7XHJcbiAgICAgICAgbjF4ID0gYTN4OyBuMXkgPSBhM3k7IG4xeiA9IGEzejtcclxuICAgICAgICBuMnggPSBhNHg7IG4yeSA9IGE0eTsgbjJ6ID0gYTR6O1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKG1pbkluZGV4ID09IDEzKSB7Ly8gYjEueiAqIGIyLnlcclxuICAgICAgICBueCA9IGFleDsgbnkgPSBhZXk7IG56ID0gYWV6O1xyXG4gICAgICAgIG4xeCA9IGEzeDsgbjF5ID0gYTN5OyBuMXogPSBhM3o7XHJcbiAgICAgICAgbjJ4ID0gYTV4OyBuMnkgPSBhNXk7IG4yeiA9IGE1ejtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmIChtaW5JbmRleCA9PSAxNCkgey8vIGIxLnogKiBiMi56XHJcbiAgICAgICAgbnggPSBhZng7IG55ID0gYWZ5OyBueiA9IGFmejtcclxuICAgICAgICBuMXggPSBhM3g7IG4xeSA9IGEzeTsgbjF6ID0gYTN6O1xyXG4gICAgICAgIG4yeCA9IGE2eDsgbjJ5ID0gYTZ5OyBuMnogPSBhNno7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXHJcblxyXG4gICAgICAvL3ZhciB2O1xyXG4gICAgICBpZiAobWluSW5kZXggPiA1KSB7XHJcbiAgICAgICAgaWYgKCFyaWdodCkge1xyXG4gICAgICAgICAgbnggPSAtbng7IG55ID0gLW55OyBueiA9IC1uejtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGRpc3RhbmNlO1xyXG4gICAgICAgIHZhciBtYXhEaXN0YW5jZTtcclxuICAgICAgICB2YXIgdng7XHJcbiAgICAgICAgdmFyIHZ5O1xyXG4gICAgICAgIHZhciB2ejtcclxuICAgICAgICB2YXIgdjF4O1xyXG4gICAgICAgIHZhciB2MXk7XHJcbiAgICAgICAgdmFyIHYxejtcclxuICAgICAgICB2YXIgdjJ4O1xyXG4gICAgICAgIHZhciB2Mnk7XHJcbiAgICAgICAgdmFyIHYyejtcclxuICAgICAgICAvL3ZlcnRleDE7XHJcbiAgICAgICAgdjF4ID0gVjFbMF07IHYxeSA9IFYxWzFdOyB2MXogPSBWMVsyXTtcclxuICAgICAgICBtYXhEaXN0YW5jZSA9IG54ICogdjF4ICsgbnkgKiB2MXkgKyBueiAqIHYxejtcclxuICAgICAgICAvL3ZlcnRleDI7XHJcbiAgICAgICAgdnggPSBWMVszXTsgdnkgPSBWMVs0XTsgdnogPSBWMVs1XTtcclxuICAgICAgICBkaXN0YW5jZSA9IG54ICogdnggKyBueSAqIHZ5ICsgbnogKiB2ejtcclxuICAgICAgICBpZiAoZGlzdGFuY2UgPiBtYXhEaXN0YW5jZSkge1xyXG4gICAgICAgICAgbWF4RGlzdGFuY2UgPSBkaXN0YW5jZTtcclxuICAgICAgICAgIHYxeCA9IHZ4OyB2MXkgPSB2eTsgdjF6ID0gdno7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vdmVydGV4MztcclxuICAgICAgICB2eCA9IFYxWzZdOyB2eSA9IFYxWzddOyB2eiA9IFYxWzhdO1xyXG4gICAgICAgIGRpc3RhbmNlID0gbnggKiB2eCArIG55ICogdnkgKyBueiAqIHZ6O1xyXG4gICAgICAgIGlmIChkaXN0YW5jZSA+IG1heERpc3RhbmNlKSB7XHJcbiAgICAgICAgICBtYXhEaXN0YW5jZSA9IGRpc3RhbmNlO1xyXG4gICAgICAgICAgdjF4ID0gdng7IHYxeSA9IHZ5OyB2MXogPSB2ejtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy92ZXJ0ZXg0O1xyXG4gICAgICAgIHZ4ID0gVjFbOV07IHZ5ID0gVjFbMTBdOyB2eiA9IFYxWzExXTtcclxuICAgICAgICBkaXN0YW5jZSA9IG54ICogdnggKyBueSAqIHZ5ICsgbnogKiB2ejtcclxuICAgICAgICBpZiAoZGlzdGFuY2UgPiBtYXhEaXN0YW5jZSkge1xyXG4gICAgICAgICAgbWF4RGlzdGFuY2UgPSBkaXN0YW5jZTtcclxuICAgICAgICAgIHYxeCA9IHZ4OyB2MXkgPSB2eTsgdjF6ID0gdno7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vdmVydGV4NTtcclxuICAgICAgICB2eCA9IFYxWzEyXTsgdnkgPSBWMVsxM107IHZ6ID0gVjFbMTRdO1xyXG4gICAgICAgIGRpc3RhbmNlID0gbnggKiB2eCArIG55ICogdnkgKyBueiAqIHZ6O1xyXG4gICAgICAgIGlmIChkaXN0YW5jZSA+IG1heERpc3RhbmNlKSB7XHJcbiAgICAgICAgICBtYXhEaXN0YW5jZSA9IGRpc3RhbmNlO1xyXG4gICAgICAgICAgdjF4ID0gdng7IHYxeSA9IHZ5OyB2MXogPSB2ejtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy92ZXJ0ZXg2O1xyXG4gICAgICAgIHZ4ID0gVjFbMTVdOyB2eSA9IFYxWzE2XTsgdnogPSBWMVsxN107XHJcbiAgICAgICAgZGlzdGFuY2UgPSBueCAqIHZ4ICsgbnkgKiB2eSArIG56ICogdno7XHJcbiAgICAgICAgaWYgKGRpc3RhbmNlID4gbWF4RGlzdGFuY2UpIHtcclxuICAgICAgICAgIG1heERpc3RhbmNlID0gZGlzdGFuY2U7XHJcbiAgICAgICAgICB2MXggPSB2eDsgdjF5ID0gdnk7IHYxeiA9IHZ6O1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL3ZlcnRleDc7XHJcbiAgICAgICAgdnggPSBWMVsxOF07IHZ5ID0gVjFbMTldOyB2eiA9IFYxWzIwXTtcclxuICAgICAgICBkaXN0YW5jZSA9IG54ICogdnggKyBueSAqIHZ5ICsgbnogKiB2ejtcclxuICAgICAgICBpZiAoZGlzdGFuY2UgPiBtYXhEaXN0YW5jZSkge1xyXG4gICAgICAgICAgbWF4RGlzdGFuY2UgPSBkaXN0YW5jZTtcclxuICAgICAgICAgIHYxeCA9IHZ4OyB2MXkgPSB2eTsgdjF6ID0gdno7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vdmVydGV4ODtcclxuICAgICAgICB2eCA9IFYxWzIxXTsgdnkgPSBWMVsyMl07IHZ6ID0gVjFbMjNdO1xyXG4gICAgICAgIGRpc3RhbmNlID0gbnggKiB2eCArIG55ICogdnkgKyBueiAqIHZ6O1xyXG4gICAgICAgIGlmIChkaXN0YW5jZSA+IG1heERpc3RhbmNlKSB7XHJcbiAgICAgICAgICBtYXhEaXN0YW5jZSA9IGRpc3RhbmNlO1xyXG4gICAgICAgICAgdjF4ID0gdng7IHYxeSA9IHZ5OyB2MXogPSB2ejtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy92ZXJ0ZXgxO1xyXG4gICAgICAgIHYyeCA9IFYyWzBdOyB2MnkgPSBWMlsxXTsgdjJ6ID0gVjJbMl07XHJcbiAgICAgICAgbWF4RGlzdGFuY2UgPSBueCAqIHYyeCArIG55ICogdjJ5ICsgbnogKiB2Mno7XHJcbiAgICAgICAgLy92ZXJ0ZXgyO1xyXG4gICAgICAgIHZ4ID0gVjJbM107IHZ5ID0gVjJbNF07IHZ6ID0gVjJbNV07XHJcbiAgICAgICAgZGlzdGFuY2UgPSBueCAqIHZ4ICsgbnkgKiB2eSArIG56ICogdno7XHJcbiAgICAgICAgaWYgKGRpc3RhbmNlIDwgbWF4RGlzdGFuY2UpIHtcclxuICAgICAgICAgIG1heERpc3RhbmNlID0gZGlzdGFuY2U7XHJcbiAgICAgICAgICB2MnggPSB2eDsgdjJ5ID0gdnk7IHYyeiA9IHZ6O1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL3ZlcnRleDM7XHJcbiAgICAgICAgdnggPSBWMls2XTsgdnkgPSBWMls3XTsgdnogPSBWMls4XTtcclxuICAgICAgICBkaXN0YW5jZSA9IG54ICogdnggKyBueSAqIHZ5ICsgbnogKiB2ejtcclxuICAgICAgICBpZiAoZGlzdGFuY2UgPCBtYXhEaXN0YW5jZSkge1xyXG4gICAgICAgICAgbWF4RGlzdGFuY2UgPSBkaXN0YW5jZTtcclxuICAgICAgICAgIHYyeCA9IHZ4OyB2MnkgPSB2eTsgdjJ6ID0gdno7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vdmVydGV4NDtcclxuICAgICAgICB2eCA9IFYyWzldOyB2eSA9IFYyWzEwXTsgdnogPSBWMlsxMV07XHJcbiAgICAgICAgZGlzdGFuY2UgPSBueCAqIHZ4ICsgbnkgKiB2eSArIG56ICogdno7XHJcbiAgICAgICAgaWYgKGRpc3RhbmNlIDwgbWF4RGlzdGFuY2UpIHtcclxuICAgICAgICAgIG1heERpc3RhbmNlID0gZGlzdGFuY2U7XHJcbiAgICAgICAgICB2MnggPSB2eDsgdjJ5ID0gdnk7IHYyeiA9IHZ6O1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL3ZlcnRleDU7XHJcbiAgICAgICAgdnggPSBWMlsxMl07IHZ5ID0gVjJbMTNdOyB2eiA9IFYyWzE0XTtcclxuICAgICAgICBkaXN0YW5jZSA9IG54ICogdnggKyBueSAqIHZ5ICsgbnogKiB2ejtcclxuICAgICAgICBpZiAoZGlzdGFuY2UgPCBtYXhEaXN0YW5jZSkge1xyXG4gICAgICAgICAgbWF4RGlzdGFuY2UgPSBkaXN0YW5jZTtcclxuICAgICAgICAgIHYyeCA9IHZ4OyB2MnkgPSB2eTsgdjJ6ID0gdno7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vdmVydGV4NjtcclxuICAgICAgICB2eCA9IFYyWzE1XTsgdnkgPSBWMlsxNl07IHZ6ID0gVjJbMTddO1xyXG4gICAgICAgIGRpc3RhbmNlID0gbnggKiB2eCArIG55ICogdnkgKyBueiAqIHZ6O1xyXG4gICAgICAgIGlmIChkaXN0YW5jZSA8IG1heERpc3RhbmNlKSB7XHJcbiAgICAgICAgICBtYXhEaXN0YW5jZSA9IGRpc3RhbmNlO1xyXG4gICAgICAgICAgdjJ4ID0gdng7IHYyeSA9IHZ5OyB2MnogPSB2ejtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy92ZXJ0ZXg3O1xyXG4gICAgICAgIHZ4ID0gVjJbMThdOyB2eSA9IFYyWzE5XTsgdnogPSBWMlsyMF07XHJcbiAgICAgICAgZGlzdGFuY2UgPSBueCAqIHZ4ICsgbnkgKiB2eSArIG56ICogdno7XHJcbiAgICAgICAgaWYgKGRpc3RhbmNlIDwgbWF4RGlzdGFuY2UpIHtcclxuICAgICAgICAgIG1heERpc3RhbmNlID0gZGlzdGFuY2U7XHJcbiAgICAgICAgICB2MnggPSB2eDsgdjJ5ID0gdnk7IHYyeiA9IHZ6O1xyXG4gICAgICAgIH1cclxuICAgICAgICAvL3ZlcnRleDg7XHJcbiAgICAgICAgdnggPSBWMlsyMV07IHZ5ID0gVjJbMjJdOyB2eiA9IFYyWzIzXTtcclxuICAgICAgICBkaXN0YW5jZSA9IG54ICogdnggKyBueSAqIHZ5ICsgbnogKiB2ejtcclxuICAgICAgICBpZiAoZGlzdGFuY2UgPCBtYXhEaXN0YW5jZSkge1xyXG4gICAgICAgICAgbWF4RGlzdGFuY2UgPSBkaXN0YW5jZTtcclxuICAgICAgICAgIHYyeCA9IHZ4OyB2MnkgPSB2eTsgdjJ6ID0gdno7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZ4ID0gdjJ4IC0gdjF4OyB2eSA9IHYyeSAtIHYxeTsgdnogPSB2MnogLSB2MXo7XHJcbiAgICAgICAgZG90MSA9IG4xeCAqIG4yeCArIG4xeSAqIG4yeSArIG4xeiAqIG4yejtcclxuICAgICAgICB2YXIgdCA9ICh2eCAqIChuMXggLSBuMnggKiBkb3QxKSArIHZ5ICogKG4xeSAtIG4yeSAqIGRvdDEpICsgdnogKiAobjF6IC0gbjJ6ICogZG90MSkpIC8gKDEgLSBkb3QxICogZG90MSk7XHJcbiAgICAgICAgbWFuaWZvbGQuYWRkUG9pbnQodjF4ICsgbjF4ICogdCArIG54ICogZGVwdGggKiAwLjUsIHYxeSArIG4xeSAqIHQgKyBueSAqIGRlcHRoICogMC41LCB2MXogKyBuMXogKiB0ICsgbnogKiBkZXB0aCAqIDAuNSwgbngsIG55LCBueiwgZGVwdGgsIGZhbHNlKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgLy8gbm93IGRldGVjdCBmYWNlLWZhY2UgY29sbGlzaW9uLi4uXHJcbiAgICAgIC8vIHRhcmdldCBxdWFkXHJcbiAgICAgIHZhciBxMXg7XHJcbiAgICAgIHZhciBxMXk7XHJcbiAgICAgIHZhciBxMXo7XHJcbiAgICAgIHZhciBxMng7XHJcbiAgICAgIHZhciBxMnk7XHJcbiAgICAgIHZhciBxMno7XHJcbiAgICAgIHZhciBxM3g7XHJcbiAgICAgIHZhciBxM3k7XHJcbiAgICAgIHZhciBxM3o7XHJcbiAgICAgIHZhciBxNHg7XHJcbiAgICAgIHZhciBxNHk7XHJcbiAgICAgIHZhciBxNHo7XHJcbiAgICAgIC8vIHNlYXJjaCBzdXBwb3J0IGZhY2UgYW5kIHZlcnRleFxyXG4gICAgICB2YXIgbWluRG90ID0gMTtcclxuICAgICAgdmFyIGRvdCA9IDA7XHJcbiAgICAgIHZhciBtaW5Eb3RJbmRleCA9IDA7XHJcbiAgICAgIGlmIChzd2FwKSB7XHJcbiAgICAgICAgZG90ID0gYTF4ICogbnggKyBhMXkgKiBueSArIGExeiAqIG56O1xyXG4gICAgICAgIGlmIChkb3QgPCBtaW5Eb3QpIHtcclxuICAgICAgICAgIG1pbkRvdCA9IGRvdDtcclxuICAgICAgICAgIG1pbkRvdEluZGV4ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKC1kb3QgPCBtaW5Eb3QpIHtcclxuICAgICAgICAgIG1pbkRvdCA9IC1kb3Q7XHJcbiAgICAgICAgICBtaW5Eb3RJbmRleCA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvdCA9IGEyeCAqIG54ICsgYTJ5ICogbnkgKyBhMnogKiBuejtcclxuICAgICAgICBpZiAoZG90IDwgbWluRG90KSB7XHJcbiAgICAgICAgICBtaW5Eb3QgPSBkb3Q7XHJcbiAgICAgICAgICBtaW5Eb3RJbmRleCA9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgtZG90IDwgbWluRG90KSB7XHJcbiAgICAgICAgICBtaW5Eb3QgPSAtZG90O1xyXG4gICAgICAgICAgbWluRG90SW5kZXggPSAzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkb3QgPSBhM3ggKiBueCArIGEzeSAqIG55ICsgYTN6ICogbno7XHJcbiAgICAgICAgaWYgKGRvdCA8IG1pbkRvdCkge1xyXG4gICAgICAgICAgbWluRG90ID0gZG90O1xyXG4gICAgICAgICAgbWluRG90SW5kZXggPSA0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoLWRvdCA8IG1pbkRvdCkge1xyXG4gICAgICAgICAgbWluRG90ID0gLWRvdDtcclxuICAgICAgICAgIG1pbkRvdEluZGV4ID0gNTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChtaW5Eb3RJbmRleCA9PSAwKSB7Ly8geCsgZmFjZVxyXG4gICAgICAgICAgcTF4ID0gVjFbMF07IHExeSA9IFYxWzFdOyBxMXogPSBWMVsyXTsvL3ZlcnRleDFcclxuICAgICAgICAgIHEyeCA9IFYxWzZdOyBxMnkgPSBWMVs3XTsgcTJ6ID0gVjFbOF07Ly92ZXJ0ZXgzXHJcbiAgICAgICAgICBxM3ggPSBWMVs5XTsgcTN5ID0gVjFbMTBdOyBxM3ogPSBWMVsxMV07Ly92ZXJ0ZXg0XHJcbiAgICAgICAgICBxNHggPSBWMVszXTsgcTR5ID0gVjFbNF07IHE0eiA9IFYxWzVdOy8vdmVydGV4MlxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChtaW5Eb3RJbmRleCA9PSAxKSB7Ly8geC0gZmFjZVxyXG4gICAgICAgICAgcTF4ID0gVjFbMTVdOyBxMXkgPSBWMVsxNl07IHExeiA9IFYxWzE3XTsvL3ZlcnRleDZcclxuICAgICAgICAgIHEyeCA9IFYxWzIxXTsgcTJ5ID0gVjFbMjJdOyBxMnogPSBWMVsyM107Ly92ZXJ0ZXg4XHJcbiAgICAgICAgICBxM3ggPSBWMVsxOF07IHEzeSA9IFYxWzE5XTsgcTN6ID0gVjFbMjBdOy8vdmVydGV4N1xyXG4gICAgICAgICAgcTR4ID0gVjFbMTJdOyBxNHkgPSBWMVsxM107IHE0eiA9IFYxWzE0XTsvL3ZlcnRleDVcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAobWluRG90SW5kZXggPT0gMikgey8vIHkrIGZhY2VcclxuICAgICAgICAgIHExeCA9IFYxWzEyXTsgcTF5ID0gVjFbMTNdOyBxMXogPSBWMVsxNF07Ly92ZXJ0ZXg1XHJcbiAgICAgICAgICBxMnggPSBWMVswXTsgcTJ5ID0gVjFbMV07IHEyeiA9IFYxWzJdOy8vdmVydGV4MVxyXG4gICAgICAgICAgcTN4ID0gVjFbM107IHEzeSA9IFYxWzRdOyBxM3ogPSBWMVs1XTsvL3ZlcnRleDJcclxuICAgICAgICAgIHE0eCA9IFYxWzE1XTsgcTR5ID0gVjFbMTZdOyBxNHogPSBWMVsxN107Ly92ZXJ0ZXg2XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG1pbkRvdEluZGV4ID09IDMpIHsvLyB5LSBmYWNlXHJcbiAgICAgICAgICBxMXggPSBWMVsyMV07IHExeSA9IFYxWzIyXTsgcTF6ID0gVjFbMjNdOy8vdmVydGV4OFxyXG4gICAgICAgICAgcTJ4ID0gVjFbOV07IHEyeSA9IFYxWzEwXTsgcTJ6ID0gVjFbMTFdOy8vdmVydGV4NFxyXG4gICAgICAgICAgcTN4ID0gVjFbNl07IHEzeSA9IFYxWzddOyBxM3ogPSBWMVs4XTsvL3ZlcnRleDNcclxuICAgICAgICAgIHE0eCA9IFYxWzE4XTsgcTR5ID0gVjFbMTldOyBxNHogPSBWMVsyMF07Ly92ZXJ0ZXg3XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG1pbkRvdEluZGV4ID09IDQpIHsvLyB6KyBmYWNlXHJcbiAgICAgICAgICBxMXggPSBWMVsxMl07IHExeSA9IFYxWzEzXTsgcTF6ID0gVjFbMTRdOy8vdmVydGV4NVxyXG4gICAgICAgICAgcTJ4ID0gVjFbMThdOyBxMnkgPSBWMVsxOV07IHEyeiA9IFYxWzIwXTsvL3ZlcnRleDdcclxuICAgICAgICAgIHEzeCA9IFYxWzZdOyBxM3kgPSBWMVs3XTsgcTN6ID0gVjFbOF07Ly92ZXJ0ZXgzXHJcbiAgICAgICAgICBxNHggPSBWMVswXTsgcTR5ID0gVjFbMV07IHE0eiA9IFYxWzJdOy8vdmVydGV4MVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChtaW5Eb3RJbmRleCA9PSA1KSB7Ly8gei0gZmFjZVxyXG4gICAgICAgICAgcTF4ID0gVjFbM107IHExeSA9IFYxWzRdOyBxMXogPSBWMVs1XTsvL3ZlcnRleDJcclxuICAgICAgICAgIC8vMng9VjFbNl07IHEyeT1WMVs3XTsgcTJ6PVYxWzhdOy8vdmVydGV4NCAhISFcclxuICAgICAgICAgIHEyeCA9IFYyWzldOyBxMnkgPSBWMlsxMF07IHEyeiA9IFYyWzExXTsvL3ZlcnRleDRcclxuICAgICAgICAgIHEzeCA9IFYxWzIxXTsgcTN5ID0gVjFbMjJdOyBxM3ogPSBWMVsyM107Ly92ZXJ0ZXg4XHJcbiAgICAgICAgICBxNHggPSBWMVsxNV07IHE0eSA9IFYxWzE2XTsgcTR6ID0gVjFbMTddOy8vdmVydGV4NlxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgZG90ID0gYTR4ICogbnggKyBhNHkgKiBueSArIGE0eiAqIG56O1xyXG4gICAgICAgIGlmIChkb3QgPCBtaW5Eb3QpIHtcclxuICAgICAgICAgIG1pbkRvdCA9IGRvdDtcclxuICAgICAgICAgIG1pbkRvdEluZGV4ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKC1kb3QgPCBtaW5Eb3QpIHtcclxuICAgICAgICAgIG1pbkRvdCA9IC1kb3Q7XHJcbiAgICAgICAgICBtaW5Eb3RJbmRleCA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvdCA9IGE1eCAqIG54ICsgYTV5ICogbnkgKyBhNXogKiBuejtcclxuICAgICAgICBpZiAoZG90IDwgbWluRG90KSB7XHJcbiAgICAgICAgICBtaW5Eb3QgPSBkb3Q7XHJcbiAgICAgICAgICBtaW5Eb3RJbmRleCA9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgtZG90IDwgbWluRG90KSB7XHJcbiAgICAgICAgICBtaW5Eb3QgPSAtZG90O1xyXG4gICAgICAgICAgbWluRG90SW5kZXggPSAzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkb3QgPSBhNnggKiBueCArIGE2eSAqIG55ICsgYTZ6ICogbno7XHJcbiAgICAgICAgaWYgKGRvdCA8IG1pbkRvdCkge1xyXG4gICAgICAgICAgbWluRG90ID0gZG90O1xyXG4gICAgICAgICAgbWluRG90SW5kZXggPSA0O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoLWRvdCA8IG1pbkRvdCkge1xyXG4gICAgICAgICAgbWluRG90ID0gLWRvdDtcclxuICAgICAgICAgIG1pbkRvdEluZGV4ID0gNTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXHJcblxyXG4gICAgICAgIGlmIChtaW5Eb3RJbmRleCA9PSAwKSB7Ly8geCsgZmFjZVxyXG4gICAgICAgICAgcTF4ID0gVjJbMF07IHExeSA9IFYyWzFdOyBxMXogPSBWMlsyXTsvL3ZlcnRleDFcclxuICAgICAgICAgIHEyeCA9IFYyWzZdOyBxMnkgPSBWMls3XTsgcTJ6ID0gVjJbOF07Ly92ZXJ0ZXgzXHJcbiAgICAgICAgICBxM3ggPSBWMls5XTsgcTN5ID0gVjJbMTBdOyBxM3ogPSBWMlsxMV07Ly92ZXJ0ZXg0XHJcbiAgICAgICAgICBxNHggPSBWMlszXTsgcTR5ID0gVjJbNF07IHE0eiA9IFYyWzVdOy8vdmVydGV4MlxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChtaW5Eb3RJbmRleCA9PSAxKSB7Ly8geC0gZmFjZVxyXG4gICAgICAgICAgcTF4ID0gVjJbMTVdOyBxMXkgPSBWMlsxNl07IHExeiA9IFYyWzE3XTsvL3ZlcnRleDZcclxuICAgICAgICAgIHEyeCA9IFYyWzIxXTsgcTJ5ID0gVjJbMjJdOyBxMnogPSBWMlsyM107IC8vdmVydGV4OFxyXG4gICAgICAgICAgcTN4ID0gVjJbMThdOyBxM3kgPSBWMlsxOV07IHEzeiA9IFYyWzIwXTsvL3ZlcnRleDdcclxuICAgICAgICAgIHE0eCA9IFYyWzEyXTsgcTR5ID0gVjJbMTNdOyBxNHogPSBWMlsxNF07Ly92ZXJ0ZXg1XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG1pbkRvdEluZGV4ID09IDIpIHsvLyB5KyBmYWNlXHJcbiAgICAgICAgICBxMXggPSBWMlsxMl07IHExeSA9IFYyWzEzXTsgcTF6ID0gVjJbMTRdOy8vdmVydGV4NVxyXG4gICAgICAgICAgcTJ4ID0gVjJbMF07IHEyeSA9IFYyWzFdOyBxMnogPSBWMlsyXTsvL3ZlcnRleDFcclxuICAgICAgICAgIHEzeCA9IFYyWzNdOyBxM3kgPSBWMls0XTsgcTN6ID0gVjJbNV07Ly92ZXJ0ZXgyXHJcbiAgICAgICAgICBxNHggPSBWMlsxNV07IHE0eSA9IFYyWzE2XTsgcTR6ID0gVjJbMTddOy8vdmVydGV4NlxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChtaW5Eb3RJbmRleCA9PSAzKSB7Ly8geS0gZmFjZVxyXG4gICAgICAgICAgcTF4ID0gVjJbMjFdOyBxMXkgPSBWMlsyMl07IHExeiA9IFYyWzIzXTsvL3ZlcnRleDhcclxuICAgICAgICAgIHEyeCA9IFYyWzldOyBxMnkgPSBWMlsxMF07IHEyeiA9IFYyWzExXTsvL3ZlcnRleDRcclxuICAgICAgICAgIHEzeCA9IFYyWzZdOyBxM3kgPSBWMls3XTsgcTN6ID0gVjJbOF07Ly92ZXJ0ZXgzXHJcbiAgICAgICAgICBxNHggPSBWMlsxOF07IHE0eSA9IFYyWzE5XTsgcTR6ID0gVjJbMjBdOy8vdmVydGV4N1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChtaW5Eb3RJbmRleCA9PSA0KSB7Ly8geisgZmFjZVxyXG4gICAgICAgICAgcTF4ID0gVjJbMTJdOyBxMXkgPSBWMlsxM107IHExeiA9IFYyWzE0XTsvL3ZlcnRleDVcclxuICAgICAgICAgIHEyeCA9IFYyWzE4XTsgcTJ5ID0gVjJbMTldOyBxMnogPSBWMlsyMF07Ly92ZXJ0ZXg3XHJcbiAgICAgICAgICBxM3ggPSBWMls2XTsgcTN5ID0gVjJbN107IHEzeiA9IFYyWzhdOy8vdmVydGV4M1xyXG4gICAgICAgICAgcTR4ID0gVjJbMF07IHE0eSA9IFYyWzFdOyBxNHogPSBWMlsyXTsvL3ZlcnRleDFcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAobWluRG90SW5kZXggPT0gNSkgey8vIHotIGZhY2VcclxuICAgICAgICAgIHExeCA9IFYyWzNdOyBxMXkgPSBWMls0XTsgcTF6ID0gVjJbNV07Ly92ZXJ0ZXgyXHJcbiAgICAgICAgICBxMnggPSBWMls5XTsgcTJ5ID0gVjJbMTBdOyBxMnogPSBWMlsxMV07Ly92ZXJ0ZXg0XHJcbiAgICAgICAgICBxM3ggPSBWMlsyMV07IHEzeSA9IFYyWzIyXTsgcTN6ID0gVjJbMjNdOy8vdmVydGV4OFxyXG4gICAgICAgICAgcTR4ID0gVjJbMTVdOyBxNHkgPSBWMlsxNl07IHE0eiA9IFYyWzE3XTsvL3ZlcnRleDZcclxuICAgICAgICB9XHJcblxyXG4gICAgICB9XHJcbiAgICAgIC8vIGNsaXAgdmVydGljZXNcclxuICAgICAgdmFyIG51bUNsaXBWZXJ0aWNlcztcclxuICAgICAgdmFyIG51bUFkZGVkQ2xpcFZlcnRpY2VzO1xyXG4gICAgICB2YXIgaW5kZXg7XHJcbiAgICAgIHZhciB4MTtcclxuICAgICAgdmFyIHkxO1xyXG4gICAgICB2YXIgejE7XHJcbiAgICAgIHZhciB4MjtcclxuICAgICAgdmFyIHkyO1xyXG4gICAgICB2YXIgejI7XHJcbiAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVswXSA9IHExeDtcclxuICAgICAgdGhpcy5jbGlwVmVydGljZXMxWzFdID0gcTF5O1xyXG4gICAgICB0aGlzLmNsaXBWZXJ0aWNlczFbMl0gPSBxMXo7XHJcbiAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVszXSA9IHEyeDtcclxuICAgICAgdGhpcy5jbGlwVmVydGljZXMxWzRdID0gcTJ5O1xyXG4gICAgICB0aGlzLmNsaXBWZXJ0aWNlczFbNV0gPSBxMno7XHJcbiAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVs2XSA9IHEzeDtcclxuICAgICAgdGhpcy5jbGlwVmVydGljZXMxWzddID0gcTN5O1xyXG4gICAgICB0aGlzLmNsaXBWZXJ0aWNlczFbOF0gPSBxM3o7XHJcbiAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVs5XSA9IHE0eDtcclxuICAgICAgdGhpcy5jbGlwVmVydGljZXMxWzEwXSA9IHE0eTtcclxuICAgICAgdGhpcy5jbGlwVmVydGljZXMxWzExXSA9IHE0ejtcclxuICAgICAgbnVtQWRkZWRDbGlwVmVydGljZXMgPSAwO1xyXG4gICAgICB4MSA9IHRoaXMuY2xpcFZlcnRpY2VzMVs5XTtcclxuICAgICAgeTEgPSB0aGlzLmNsaXBWZXJ0aWNlczFbMTBdO1xyXG4gICAgICB6MSA9IHRoaXMuY2xpcFZlcnRpY2VzMVsxMV07XHJcbiAgICAgIGRvdDEgPSAoeDEgLSBjeCAtIHMxeCkgKiBuMXggKyAoeTEgLSBjeSAtIHMxeSkgKiBuMXkgKyAoejEgLSBjeiAtIHMxeikgKiBuMXo7XHJcblxyXG4gICAgICAvL3ZhciBpID0gNDtcclxuICAgICAgLy93aGlsZShpLS0pe1xyXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xyXG4gICAgICAgIGluZGV4ID0gaSAqIDM7XHJcbiAgICAgICAgeDIgPSB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXhdO1xyXG4gICAgICAgIHkyID0gdGhpcy5jbGlwVmVydGljZXMxW2luZGV4ICsgMV07XHJcbiAgICAgICAgejIgPSB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXggKyAyXTtcclxuICAgICAgICBkb3QyID0gKHgyIC0gY3ggLSBzMXgpICogbjF4ICsgKHkyIC0gY3kgLSBzMXkpICogbjF5ICsgKHoyIC0gY3ogLSBzMXopICogbjF6O1xyXG4gICAgICAgIGlmIChkb3QxID4gMCkge1xyXG4gICAgICAgICAgaWYgKGRvdDIgPiAwKSB7XHJcbiAgICAgICAgICAgIGluZGV4ID0gbnVtQWRkZWRDbGlwVmVydGljZXMgKiAzO1xyXG4gICAgICAgICAgICBudW1BZGRlZENsaXBWZXJ0aWNlcysrO1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXhdID0geDI7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMltpbmRleCArIDFdID0geTI7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMltpbmRleCArIDJdID0gejI7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpbmRleCA9IG51bUFkZGVkQ2xpcFZlcnRpY2VzICogMztcclxuICAgICAgICAgICAgbnVtQWRkZWRDbGlwVmVydGljZXMrKztcclxuICAgICAgICAgICAgdCA9IGRvdDEgLyAoZG90MSAtIGRvdDIpO1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXhdID0geDEgKyAoeDIgLSB4MSkgKiB0O1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXggKyAxXSA9IHkxICsgKHkyIC0geTEpICogdDtcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMyW2luZGV4ICsgMl0gPSB6MSArICh6MiAtIHoxKSAqIHQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChkb3QyID4gMCkge1xyXG4gICAgICAgICAgICBpbmRleCA9IG51bUFkZGVkQ2xpcFZlcnRpY2VzICogMztcclxuICAgICAgICAgICAgbnVtQWRkZWRDbGlwVmVydGljZXMrKztcclxuICAgICAgICAgICAgdCA9IGRvdDEgLyAoZG90MSAtIGRvdDIpO1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXhdID0geDEgKyAoeDIgLSB4MSkgKiB0O1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXggKyAxXSA9IHkxICsgKHkyIC0geTEpICogdDtcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMyW2luZGV4ICsgMl0gPSB6MSArICh6MiAtIHoxKSAqIHQ7XHJcbiAgICAgICAgICAgIGluZGV4ID0gbnVtQWRkZWRDbGlwVmVydGljZXMgKiAzO1xyXG4gICAgICAgICAgICBudW1BZGRlZENsaXBWZXJ0aWNlcysrO1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXhdID0geDI7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMltpbmRleCArIDFdID0geTI7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMltpbmRleCArIDJdID0gejI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHgxID0geDI7XHJcbiAgICAgICAgeTEgPSB5MjtcclxuICAgICAgICB6MSA9IHoyO1xyXG4gICAgICAgIGRvdDEgPSBkb3QyO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBudW1DbGlwVmVydGljZXMgPSBudW1BZGRlZENsaXBWZXJ0aWNlcztcclxuICAgICAgaWYgKG51bUNsaXBWZXJ0aWNlcyA9PSAwKSByZXR1cm47XHJcbiAgICAgIG51bUFkZGVkQ2xpcFZlcnRpY2VzID0gMDtcclxuICAgICAgaW5kZXggPSAobnVtQ2xpcFZlcnRpY2VzIC0gMSkgKiAzO1xyXG4gICAgICB4MSA9IHRoaXMuY2xpcFZlcnRpY2VzMltpbmRleF07XHJcbiAgICAgIHkxID0gdGhpcy5jbGlwVmVydGljZXMyW2luZGV4ICsgMV07XHJcbiAgICAgIHoxID0gdGhpcy5jbGlwVmVydGljZXMyW2luZGV4ICsgMl07XHJcbiAgICAgIGRvdDEgPSAoeDEgLSBjeCAtIHMyeCkgKiBuMnggKyAoeTEgLSBjeSAtIHMyeSkgKiBuMnkgKyAoejEgLSBjeiAtIHMyeikgKiBuMno7XHJcblxyXG4gICAgICAvL2kgPSBudW1DbGlwVmVydGljZXM7XHJcbiAgICAgIC8vd2hpbGUoaS0tKXtcclxuICAgICAgZm9yIChpID0gMDsgaSA8IG51bUNsaXBWZXJ0aWNlczsgaSsrKSB7XHJcbiAgICAgICAgaW5kZXggPSBpICogMztcclxuICAgICAgICB4MiA9IHRoaXMuY2xpcFZlcnRpY2VzMltpbmRleF07XHJcbiAgICAgICAgeTIgPSB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXggKyAxXTtcclxuICAgICAgICB6MiA9IHRoaXMuY2xpcFZlcnRpY2VzMltpbmRleCArIDJdO1xyXG4gICAgICAgIGRvdDIgPSAoeDIgLSBjeCAtIHMyeCkgKiBuMnggKyAoeTIgLSBjeSAtIHMyeSkgKiBuMnkgKyAoejIgLSBjeiAtIHMyeikgKiBuMno7XHJcbiAgICAgICAgaWYgKGRvdDEgPiAwKSB7XHJcbiAgICAgICAgICBpZiAoZG90MiA+IDApIHtcclxuICAgICAgICAgICAgaW5kZXggPSBudW1BZGRlZENsaXBWZXJ0aWNlcyAqIDM7XHJcbiAgICAgICAgICAgIG51bUFkZGVkQ2xpcFZlcnRpY2VzKys7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleF0gPSB4MjtcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMxW2luZGV4ICsgMV0gPSB5MjtcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMxW2luZGV4ICsgMl0gPSB6MjtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGluZGV4ID0gbnVtQWRkZWRDbGlwVmVydGljZXMgKiAzO1xyXG4gICAgICAgICAgICBudW1BZGRlZENsaXBWZXJ0aWNlcysrO1xyXG4gICAgICAgICAgICB0ID0gZG90MSAvIChkb3QxIC0gZG90Mik7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleF0gPSB4MSArICh4MiAtIHgxKSAqIHQ7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleCArIDFdID0geTEgKyAoeTIgLSB5MSkgKiB0O1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXggKyAyXSA9IHoxICsgKHoyIC0gejEpICogdDtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKGRvdDIgPiAwKSB7XHJcbiAgICAgICAgICAgIGluZGV4ID0gbnVtQWRkZWRDbGlwVmVydGljZXMgKiAzO1xyXG4gICAgICAgICAgICBudW1BZGRlZENsaXBWZXJ0aWNlcysrO1xyXG4gICAgICAgICAgICB0ID0gZG90MSAvIChkb3QxIC0gZG90Mik7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleF0gPSB4MSArICh4MiAtIHgxKSAqIHQ7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleCArIDFdID0geTEgKyAoeTIgLSB5MSkgKiB0O1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXggKyAyXSA9IHoxICsgKHoyIC0gejEpICogdDtcclxuICAgICAgICAgICAgaW5kZXggPSBudW1BZGRlZENsaXBWZXJ0aWNlcyAqIDM7XHJcbiAgICAgICAgICAgIG51bUFkZGVkQ2xpcFZlcnRpY2VzKys7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleF0gPSB4MjtcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMxW2luZGV4ICsgMV0gPSB5MjtcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMxW2luZGV4ICsgMl0gPSB6MjtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgeDEgPSB4MjtcclxuICAgICAgICB5MSA9IHkyO1xyXG4gICAgICAgIHoxID0gejI7XHJcbiAgICAgICAgZG90MSA9IGRvdDI7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIG51bUNsaXBWZXJ0aWNlcyA9IG51bUFkZGVkQ2xpcFZlcnRpY2VzO1xyXG4gICAgICBpZiAobnVtQ2xpcFZlcnRpY2VzID09IDApIHJldHVybjtcclxuICAgICAgbnVtQWRkZWRDbGlwVmVydGljZXMgPSAwO1xyXG4gICAgICBpbmRleCA9IChudW1DbGlwVmVydGljZXMgLSAxKSAqIDM7XHJcbiAgICAgIHgxID0gdGhpcy5jbGlwVmVydGljZXMxW2luZGV4XTtcclxuICAgICAgeTEgPSB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXggKyAxXTtcclxuICAgICAgejEgPSB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXggKyAyXTtcclxuICAgICAgZG90MSA9ICh4MSAtIGN4ICsgczF4KSAqIC1uMXggKyAoeTEgLSBjeSArIHMxeSkgKiAtbjF5ICsgKHoxIC0gY3ogKyBzMXopICogLW4xejtcclxuXHJcbiAgICAgIC8vaSA9IG51bUNsaXBWZXJ0aWNlcztcclxuICAgICAgLy93aGlsZShpLS0pe1xyXG4gICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtQ2xpcFZlcnRpY2VzOyBpKyspIHtcclxuICAgICAgICBpbmRleCA9IGkgKiAzO1xyXG4gICAgICAgIHgyID0gdGhpcy5jbGlwVmVydGljZXMxW2luZGV4XTtcclxuICAgICAgICB5MiA9IHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleCArIDFdO1xyXG4gICAgICAgIHoyID0gdGhpcy5jbGlwVmVydGljZXMxW2luZGV4ICsgMl07XHJcbiAgICAgICAgZG90MiA9ICh4MiAtIGN4ICsgczF4KSAqIC1uMXggKyAoeTIgLSBjeSArIHMxeSkgKiAtbjF5ICsgKHoyIC0gY3ogKyBzMXopICogLW4xejtcclxuICAgICAgICBpZiAoZG90MSA+IDApIHtcclxuICAgICAgICAgIGlmIChkb3QyID4gMCkge1xyXG4gICAgICAgICAgICBpbmRleCA9IG51bUFkZGVkQ2xpcFZlcnRpY2VzICogMztcclxuICAgICAgICAgICAgbnVtQWRkZWRDbGlwVmVydGljZXMrKztcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMyW2luZGV4XSA9IHgyO1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXggKyAxXSA9IHkyO1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXggKyAyXSA9IHoyO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgaW5kZXggPSBudW1BZGRlZENsaXBWZXJ0aWNlcyAqIDM7XHJcbiAgICAgICAgICAgIG51bUFkZGVkQ2xpcFZlcnRpY2VzKys7XHJcbiAgICAgICAgICAgIHQgPSBkb3QxIC8gKGRvdDEgLSBkb3QyKTtcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMyW2luZGV4XSA9IHgxICsgKHgyIC0geDEpICogdDtcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMyW2luZGV4ICsgMV0gPSB5MSArICh5MiAtIHkxKSAqIHQ7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMltpbmRleCArIDJdID0gejEgKyAoejIgLSB6MSkgKiB0O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAoZG90MiA+IDApIHtcclxuICAgICAgICAgICAgaW5kZXggPSBudW1BZGRlZENsaXBWZXJ0aWNlcyAqIDM7XHJcbiAgICAgICAgICAgIG51bUFkZGVkQ2xpcFZlcnRpY2VzKys7XHJcbiAgICAgICAgICAgIHQgPSBkb3QxIC8gKGRvdDEgLSBkb3QyKTtcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMyW2luZGV4XSA9IHgxICsgKHgyIC0geDEpICogdDtcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMyW2luZGV4ICsgMV0gPSB5MSArICh5MiAtIHkxKSAqIHQ7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMltpbmRleCArIDJdID0gejEgKyAoejIgLSB6MSkgKiB0O1xyXG4gICAgICAgICAgICBpbmRleCA9IG51bUFkZGVkQ2xpcFZlcnRpY2VzICogMztcclxuICAgICAgICAgICAgbnVtQWRkZWRDbGlwVmVydGljZXMrKztcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMyW2luZGV4XSA9IHgyO1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXggKyAxXSA9IHkyO1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXggKyAyXSA9IHoyO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB4MSA9IHgyO1xyXG4gICAgICAgIHkxID0geTI7XHJcbiAgICAgICAgejEgPSB6MjtcclxuICAgICAgICBkb3QxID0gZG90MjtcclxuICAgICAgfVxyXG5cclxuICAgICAgbnVtQ2xpcFZlcnRpY2VzID0gbnVtQWRkZWRDbGlwVmVydGljZXM7XHJcbiAgICAgIGlmIChudW1DbGlwVmVydGljZXMgPT0gMCkgcmV0dXJuO1xyXG4gICAgICBudW1BZGRlZENsaXBWZXJ0aWNlcyA9IDA7XHJcbiAgICAgIGluZGV4ID0gKG51bUNsaXBWZXJ0aWNlcyAtIDEpICogMztcclxuICAgICAgeDEgPSB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXhdO1xyXG4gICAgICB5MSA9IHRoaXMuY2xpcFZlcnRpY2VzMltpbmRleCArIDFdO1xyXG4gICAgICB6MSA9IHRoaXMuY2xpcFZlcnRpY2VzMltpbmRleCArIDJdO1xyXG4gICAgICBkb3QxID0gKHgxIC0gY3ggKyBzMngpICogLW4yeCArICh5MSAtIGN5ICsgczJ5KSAqIC1uMnkgKyAoejEgLSBjeiArIHMyeikgKiAtbjJ6O1xyXG5cclxuICAgICAgLy9pID0gbnVtQ2xpcFZlcnRpY2VzO1xyXG4gICAgICAvL3doaWxlKGktLSl7XHJcbiAgICAgIGZvciAoaSA9IDA7IGkgPCBudW1DbGlwVmVydGljZXM7IGkrKykge1xyXG4gICAgICAgIGluZGV4ID0gaSAqIDM7XHJcbiAgICAgICAgeDIgPSB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXhdO1xyXG4gICAgICAgIHkyID0gdGhpcy5jbGlwVmVydGljZXMyW2luZGV4ICsgMV07XHJcbiAgICAgICAgejIgPSB0aGlzLmNsaXBWZXJ0aWNlczJbaW5kZXggKyAyXTtcclxuICAgICAgICBkb3QyID0gKHgyIC0gY3ggKyBzMngpICogLW4yeCArICh5MiAtIGN5ICsgczJ5KSAqIC1uMnkgKyAoejIgLSBjeiArIHMyeikgKiAtbjJ6O1xyXG4gICAgICAgIGlmIChkb3QxID4gMCkge1xyXG4gICAgICAgICAgaWYgKGRvdDIgPiAwKSB7XHJcbiAgICAgICAgICAgIGluZGV4ID0gbnVtQWRkZWRDbGlwVmVydGljZXMgKiAzO1xyXG4gICAgICAgICAgICBudW1BZGRlZENsaXBWZXJ0aWNlcysrO1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXhdID0geDI7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleCArIDFdID0geTI7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleCArIDJdID0gejI7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpbmRleCA9IG51bUFkZGVkQ2xpcFZlcnRpY2VzICogMztcclxuICAgICAgICAgICAgbnVtQWRkZWRDbGlwVmVydGljZXMrKztcclxuICAgICAgICAgICAgdCA9IGRvdDEgLyAoZG90MSAtIGRvdDIpO1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXhdID0geDEgKyAoeDIgLSB4MSkgKiB0O1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXggKyAxXSA9IHkxICsgKHkyIC0geTEpICogdDtcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMxW2luZGV4ICsgMl0gPSB6MSArICh6MiAtIHoxKSAqIHQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGlmIChkb3QyID4gMCkge1xyXG4gICAgICAgICAgICBpbmRleCA9IG51bUFkZGVkQ2xpcFZlcnRpY2VzICogMztcclxuICAgICAgICAgICAgbnVtQWRkZWRDbGlwVmVydGljZXMrKztcclxuICAgICAgICAgICAgdCA9IGRvdDEgLyAoZG90MSAtIGRvdDIpO1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXhdID0geDEgKyAoeDIgLSB4MSkgKiB0O1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXggKyAxXSA9IHkxICsgKHkyIC0geTEpICogdDtcclxuICAgICAgICAgICAgdGhpcy5jbGlwVmVydGljZXMxW2luZGV4ICsgMl0gPSB6MSArICh6MiAtIHoxKSAqIHQ7XHJcbiAgICAgICAgICAgIGluZGV4ID0gbnVtQWRkZWRDbGlwVmVydGljZXMgKiAzO1xyXG4gICAgICAgICAgICBudW1BZGRlZENsaXBWZXJ0aWNlcysrO1xyXG4gICAgICAgICAgICB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXhdID0geDI7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleCArIDFdID0geTI7XHJcbiAgICAgICAgICAgIHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleCArIDJdID0gejI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHgxID0geDI7XHJcbiAgICAgICAgeTEgPSB5MjtcclxuICAgICAgICB6MSA9IHoyO1xyXG4gICAgICAgIGRvdDEgPSBkb3QyO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBudW1DbGlwVmVydGljZXMgPSBudW1BZGRlZENsaXBWZXJ0aWNlcztcclxuICAgICAgaWYgKHN3YXApIHtcclxuICAgICAgICB2YXIgdGIgPSBiMTtcclxuICAgICAgICBiMSA9IGIyO1xyXG4gICAgICAgIGIyID0gdGI7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKG51bUNsaXBWZXJ0aWNlcyA9PSAwKSByZXR1cm47XHJcbiAgICAgIHZhciBmbGlwcGVkID0gYjEgIT0gc2hhcGUxO1xyXG4gICAgICBpZiAobnVtQ2xpcFZlcnRpY2VzID4gNCkge1xyXG4gICAgICAgIHgxID0gKHExeCArIHEyeCArIHEzeCArIHE0eCkgKiAwLjI1O1xyXG4gICAgICAgIHkxID0gKHExeSArIHEyeSArIHEzeSArIHE0eSkgKiAwLjI1O1xyXG4gICAgICAgIHoxID0gKHExeiArIHEyeiArIHEzeiArIHE0eikgKiAwLjI1O1xyXG4gICAgICAgIG4xeCA9IHExeCAtIHgxO1xyXG4gICAgICAgIG4xeSA9IHExeSAtIHkxO1xyXG4gICAgICAgIG4xeiA9IHExeiAtIHoxO1xyXG4gICAgICAgIG4yeCA9IHEyeCAtIHgxO1xyXG4gICAgICAgIG4yeSA9IHEyeSAtIHkxO1xyXG4gICAgICAgIG4yeiA9IHEyeiAtIHoxO1xyXG4gICAgICAgIHZhciBpbmRleDEgPSAwO1xyXG4gICAgICAgIHZhciBpbmRleDIgPSAwO1xyXG4gICAgICAgIHZhciBpbmRleDMgPSAwO1xyXG4gICAgICAgIHZhciBpbmRleDQgPSAwO1xyXG4gICAgICAgIHZhciBtYXhEb3QgPSAtdGhpcy5JTkY7XHJcbiAgICAgICAgbWluRG90ID0gdGhpcy5JTkY7XHJcblxyXG4gICAgICAgIC8vaSA9IG51bUNsaXBWZXJ0aWNlcztcclxuICAgICAgICAvL3doaWxlKGktLSl7XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IG51bUNsaXBWZXJ0aWNlczsgaSsrKSB7XHJcbiAgICAgICAgICB0aGlzLnVzZWRbaV0gPSBmYWxzZTtcclxuICAgICAgICAgIGluZGV4ID0gaSAqIDM7XHJcbiAgICAgICAgICB4MSA9IHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleF07XHJcbiAgICAgICAgICB5MSA9IHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleCArIDFdO1xyXG4gICAgICAgICAgejEgPSB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXggKyAyXTtcclxuICAgICAgICAgIGRvdCA9IHgxICogbjF4ICsgeTEgKiBuMXkgKyB6MSAqIG4xejtcclxuICAgICAgICAgIGlmIChkb3QgPCBtaW5Eb3QpIHtcclxuICAgICAgICAgICAgbWluRG90ID0gZG90O1xyXG4gICAgICAgICAgICBpbmRleDEgPSBpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKGRvdCA+IG1heERvdCkge1xyXG4gICAgICAgICAgICBtYXhEb3QgPSBkb3Q7XHJcbiAgICAgICAgICAgIGluZGV4MyA9IGk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnVzZWRbaW5kZXgxXSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy51c2VkW2luZGV4M10gPSB0cnVlO1xyXG4gICAgICAgIG1heERvdCA9IC10aGlzLklORjtcclxuICAgICAgICBtaW5Eb3QgPSB0aGlzLklORjtcclxuXHJcbiAgICAgICAgLy9pID0gbnVtQ2xpcFZlcnRpY2VzO1xyXG4gICAgICAgIC8vd2hpbGUoaS0tKXtcclxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtQ2xpcFZlcnRpY2VzOyBpKyspIHtcclxuICAgICAgICAgIGlmICh0aGlzLnVzZWRbaV0pIGNvbnRpbnVlO1xyXG4gICAgICAgICAgaW5kZXggPSBpICogMztcclxuICAgICAgICAgIHgxID0gdGhpcy5jbGlwVmVydGljZXMxW2luZGV4XTtcclxuICAgICAgICAgIHkxID0gdGhpcy5jbGlwVmVydGljZXMxW2luZGV4ICsgMV07XHJcbiAgICAgICAgICB6MSA9IHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleCArIDJdO1xyXG4gICAgICAgICAgZG90ID0geDEgKiBuMnggKyB5MSAqIG4yeSArIHoxICogbjJ6O1xyXG4gICAgICAgICAgaWYgKGRvdCA8IG1pbkRvdCkge1xyXG4gICAgICAgICAgICBtaW5Eb3QgPSBkb3Q7XHJcbiAgICAgICAgICAgIGluZGV4MiA9IGk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoZG90ID4gbWF4RG90KSB7XHJcbiAgICAgICAgICAgIG1heERvdCA9IGRvdDtcclxuICAgICAgICAgICAgaW5kZXg0ID0gaTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGluZGV4ID0gaW5kZXgxICogMztcclxuICAgICAgICB4MSA9IHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleF07XHJcbiAgICAgICAgeTEgPSB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXggKyAxXTtcclxuICAgICAgICB6MSA9IHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleCArIDJdO1xyXG4gICAgICAgIGRvdCA9ICh4MSAtIGN4KSAqIG54ICsgKHkxIC0gY3kpICogbnkgKyAoejEgLSBjeikgKiBuejtcclxuICAgICAgICBpZiAoZG90IDwgMCkgbWFuaWZvbGQuYWRkUG9pbnQoeDEsIHkxLCB6MSwgbngsIG55LCBueiwgZG90LCBmbGlwcGVkKTtcclxuXHJcbiAgICAgICAgaW5kZXggPSBpbmRleDIgKiAzO1xyXG4gICAgICAgIHgxID0gdGhpcy5jbGlwVmVydGljZXMxW2luZGV4XTtcclxuICAgICAgICB5MSA9IHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleCArIDFdO1xyXG4gICAgICAgIHoxID0gdGhpcy5jbGlwVmVydGljZXMxW2luZGV4ICsgMl07XHJcbiAgICAgICAgZG90ID0gKHgxIC0gY3gpICogbnggKyAoeTEgLSBjeSkgKiBueSArICh6MSAtIGN6KSAqIG56O1xyXG4gICAgICAgIGlmIChkb3QgPCAwKSBtYW5pZm9sZC5hZGRQb2ludCh4MSwgeTEsIHoxLCBueCwgbnksIG56LCBkb3QsIGZsaXBwZWQpO1xyXG5cclxuICAgICAgICBpbmRleCA9IGluZGV4MyAqIDM7XHJcbiAgICAgICAgeDEgPSB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXhdO1xyXG4gICAgICAgIHkxID0gdGhpcy5jbGlwVmVydGljZXMxW2luZGV4ICsgMV07XHJcbiAgICAgICAgejEgPSB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXggKyAyXTtcclxuICAgICAgICBkb3QgPSAoeDEgLSBjeCkgKiBueCArICh5MSAtIGN5KSAqIG55ICsgKHoxIC0gY3opICogbno7XHJcbiAgICAgICAgaWYgKGRvdCA8IDApIG1hbmlmb2xkLmFkZFBvaW50KHgxLCB5MSwgejEsIG54LCBueSwgbnosIGRvdCwgZmxpcHBlZCk7XHJcblxyXG4gICAgICAgIGluZGV4ID0gaW5kZXg0ICogMztcclxuICAgICAgICB4MSA9IHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleF07XHJcbiAgICAgICAgeTEgPSB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXggKyAxXTtcclxuICAgICAgICB6MSA9IHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleCArIDJdO1xyXG4gICAgICAgIGRvdCA9ICh4MSAtIGN4KSAqIG54ICsgKHkxIC0gY3kpICogbnkgKyAoejEgLSBjeikgKiBuejtcclxuICAgICAgICBpZiAoZG90IDwgMCkgbWFuaWZvbGQuYWRkUG9pbnQoeDEsIHkxLCB6MSwgbngsIG55LCBueiwgZG90LCBmbGlwcGVkKTtcclxuXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy9pID0gbnVtQ2xpcFZlcnRpY2VzO1xyXG4gICAgICAgIC8vd2hpbGUoaS0tKXtcclxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnVtQ2xpcFZlcnRpY2VzOyBpKyspIHtcclxuICAgICAgICAgIGluZGV4ID0gaSAqIDM7XHJcbiAgICAgICAgICB4MSA9IHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleF07XHJcbiAgICAgICAgICB5MSA9IHRoaXMuY2xpcFZlcnRpY2VzMVtpbmRleCArIDFdO1xyXG4gICAgICAgICAgejEgPSB0aGlzLmNsaXBWZXJ0aWNlczFbaW5kZXggKyAyXTtcclxuICAgICAgICAgIGRvdCA9ICh4MSAtIGN4KSAqIG54ICsgKHkxIC0gY3kpICogbnkgKyAoejEgLSBjeikgKiBuejtcclxuICAgICAgICAgIGlmIChkb3QgPCAwKSBtYW5pZm9sZC5hZGRQb2ludCh4MSwgeTEsIHoxLCBueCwgbnksIG56LCBkb3QsIGZsaXBwZWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIGZ1bmN0aW9uIEJveEN5bGluZGVyQ29sbGlzaW9uRGV0ZWN0b3IoZmxpcCkge1xyXG5cclxuICAgIENvbGxpc2lvbkRldGVjdG9yLmNhbGwodGhpcyk7XHJcbiAgICB0aGlzLmZsaXAgPSBmbGlwO1xyXG5cclxuICB9XHJcbiAgQm94Q3lsaW5kZXJDb2xsaXNpb25EZXRlY3Rvci5wcm90b3R5cGUgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoQ29sbGlzaW9uRGV0ZWN0b3IucHJvdG90eXBlKSwge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yOiBCb3hDeWxpbmRlckNvbGxpc2lvbkRldGVjdG9yLFxyXG5cclxuICAgIGdldFNlcDogZnVuY3Rpb24gKGMxLCBjMiwgc2VwLCBwb3MsIGRlcCkge1xyXG5cclxuICAgICAgdmFyIHQxeDtcclxuICAgICAgdmFyIHQxeTtcclxuICAgICAgdmFyIHQxejtcclxuICAgICAgdmFyIHQyeDtcclxuICAgICAgdmFyIHQyeTtcclxuICAgICAgdmFyIHQyejtcclxuICAgICAgdmFyIHN1cCA9IG5ldyBWZWMzKCk7XHJcbiAgICAgIHZhciBsZW47XHJcbiAgICAgIHZhciBwMXg7XHJcbiAgICAgIHZhciBwMXk7XHJcbiAgICAgIHZhciBwMXo7XHJcbiAgICAgIHZhciBwMng7XHJcbiAgICAgIHZhciBwMnk7XHJcbiAgICAgIHZhciBwMno7XHJcbiAgICAgIHZhciB2MDF4ID0gYzEucG9zaXRpb24ueDtcclxuICAgICAgdmFyIHYwMXkgPSBjMS5wb3NpdGlvbi55O1xyXG4gICAgICB2YXIgdjAxeiA9IGMxLnBvc2l0aW9uLno7XHJcbiAgICAgIHZhciB2MDJ4ID0gYzIucG9zaXRpb24ueDtcclxuICAgICAgdmFyIHYwMnkgPSBjMi5wb3NpdGlvbi55O1xyXG4gICAgICB2YXIgdjAyeiA9IGMyLnBvc2l0aW9uLno7XHJcbiAgICAgIHZhciB2MHggPSB2MDJ4IC0gdjAxeDtcclxuICAgICAgdmFyIHYweSA9IHYwMnkgLSB2MDF5O1xyXG4gICAgICB2YXIgdjB6ID0gdjAyeiAtIHYwMXo7XHJcbiAgICAgIGlmICh2MHggKiB2MHggKyB2MHkgKiB2MHkgKyB2MHogKiB2MHogPT0gMCkgdjB5ID0gMC4wMDE7XHJcbiAgICAgIHZhciBueCA9IC12MHg7XHJcbiAgICAgIHZhciBueSA9IC12MHk7XHJcbiAgICAgIHZhciBueiA9IC12MHo7XHJcbiAgICAgIHRoaXMuc3VwcG9ydFBvaW50QihjMSwgLW54LCAtbnksIC1ueiwgc3VwKTtcclxuICAgICAgdmFyIHYxMXggPSBzdXAueDtcclxuICAgICAgdmFyIHYxMXkgPSBzdXAueTtcclxuICAgICAgdmFyIHYxMXogPSBzdXAuejtcclxuICAgICAgdGhpcy5zdXBwb3J0UG9pbnRDKGMyLCBueCwgbnksIG56LCBzdXApO1xyXG4gICAgICB2YXIgdjEyeCA9IHN1cC54O1xyXG4gICAgICB2YXIgdjEyeSA9IHN1cC55O1xyXG4gICAgICB2YXIgdjEyeiA9IHN1cC56O1xyXG4gICAgICB2YXIgdjF4ID0gdjEyeCAtIHYxMXg7XHJcbiAgICAgIHZhciB2MXkgPSB2MTJ5IC0gdjExeTtcclxuICAgICAgdmFyIHYxeiA9IHYxMnogLSB2MTF6O1xyXG4gICAgICBpZiAodjF4ICogbnggKyB2MXkgKiBueSArIHYxeiAqIG56IDw9IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgbnggPSB2MXkgKiB2MHogLSB2MXogKiB2MHk7XHJcbiAgICAgIG55ID0gdjF6ICogdjB4IC0gdjF4ICogdjB6O1xyXG4gICAgICBueiA9IHYxeCAqIHYweSAtIHYxeSAqIHYweDtcclxuICAgICAgaWYgKG54ICogbnggKyBueSAqIG55ICsgbnogKiBueiA9PSAwKSB7XHJcbiAgICAgICAgc2VwLnNldCh2MXggLSB2MHgsIHYxeSAtIHYweSwgdjF6IC0gdjB6KS5ub3JtYWxpemUoKTtcclxuICAgICAgICBwb3Muc2V0KCh2MTF4ICsgdjEyeCkgKiAwLjUsICh2MTF5ICsgdjEyeSkgKiAwLjUsICh2MTF6ICsgdjEyeikgKiAwLjUpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuc3VwcG9ydFBvaW50QihjMSwgLW54LCAtbnksIC1ueiwgc3VwKTtcclxuICAgICAgdmFyIHYyMXggPSBzdXAueDtcclxuICAgICAgdmFyIHYyMXkgPSBzdXAueTtcclxuICAgICAgdmFyIHYyMXogPSBzdXAuejtcclxuICAgICAgdGhpcy5zdXBwb3J0UG9pbnRDKGMyLCBueCwgbnksIG56LCBzdXApO1xyXG4gICAgICB2YXIgdjIyeCA9IHN1cC54O1xyXG4gICAgICB2YXIgdjIyeSA9IHN1cC55O1xyXG4gICAgICB2YXIgdjIyeiA9IHN1cC56O1xyXG4gICAgICB2YXIgdjJ4ID0gdjIyeCAtIHYyMXg7XHJcbiAgICAgIHZhciB2MnkgPSB2MjJ5IC0gdjIxeTtcclxuICAgICAgdmFyIHYyeiA9IHYyMnogLSB2MjF6O1xyXG4gICAgICBpZiAodjJ4ICogbnggKyB2MnkgKiBueSArIHYyeiAqIG56IDw9IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgdDF4ID0gdjF4IC0gdjB4O1xyXG4gICAgICB0MXkgPSB2MXkgLSB2MHk7XHJcbiAgICAgIHQxeiA9IHYxeiAtIHYwejtcclxuICAgICAgdDJ4ID0gdjJ4IC0gdjB4O1xyXG4gICAgICB0MnkgPSB2MnkgLSB2MHk7XHJcbiAgICAgIHQyeiA9IHYyeiAtIHYwejtcclxuICAgICAgbnggPSB0MXkgKiB0MnogLSB0MXogKiB0Mnk7XHJcbiAgICAgIG55ID0gdDF6ICogdDJ4IC0gdDF4ICogdDJ6O1xyXG4gICAgICBueiA9IHQxeCAqIHQyeSAtIHQxeSAqIHQyeDtcclxuICAgICAgaWYgKG54ICogdjB4ICsgbnkgKiB2MHkgKyBueiAqIHYweiA+IDApIHtcclxuICAgICAgICB0MXggPSB2MXg7XHJcbiAgICAgICAgdDF5ID0gdjF5O1xyXG4gICAgICAgIHQxeiA9IHYxejtcclxuICAgICAgICB2MXggPSB2Mng7XHJcbiAgICAgICAgdjF5ID0gdjJ5O1xyXG4gICAgICAgIHYxeiA9IHYyejtcclxuICAgICAgICB2MnggPSB0MXg7XHJcbiAgICAgICAgdjJ5ID0gdDF5O1xyXG4gICAgICAgIHYyeiA9IHQxejtcclxuICAgICAgICB0MXggPSB2MTF4O1xyXG4gICAgICAgIHQxeSA9IHYxMXk7XHJcbiAgICAgICAgdDF6ID0gdjExejtcclxuICAgICAgICB2MTF4ID0gdjIxeDtcclxuICAgICAgICB2MTF5ID0gdjIxeTtcclxuICAgICAgICB2MTF6ID0gdjIxejtcclxuICAgICAgICB2MjF4ID0gdDF4O1xyXG4gICAgICAgIHYyMXkgPSB0MXk7XHJcbiAgICAgICAgdjIxeiA9IHQxejtcclxuICAgICAgICB0MXggPSB2MTJ4O1xyXG4gICAgICAgIHQxeSA9IHYxMnk7XHJcbiAgICAgICAgdDF6ID0gdjEyejtcclxuICAgICAgICB2MTJ4ID0gdjIyeDtcclxuICAgICAgICB2MTJ5ID0gdjIyeTtcclxuICAgICAgICB2MTJ6ID0gdjIyejtcclxuICAgICAgICB2MjJ4ID0gdDF4O1xyXG4gICAgICAgIHYyMnkgPSB0MXk7XHJcbiAgICAgICAgdjIyeiA9IHQxejtcclxuICAgICAgICBueCA9IC1ueDtcclxuICAgICAgICBueSA9IC1ueTtcclxuICAgICAgICBueiA9IC1uejtcclxuICAgICAgfVxyXG4gICAgICB2YXIgaXRlcmF0aW9ucyA9IDA7XHJcbiAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgaWYgKCsraXRlcmF0aW9ucyA+IDEwMCkge1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnN1cHBvcnRQb2ludEIoYzEsIC1ueCwgLW55LCAtbnosIHN1cCk7XHJcbiAgICAgICAgdmFyIHYzMXggPSBzdXAueDtcclxuICAgICAgICB2YXIgdjMxeSA9IHN1cC55O1xyXG4gICAgICAgIHZhciB2MzF6ID0gc3VwLno7XHJcbiAgICAgICAgdGhpcy5zdXBwb3J0UG9pbnRDKGMyLCBueCwgbnksIG56LCBzdXApO1xyXG4gICAgICAgIHZhciB2MzJ4ID0gc3VwLng7XHJcbiAgICAgICAgdmFyIHYzMnkgPSBzdXAueTtcclxuICAgICAgICB2YXIgdjMyeiA9IHN1cC56O1xyXG4gICAgICAgIHZhciB2M3ggPSB2MzJ4IC0gdjMxeDtcclxuICAgICAgICB2YXIgdjN5ID0gdjMyeSAtIHYzMXk7XHJcbiAgICAgICAgdmFyIHYzeiA9IHYzMnogLSB2MzF6O1xyXG4gICAgICAgIGlmICh2M3ggKiBueCArIHYzeSAqIG55ICsgdjN6ICogbnogPD0gMCkge1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKHYxeSAqIHYzeiAtIHYxeiAqIHYzeSkgKiB2MHggKyAodjF6ICogdjN4IC0gdjF4ICogdjN6KSAqIHYweSArICh2MXggKiB2M3kgLSB2MXkgKiB2M3gpICogdjB6IDwgMCkge1xyXG4gICAgICAgICAgdjJ4ID0gdjN4O1xyXG4gICAgICAgICAgdjJ5ID0gdjN5O1xyXG4gICAgICAgICAgdjJ6ID0gdjN6O1xyXG4gICAgICAgICAgdjIxeCA9IHYzMXg7XHJcbiAgICAgICAgICB2MjF5ID0gdjMxeTtcclxuICAgICAgICAgIHYyMXogPSB2MzF6O1xyXG4gICAgICAgICAgdjIyeCA9IHYzMng7XHJcbiAgICAgICAgICB2MjJ5ID0gdjMyeTtcclxuICAgICAgICAgIHYyMnogPSB2MzJ6O1xyXG4gICAgICAgICAgdDF4ID0gdjF4IC0gdjB4O1xyXG4gICAgICAgICAgdDF5ID0gdjF5IC0gdjB5O1xyXG4gICAgICAgICAgdDF6ID0gdjF6IC0gdjB6O1xyXG4gICAgICAgICAgdDJ4ID0gdjN4IC0gdjB4O1xyXG4gICAgICAgICAgdDJ5ID0gdjN5IC0gdjB5O1xyXG4gICAgICAgICAgdDJ6ID0gdjN6IC0gdjB6O1xyXG4gICAgICAgICAgbnggPSB0MXkgKiB0MnogLSB0MXogKiB0Mnk7XHJcbiAgICAgICAgICBueSA9IHQxeiAqIHQyeCAtIHQxeCAqIHQyejtcclxuICAgICAgICAgIG56ID0gdDF4ICogdDJ5IC0gdDF5ICogdDJ4O1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgodjN5ICogdjJ6IC0gdjN6ICogdjJ5KSAqIHYweCArICh2M3ogKiB2MnggLSB2M3ggKiB2MnopICogdjB5ICsgKHYzeCAqIHYyeSAtIHYzeSAqIHYyeCkgKiB2MHogPCAwKSB7XHJcbiAgICAgICAgICB2MXggPSB2M3g7XHJcbiAgICAgICAgICB2MXkgPSB2M3k7XHJcbiAgICAgICAgICB2MXogPSB2M3o7XHJcbiAgICAgICAgICB2MTF4ID0gdjMxeDtcclxuICAgICAgICAgIHYxMXkgPSB2MzF5O1xyXG4gICAgICAgICAgdjExeiA9IHYzMXo7XHJcbiAgICAgICAgICB2MTJ4ID0gdjMyeDtcclxuICAgICAgICAgIHYxMnkgPSB2MzJ5O1xyXG4gICAgICAgICAgdjEyeiA9IHYzMno7XHJcbiAgICAgICAgICB0MXggPSB2M3ggLSB2MHg7XHJcbiAgICAgICAgICB0MXkgPSB2M3kgLSB2MHk7XHJcbiAgICAgICAgICB0MXogPSB2M3ogLSB2MHo7XHJcbiAgICAgICAgICB0MnggPSB2MnggLSB2MHg7XHJcbiAgICAgICAgICB0MnkgPSB2MnkgLSB2MHk7XHJcbiAgICAgICAgICB0MnogPSB2MnogLSB2MHo7XHJcbiAgICAgICAgICBueCA9IHQxeSAqIHQyeiAtIHQxeiAqIHQyeTtcclxuICAgICAgICAgIG55ID0gdDF6ICogdDJ4IC0gdDF4ICogdDJ6O1xyXG4gICAgICAgICAgbnogPSB0MXggKiB0MnkgLSB0MXkgKiB0Mng7XHJcbiAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGhpdCA9IGZhbHNlO1xyXG4gICAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgICB0MXggPSB2MnggLSB2MXg7XHJcbiAgICAgICAgICB0MXkgPSB2MnkgLSB2MXk7XHJcbiAgICAgICAgICB0MXogPSB2MnogLSB2MXo7XHJcbiAgICAgICAgICB0MnggPSB2M3ggLSB2MXg7XHJcbiAgICAgICAgICB0MnkgPSB2M3kgLSB2MXk7XHJcbiAgICAgICAgICB0MnogPSB2M3ogLSB2MXo7XHJcbiAgICAgICAgICBueCA9IHQxeSAqIHQyeiAtIHQxeiAqIHQyeTtcclxuICAgICAgICAgIG55ID0gdDF6ICogdDJ4IC0gdDF4ICogdDJ6O1xyXG4gICAgICAgICAgbnogPSB0MXggKiB0MnkgLSB0MXkgKiB0Mng7XHJcbiAgICAgICAgICBsZW4gPSAxIC8gX01hdGguc3FydChueCAqIG54ICsgbnkgKiBueSArIG56ICogbnopO1xyXG4gICAgICAgICAgbnggKj0gbGVuO1xyXG4gICAgICAgICAgbnkgKj0gbGVuO1xyXG4gICAgICAgICAgbnogKj0gbGVuO1xyXG4gICAgICAgICAgaWYgKG54ICogdjF4ICsgbnkgKiB2MXkgKyBueiAqIHYxeiA+PSAwICYmICFoaXQpIHtcclxuICAgICAgICAgICAgdmFyIGIwID0gKHYxeSAqIHYyeiAtIHYxeiAqIHYyeSkgKiB2M3ggKyAodjF6ICogdjJ4IC0gdjF4ICogdjJ6KSAqIHYzeSArICh2MXggKiB2MnkgLSB2MXkgKiB2MngpICogdjN6O1xyXG4gICAgICAgICAgICB2YXIgYjEgPSAodjN5ICogdjJ6IC0gdjN6ICogdjJ5KSAqIHYweCArICh2M3ogKiB2MnggLSB2M3ggKiB2MnopICogdjB5ICsgKHYzeCAqIHYyeSAtIHYzeSAqIHYyeCkgKiB2MHo7XHJcbiAgICAgICAgICAgIHZhciBiMiA9ICh2MHkgKiB2MXogLSB2MHogKiB2MXkpICogdjN4ICsgKHYweiAqIHYxeCAtIHYweCAqIHYxeikgKiB2M3kgKyAodjB4ICogdjF5IC0gdjB5ICogdjF4KSAqIHYzejtcclxuICAgICAgICAgICAgdmFyIGIzID0gKHYyeSAqIHYxeiAtIHYyeiAqIHYxeSkgKiB2MHggKyAodjJ6ICogdjF4IC0gdjJ4ICogdjF6KSAqIHYweSArICh2MnggKiB2MXkgLSB2MnkgKiB2MXgpICogdjB6O1xyXG4gICAgICAgICAgICB2YXIgc3VtID0gYjAgKyBiMSArIGIyICsgYjM7XHJcbiAgICAgICAgICAgIGlmIChzdW0gPD0gMCkge1xyXG4gICAgICAgICAgICAgIGIwID0gMDtcclxuICAgICAgICAgICAgICBiMSA9ICh2MnkgKiB2M3ogLSB2MnogKiB2M3kpICogbnggKyAodjJ6ICogdjN4IC0gdjJ4ICogdjN6KSAqIG55ICsgKHYyeCAqIHYzeSAtIHYyeSAqIHYzeCkgKiBuejtcclxuICAgICAgICAgICAgICBiMiA9ICh2M3kgKiB2MnogLSB2M3ogKiB2MnkpICogbnggKyAodjN6ICogdjJ4IC0gdjN4ICogdjJ6KSAqIG55ICsgKHYzeCAqIHYyeSAtIHYzeSAqIHYyeCkgKiBuejtcclxuICAgICAgICAgICAgICBiMyA9ICh2MXkgKiB2MnogLSB2MXogKiB2MnkpICogbnggKyAodjF6ICogdjJ4IC0gdjF4ICogdjJ6KSAqIG55ICsgKHYxeCAqIHYyeSAtIHYxeSAqIHYyeCkgKiBuejtcclxuICAgICAgICAgICAgICBzdW0gPSBiMSArIGIyICsgYjM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdmFyIGludiA9IDEgLyBzdW07XHJcbiAgICAgICAgICAgIHAxeCA9ICh2MDF4ICogYjAgKyB2MTF4ICogYjEgKyB2MjF4ICogYjIgKyB2MzF4ICogYjMpICogaW52O1xyXG4gICAgICAgICAgICBwMXkgPSAodjAxeSAqIGIwICsgdjExeSAqIGIxICsgdjIxeSAqIGIyICsgdjMxeSAqIGIzKSAqIGludjtcclxuICAgICAgICAgICAgcDF6ID0gKHYwMXogKiBiMCArIHYxMXogKiBiMSArIHYyMXogKiBiMiArIHYzMXogKiBiMykgKiBpbnY7XHJcbiAgICAgICAgICAgIHAyeCA9ICh2MDJ4ICogYjAgKyB2MTJ4ICogYjEgKyB2MjJ4ICogYjIgKyB2MzJ4ICogYjMpICogaW52O1xyXG4gICAgICAgICAgICBwMnkgPSAodjAyeSAqIGIwICsgdjEyeSAqIGIxICsgdjIyeSAqIGIyICsgdjMyeSAqIGIzKSAqIGludjtcclxuICAgICAgICAgICAgcDJ6ID0gKHYwMnogKiBiMCArIHYxMnogKiBiMSArIHYyMnogKiBiMiArIHYzMnogKiBiMykgKiBpbnY7XHJcbiAgICAgICAgICAgIGhpdCA9IHRydWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB0aGlzLnN1cHBvcnRQb2ludEIoYzEsIC1ueCwgLW55LCAtbnosIHN1cCk7XHJcbiAgICAgICAgICB2YXIgdjQxeCA9IHN1cC54O1xyXG4gICAgICAgICAgdmFyIHY0MXkgPSBzdXAueTtcclxuICAgICAgICAgIHZhciB2NDF6ID0gc3VwLno7XHJcbiAgICAgICAgICB0aGlzLnN1cHBvcnRQb2ludEMoYzIsIG54LCBueSwgbnosIHN1cCk7XHJcbiAgICAgICAgICB2YXIgdjQyeCA9IHN1cC54O1xyXG4gICAgICAgICAgdmFyIHY0MnkgPSBzdXAueTtcclxuICAgICAgICAgIHZhciB2NDJ6ID0gc3VwLno7XHJcbiAgICAgICAgICB2YXIgdjR4ID0gdjQyeCAtIHY0MXg7XHJcbiAgICAgICAgICB2YXIgdjR5ID0gdjQyeSAtIHY0MXk7XHJcbiAgICAgICAgICB2YXIgdjR6ID0gdjQyeiAtIHY0MXo7XHJcbiAgICAgICAgICB2YXIgc2VwYXJhdGlvbiA9IC0odjR4ICogbnggKyB2NHkgKiBueSArIHY0eiAqIG56KTtcclxuICAgICAgICAgIGlmICgodjR4IC0gdjN4KSAqIG54ICsgKHY0eSAtIHYzeSkgKiBueSArICh2NHogLSB2M3opICogbnogPD0gMC4wMSB8fCBzZXBhcmF0aW9uID49IDApIHtcclxuICAgICAgICAgICAgaWYgKGhpdCkge1xyXG4gICAgICAgICAgICAgIHNlcC5zZXQoLW54LCAtbnksIC1ueik7XHJcbiAgICAgICAgICAgICAgcG9zLnNldCgocDF4ICsgcDJ4KSAqIDAuNSwgKHAxeSArIHAyeSkgKiAwLjUsIChwMXogKyBwMnopICogMC41KTtcclxuICAgICAgICAgICAgICBkZXAueCA9IHNlcGFyYXRpb247XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAodjR5ICogdjF6IC0gdjR6ICogdjF5KSAqIHYweCArXHJcbiAgICAgICAgICAgICh2NHogKiB2MXggLSB2NHggKiB2MXopICogdjB5ICtcclxuICAgICAgICAgICAgKHY0eCAqIHYxeSAtIHY0eSAqIHYxeCkgKiB2MHogPCAwXHJcbiAgICAgICAgICApIHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICh2NHkgKiB2MnogLSB2NHogKiB2MnkpICogdjB4ICtcclxuICAgICAgICAgICAgICAodjR6ICogdjJ4IC0gdjR4ICogdjJ6KSAqIHYweSArXHJcbiAgICAgICAgICAgICAgKHY0eCAqIHYyeSAtIHY0eSAqIHYyeCkgKiB2MHogPCAwXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgIHYxeCA9IHY0eDtcclxuICAgICAgICAgICAgICB2MXkgPSB2NHk7XHJcbiAgICAgICAgICAgICAgdjF6ID0gdjR6O1xyXG4gICAgICAgICAgICAgIHYxMXggPSB2NDF4O1xyXG4gICAgICAgICAgICAgIHYxMXkgPSB2NDF5O1xyXG4gICAgICAgICAgICAgIHYxMXogPSB2NDF6O1xyXG4gICAgICAgICAgICAgIHYxMnggPSB2NDJ4O1xyXG4gICAgICAgICAgICAgIHYxMnkgPSB2NDJ5O1xyXG4gICAgICAgICAgICAgIHYxMnogPSB2NDJ6O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHYzeCA9IHY0eDtcclxuICAgICAgICAgICAgICB2M3kgPSB2NHk7XHJcbiAgICAgICAgICAgICAgdjN6ID0gdjR6O1xyXG4gICAgICAgICAgICAgIHYzMXggPSB2NDF4O1xyXG4gICAgICAgICAgICAgIHYzMXkgPSB2NDF5O1xyXG4gICAgICAgICAgICAgIHYzMXogPSB2NDF6O1xyXG4gICAgICAgICAgICAgIHYzMnggPSB2NDJ4O1xyXG4gICAgICAgICAgICAgIHYzMnkgPSB2NDJ5O1xyXG4gICAgICAgICAgICAgIHYzMnogPSB2NDJ6O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgKHY0eSAqIHYzeiAtIHY0eiAqIHYzeSkgKiB2MHggK1xyXG4gICAgICAgICAgICAgICh2NHogKiB2M3ggLSB2NHggKiB2M3opICogdjB5ICtcclxuICAgICAgICAgICAgICAodjR4ICogdjN5IC0gdjR5ICogdjN4KSAqIHYweiA8IDBcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgdjJ4ID0gdjR4O1xyXG4gICAgICAgICAgICAgIHYyeSA9IHY0eTtcclxuICAgICAgICAgICAgICB2MnogPSB2NHo7XHJcbiAgICAgICAgICAgICAgdjIxeCA9IHY0MXg7XHJcbiAgICAgICAgICAgICAgdjIxeSA9IHY0MXk7XHJcbiAgICAgICAgICAgICAgdjIxeiA9IHY0MXo7XHJcbiAgICAgICAgICAgICAgdjIyeCA9IHY0Mng7XHJcbiAgICAgICAgICAgICAgdjIyeSA9IHY0Mnk7XHJcbiAgICAgICAgICAgICAgdjIyeiA9IHY0Mno7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdjF4ID0gdjR4O1xyXG4gICAgICAgICAgICAgIHYxeSA9IHY0eTtcclxuICAgICAgICAgICAgICB2MXogPSB2NHo7XHJcbiAgICAgICAgICAgICAgdjExeCA9IHY0MXg7XHJcbiAgICAgICAgICAgICAgdjExeSA9IHY0MXk7XHJcbiAgICAgICAgICAgICAgdjExeiA9IHY0MXo7XHJcbiAgICAgICAgICAgICAgdjEyeCA9IHY0Mng7XHJcbiAgICAgICAgICAgICAgdjEyeSA9IHY0Mnk7XHJcbiAgICAgICAgICAgICAgdjEyeiA9IHY0Mno7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgLy9yZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG5cclxuICAgIHN1cHBvcnRQb2ludEI6IGZ1bmN0aW9uIChjLCBkeCwgZHksIGR6LCBvdXQpIHtcclxuXHJcbiAgICAgIHZhciByb3QgPSBjLnJvdGF0aW9uLmVsZW1lbnRzO1xyXG4gICAgICB2YXIgbGR4ID0gcm90WzBdICogZHggKyByb3RbM10gKiBkeSArIHJvdFs2XSAqIGR6O1xyXG4gICAgICB2YXIgbGR5ID0gcm90WzFdICogZHggKyByb3RbNF0gKiBkeSArIHJvdFs3XSAqIGR6O1xyXG4gICAgICB2YXIgbGR6ID0gcm90WzJdICogZHggKyByb3RbNV0gKiBkeSArIHJvdFs4XSAqIGR6O1xyXG4gICAgICB2YXIgdyA9IGMuaGFsZldpZHRoO1xyXG4gICAgICB2YXIgaCA9IGMuaGFsZkhlaWdodDtcclxuICAgICAgdmFyIGQgPSBjLmhhbGZEZXB0aDtcclxuICAgICAgdmFyIG94O1xyXG4gICAgICB2YXIgb3k7XHJcbiAgICAgIHZhciBvejtcclxuICAgICAgaWYgKGxkeCA8IDApIG94ID0gLXc7XHJcbiAgICAgIGVsc2Ugb3ggPSB3O1xyXG4gICAgICBpZiAobGR5IDwgMCkgb3kgPSAtaDtcclxuICAgICAgZWxzZSBveSA9IGg7XHJcbiAgICAgIGlmIChsZHogPCAwKSBveiA9IC1kO1xyXG4gICAgICBlbHNlIG96ID0gZDtcclxuICAgICAgbGR4ID0gcm90WzBdICogb3ggKyByb3RbMV0gKiBveSArIHJvdFsyXSAqIG96ICsgYy5wb3NpdGlvbi54O1xyXG4gICAgICBsZHkgPSByb3RbM10gKiBveCArIHJvdFs0XSAqIG95ICsgcm90WzVdICogb3ogKyBjLnBvc2l0aW9uLnk7XHJcbiAgICAgIGxkeiA9IHJvdFs2XSAqIG94ICsgcm90WzddICogb3kgKyByb3RbOF0gKiBveiArIGMucG9zaXRpb24uejtcclxuICAgICAgb3V0LnNldChsZHgsIGxkeSwgbGR6KTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIHN1cHBvcnRQb2ludEM6IGZ1bmN0aW9uIChjLCBkeCwgZHksIGR6LCBvdXQpIHtcclxuXHJcbiAgICAgIHZhciByb3QgPSBjLnJvdGF0aW9uLmVsZW1lbnRzO1xyXG4gICAgICB2YXIgbGR4ID0gcm90WzBdICogZHggKyByb3RbM10gKiBkeSArIHJvdFs2XSAqIGR6O1xyXG4gICAgICB2YXIgbGR5ID0gcm90WzFdICogZHggKyByb3RbNF0gKiBkeSArIHJvdFs3XSAqIGR6O1xyXG4gICAgICB2YXIgbGR6ID0gcm90WzJdICogZHggKyByb3RbNV0gKiBkeSArIHJvdFs4XSAqIGR6O1xyXG4gICAgICB2YXIgcmFkeCA9IGxkeDtcclxuICAgICAgdmFyIHJhZHogPSBsZHo7XHJcbiAgICAgIHZhciBsZW4gPSByYWR4ICogcmFkeCArIHJhZHogKiByYWR6O1xyXG4gICAgICB2YXIgcmFkID0gYy5yYWRpdXM7XHJcbiAgICAgIHZhciBoaCA9IGMuaGFsZkhlaWdodDtcclxuICAgICAgdmFyIG94O1xyXG4gICAgICB2YXIgb3k7XHJcbiAgICAgIHZhciBvejtcclxuICAgICAgaWYgKGxlbiA9PSAwKSB7XHJcbiAgICAgICAgaWYgKGxkeSA8IDApIHtcclxuICAgICAgICAgIG94ID0gcmFkO1xyXG4gICAgICAgICAgb3kgPSAtaGg7XHJcbiAgICAgICAgICBveiA9IDA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIG94ID0gcmFkO1xyXG4gICAgICAgICAgb3kgPSBoaDtcclxuICAgICAgICAgIG96ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGVuID0gYy5yYWRpdXMgLyBfTWF0aC5zcXJ0KGxlbik7XHJcbiAgICAgICAgaWYgKGxkeSA8IDApIHtcclxuICAgICAgICAgIG94ID0gcmFkeCAqIGxlbjtcclxuICAgICAgICAgIG95ID0gLWhoO1xyXG4gICAgICAgICAgb3ogPSByYWR6ICogbGVuO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBveCA9IHJhZHggKiBsZW47XHJcbiAgICAgICAgICBveSA9IGhoO1xyXG4gICAgICAgICAgb3ogPSByYWR6ICogbGVuO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBsZHggPSByb3RbMF0gKiBveCArIHJvdFsxXSAqIG95ICsgcm90WzJdICogb3ogKyBjLnBvc2l0aW9uLng7XHJcbiAgICAgIGxkeSA9IHJvdFszXSAqIG94ICsgcm90WzRdICogb3kgKyByb3RbNV0gKiBveiArIGMucG9zaXRpb24ueTtcclxuICAgICAgbGR6ID0gcm90WzZdICogb3ggKyByb3RbN10gKiBveSArIHJvdFs4XSAqIG96ICsgYy5wb3NpdGlvbi56O1xyXG4gICAgICBvdXQuc2V0KGxkeCwgbGR5LCBsZHopO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgZGV0ZWN0Q29sbGlzaW9uOiBmdW5jdGlvbiAoc2hhcGUxLCBzaGFwZTIsIG1hbmlmb2xkKSB7XHJcblxyXG4gICAgICB2YXIgYjtcclxuICAgICAgdmFyIGM7XHJcbiAgICAgIGlmICh0aGlzLmZsaXApIHtcclxuICAgICAgICBiID0gc2hhcGUyO1xyXG4gICAgICAgIGMgPSBzaGFwZTE7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgYiA9IHNoYXBlMTtcclxuICAgICAgICBjID0gc2hhcGUyO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBzZXAgPSBuZXcgVmVjMygpO1xyXG4gICAgICB2YXIgcG9zID0gbmV3IFZlYzMoKTtcclxuICAgICAgdmFyIGRlcCA9IG5ldyBWZWMzKCk7XHJcblxyXG4gICAgICBpZiAoIXRoaXMuZ2V0U2VwKGIsIGMsIHNlcCwgcG9zLCBkZXApKSByZXR1cm47XHJcbiAgICAgIHZhciBwYnggPSBiLnBvc2l0aW9uLng7XHJcbiAgICAgIHZhciBwYnkgPSBiLnBvc2l0aW9uLnk7XHJcbiAgICAgIHZhciBwYnogPSBiLnBvc2l0aW9uLno7XHJcbiAgICAgIHZhciBwY3ggPSBjLnBvc2l0aW9uLng7XHJcbiAgICAgIHZhciBwY3kgPSBjLnBvc2l0aW9uLnk7XHJcbiAgICAgIHZhciBwY3ogPSBjLnBvc2l0aW9uLno7XHJcbiAgICAgIHZhciBidyA9IGIuaGFsZldpZHRoO1xyXG4gICAgICB2YXIgYmggPSBiLmhhbGZIZWlnaHQ7XHJcbiAgICAgIHZhciBiZCA9IGIuaGFsZkRlcHRoO1xyXG4gICAgICB2YXIgY2ggPSBjLmhhbGZIZWlnaHQ7XHJcbiAgICAgIHZhciByID0gYy5yYWRpdXM7XHJcblxyXG4gICAgICB2YXIgRCA9IGIuZGltZW50aW9ucztcclxuXHJcbiAgICAgIHZhciBud3ggPSBEWzBdOy8vYi5ub3JtYWxEaXJlY3Rpb25XaWR0aC54O1xyXG4gICAgICB2YXIgbnd5ID0gRFsxXTsvL2Iubm9ybWFsRGlyZWN0aW9uV2lkdGgueTtcclxuICAgICAgdmFyIG53eiA9IERbMl07Ly9iLm5vcm1hbERpcmVjdGlvbldpZHRoLno7XHJcbiAgICAgIHZhciBuaHggPSBEWzNdOy8vYi5ub3JtYWxEaXJlY3Rpb25IZWlnaHQueDtcclxuICAgICAgdmFyIG5oeSA9IERbNF07Ly9iLm5vcm1hbERpcmVjdGlvbkhlaWdodC55O1xyXG4gICAgICB2YXIgbmh6ID0gRFs1XTsvL2Iubm9ybWFsRGlyZWN0aW9uSGVpZ2h0Lno7XHJcbiAgICAgIHZhciBuZHggPSBEWzZdOy8vYi5ub3JtYWxEaXJlY3Rpb25EZXB0aC54O1xyXG4gICAgICB2YXIgbmR5ID0gRFs3XTsvL2Iubm9ybWFsRGlyZWN0aW9uRGVwdGgueTtcclxuICAgICAgdmFyIG5keiA9IERbOF07Ly9iLm5vcm1hbERpcmVjdGlvbkRlcHRoLno7XHJcblxyXG4gICAgICB2YXIgZHd4ID0gRFs5XTsvL2IuaGFsZkRpcmVjdGlvbldpZHRoLng7XHJcbiAgICAgIHZhciBkd3kgPSBEWzEwXTsvL2IuaGFsZkRpcmVjdGlvbldpZHRoLnk7XHJcbiAgICAgIHZhciBkd3ogPSBEWzExXTsvL2IuaGFsZkRpcmVjdGlvbldpZHRoLno7XHJcbiAgICAgIHZhciBkaHggPSBEWzEyXTsvL2IuaGFsZkRpcmVjdGlvbkhlaWdodC54O1xyXG4gICAgICB2YXIgZGh5ID0gRFsxM107Ly9iLmhhbGZEaXJlY3Rpb25IZWlnaHQueTtcclxuICAgICAgdmFyIGRoeiA9IERbMTRdOy8vYi5oYWxmRGlyZWN0aW9uSGVpZ2h0Lno7XHJcbiAgICAgIHZhciBkZHggPSBEWzE1XTsvL2IuaGFsZkRpcmVjdGlvbkRlcHRoLng7XHJcbiAgICAgIHZhciBkZHkgPSBEWzE2XTsvL2IuaGFsZkRpcmVjdGlvbkRlcHRoLnk7XHJcbiAgICAgIHZhciBkZHogPSBEWzE3XTsvL2IuaGFsZkRpcmVjdGlvbkRlcHRoLno7XHJcblxyXG4gICAgICB2YXIgbmN4ID0gYy5ub3JtYWxEaXJlY3Rpb24ueDtcclxuICAgICAgdmFyIG5jeSA9IGMubm9ybWFsRGlyZWN0aW9uLnk7XHJcbiAgICAgIHZhciBuY3ogPSBjLm5vcm1hbERpcmVjdGlvbi56O1xyXG4gICAgICB2YXIgZGN4ID0gYy5oYWxmRGlyZWN0aW9uLng7XHJcbiAgICAgIHZhciBkY3kgPSBjLmhhbGZEaXJlY3Rpb24ueTtcclxuICAgICAgdmFyIGRjeiA9IGMuaGFsZkRpcmVjdGlvbi56O1xyXG4gICAgICB2YXIgbnggPSBzZXAueDtcclxuICAgICAgdmFyIG55ID0gc2VwLnk7XHJcbiAgICAgIHZhciBueiA9IHNlcC56O1xyXG4gICAgICB2YXIgZG90dyA9IG54ICogbnd4ICsgbnkgKiBud3kgKyBueiAqIG53ejtcclxuICAgICAgdmFyIGRvdGggPSBueCAqIG5oeCArIG55ICogbmh5ICsgbnogKiBuaHo7XHJcbiAgICAgIHZhciBkb3RkID0gbnggKiBuZHggKyBueSAqIG5keSArIG56ICogbmR6O1xyXG4gICAgICB2YXIgZG90YyA9IG54ICogbmN4ICsgbnkgKiBuY3kgKyBueiAqIG5jejtcclxuICAgICAgdmFyIHJpZ2h0MSA9IGRvdHcgPiAwO1xyXG4gICAgICB2YXIgcmlnaHQyID0gZG90aCA+IDA7XHJcbiAgICAgIHZhciByaWdodDMgPSBkb3RkID4gMDtcclxuICAgICAgdmFyIHJpZ2h0NCA9IGRvdGMgPiAwO1xyXG4gICAgICBpZiAoIXJpZ2h0MSkgZG90dyA9IC1kb3R3O1xyXG4gICAgICBpZiAoIXJpZ2h0MikgZG90aCA9IC1kb3RoO1xyXG4gICAgICBpZiAoIXJpZ2h0MykgZG90ZCA9IC1kb3RkO1xyXG4gICAgICBpZiAoIXJpZ2h0NCkgZG90YyA9IC1kb3RjO1xyXG4gICAgICB2YXIgc3RhdGUgPSAwO1xyXG4gICAgICBpZiAoZG90YyA+IDAuOTk5KSB7XHJcbiAgICAgICAgaWYgKGRvdHcgPiAwLjk5OSkge1xyXG4gICAgICAgICAgaWYgKGRvdHcgPiBkb3RjKSBzdGF0ZSA9IDE7XHJcbiAgICAgICAgICBlbHNlIHN0YXRlID0gNDtcclxuICAgICAgICB9IGVsc2UgaWYgKGRvdGggPiAwLjk5OSkge1xyXG4gICAgICAgICAgaWYgKGRvdGggPiBkb3RjKSBzdGF0ZSA9IDI7XHJcbiAgICAgICAgICBlbHNlIHN0YXRlID0gNDtcclxuICAgICAgICB9IGVsc2UgaWYgKGRvdGQgPiAwLjk5OSkge1xyXG4gICAgICAgICAgaWYgKGRvdGQgPiBkb3RjKSBzdGF0ZSA9IDM7XHJcbiAgICAgICAgICBlbHNlIHN0YXRlID0gNDtcclxuICAgICAgICB9IGVsc2Ugc3RhdGUgPSA0O1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGlmIChkb3R3ID4gMC45OTkpIHN0YXRlID0gMTtcclxuICAgICAgICBlbHNlIGlmIChkb3RoID4gMC45OTkpIHN0YXRlID0gMjtcclxuICAgICAgICBlbHNlIGlmIChkb3RkID4gMC45OTkpIHN0YXRlID0gMztcclxuICAgICAgfVxyXG4gICAgICB2YXIgY2J4O1xyXG4gICAgICB2YXIgY2J5O1xyXG4gICAgICB2YXIgY2J6O1xyXG4gICAgICB2YXIgY2N4O1xyXG4gICAgICB2YXIgY2N5O1xyXG4gICAgICB2YXIgY2N6O1xyXG4gICAgICB2YXIgcjAwO1xyXG4gICAgICB2YXIgcjAxO1xyXG4gICAgICB2YXIgcjAyO1xyXG4gICAgICB2YXIgcjEwO1xyXG4gICAgICB2YXIgcjExO1xyXG4gICAgICB2YXIgcjEyO1xyXG4gICAgICB2YXIgcjIwO1xyXG4gICAgICB2YXIgcjIxO1xyXG4gICAgICB2YXIgcjIyO1xyXG4gICAgICB2YXIgcHg7XHJcbiAgICAgIHZhciBweTtcclxuICAgICAgdmFyIHB6O1xyXG4gICAgICB2YXIgcGQ7XHJcbiAgICAgIHZhciBkb3Q7XHJcbiAgICAgIHZhciBsZW47XHJcbiAgICAgIHZhciB0eDtcclxuICAgICAgdmFyIHR5O1xyXG4gICAgICB2YXIgdHo7XHJcbiAgICAgIHZhciB0ZDtcclxuICAgICAgdmFyIGR4O1xyXG4gICAgICB2YXIgZHk7XHJcbiAgICAgIHZhciBkejtcclxuICAgICAgdmFyIGQxeDtcclxuICAgICAgdmFyIGQxeTtcclxuICAgICAgdmFyIGQxejtcclxuICAgICAgdmFyIGQyeDtcclxuICAgICAgdmFyIGQyeTtcclxuICAgICAgdmFyIGQyejtcclxuICAgICAgdmFyIHN4O1xyXG4gICAgICB2YXIgc3k7XHJcbiAgICAgIHZhciBzejtcclxuICAgICAgdmFyIHNkO1xyXG4gICAgICB2YXIgZXg7XHJcbiAgICAgIHZhciBleTtcclxuICAgICAgdmFyIGV6O1xyXG4gICAgICB2YXIgZWQ7XHJcbiAgICAgIHZhciBkb3QxO1xyXG4gICAgICB2YXIgZG90MjtcclxuICAgICAgdmFyIHQxO1xyXG4gICAgICB2YXIgZGlyMXg7XHJcbiAgICAgIHZhciBkaXIxeTtcclxuICAgICAgdmFyIGRpcjF6O1xyXG4gICAgICB2YXIgZGlyMng7XHJcbiAgICAgIHZhciBkaXIyeTtcclxuICAgICAgdmFyIGRpcjJ6O1xyXG4gICAgICB2YXIgZGlyMWw7XHJcbiAgICAgIHZhciBkaXIybDtcclxuICAgICAgaWYgKHN0YXRlID09IDApIHtcclxuICAgICAgICAvL21hbmlmb2xkLmFkZFBvaW50KHBvcy54LHBvcy55LHBvcy56LG54LG55LG56LGRlcC54LGIsYywwLDAsZmFsc2UpO1xyXG4gICAgICAgIG1hbmlmb2xkLmFkZFBvaW50KHBvcy54LCBwb3MueSwgcG9zLnosIG54LCBueSwgbnosIGRlcC54LCB0aGlzLmZsaXApO1xyXG4gICAgICB9IGVsc2UgaWYgKHN0YXRlID09IDQpIHtcclxuICAgICAgICBpZiAocmlnaHQ0KSB7XHJcbiAgICAgICAgICBjY3ggPSBwY3ggLSBkY3g7XHJcbiAgICAgICAgICBjY3kgPSBwY3kgLSBkY3k7XHJcbiAgICAgICAgICBjY3ogPSBwY3ogLSBkY3o7XHJcbiAgICAgICAgICBueCA9IC1uY3g7XHJcbiAgICAgICAgICBueSA9IC1uY3k7XHJcbiAgICAgICAgICBueiA9IC1uY3o7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGNjeCA9IHBjeCArIGRjeDtcclxuICAgICAgICAgIGNjeSA9IHBjeSArIGRjeTtcclxuICAgICAgICAgIGNjeiA9IHBjeiArIGRjejtcclxuICAgICAgICAgIG54ID0gbmN4O1xyXG4gICAgICAgICAgbnkgPSBuY3k7XHJcbiAgICAgICAgICBueiA9IG5jejtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIHYxeDtcclxuICAgICAgICB2YXIgdjF5O1xyXG4gICAgICAgIHZhciB2MXo7XHJcbiAgICAgICAgdmFyIHYyeDtcclxuICAgICAgICB2YXIgdjJ5O1xyXG4gICAgICAgIHZhciB2Mno7XHJcbiAgICAgICAgdmFyIHYzeDtcclxuICAgICAgICB2YXIgdjN5O1xyXG4gICAgICAgIHZhciB2M3o7XHJcbiAgICAgICAgdmFyIHY0eDtcclxuICAgICAgICB2YXIgdjR5O1xyXG4gICAgICAgIHZhciB2NHo7XHJcblxyXG4gICAgICAgIGRvdCA9IDE7XHJcbiAgICAgICAgc3RhdGUgPSAwO1xyXG4gICAgICAgIGRvdDEgPSBud3ggKiBueCArIG53eSAqIG55ICsgbnd6ICogbno7XHJcbiAgICAgICAgaWYgKGRvdDEgPCBkb3QpIHtcclxuICAgICAgICAgIGRvdCA9IGRvdDE7XHJcbiAgICAgICAgICBzdGF0ZSA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgtZG90MSA8IGRvdCkge1xyXG4gICAgICAgICAgZG90ID0gLWRvdDE7XHJcbiAgICAgICAgICBzdGF0ZSA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvdDEgPSBuaHggKiBueCArIG5oeSAqIG55ICsgbmh6ICogbno7XHJcbiAgICAgICAgaWYgKGRvdDEgPCBkb3QpIHtcclxuICAgICAgICAgIGRvdCA9IGRvdDE7XHJcbiAgICAgICAgICBzdGF0ZSA9IDI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgtZG90MSA8IGRvdCkge1xyXG4gICAgICAgICAgZG90ID0gLWRvdDE7XHJcbiAgICAgICAgICBzdGF0ZSA9IDM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvdDEgPSBuZHggKiBueCArIG5keSAqIG55ICsgbmR6ICogbno7XHJcbiAgICAgICAgaWYgKGRvdDEgPCBkb3QpIHtcclxuICAgICAgICAgIGRvdCA9IGRvdDE7XHJcbiAgICAgICAgICBzdGF0ZSA9IDQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICgtZG90MSA8IGRvdCkge1xyXG4gICAgICAgICAgZG90ID0gLWRvdDE7XHJcbiAgICAgICAgICBzdGF0ZSA9IDU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciB2ID0gYi5lbGVtZW50cztcclxuICAgICAgICBzd2l0Y2ggKHN0YXRlKSB7XHJcbiAgICAgICAgICBjYXNlIDA6XHJcbiAgICAgICAgICAgIC8vdj1iLnZlcnRleDE7XHJcbiAgICAgICAgICAgIHYxeCA9IHZbMF07Ly92Lng7XHJcbiAgICAgICAgICAgIHYxeSA9IHZbMV07Ly92Lnk7XHJcbiAgICAgICAgICAgIHYxeiA9IHZbMl07Ly92Lno7XHJcbiAgICAgICAgICAgIC8vdj1iLnZlcnRleDM7XHJcbiAgICAgICAgICAgIHYyeCA9IHZbNl07Ly92Lng7XHJcbiAgICAgICAgICAgIHYyeSA9IHZbN107Ly92Lnk7XHJcbiAgICAgICAgICAgIHYyeiA9IHZbOF07Ly92Lno7XHJcbiAgICAgICAgICAgIC8vdj1iLnZlcnRleDQ7XHJcbiAgICAgICAgICAgIHYzeCA9IHZbOV07Ly92Lng7XHJcbiAgICAgICAgICAgIHYzeSA9IHZbMTBdOy8vdi55O1xyXG4gICAgICAgICAgICB2M3ogPSB2WzExXTsvL3YuejtcclxuICAgICAgICAgICAgLy92PWIudmVydGV4MjtcclxuICAgICAgICAgICAgdjR4ID0gdlszXTsvL3YueDtcclxuICAgICAgICAgICAgdjR5ID0gdls0XTsvL3YueTtcclxuICAgICAgICAgICAgdjR6ID0gdls1XTsvL3YuejtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgIC8vdj1iLnZlcnRleDY7XHJcbiAgICAgICAgICAgIHYxeCA9IHZbMTVdOy8vdi54O1xyXG4gICAgICAgICAgICB2MXkgPSB2WzE2XTsvL3YueTtcclxuICAgICAgICAgICAgdjF6ID0gdlsxN107Ly92Lno7XHJcbiAgICAgICAgICAgIC8vdj1iLnZlcnRleDg7XHJcbiAgICAgICAgICAgIHYyeCA9IHZbMjFdOy8vdi54O1xyXG4gICAgICAgICAgICB2MnkgPSB2WzIyXTsvL3YueTtcclxuICAgICAgICAgICAgdjJ6ID0gdlsyM107Ly92Lno7XHJcbiAgICAgICAgICAgIC8vdj1iLnZlcnRleDc7XHJcbiAgICAgICAgICAgIHYzeCA9IHZbMThdOy8vdi54O1xyXG4gICAgICAgICAgICB2M3kgPSB2WzE5XTsvL3YueTtcclxuICAgICAgICAgICAgdjN6ID0gdlsyMF07Ly92Lno7XHJcbiAgICAgICAgICAgIC8vdj1iLnZlcnRleDU7XHJcbiAgICAgICAgICAgIHY0eCA9IHZbMTJdOy8vdi54O1xyXG4gICAgICAgICAgICB2NHkgPSB2WzEzXTsvL3YueTtcclxuICAgICAgICAgICAgdjR6ID0gdlsxNF07Ly92Lno7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgICAvL3Y9Yi52ZXJ0ZXg1O1xyXG4gICAgICAgICAgICB2MXggPSB2WzEyXTsvL3YueDtcclxuICAgICAgICAgICAgdjF5ID0gdlsxM107Ly92Lnk7XHJcbiAgICAgICAgICAgIHYxeiA9IHZbMTRdOy8vdi56O1xyXG4gICAgICAgICAgICAvL3Y9Yi52ZXJ0ZXgxO1xyXG4gICAgICAgICAgICB2MnggPSB2WzBdOy8vdi54O1xyXG4gICAgICAgICAgICB2MnkgPSB2WzFdOy8vdi55O1xyXG4gICAgICAgICAgICB2MnogPSB2WzJdOy8vdi56O1xyXG4gICAgICAgICAgICAvL3Y9Yi52ZXJ0ZXgyO1xyXG4gICAgICAgICAgICB2M3ggPSB2WzNdOy8vdi54O1xyXG4gICAgICAgICAgICB2M3kgPSB2WzRdOy8vdi55O1xyXG4gICAgICAgICAgICB2M3ogPSB2WzVdOy8vdi56O1xyXG4gICAgICAgICAgICAvL3Y9Yi52ZXJ0ZXg2O1xyXG4gICAgICAgICAgICB2NHggPSB2WzE1XTsvL3YueDtcclxuICAgICAgICAgICAgdjR5ID0gdlsxNl07Ly92Lnk7XHJcbiAgICAgICAgICAgIHY0eiA9IHZbMTddOy8vdi56O1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgMzpcclxuICAgICAgICAgICAgLy92PWIudmVydGV4ODtcclxuICAgICAgICAgICAgdjF4ID0gdlsyMV07Ly92Lng7XHJcbiAgICAgICAgICAgIHYxeSA9IHZbMjJdOy8vdi55O1xyXG4gICAgICAgICAgICB2MXogPSB2WzIzXTsvL3YuejtcclxuICAgICAgICAgICAgLy92PWIudmVydGV4NDtcclxuICAgICAgICAgICAgdjJ4ID0gdls5XTsvL3YueDtcclxuICAgICAgICAgICAgdjJ5ID0gdlsxMF07Ly92Lnk7XHJcbiAgICAgICAgICAgIHYyeiA9IHZbMTFdOy8vdi56O1xyXG4gICAgICAgICAgICAvL3Y9Yi52ZXJ0ZXgzO1xyXG4gICAgICAgICAgICB2M3ggPSB2WzZdOy8vdi54O1xyXG4gICAgICAgICAgICB2M3kgPSB2WzddOy8vdi55O1xyXG4gICAgICAgICAgICB2M3ogPSB2WzhdOy8vdi56O1xyXG4gICAgICAgICAgICAvL3Y9Yi52ZXJ0ZXg3O1xyXG4gICAgICAgICAgICB2NHggPSB2WzE4XTsvL3YueDtcclxuICAgICAgICAgICAgdjR5ID0gdlsxOV07Ly92Lnk7XHJcbiAgICAgICAgICAgIHY0eiA9IHZbMjBdOy8vdi56O1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgNDpcclxuICAgICAgICAgICAgLy92PWIudmVydGV4NTtcclxuICAgICAgICAgICAgdjF4ID0gdlsxMl07Ly92Lng7XHJcbiAgICAgICAgICAgIHYxeSA9IHZbMTNdOy8vdi55O1xyXG4gICAgICAgICAgICB2MXogPSB2WzE0XTsvL3YuejtcclxuICAgICAgICAgICAgLy92PWIudmVydGV4NztcclxuICAgICAgICAgICAgdjJ4ID0gdlsxOF07Ly92Lng7XHJcbiAgICAgICAgICAgIHYyeSA9IHZbMTldOy8vdi55O1xyXG4gICAgICAgICAgICB2MnogPSB2WzIwXTsvL3YuejtcclxuICAgICAgICAgICAgLy92PWIudmVydGV4MztcclxuICAgICAgICAgICAgdjN4ID0gdls2XTsvL3YueDtcclxuICAgICAgICAgICAgdjN5ID0gdls3XTsvL3YueTtcclxuICAgICAgICAgICAgdjN6ID0gdls4XTsvL3YuejtcclxuICAgICAgICAgICAgLy92PWIudmVydGV4MTtcclxuICAgICAgICAgICAgdjR4ID0gdlswXTsvL3YueDtcclxuICAgICAgICAgICAgdjR5ID0gdlsxXTsvL3YueTtcclxuICAgICAgICAgICAgdjR6ID0gdlsyXTsvL3YuejtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICBjYXNlIDU6XHJcbiAgICAgICAgICAgIC8vdj1iLnZlcnRleDI7XHJcbiAgICAgICAgICAgIHYxeCA9IHZbM107Ly92Lng7XHJcbiAgICAgICAgICAgIHYxeSA9IHZbNF07Ly92Lnk7XHJcbiAgICAgICAgICAgIHYxeiA9IHZbNV07Ly92Lno7XHJcbiAgICAgICAgICAgIC8vdj1iLnZlcnRleDQ7XHJcbiAgICAgICAgICAgIHYyeCA9IHZbOV07Ly92Lng7XHJcbiAgICAgICAgICAgIHYyeSA9IHZbMTBdOy8vdi55O1xyXG4gICAgICAgICAgICB2MnogPSB2WzExXTsvL3YuejtcclxuICAgICAgICAgICAgLy92PWIudmVydGV4ODtcclxuICAgICAgICAgICAgdjN4ID0gdlsyMV07Ly92Lng7XHJcbiAgICAgICAgICAgIHYzeSA9IHZbMjJdOy8vdi55O1xyXG4gICAgICAgICAgICB2M3ogPSB2WzIzXTsvL3YuejtcclxuICAgICAgICAgICAgLy92PWIudmVydGV4NjtcclxuICAgICAgICAgICAgdjR4ID0gdlsxNV07Ly92Lng7XHJcbiAgICAgICAgICAgIHY0eSA9IHZbMTZdOy8vdi55O1xyXG4gICAgICAgICAgICB2NHogPSB2WzE3XTsvL3YuejtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBkID0gbnggKiAodjF4IC0gY2N4KSArIG55ICogKHYxeSAtIGNjeSkgKyBueiAqICh2MXogLSBjY3opO1xyXG4gICAgICAgIGlmIChwZCA8PSAwKSBtYW5pZm9sZC5hZGRQb2ludCh2MXgsIHYxeSwgdjF6LCAtbngsIC1ueSwgLW56LCBwZCwgdGhpcy5mbGlwKTtcclxuICAgICAgICBwZCA9IG54ICogKHYyeCAtIGNjeCkgKyBueSAqICh2MnkgLSBjY3kpICsgbnogKiAodjJ6IC0gY2N6KTtcclxuICAgICAgICBpZiAocGQgPD0gMCkgbWFuaWZvbGQuYWRkUG9pbnQodjJ4LCB2MnksIHYyeiwgLW54LCAtbnksIC1ueiwgcGQsIHRoaXMuZmxpcCk7XHJcbiAgICAgICAgcGQgPSBueCAqICh2M3ggLSBjY3gpICsgbnkgKiAodjN5IC0gY2N5KSArIG56ICogKHYzeiAtIGNjeik7XHJcbiAgICAgICAgaWYgKHBkIDw9IDApIG1hbmlmb2xkLmFkZFBvaW50KHYzeCwgdjN5LCB2M3osIC1ueCwgLW55LCAtbnosIHBkLCB0aGlzLmZsaXApO1xyXG4gICAgICAgIHBkID0gbnggKiAodjR4IC0gY2N4KSArIG55ICogKHY0eSAtIGNjeSkgKyBueiAqICh2NHogLSBjY3opO1xyXG4gICAgICAgIGlmIChwZCA8PSAwKSBtYW5pZm9sZC5hZGRQb2ludCh2NHgsIHY0eSwgdjR6LCAtbngsIC1ueSwgLW56LCBwZCwgdGhpcy5mbGlwKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBzd2l0Y2ggKHN0YXRlKSB7XHJcbiAgICAgICAgICBjYXNlIDE6XHJcbiAgICAgICAgICAgIGlmIChyaWdodDEpIHtcclxuICAgICAgICAgICAgICBjYnggPSBwYnggKyBkd3g7XHJcbiAgICAgICAgICAgICAgY2J5ID0gcGJ5ICsgZHd5O1xyXG4gICAgICAgICAgICAgIGNieiA9IHBieiArIGR3ejtcclxuICAgICAgICAgICAgICBueCA9IG53eDtcclxuICAgICAgICAgICAgICBueSA9IG53eTtcclxuICAgICAgICAgICAgICBueiA9IG53ejtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBjYnggPSBwYnggLSBkd3g7XHJcbiAgICAgICAgICAgICAgY2J5ID0gcGJ5IC0gZHd5O1xyXG4gICAgICAgICAgICAgIGNieiA9IHBieiAtIGR3ejtcclxuICAgICAgICAgICAgICBueCA9IC1ud3g7XHJcbiAgICAgICAgICAgICAgbnkgPSAtbnd5O1xyXG4gICAgICAgICAgICAgIG56ID0gLW53ejtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkaXIxeCA9IG5oeDtcclxuICAgICAgICAgICAgZGlyMXkgPSBuaHk7XHJcbiAgICAgICAgICAgIGRpcjF6ID0gbmh6O1xyXG4gICAgICAgICAgICBkaXIxbCA9IGJoO1xyXG4gICAgICAgICAgICBkaXIyeCA9IG5keDtcclxuICAgICAgICAgICAgZGlyMnkgPSBuZHk7XHJcbiAgICAgICAgICAgIGRpcjJ6ID0gbmR6O1xyXG4gICAgICAgICAgICBkaXIybCA9IGJkO1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIGNhc2UgMjpcclxuICAgICAgICAgICAgaWYgKHJpZ2h0Mikge1xyXG4gICAgICAgICAgICAgIGNieCA9IHBieCArIGRoeDtcclxuICAgICAgICAgICAgICBjYnkgPSBwYnkgKyBkaHk7XHJcbiAgICAgICAgICAgICAgY2J6ID0gcGJ6ICsgZGh6O1xyXG4gICAgICAgICAgICAgIG54ID0gbmh4O1xyXG4gICAgICAgICAgICAgIG55ID0gbmh5O1xyXG4gICAgICAgICAgICAgIG56ID0gbmh6O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGNieCA9IHBieCAtIGRoeDtcclxuICAgICAgICAgICAgICBjYnkgPSBwYnkgLSBkaHk7XHJcbiAgICAgICAgICAgICAgY2J6ID0gcGJ6IC0gZGh6O1xyXG4gICAgICAgICAgICAgIG54ID0gLW5oeDtcclxuICAgICAgICAgICAgICBueSA9IC1uaHk7XHJcbiAgICAgICAgICAgICAgbnogPSAtbmh6O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGRpcjF4ID0gbnd4O1xyXG4gICAgICAgICAgICBkaXIxeSA9IG53eTtcclxuICAgICAgICAgICAgZGlyMXogPSBud3o7XHJcbiAgICAgICAgICAgIGRpcjFsID0gYnc7XHJcbiAgICAgICAgICAgIGRpcjJ4ID0gbmR4O1xyXG4gICAgICAgICAgICBkaXIyeSA9IG5keTtcclxuICAgICAgICAgICAgZGlyMnogPSBuZHo7XHJcbiAgICAgICAgICAgIGRpcjJsID0gYmQ7XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSAzOlxyXG4gICAgICAgICAgICBpZiAocmlnaHQzKSB7XHJcbiAgICAgICAgICAgICAgY2J4ID0gcGJ4ICsgZGR4O1xyXG4gICAgICAgICAgICAgIGNieSA9IHBieSArIGRkeTtcclxuICAgICAgICAgICAgICBjYnogPSBwYnogKyBkZHo7XHJcbiAgICAgICAgICAgICAgbnggPSBuZHg7XHJcbiAgICAgICAgICAgICAgbnkgPSBuZHk7XHJcbiAgICAgICAgICAgICAgbnogPSBuZHo7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgY2J4ID0gcGJ4IC0gZGR4O1xyXG4gICAgICAgICAgICAgIGNieSA9IHBieSAtIGRkeTtcclxuICAgICAgICAgICAgICBjYnogPSBwYnogLSBkZHo7XHJcbiAgICAgICAgICAgICAgbnggPSAtbmR4O1xyXG4gICAgICAgICAgICAgIG55ID0gLW5keTtcclxuICAgICAgICAgICAgICBueiA9IC1uZHo7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGlyMXggPSBud3g7XHJcbiAgICAgICAgICAgIGRpcjF5ID0gbnd5O1xyXG4gICAgICAgICAgICBkaXIxeiA9IG53ejtcclxuICAgICAgICAgICAgZGlyMWwgPSBidztcclxuICAgICAgICAgICAgZGlyMnggPSBuaHg7XHJcbiAgICAgICAgICAgIGRpcjJ5ID0gbmh5O1xyXG4gICAgICAgICAgICBkaXIyeiA9IG5oejtcclxuICAgICAgICAgICAgZGlyMmwgPSBiaDtcclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvdCA9IG54ICogbmN4ICsgbnkgKiBuY3kgKyBueiAqIG5jejtcclxuICAgICAgICBpZiAoZG90IDwgMCkgbGVuID0gY2g7XHJcbiAgICAgICAgZWxzZSBsZW4gPSAtY2g7XHJcbiAgICAgICAgY2N4ID0gcGN4ICsgbGVuICogbmN4O1xyXG4gICAgICAgIGNjeSA9IHBjeSArIGxlbiAqIG5jeTtcclxuICAgICAgICBjY3ogPSBwY3ogKyBsZW4gKiBuY3o7XHJcbiAgICAgICAgaWYgKGRvdGMgPj0gMC45OTk5OTkpIHtcclxuICAgICAgICAgIHR4ID0gLW55O1xyXG4gICAgICAgICAgdHkgPSBuejtcclxuICAgICAgICAgIHR6ID0gbng7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHR4ID0gbng7XHJcbiAgICAgICAgICB0eSA9IG55O1xyXG4gICAgICAgICAgdHogPSBuejtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGVuID0gdHggKiBuY3ggKyB0eSAqIG5jeSArIHR6ICogbmN6O1xyXG4gICAgICAgIGR4ID0gbGVuICogbmN4IC0gdHg7XHJcbiAgICAgICAgZHkgPSBsZW4gKiBuY3kgLSB0eTtcclxuICAgICAgICBkeiA9IGxlbiAqIG5jeiAtIHR6O1xyXG4gICAgICAgIGxlbiA9IF9NYXRoLnNxcnQoZHggKiBkeCArIGR5ICogZHkgKyBkeiAqIGR6KTtcclxuICAgICAgICBpZiAobGVuID09IDApIHJldHVybjtcclxuICAgICAgICBsZW4gPSByIC8gbGVuO1xyXG4gICAgICAgIGR4ICo9IGxlbjtcclxuICAgICAgICBkeSAqPSBsZW47XHJcbiAgICAgICAgZHogKj0gbGVuO1xyXG4gICAgICAgIHR4ID0gY2N4ICsgZHg7XHJcbiAgICAgICAgdHkgPSBjY3kgKyBkeTtcclxuICAgICAgICB0eiA9IGNjeiArIGR6O1xyXG4gICAgICAgIGlmIChkb3QgPCAtMC45NiB8fCBkb3QgPiAwLjk2KSB7XHJcbiAgICAgICAgICByMDAgPSBuY3ggKiBuY3ggKiAxLjUgLSAwLjU7XHJcbiAgICAgICAgICByMDEgPSBuY3ggKiBuY3kgKiAxLjUgLSBuY3ogKiAwLjg2NjAyNTQwMztcclxuICAgICAgICAgIHIwMiA9IG5jeCAqIG5jeiAqIDEuNSArIG5jeSAqIDAuODY2MDI1NDAzO1xyXG4gICAgICAgICAgcjEwID0gbmN5ICogbmN4ICogMS41ICsgbmN6ICogMC44NjYwMjU0MDM7XHJcbiAgICAgICAgICByMTEgPSBuY3kgKiBuY3kgKiAxLjUgLSAwLjU7XHJcbiAgICAgICAgICByMTIgPSBuY3kgKiBuY3ogKiAxLjUgLSBuY3ggKiAwLjg2NjAyNTQwMztcclxuICAgICAgICAgIHIyMCA9IG5jeiAqIG5jeCAqIDEuNSAtIG5jeSAqIDAuODY2MDI1NDAzO1xyXG4gICAgICAgICAgcjIxID0gbmN6ICogbmN5ICogMS41ICsgbmN4ICogMC44NjYwMjU0MDM7XHJcbiAgICAgICAgICByMjIgPSBuY3ogKiBuY3ogKiAxLjUgLSAwLjU7XHJcbiAgICAgICAgICBweCA9IHR4O1xyXG4gICAgICAgICAgcHkgPSB0eTtcclxuICAgICAgICAgIHB6ID0gdHo7XHJcbiAgICAgICAgICBwZCA9IG54ICogKHB4IC0gY2J4KSArIG55ICogKHB5IC0gY2J5KSArIG56ICogKHB6IC0gY2J6KTtcclxuICAgICAgICAgIHR4ID0gcHggLSBwZCAqIG54IC0gY2J4O1xyXG4gICAgICAgICAgdHkgPSBweSAtIHBkICogbnkgLSBjYnk7XHJcbiAgICAgICAgICB0eiA9IHB6IC0gcGQgKiBueiAtIGNiejtcclxuICAgICAgICAgIHNkID0gZGlyMXggKiB0eCArIGRpcjF5ICogdHkgKyBkaXIxeiAqIHR6O1xyXG4gICAgICAgICAgZWQgPSBkaXIyeCAqIHR4ICsgZGlyMnkgKiB0eSArIGRpcjJ6ICogdHo7XHJcbiAgICAgICAgICBpZiAoc2QgPCAtZGlyMWwpIHNkID0gLWRpcjFsO1xyXG4gICAgICAgICAgZWxzZSBpZiAoc2QgPiBkaXIxbCkgc2QgPSBkaXIxbDtcclxuICAgICAgICAgIGlmIChlZCA8IC1kaXIybCkgZWQgPSAtZGlyMmw7XHJcbiAgICAgICAgICBlbHNlIGlmIChlZCA+IGRpcjJsKSBlZCA9IGRpcjJsO1xyXG4gICAgICAgICAgdHggPSBzZCAqIGRpcjF4ICsgZWQgKiBkaXIyeDtcclxuICAgICAgICAgIHR5ID0gc2QgKiBkaXIxeSArIGVkICogZGlyMnk7XHJcbiAgICAgICAgICB0eiA9IHNkICogZGlyMXogKyBlZCAqIGRpcjJ6O1xyXG4gICAgICAgICAgcHggPSBjYnggKyB0eDtcclxuICAgICAgICAgIHB5ID0gY2J5ICsgdHk7XHJcbiAgICAgICAgICBweiA9IGNieiArIHR6O1xyXG4gICAgICAgICAgbWFuaWZvbGQuYWRkUG9pbnQocHgsIHB5LCBweiwgbngsIG55LCBueiwgcGQsIHRoaXMuZmxpcCk7XHJcbiAgICAgICAgICBweCA9IGR4ICogcjAwICsgZHkgKiByMDEgKyBkeiAqIHIwMjtcclxuICAgICAgICAgIHB5ID0gZHggKiByMTAgKyBkeSAqIHIxMSArIGR6ICogcjEyO1xyXG4gICAgICAgICAgcHogPSBkeCAqIHIyMCArIGR5ICogcjIxICsgZHogKiByMjI7XHJcbiAgICAgICAgICBweCA9IChkeCA9IHB4KSArIGNjeDtcclxuICAgICAgICAgIHB5ID0gKGR5ID0gcHkpICsgY2N5O1xyXG4gICAgICAgICAgcHogPSAoZHogPSBweikgKyBjY3o7XHJcbiAgICAgICAgICBwZCA9IG54ICogKHB4IC0gY2J4KSArIG55ICogKHB5IC0gY2J5KSArIG56ICogKHB6IC0gY2J6KTtcclxuICAgICAgICAgIGlmIChwZCA8PSAwKSB7XHJcbiAgICAgICAgICAgIHR4ID0gcHggLSBwZCAqIG54IC0gY2J4O1xyXG4gICAgICAgICAgICB0eSA9IHB5IC0gcGQgKiBueSAtIGNieTtcclxuICAgICAgICAgICAgdHogPSBweiAtIHBkICogbnogLSBjYno7XHJcbiAgICAgICAgICAgIHNkID0gZGlyMXggKiB0eCArIGRpcjF5ICogdHkgKyBkaXIxeiAqIHR6O1xyXG4gICAgICAgICAgICBlZCA9IGRpcjJ4ICogdHggKyBkaXIyeSAqIHR5ICsgZGlyMnogKiB0ejtcclxuICAgICAgICAgICAgaWYgKHNkIDwgLWRpcjFsKSBzZCA9IC1kaXIxbDtcclxuICAgICAgICAgICAgZWxzZSBpZiAoc2QgPiBkaXIxbCkgc2QgPSBkaXIxbDtcclxuICAgICAgICAgICAgaWYgKGVkIDwgLWRpcjJsKSBlZCA9IC1kaXIybDtcclxuICAgICAgICAgICAgZWxzZSBpZiAoZWQgPiBkaXIybCkgZWQgPSBkaXIybDtcclxuICAgICAgICAgICAgdHggPSBzZCAqIGRpcjF4ICsgZWQgKiBkaXIyeDtcclxuICAgICAgICAgICAgdHkgPSBzZCAqIGRpcjF5ICsgZWQgKiBkaXIyeTtcclxuICAgICAgICAgICAgdHogPSBzZCAqIGRpcjF6ICsgZWQgKiBkaXIyejtcclxuICAgICAgICAgICAgcHggPSBjYnggKyB0eDtcclxuICAgICAgICAgICAgcHkgPSBjYnkgKyB0eTtcclxuICAgICAgICAgICAgcHogPSBjYnogKyB0ejtcclxuICAgICAgICAgICAgLy9tYW5pZm9sZC5hZGRQb2ludChweCxweSxweixueCxueSxueixwZCxiLGMsMiwwLGZhbHNlKTtcclxuICAgICAgICAgICAgbWFuaWZvbGQuYWRkUG9pbnQocHgsIHB5LCBweiwgbngsIG55LCBueiwgcGQsIHRoaXMuZmxpcCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBweCA9IGR4ICogcjAwICsgZHkgKiByMDEgKyBkeiAqIHIwMjtcclxuICAgICAgICAgIHB5ID0gZHggKiByMTAgKyBkeSAqIHIxMSArIGR6ICogcjEyO1xyXG4gICAgICAgICAgcHogPSBkeCAqIHIyMCArIGR5ICogcjIxICsgZHogKiByMjI7XHJcbiAgICAgICAgICBweCA9IChkeCA9IHB4KSArIGNjeDtcclxuICAgICAgICAgIHB5ID0gKGR5ID0gcHkpICsgY2N5O1xyXG4gICAgICAgICAgcHogPSAoZHogPSBweikgKyBjY3o7XHJcbiAgICAgICAgICBwZCA9IG54ICogKHB4IC0gY2J4KSArIG55ICogKHB5IC0gY2J5KSArIG56ICogKHB6IC0gY2J6KTtcclxuICAgICAgICAgIGlmIChwZCA8PSAwKSB7XHJcbiAgICAgICAgICAgIHR4ID0gcHggLSBwZCAqIG54IC0gY2J4O1xyXG4gICAgICAgICAgICB0eSA9IHB5IC0gcGQgKiBueSAtIGNieTtcclxuICAgICAgICAgICAgdHogPSBweiAtIHBkICogbnogLSBjYno7XHJcbiAgICAgICAgICAgIHNkID0gZGlyMXggKiB0eCArIGRpcjF5ICogdHkgKyBkaXIxeiAqIHR6O1xyXG4gICAgICAgICAgICBlZCA9IGRpcjJ4ICogdHggKyBkaXIyeSAqIHR5ICsgZGlyMnogKiB0ejtcclxuICAgICAgICAgICAgaWYgKHNkIDwgLWRpcjFsKSBzZCA9IC1kaXIxbDtcclxuICAgICAgICAgICAgZWxzZSBpZiAoc2QgPiBkaXIxbCkgc2QgPSBkaXIxbDtcclxuICAgICAgICAgICAgaWYgKGVkIDwgLWRpcjJsKSBlZCA9IC1kaXIybDtcclxuICAgICAgICAgICAgZWxzZSBpZiAoZWQgPiBkaXIybCkgZWQgPSBkaXIybDtcclxuICAgICAgICAgICAgdHggPSBzZCAqIGRpcjF4ICsgZWQgKiBkaXIyeDtcclxuICAgICAgICAgICAgdHkgPSBzZCAqIGRpcjF5ICsgZWQgKiBkaXIyeTtcclxuICAgICAgICAgICAgdHogPSBzZCAqIGRpcjF6ICsgZWQgKiBkaXIyejtcclxuICAgICAgICAgICAgcHggPSBjYnggKyB0eDtcclxuICAgICAgICAgICAgcHkgPSBjYnkgKyB0eTtcclxuICAgICAgICAgICAgcHogPSBjYnogKyB0ejtcclxuICAgICAgICAgICAgLy9tYW5pZm9sZC5hZGRQb2ludChweCxweSxweixueCxueSxueixwZCxiLGMsMywwLGZhbHNlKTtcclxuICAgICAgICAgICAgbWFuaWZvbGQuYWRkUG9pbnQocHgsIHB5LCBweiwgbngsIG55LCBueiwgcGQsIHRoaXMuZmxpcCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHN4ID0gdHg7XHJcbiAgICAgICAgICBzeSA9IHR5O1xyXG4gICAgICAgICAgc3ogPSB0ejtcclxuICAgICAgICAgIHNkID0gbnggKiAoc3ggLSBjYngpICsgbnkgKiAoc3kgLSBjYnkpICsgbnogKiAoc3ogLSBjYnopO1xyXG4gICAgICAgICAgc3ggLT0gc2QgKiBueDtcclxuICAgICAgICAgIHN5IC09IHNkICogbnk7XHJcbiAgICAgICAgICBzeiAtPSBzZCAqIG56O1xyXG4gICAgICAgICAgaWYgKGRvdCA+IDApIHtcclxuICAgICAgICAgICAgZXggPSB0eCArIGRjeCAqIDI7XHJcbiAgICAgICAgICAgIGV5ID0gdHkgKyBkY3kgKiAyO1xyXG4gICAgICAgICAgICBleiA9IHR6ICsgZGN6ICogMjtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGV4ID0gdHggLSBkY3ggKiAyO1xyXG4gICAgICAgICAgICBleSA9IHR5IC0gZGN5ICogMjtcclxuICAgICAgICAgICAgZXogPSB0eiAtIGRjeiAqIDI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlZCA9IG54ICogKGV4IC0gY2J4KSArIG55ICogKGV5IC0gY2J5KSArIG56ICogKGV6IC0gY2J6KTtcclxuICAgICAgICAgIGV4IC09IGVkICogbng7XHJcbiAgICAgICAgICBleSAtPSBlZCAqIG55O1xyXG4gICAgICAgICAgZXogLT0gZWQgKiBuejtcclxuICAgICAgICAgIGQxeCA9IHN4IC0gY2J4O1xyXG4gICAgICAgICAgZDF5ID0gc3kgLSBjYnk7XHJcbiAgICAgICAgICBkMXogPSBzeiAtIGNiejtcclxuICAgICAgICAgIGQyeCA9IGV4IC0gY2J4O1xyXG4gICAgICAgICAgZDJ5ID0gZXkgLSBjYnk7XHJcbiAgICAgICAgICBkMnogPSBleiAtIGNiejtcclxuICAgICAgICAgIHR4ID0gZXggLSBzeDtcclxuICAgICAgICAgIHR5ID0gZXkgLSBzeTtcclxuICAgICAgICAgIHR6ID0gZXogLSBzejtcclxuICAgICAgICAgIHRkID0gZWQgLSBzZDtcclxuICAgICAgICAgIGRvdHcgPSBkMXggKiBkaXIxeCArIGQxeSAqIGRpcjF5ICsgZDF6ICogZGlyMXo7XHJcbiAgICAgICAgICBkb3RoID0gZDJ4ICogZGlyMXggKyBkMnkgKiBkaXIxeSArIGQyeiAqIGRpcjF6O1xyXG4gICAgICAgICAgZG90MSA9IGRvdHcgLSBkaXIxbDtcclxuICAgICAgICAgIGRvdDIgPSBkb3RoIC0gZGlyMWw7XHJcbiAgICAgICAgICBpZiAoZG90MSA+IDApIHtcclxuICAgICAgICAgICAgaWYgKGRvdDIgPiAwKSByZXR1cm47XHJcbiAgICAgICAgICAgIHQxID0gZG90MSAvIChkb3QxIC0gZG90Mik7XHJcbiAgICAgICAgICAgIHN4ID0gc3ggKyB0eCAqIHQxO1xyXG4gICAgICAgICAgICBzeSA9IHN5ICsgdHkgKiB0MTtcclxuICAgICAgICAgICAgc3ogPSBzeiArIHR6ICogdDE7XHJcbiAgICAgICAgICAgIHNkID0gc2QgKyB0ZCAqIHQxO1xyXG4gICAgICAgICAgICBkMXggPSBzeCAtIGNieDtcclxuICAgICAgICAgICAgZDF5ID0gc3kgLSBjYnk7XHJcbiAgICAgICAgICAgIGQxeiA9IHN6IC0gY2J6O1xyXG4gICAgICAgICAgICBkb3R3ID0gZDF4ICogZGlyMXggKyBkMXkgKiBkaXIxeSArIGQxeiAqIGRpcjF6O1xyXG4gICAgICAgICAgICB0eCA9IGV4IC0gc3g7XHJcbiAgICAgICAgICAgIHR5ID0gZXkgLSBzeTtcclxuICAgICAgICAgICAgdHogPSBleiAtIHN6O1xyXG4gICAgICAgICAgICB0ZCA9IGVkIC0gc2Q7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKGRvdDIgPiAwKSB7XHJcbiAgICAgICAgICAgIHQxID0gZG90MSAvIChkb3QxIC0gZG90Mik7XHJcbiAgICAgICAgICAgIGV4ID0gc3ggKyB0eCAqIHQxO1xyXG4gICAgICAgICAgICBleSA9IHN5ICsgdHkgKiB0MTtcclxuICAgICAgICAgICAgZXogPSBzeiArIHR6ICogdDE7XHJcbiAgICAgICAgICAgIGVkID0gc2QgKyB0ZCAqIHQxO1xyXG4gICAgICAgICAgICBkMnggPSBleCAtIGNieDtcclxuICAgICAgICAgICAgZDJ5ID0gZXkgLSBjYnk7XHJcbiAgICAgICAgICAgIGQyeiA9IGV6IC0gY2J6O1xyXG4gICAgICAgICAgICBkb3RoID0gZDJ4ICogZGlyMXggKyBkMnkgKiBkaXIxeSArIGQyeiAqIGRpcjF6O1xyXG4gICAgICAgICAgICB0eCA9IGV4IC0gc3g7XHJcbiAgICAgICAgICAgIHR5ID0gZXkgLSBzeTtcclxuICAgICAgICAgICAgdHogPSBleiAtIHN6O1xyXG4gICAgICAgICAgICB0ZCA9IGVkIC0gc2Q7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBkb3QxID0gZG90dyArIGRpcjFsO1xyXG4gICAgICAgICAgZG90MiA9IGRvdGggKyBkaXIxbDtcclxuICAgICAgICAgIGlmIChkb3QxIDwgMCkge1xyXG4gICAgICAgICAgICBpZiAoZG90MiA8IDApIHJldHVybjtcclxuICAgICAgICAgICAgdDEgPSBkb3QxIC8gKGRvdDEgLSBkb3QyKTtcclxuICAgICAgICAgICAgc3ggPSBzeCArIHR4ICogdDE7XHJcbiAgICAgICAgICAgIHN5ID0gc3kgKyB0eSAqIHQxO1xyXG4gICAgICAgICAgICBzeiA9IHN6ICsgdHogKiB0MTtcclxuICAgICAgICAgICAgc2QgPSBzZCArIHRkICogdDE7XHJcbiAgICAgICAgICAgIGQxeCA9IHN4IC0gY2J4O1xyXG4gICAgICAgICAgICBkMXkgPSBzeSAtIGNieTtcclxuICAgICAgICAgICAgZDF6ID0gc3ogLSBjYno7XHJcbiAgICAgICAgICAgIHR4ID0gZXggLSBzeDtcclxuICAgICAgICAgICAgdHkgPSBleSAtIHN5O1xyXG4gICAgICAgICAgICB0eiA9IGV6IC0gc3o7XHJcbiAgICAgICAgICAgIHRkID0gZWQgLSBzZDtcclxuICAgICAgICAgIH0gZWxzZSBpZiAoZG90MiA8IDApIHtcclxuICAgICAgICAgICAgdDEgPSBkb3QxIC8gKGRvdDEgLSBkb3QyKTtcclxuICAgICAgICAgICAgZXggPSBzeCArIHR4ICogdDE7XHJcbiAgICAgICAgICAgIGV5ID0gc3kgKyB0eSAqIHQxO1xyXG4gICAgICAgICAgICBleiA9IHN6ICsgdHogKiB0MTtcclxuICAgICAgICAgICAgZWQgPSBzZCArIHRkICogdDE7XHJcbiAgICAgICAgICAgIGQyeCA9IGV4IC0gY2J4O1xyXG4gICAgICAgICAgICBkMnkgPSBleSAtIGNieTtcclxuICAgICAgICAgICAgZDJ6ID0gZXogLSBjYno7XHJcbiAgICAgICAgICAgIHR4ID0gZXggLSBzeDtcclxuICAgICAgICAgICAgdHkgPSBleSAtIHN5O1xyXG4gICAgICAgICAgICB0eiA9IGV6IC0gc3o7XHJcbiAgICAgICAgICAgIHRkID0gZWQgLSBzZDtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGRvdHcgPSBkMXggKiBkaXIyeCArIGQxeSAqIGRpcjJ5ICsgZDF6ICogZGlyMno7XHJcbiAgICAgICAgICBkb3RoID0gZDJ4ICogZGlyMnggKyBkMnkgKiBkaXIyeSArIGQyeiAqIGRpcjJ6O1xyXG4gICAgICAgICAgZG90MSA9IGRvdHcgLSBkaXIybDtcclxuICAgICAgICAgIGRvdDIgPSBkb3RoIC0gZGlyMmw7XHJcbiAgICAgICAgICBpZiAoZG90MSA+IDApIHtcclxuICAgICAgICAgICAgaWYgKGRvdDIgPiAwKSByZXR1cm47XHJcbiAgICAgICAgICAgIHQxID0gZG90MSAvIChkb3QxIC0gZG90Mik7XHJcbiAgICAgICAgICAgIHN4ID0gc3ggKyB0eCAqIHQxO1xyXG4gICAgICAgICAgICBzeSA9IHN5ICsgdHkgKiB0MTtcclxuICAgICAgICAgICAgc3ogPSBzeiArIHR6ICogdDE7XHJcbiAgICAgICAgICAgIHNkID0gc2QgKyB0ZCAqIHQxO1xyXG4gICAgICAgICAgICBkMXggPSBzeCAtIGNieDtcclxuICAgICAgICAgICAgZDF5ID0gc3kgLSBjYnk7XHJcbiAgICAgICAgICAgIGQxeiA9IHN6IC0gY2J6O1xyXG4gICAgICAgICAgICBkb3R3ID0gZDF4ICogZGlyMnggKyBkMXkgKiBkaXIyeSArIGQxeiAqIGRpcjJ6O1xyXG4gICAgICAgICAgICB0eCA9IGV4IC0gc3g7XHJcbiAgICAgICAgICAgIHR5ID0gZXkgLSBzeTtcclxuICAgICAgICAgICAgdHogPSBleiAtIHN6O1xyXG4gICAgICAgICAgICB0ZCA9IGVkIC0gc2Q7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKGRvdDIgPiAwKSB7XHJcbiAgICAgICAgICAgIHQxID0gZG90MSAvIChkb3QxIC0gZG90Mik7XHJcbiAgICAgICAgICAgIGV4ID0gc3ggKyB0eCAqIHQxO1xyXG4gICAgICAgICAgICBleSA9IHN5ICsgdHkgKiB0MTtcclxuICAgICAgICAgICAgZXogPSBzeiArIHR6ICogdDE7XHJcbiAgICAgICAgICAgIGVkID0gc2QgKyB0ZCAqIHQxO1xyXG4gICAgICAgICAgICBkMnggPSBleCAtIGNieDtcclxuICAgICAgICAgICAgZDJ5ID0gZXkgLSBjYnk7XHJcbiAgICAgICAgICAgIGQyeiA9IGV6IC0gY2J6O1xyXG4gICAgICAgICAgICBkb3RoID0gZDJ4ICogZGlyMnggKyBkMnkgKiBkaXIyeSArIGQyeiAqIGRpcjJ6O1xyXG4gICAgICAgICAgICB0eCA9IGV4IC0gc3g7XHJcbiAgICAgICAgICAgIHR5ID0gZXkgLSBzeTtcclxuICAgICAgICAgICAgdHogPSBleiAtIHN6O1xyXG4gICAgICAgICAgICB0ZCA9IGVkIC0gc2Q7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBkb3QxID0gZG90dyArIGRpcjJsO1xyXG4gICAgICAgICAgZG90MiA9IGRvdGggKyBkaXIybDtcclxuICAgICAgICAgIGlmIChkb3QxIDwgMCkge1xyXG4gICAgICAgICAgICBpZiAoZG90MiA8IDApIHJldHVybjtcclxuICAgICAgICAgICAgdDEgPSBkb3QxIC8gKGRvdDEgLSBkb3QyKTtcclxuICAgICAgICAgICAgc3ggPSBzeCArIHR4ICogdDE7XHJcbiAgICAgICAgICAgIHN5ID0gc3kgKyB0eSAqIHQxO1xyXG4gICAgICAgICAgICBzeiA9IHN6ICsgdHogKiB0MTtcclxuICAgICAgICAgICAgc2QgPSBzZCArIHRkICogdDE7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKGRvdDIgPCAwKSB7XHJcbiAgICAgICAgICAgIHQxID0gZG90MSAvIChkb3QxIC0gZG90Mik7XHJcbiAgICAgICAgICAgIGV4ID0gc3ggKyB0eCAqIHQxO1xyXG4gICAgICAgICAgICBleSA9IHN5ICsgdHkgKiB0MTtcclxuICAgICAgICAgICAgZXogPSBzeiArIHR6ICogdDE7XHJcbiAgICAgICAgICAgIGVkID0gc2QgKyB0ZCAqIHQxO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKHNkIDwgMCkge1xyXG4gICAgICAgICAgICAvL21hbmlmb2xkLmFkZFBvaW50KHN4LHN5LHN6LG54LG55LG56LHNkLGIsYywxLDAsZmFsc2UpO1xyXG4gICAgICAgICAgICBtYW5pZm9sZC5hZGRQb2ludChzeCwgc3ksIHN6LCBueCwgbnksIG56LCBzZCwgdGhpcy5mbGlwKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmIChlZCA8IDApIHtcclxuICAgICAgICAgICAgLy9tYW5pZm9sZC5hZGRQb2ludChleCxleSxleixueCxueSxueixlZCxiLGMsNCwwLGZhbHNlKTtcclxuICAgICAgICAgICAgbWFuaWZvbGQuYWRkUG9pbnQoZXgsIGV5LCBleiwgbngsIG55LCBueiwgZWQsIHRoaXMuZmxpcCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gQ3lsaW5kZXJDeWxpbmRlckNvbGxpc2lvbkRldGVjdG9yKCkge1xyXG5cclxuICAgIENvbGxpc2lvbkRldGVjdG9yLmNhbGwodGhpcyk7XHJcblxyXG4gIH1cclxuICBDeWxpbmRlckN5bGluZGVyQ29sbGlzaW9uRGV0ZWN0b3IucHJvdG90eXBlID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKENvbGxpc2lvbkRldGVjdG9yLnByb3RvdHlwZSksIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcjogQ3lsaW5kZXJDeWxpbmRlckNvbGxpc2lvbkRldGVjdG9yLFxyXG5cclxuXHJcbiAgICBnZXRTZXA6IGZ1bmN0aW9uIChjMSwgYzIsIHNlcCwgcG9zLCBkZXApIHtcclxuXHJcbiAgICAgIHZhciB0MXg7XHJcbiAgICAgIHZhciB0MXk7XHJcbiAgICAgIHZhciB0MXo7XHJcbiAgICAgIHZhciB0Mng7XHJcbiAgICAgIHZhciB0Mnk7XHJcbiAgICAgIHZhciB0Mno7XHJcbiAgICAgIHZhciBzdXAgPSBuZXcgVmVjMygpO1xyXG4gICAgICB2YXIgbGVuO1xyXG4gICAgICB2YXIgcDF4O1xyXG4gICAgICB2YXIgcDF5O1xyXG4gICAgICB2YXIgcDF6O1xyXG4gICAgICB2YXIgcDJ4O1xyXG4gICAgICB2YXIgcDJ5O1xyXG4gICAgICB2YXIgcDJ6O1xyXG4gICAgICB2YXIgdjAxeCA9IGMxLnBvc2l0aW9uLng7XHJcbiAgICAgIHZhciB2MDF5ID0gYzEucG9zaXRpb24ueTtcclxuICAgICAgdmFyIHYwMXogPSBjMS5wb3NpdGlvbi56O1xyXG4gICAgICB2YXIgdjAyeCA9IGMyLnBvc2l0aW9uLng7XHJcbiAgICAgIHZhciB2MDJ5ID0gYzIucG9zaXRpb24ueTtcclxuICAgICAgdmFyIHYwMnogPSBjMi5wb3NpdGlvbi56O1xyXG4gICAgICB2YXIgdjB4ID0gdjAyeCAtIHYwMXg7XHJcbiAgICAgIHZhciB2MHkgPSB2MDJ5IC0gdjAxeTtcclxuICAgICAgdmFyIHYweiA9IHYwMnogLSB2MDF6O1xyXG4gICAgICBpZiAodjB4ICogdjB4ICsgdjB5ICogdjB5ICsgdjB6ICogdjB6ID09IDApIHYweSA9IDAuMDAxO1xyXG4gICAgICB2YXIgbnggPSAtdjB4O1xyXG4gICAgICB2YXIgbnkgPSAtdjB5O1xyXG4gICAgICB2YXIgbnogPSAtdjB6O1xyXG4gICAgICB0aGlzLnN1cHBvcnRQb2ludChjMSwgLW54LCAtbnksIC1ueiwgc3VwKTtcclxuICAgICAgdmFyIHYxMXggPSBzdXAueDtcclxuICAgICAgdmFyIHYxMXkgPSBzdXAueTtcclxuICAgICAgdmFyIHYxMXogPSBzdXAuejtcclxuICAgICAgdGhpcy5zdXBwb3J0UG9pbnQoYzIsIG54LCBueSwgbnosIHN1cCk7XHJcbiAgICAgIHZhciB2MTJ4ID0gc3VwLng7XHJcbiAgICAgIHZhciB2MTJ5ID0gc3VwLnk7XHJcbiAgICAgIHZhciB2MTJ6ID0gc3VwLno7XHJcbiAgICAgIHZhciB2MXggPSB2MTJ4IC0gdjExeDtcclxuICAgICAgdmFyIHYxeSA9IHYxMnkgLSB2MTF5O1xyXG4gICAgICB2YXIgdjF6ID0gdjEyeiAtIHYxMXo7XHJcbiAgICAgIGlmICh2MXggKiBueCArIHYxeSAqIG55ICsgdjF6ICogbnogPD0gMCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgICBueCA9IHYxeSAqIHYweiAtIHYxeiAqIHYweTtcclxuICAgICAgbnkgPSB2MXogKiB2MHggLSB2MXggKiB2MHo7XHJcbiAgICAgIG56ID0gdjF4ICogdjB5IC0gdjF5ICogdjB4O1xyXG4gICAgICBpZiAobnggKiBueCArIG55ICogbnkgKyBueiAqIG56ID09IDApIHtcclxuICAgICAgICBzZXAuc2V0KHYxeCAtIHYweCwgdjF5IC0gdjB5LCB2MXogLSB2MHopLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgIHBvcy5zZXQoKHYxMXggKyB2MTJ4KSAqIDAuNSwgKHYxMXkgKyB2MTJ5KSAqIDAuNSwgKHYxMXogKyB2MTJ6KSAqIDAuNSk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5zdXBwb3J0UG9pbnQoYzEsIC1ueCwgLW55LCAtbnosIHN1cCk7XHJcbiAgICAgIHZhciB2MjF4ID0gc3VwLng7XHJcbiAgICAgIHZhciB2MjF5ID0gc3VwLnk7XHJcbiAgICAgIHZhciB2MjF6ID0gc3VwLno7XHJcbiAgICAgIHRoaXMuc3VwcG9ydFBvaW50KGMyLCBueCwgbnksIG56LCBzdXApO1xyXG4gICAgICB2YXIgdjIyeCA9IHN1cC54O1xyXG4gICAgICB2YXIgdjIyeSA9IHN1cC55O1xyXG4gICAgICB2YXIgdjIyeiA9IHN1cC56O1xyXG4gICAgICB2YXIgdjJ4ID0gdjIyeCAtIHYyMXg7XHJcbiAgICAgIHZhciB2MnkgPSB2MjJ5IC0gdjIxeTtcclxuICAgICAgdmFyIHYyeiA9IHYyMnogLSB2MjF6O1xyXG4gICAgICBpZiAodjJ4ICogbnggKyB2MnkgKiBueSArIHYyeiAqIG56IDw9IDApIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgIH1cclxuICAgICAgdDF4ID0gdjF4IC0gdjB4O1xyXG4gICAgICB0MXkgPSB2MXkgLSB2MHk7XHJcbiAgICAgIHQxeiA9IHYxeiAtIHYwejtcclxuICAgICAgdDJ4ID0gdjJ4IC0gdjB4O1xyXG4gICAgICB0MnkgPSB2MnkgLSB2MHk7XHJcbiAgICAgIHQyeiA9IHYyeiAtIHYwejtcclxuICAgICAgbnggPSB0MXkgKiB0MnogLSB0MXogKiB0Mnk7XHJcbiAgICAgIG55ID0gdDF6ICogdDJ4IC0gdDF4ICogdDJ6O1xyXG4gICAgICBueiA9IHQxeCAqIHQyeSAtIHQxeSAqIHQyeDtcclxuICAgICAgaWYgKG54ICogdjB4ICsgbnkgKiB2MHkgKyBueiAqIHYweiA+IDApIHtcclxuICAgICAgICB0MXggPSB2MXg7XHJcbiAgICAgICAgdDF5ID0gdjF5O1xyXG4gICAgICAgIHQxeiA9IHYxejtcclxuICAgICAgICB2MXggPSB2Mng7XHJcbiAgICAgICAgdjF5ID0gdjJ5O1xyXG4gICAgICAgIHYxeiA9IHYyejtcclxuICAgICAgICB2MnggPSB0MXg7XHJcbiAgICAgICAgdjJ5ID0gdDF5O1xyXG4gICAgICAgIHYyeiA9IHQxejtcclxuICAgICAgICB0MXggPSB2MTF4O1xyXG4gICAgICAgIHQxeSA9IHYxMXk7XHJcbiAgICAgICAgdDF6ID0gdjExejtcclxuICAgICAgICB2MTF4ID0gdjIxeDtcclxuICAgICAgICB2MTF5ID0gdjIxeTtcclxuICAgICAgICB2MTF6ID0gdjIxejtcclxuICAgICAgICB2MjF4ID0gdDF4O1xyXG4gICAgICAgIHYyMXkgPSB0MXk7XHJcbiAgICAgICAgdjIxeiA9IHQxejtcclxuICAgICAgICB0MXggPSB2MTJ4O1xyXG4gICAgICAgIHQxeSA9IHYxMnk7XHJcbiAgICAgICAgdDF6ID0gdjEyejtcclxuICAgICAgICB2MTJ4ID0gdjIyeDtcclxuICAgICAgICB2MTJ5ID0gdjIyeTtcclxuICAgICAgICB2MTJ6ID0gdjIyejtcclxuICAgICAgICB2MjJ4ID0gdDF4O1xyXG4gICAgICAgIHYyMnkgPSB0MXk7XHJcbiAgICAgICAgdjIyeiA9IHQxejtcclxuICAgICAgICBueCA9IC1ueDtcclxuICAgICAgICBueSA9IC1ueTtcclxuICAgICAgICBueiA9IC1uejtcclxuICAgICAgfVxyXG4gICAgICB2YXIgaXRlcmF0aW9ucyA9IDA7XHJcbiAgICAgIHdoaWxlICh0cnVlKSB7XHJcbiAgICAgICAgaWYgKCsraXRlcmF0aW9ucyA+IDEwMCkge1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnN1cHBvcnRQb2ludChjMSwgLW54LCAtbnksIC1ueiwgc3VwKTtcclxuICAgICAgICB2YXIgdjMxeCA9IHN1cC54O1xyXG4gICAgICAgIHZhciB2MzF5ID0gc3VwLnk7XHJcbiAgICAgICAgdmFyIHYzMXogPSBzdXAuejtcclxuICAgICAgICB0aGlzLnN1cHBvcnRQb2ludChjMiwgbngsIG55LCBueiwgc3VwKTtcclxuICAgICAgICB2YXIgdjMyeCA9IHN1cC54O1xyXG4gICAgICAgIHZhciB2MzJ5ID0gc3VwLnk7XHJcbiAgICAgICAgdmFyIHYzMnogPSBzdXAuejtcclxuICAgICAgICB2YXIgdjN4ID0gdjMyeCAtIHYzMXg7XHJcbiAgICAgICAgdmFyIHYzeSA9IHYzMnkgLSB2MzF5O1xyXG4gICAgICAgIHZhciB2M3ogPSB2MzJ6IC0gdjMxejtcclxuICAgICAgICBpZiAodjN4ICogbnggKyB2M3kgKiBueSArIHYzeiAqIG56IDw9IDApIHtcclxuICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCh2MXkgKiB2M3ogLSB2MXogKiB2M3kpICogdjB4ICsgKHYxeiAqIHYzeCAtIHYxeCAqIHYzeikgKiB2MHkgKyAodjF4ICogdjN5IC0gdjF5ICogdjN4KSAqIHYweiA8IDApIHtcclxuICAgICAgICAgIHYyeCA9IHYzeDtcclxuICAgICAgICAgIHYyeSA9IHYzeTtcclxuICAgICAgICAgIHYyeiA9IHYzejtcclxuICAgICAgICAgIHYyMXggPSB2MzF4O1xyXG4gICAgICAgICAgdjIxeSA9IHYzMXk7XHJcbiAgICAgICAgICB2MjF6ID0gdjMxejtcclxuICAgICAgICAgIHYyMnggPSB2MzJ4O1xyXG4gICAgICAgICAgdjIyeSA9IHYzMnk7XHJcbiAgICAgICAgICB2MjJ6ID0gdjMyejtcclxuICAgICAgICAgIHQxeCA9IHYxeCAtIHYweDtcclxuICAgICAgICAgIHQxeSA9IHYxeSAtIHYweTtcclxuICAgICAgICAgIHQxeiA9IHYxeiAtIHYwejtcclxuICAgICAgICAgIHQyeCA9IHYzeCAtIHYweDtcclxuICAgICAgICAgIHQyeSA9IHYzeSAtIHYweTtcclxuICAgICAgICAgIHQyeiA9IHYzeiAtIHYwejtcclxuICAgICAgICAgIG54ID0gdDF5ICogdDJ6IC0gdDF6ICogdDJ5O1xyXG4gICAgICAgICAgbnkgPSB0MXogKiB0MnggLSB0MXggKiB0Mno7XHJcbiAgICAgICAgICBueiA9IHQxeCAqIHQyeSAtIHQxeSAqIHQyeDtcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoKHYzeSAqIHYyeiAtIHYzeiAqIHYyeSkgKiB2MHggKyAodjN6ICogdjJ4IC0gdjN4ICogdjJ6KSAqIHYweSArICh2M3ggKiB2MnkgLSB2M3kgKiB2MngpICogdjB6IDwgMCkge1xyXG4gICAgICAgICAgdjF4ID0gdjN4O1xyXG4gICAgICAgICAgdjF5ID0gdjN5O1xyXG4gICAgICAgICAgdjF6ID0gdjN6O1xyXG4gICAgICAgICAgdjExeCA9IHYzMXg7XHJcbiAgICAgICAgICB2MTF5ID0gdjMxeTtcclxuICAgICAgICAgIHYxMXogPSB2MzF6O1xyXG4gICAgICAgICAgdjEyeCA9IHYzMng7XHJcbiAgICAgICAgICB2MTJ5ID0gdjMyeTtcclxuICAgICAgICAgIHYxMnogPSB2MzJ6O1xyXG4gICAgICAgICAgdDF4ID0gdjN4IC0gdjB4O1xyXG4gICAgICAgICAgdDF5ID0gdjN5IC0gdjB5O1xyXG4gICAgICAgICAgdDF6ID0gdjN6IC0gdjB6O1xyXG4gICAgICAgICAgdDJ4ID0gdjJ4IC0gdjB4O1xyXG4gICAgICAgICAgdDJ5ID0gdjJ5IC0gdjB5O1xyXG4gICAgICAgICAgdDJ6ID0gdjJ6IC0gdjB6O1xyXG4gICAgICAgICAgbnggPSB0MXkgKiB0MnogLSB0MXogKiB0Mnk7XHJcbiAgICAgICAgICBueSA9IHQxeiAqIHQyeCAtIHQxeCAqIHQyejtcclxuICAgICAgICAgIG56ID0gdDF4ICogdDJ5IC0gdDF5ICogdDJ4O1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBoaXQgPSBmYWxzZTtcclxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgdDF4ID0gdjJ4IC0gdjF4O1xyXG4gICAgICAgICAgdDF5ID0gdjJ5IC0gdjF5O1xyXG4gICAgICAgICAgdDF6ID0gdjJ6IC0gdjF6O1xyXG4gICAgICAgICAgdDJ4ID0gdjN4IC0gdjF4O1xyXG4gICAgICAgICAgdDJ5ID0gdjN5IC0gdjF5O1xyXG4gICAgICAgICAgdDJ6ID0gdjN6IC0gdjF6O1xyXG4gICAgICAgICAgbnggPSB0MXkgKiB0MnogLSB0MXogKiB0Mnk7XHJcbiAgICAgICAgICBueSA9IHQxeiAqIHQyeCAtIHQxeCAqIHQyejtcclxuICAgICAgICAgIG56ID0gdDF4ICogdDJ5IC0gdDF5ICogdDJ4O1xyXG4gICAgICAgICAgbGVuID0gMSAvIF9NYXRoLnNxcnQobnggKiBueCArIG55ICogbnkgKyBueiAqIG56KTtcclxuICAgICAgICAgIG54ICo9IGxlbjtcclxuICAgICAgICAgIG55ICo9IGxlbjtcclxuICAgICAgICAgIG56ICo9IGxlbjtcclxuICAgICAgICAgIGlmIChueCAqIHYxeCArIG55ICogdjF5ICsgbnogKiB2MXogPj0gMCAmJiAhaGl0KSB7XHJcbiAgICAgICAgICAgIHZhciBiMCA9ICh2MXkgKiB2MnogLSB2MXogKiB2MnkpICogdjN4ICsgKHYxeiAqIHYyeCAtIHYxeCAqIHYyeikgKiB2M3kgKyAodjF4ICogdjJ5IC0gdjF5ICogdjJ4KSAqIHYzejtcclxuICAgICAgICAgICAgdmFyIGIxID0gKHYzeSAqIHYyeiAtIHYzeiAqIHYyeSkgKiB2MHggKyAodjN6ICogdjJ4IC0gdjN4ICogdjJ6KSAqIHYweSArICh2M3ggKiB2MnkgLSB2M3kgKiB2MngpICogdjB6O1xyXG4gICAgICAgICAgICB2YXIgYjIgPSAodjB5ICogdjF6IC0gdjB6ICogdjF5KSAqIHYzeCArICh2MHogKiB2MXggLSB2MHggKiB2MXopICogdjN5ICsgKHYweCAqIHYxeSAtIHYweSAqIHYxeCkgKiB2M3o7XHJcbiAgICAgICAgICAgIHZhciBiMyA9ICh2MnkgKiB2MXogLSB2MnogKiB2MXkpICogdjB4ICsgKHYyeiAqIHYxeCAtIHYyeCAqIHYxeikgKiB2MHkgKyAodjJ4ICogdjF5IC0gdjJ5ICogdjF4KSAqIHYwejtcclxuICAgICAgICAgICAgdmFyIHN1bSA9IGIwICsgYjEgKyBiMiArIGIzO1xyXG4gICAgICAgICAgICBpZiAoc3VtIDw9IDApIHtcclxuICAgICAgICAgICAgICBiMCA9IDA7XHJcbiAgICAgICAgICAgICAgYjEgPSAodjJ5ICogdjN6IC0gdjJ6ICogdjN5KSAqIG54ICsgKHYyeiAqIHYzeCAtIHYyeCAqIHYzeikgKiBueSArICh2MnggKiB2M3kgLSB2MnkgKiB2M3gpICogbno7XHJcbiAgICAgICAgICAgICAgYjIgPSAodjN5ICogdjJ6IC0gdjN6ICogdjJ5KSAqIG54ICsgKHYzeiAqIHYyeCAtIHYzeCAqIHYyeikgKiBueSArICh2M3ggKiB2MnkgLSB2M3kgKiB2MngpICogbno7XHJcbiAgICAgICAgICAgICAgYjMgPSAodjF5ICogdjJ6IC0gdjF6ICogdjJ5KSAqIG54ICsgKHYxeiAqIHYyeCAtIHYxeCAqIHYyeikgKiBueSArICh2MXggKiB2MnkgLSB2MXkgKiB2MngpICogbno7XHJcbiAgICAgICAgICAgICAgc3VtID0gYjEgKyBiMiArIGIzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciBpbnYgPSAxIC8gc3VtO1xyXG4gICAgICAgICAgICBwMXggPSAodjAxeCAqIGIwICsgdjExeCAqIGIxICsgdjIxeCAqIGIyICsgdjMxeCAqIGIzKSAqIGludjtcclxuICAgICAgICAgICAgcDF5ID0gKHYwMXkgKiBiMCArIHYxMXkgKiBiMSArIHYyMXkgKiBiMiArIHYzMXkgKiBiMykgKiBpbnY7XHJcbiAgICAgICAgICAgIHAxeiA9ICh2MDF6ICogYjAgKyB2MTF6ICogYjEgKyB2MjF6ICogYjIgKyB2MzF6ICogYjMpICogaW52O1xyXG4gICAgICAgICAgICBwMnggPSAodjAyeCAqIGIwICsgdjEyeCAqIGIxICsgdjIyeCAqIGIyICsgdjMyeCAqIGIzKSAqIGludjtcclxuICAgICAgICAgICAgcDJ5ID0gKHYwMnkgKiBiMCArIHYxMnkgKiBiMSArIHYyMnkgKiBiMiArIHYzMnkgKiBiMykgKiBpbnY7XHJcbiAgICAgICAgICAgIHAyeiA9ICh2MDJ6ICogYjAgKyB2MTJ6ICogYjEgKyB2MjJ6ICogYjIgKyB2MzJ6ICogYjMpICogaW52O1xyXG4gICAgICAgICAgICBoaXQgPSB0cnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy5zdXBwb3J0UG9pbnQoYzEsIC1ueCwgLW55LCAtbnosIHN1cCk7XHJcbiAgICAgICAgICB2YXIgdjQxeCA9IHN1cC54O1xyXG4gICAgICAgICAgdmFyIHY0MXkgPSBzdXAueTtcclxuICAgICAgICAgIHZhciB2NDF6ID0gc3VwLno7XHJcbiAgICAgICAgICB0aGlzLnN1cHBvcnRQb2ludChjMiwgbngsIG55LCBueiwgc3VwKTtcclxuICAgICAgICAgIHZhciB2NDJ4ID0gc3VwLng7XHJcbiAgICAgICAgICB2YXIgdjQyeSA9IHN1cC55O1xyXG4gICAgICAgICAgdmFyIHY0MnogPSBzdXAuejtcclxuICAgICAgICAgIHZhciB2NHggPSB2NDJ4IC0gdjQxeDtcclxuICAgICAgICAgIHZhciB2NHkgPSB2NDJ5IC0gdjQxeTtcclxuICAgICAgICAgIHZhciB2NHogPSB2NDJ6IC0gdjQxejtcclxuICAgICAgICAgIHZhciBzZXBhcmF0aW9uID0gLSh2NHggKiBueCArIHY0eSAqIG55ICsgdjR6ICogbnopO1xyXG4gICAgICAgICAgaWYgKCh2NHggLSB2M3gpICogbnggKyAodjR5IC0gdjN5KSAqIG55ICsgKHY0eiAtIHYzeikgKiBueiA8PSAwLjAxIHx8IHNlcGFyYXRpb24gPj0gMCkge1xyXG4gICAgICAgICAgICBpZiAoaGl0KSB7XHJcbiAgICAgICAgICAgICAgc2VwLnNldCgtbngsIC1ueSwgLW56KTtcclxuICAgICAgICAgICAgICBwb3Muc2V0KChwMXggKyBwMngpICogMC41LCAocDF5ICsgcDJ5KSAqIDAuNSwgKHAxeiArIHAyeikgKiAwLjUpO1xyXG4gICAgICAgICAgICAgIGRlcC54ID0gc2VwYXJhdGlvbjtcclxuICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICh2NHkgKiB2MXogLSB2NHogKiB2MXkpICogdjB4ICtcclxuICAgICAgICAgICAgKHY0eiAqIHYxeCAtIHY0eCAqIHYxeikgKiB2MHkgK1xyXG4gICAgICAgICAgICAodjR4ICogdjF5IC0gdjR5ICogdjF4KSAqIHYweiA8IDBcclxuICAgICAgICAgICkge1xyXG4gICAgICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgICAgKHY0eSAqIHYyeiAtIHY0eiAqIHYyeSkgKiB2MHggK1xyXG4gICAgICAgICAgICAgICh2NHogKiB2MnggLSB2NHggKiB2MnopICogdjB5ICtcclxuICAgICAgICAgICAgICAodjR4ICogdjJ5IC0gdjR5ICogdjJ4KSAqIHYweiA8IDBcclxuICAgICAgICAgICAgKSB7XHJcbiAgICAgICAgICAgICAgdjF4ID0gdjR4O1xyXG4gICAgICAgICAgICAgIHYxeSA9IHY0eTtcclxuICAgICAgICAgICAgICB2MXogPSB2NHo7XHJcbiAgICAgICAgICAgICAgdjExeCA9IHY0MXg7XHJcbiAgICAgICAgICAgICAgdjExeSA9IHY0MXk7XHJcbiAgICAgICAgICAgICAgdjExeiA9IHY0MXo7XHJcbiAgICAgICAgICAgICAgdjEyeCA9IHY0Mng7XHJcbiAgICAgICAgICAgICAgdjEyeSA9IHY0Mnk7XHJcbiAgICAgICAgICAgICAgdjEyeiA9IHY0Mno7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgdjN4ID0gdjR4O1xyXG4gICAgICAgICAgICAgIHYzeSA9IHY0eTtcclxuICAgICAgICAgICAgICB2M3ogPSB2NHo7XHJcbiAgICAgICAgICAgICAgdjMxeCA9IHY0MXg7XHJcbiAgICAgICAgICAgICAgdjMxeSA9IHY0MXk7XHJcbiAgICAgICAgICAgICAgdjMxeiA9IHY0MXo7XHJcbiAgICAgICAgICAgICAgdjMyeCA9IHY0Mng7XHJcbiAgICAgICAgICAgICAgdjMyeSA9IHY0Mnk7XHJcbiAgICAgICAgICAgICAgdjMyeiA9IHY0Mno7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAodjR5ICogdjN6IC0gdjR6ICogdjN5KSAqIHYweCArXHJcbiAgICAgICAgICAgICAgKHY0eiAqIHYzeCAtIHY0eCAqIHYzeikgKiB2MHkgK1xyXG4gICAgICAgICAgICAgICh2NHggKiB2M3kgLSB2NHkgKiB2M3gpICogdjB6IDwgMFxyXG4gICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICB2MnggPSB2NHg7XHJcbiAgICAgICAgICAgICAgdjJ5ID0gdjR5O1xyXG4gICAgICAgICAgICAgIHYyeiA9IHY0ejtcclxuICAgICAgICAgICAgICB2MjF4ID0gdjQxeDtcclxuICAgICAgICAgICAgICB2MjF5ID0gdjQxeTtcclxuICAgICAgICAgICAgICB2MjF6ID0gdjQxejtcclxuICAgICAgICAgICAgICB2MjJ4ID0gdjQyeDtcclxuICAgICAgICAgICAgICB2MjJ5ID0gdjQyeTtcclxuICAgICAgICAgICAgICB2MjJ6ID0gdjQyejtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICB2MXggPSB2NHg7XHJcbiAgICAgICAgICAgICAgdjF5ID0gdjR5O1xyXG4gICAgICAgICAgICAgIHYxeiA9IHY0ejtcclxuICAgICAgICAgICAgICB2MTF4ID0gdjQxeDtcclxuICAgICAgICAgICAgICB2MTF5ID0gdjQxeTtcclxuICAgICAgICAgICAgICB2MTF6ID0gdjQxejtcclxuICAgICAgICAgICAgICB2MTJ4ID0gdjQyeDtcclxuICAgICAgICAgICAgICB2MTJ5ID0gdjQyeTtcclxuICAgICAgICAgICAgICB2MTJ6ID0gdjQyejtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICAvL3JldHVybiBmYWxzZTtcclxuICAgIH0sXHJcblxyXG4gICAgc3VwcG9ydFBvaW50OiBmdW5jdGlvbiAoYywgZHgsIGR5LCBkeiwgb3V0KSB7XHJcblxyXG4gICAgICB2YXIgcm90ID0gYy5yb3RhdGlvbi5lbGVtZW50cztcclxuICAgICAgdmFyIGxkeCA9IHJvdFswXSAqIGR4ICsgcm90WzNdICogZHkgKyByb3RbNl0gKiBkejtcclxuICAgICAgdmFyIGxkeSA9IHJvdFsxXSAqIGR4ICsgcm90WzRdICogZHkgKyByb3RbN10gKiBkejtcclxuICAgICAgdmFyIGxkeiA9IHJvdFsyXSAqIGR4ICsgcm90WzVdICogZHkgKyByb3RbOF0gKiBkejtcclxuICAgICAgdmFyIHJhZHggPSBsZHg7XHJcbiAgICAgIHZhciByYWR6ID0gbGR6O1xyXG4gICAgICB2YXIgbGVuID0gcmFkeCAqIHJhZHggKyByYWR6ICogcmFkejtcclxuICAgICAgdmFyIHJhZCA9IGMucmFkaXVzO1xyXG4gICAgICB2YXIgaGggPSBjLmhhbGZIZWlnaHQ7XHJcbiAgICAgIHZhciBveDtcclxuICAgICAgdmFyIG95O1xyXG4gICAgICB2YXIgb3o7XHJcbiAgICAgIGlmIChsZW4gPT0gMCkge1xyXG4gICAgICAgIGlmIChsZHkgPCAwKSB7XHJcbiAgICAgICAgICBveCA9IHJhZDtcclxuICAgICAgICAgIG95ID0gLWhoO1xyXG4gICAgICAgICAgb3ogPSAwO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBveCA9IHJhZDtcclxuICAgICAgICAgIG95ID0gaGg7XHJcbiAgICAgICAgICBveiA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxlbiA9IGMucmFkaXVzIC8gX01hdGguc3FydChsZW4pO1xyXG4gICAgICAgIGlmIChsZHkgPCAwKSB7XHJcbiAgICAgICAgICBveCA9IHJhZHggKiBsZW47XHJcbiAgICAgICAgICBveSA9IC1oaDtcclxuICAgICAgICAgIG96ID0gcmFkeiAqIGxlbjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgb3ggPSByYWR4ICogbGVuO1xyXG4gICAgICAgICAgb3kgPSBoaDtcclxuICAgICAgICAgIG96ID0gcmFkeiAqIGxlbjtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgbGR4ID0gcm90WzBdICogb3ggKyByb3RbMV0gKiBveSArIHJvdFsyXSAqIG96ICsgYy5wb3NpdGlvbi54O1xyXG4gICAgICBsZHkgPSByb3RbM10gKiBveCArIHJvdFs0XSAqIG95ICsgcm90WzVdICogb3ogKyBjLnBvc2l0aW9uLnk7XHJcbiAgICAgIGxkeiA9IHJvdFs2XSAqIG94ICsgcm90WzddICogb3kgKyByb3RbOF0gKiBveiArIGMucG9zaXRpb24uejtcclxuICAgICAgb3V0LnNldChsZHgsIGxkeSwgbGR6KTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGRldGVjdENvbGxpc2lvbjogZnVuY3Rpb24gKHNoYXBlMSwgc2hhcGUyLCBtYW5pZm9sZCkge1xyXG5cclxuICAgICAgdmFyIGMxO1xyXG4gICAgICB2YXIgYzI7XHJcbiAgICAgIGlmIChzaGFwZTEuaWQgPCBzaGFwZTIuaWQpIHtcclxuICAgICAgICBjMSA9IHNoYXBlMTtcclxuICAgICAgICBjMiA9IHNoYXBlMjtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjMSA9IHNoYXBlMjtcclxuICAgICAgICBjMiA9IHNoYXBlMTtcclxuICAgICAgfVxyXG4gICAgICB2YXIgcDEgPSBjMS5wb3NpdGlvbjtcclxuICAgICAgdmFyIHAyID0gYzIucG9zaXRpb247XHJcbiAgICAgIHZhciBwMXggPSBwMS54O1xyXG4gICAgICB2YXIgcDF5ID0gcDEueTtcclxuICAgICAgdmFyIHAxeiA9IHAxLno7XHJcbiAgICAgIHZhciBwMnggPSBwMi54O1xyXG4gICAgICB2YXIgcDJ5ID0gcDIueTtcclxuICAgICAgdmFyIHAyeiA9IHAyLno7XHJcbiAgICAgIHZhciBoMSA9IGMxLmhhbGZIZWlnaHQ7XHJcbiAgICAgIHZhciBoMiA9IGMyLmhhbGZIZWlnaHQ7XHJcbiAgICAgIHZhciBuMSA9IGMxLm5vcm1hbERpcmVjdGlvbjtcclxuICAgICAgdmFyIG4yID0gYzIubm9ybWFsRGlyZWN0aW9uO1xyXG4gICAgICB2YXIgZDEgPSBjMS5oYWxmRGlyZWN0aW9uO1xyXG4gICAgICB2YXIgZDIgPSBjMi5oYWxmRGlyZWN0aW9uO1xyXG4gICAgICB2YXIgcjEgPSBjMS5yYWRpdXM7XHJcbiAgICAgIHZhciByMiA9IGMyLnJhZGl1cztcclxuICAgICAgdmFyIG4xeCA9IG4xLng7XHJcbiAgICAgIHZhciBuMXkgPSBuMS55O1xyXG4gICAgICB2YXIgbjF6ID0gbjEuejtcclxuICAgICAgdmFyIG4yeCA9IG4yLng7XHJcbiAgICAgIHZhciBuMnkgPSBuMi55O1xyXG4gICAgICB2YXIgbjJ6ID0gbjIuejtcclxuICAgICAgdmFyIGQxeCA9IGQxLng7XHJcbiAgICAgIHZhciBkMXkgPSBkMS55O1xyXG4gICAgICB2YXIgZDF6ID0gZDEuejtcclxuICAgICAgdmFyIGQyeCA9IGQyLng7XHJcbiAgICAgIHZhciBkMnkgPSBkMi55O1xyXG4gICAgICB2YXIgZDJ6ID0gZDIuejtcclxuICAgICAgdmFyIGR4ID0gcDF4IC0gcDJ4O1xyXG4gICAgICB2YXIgZHkgPSBwMXkgLSBwMnk7XHJcbiAgICAgIHZhciBkeiA9IHAxeiAtIHAyejtcclxuICAgICAgdmFyIGxlbjtcclxuICAgICAgdmFyIGMxeDtcclxuICAgICAgdmFyIGMxeTtcclxuICAgICAgdmFyIGMxejtcclxuICAgICAgdmFyIGMyeDtcclxuICAgICAgdmFyIGMyeTtcclxuICAgICAgdmFyIGMyejtcclxuICAgICAgdmFyIHR4O1xyXG4gICAgICB2YXIgdHk7XHJcbiAgICAgIHZhciB0ejtcclxuICAgICAgdmFyIHN4O1xyXG4gICAgICB2YXIgc3k7XHJcbiAgICAgIHZhciBzejtcclxuICAgICAgdmFyIGV4O1xyXG4gICAgICB2YXIgZXk7XHJcbiAgICAgIHZhciBlejtcclxuICAgICAgdmFyIGRlcHRoMTtcclxuICAgICAgdmFyIGRlcHRoMjtcclxuICAgICAgdmFyIGRvdDtcclxuICAgICAgdmFyIHQxO1xyXG4gICAgICB2YXIgdDI7XHJcbiAgICAgIHZhciBzZXAgPSBuZXcgVmVjMygpO1xyXG4gICAgICB2YXIgcG9zID0gbmV3IFZlYzMoKTtcclxuICAgICAgdmFyIGRlcCA9IG5ldyBWZWMzKCk7XHJcbiAgICAgIGlmICghdGhpcy5nZXRTZXAoYzEsIGMyLCBzZXAsIHBvcywgZGVwKSkgcmV0dXJuO1xyXG4gICAgICB2YXIgZG90MSA9IHNlcC54ICogbjF4ICsgc2VwLnkgKiBuMXkgKyBzZXAueiAqIG4xejtcclxuICAgICAgdmFyIGRvdDIgPSBzZXAueCAqIG4yeCArIHNlcC55ICogbjJ5ICsgc2VwLnogKiBuMno7XHJcbiAgICAgIHZhciByaWdodDEgPSBkb3QxID4gMDtcclxuICAgICAgdmFyIHJpZ2h0MiA9IGRvdDIgPiAwO1xyXG4gICAgICBpZiAoIXJpZ2h0MSkgZG90MSA9IC1kb3QxO1xyXG4gICAgICBpZiAoIXJpZ2h0MikgZG90MiA9IC1kb3QyO1xyXG4gICAgICB2YXIgc3RhdGUgPSAwO1xyXG4gICAgICBpZiAoZG90MSA+IDAuOTk5IHx8IGRvdDIgPiAwLjk5OSkge1xyXG4gICAgICAgIGlmIChkb3QxID4gZG90Mikgc3RhdGUgPSAxO1xyXG4gICAgICAgIGVsc2Ugc3RhdGUgPSAyO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBueDtcclxuICAgICAgdmFyIG55O1xyXG4gICAgICB2YXIgbno7XHJcbiAgICAgIHZhciBkZXB0aCA9IGRlcC54O1xyXG4gICAgICB2YXIgcjAwO1xyXG4gICAgICB2YXIgcjAxO1xyXG4gICAgICB2YXIgcjAyO1xyXG4gICAgICB2YXIgcjEwO1xyXG4gICAgICB2YXIgcjExO1xyXG4gICAgICB2YXIgcjEyO1xyXG4gICAgICB2YXIgcjIwO1xyXG4gICAgICB2YXIgcjIxO1xyXG4gICAgICB2YXIgcjIyO1xyXG4gICAgICB2YXIgcHg7XHJcbiAgICAgIHZhciBweTtcclxuICAgICAgdmFyIHB6O1xyXG4gICAgICB2YXIgcGQ7XHJcbiAgICAgIHZhciBhO1xyXG4gICAgICB2YXIgYjtcclxuICAgICAgdmFyIGU7XHJcbiAgICAgIHZhciBmO1xyXG4gICAgICBueCA9IHNlcC54O1xyXG4gICAgICBueSA9IHNlcC55O1xyXG4gICAgICBueiA9IHNlcC56O1xyXG4gICAgICBzd2l0Y2ggKHN0YXRlKSB7XHJcbiAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgbWFuaWZvbGQuYWRkUG9pbnQocG9zLngsIHBvcy55LCBwb3MueiwgbngsIG55LCBueiwgZGVwdGgsIGZhbHNlKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgMTpcclxuICAgICAgICAgIGlmIChyaWdodDEpIHtcclxuICAgICAgICAgICAgYzF4ID0gcDF4ICsgZDF4O1xyXG4gICAgICAgICAgICBjMXkgPSBwMXkgKyBkMXk7XHJcbiAgICAgICAgICAgIGMxeiA9IHAxeiArIGQxejtcclxuICAgICAgICAgICAgbnggPSBuMXg7XHJcbiAgICAgICAgICAgIG55ID0gbjF5O1xyXG4gICAgICAgICAgICBueiA9IG4xejtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGMxeCA9IHAxeCAtIGQxeDtcclxuICAgICAgICAgICAgYzF5ID0gcDF5IC0gZDF5O1xyXG4gICAgICAgICAgICBjMXogPSBwMXogLSBkMXo7XHJcbiAgICAgICAgICAgIG54ID0gLW4xeDtcclxuICAgICAgICAgICAgbnkgPSAtbjF5O1xyXG4gICAgICAgICAgICBueiA9IC1uMXo7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBkb3QgPSBueCAqIG4yeCArIG55ICogbjJ5ICsgbnogKiBuMno7XHJcbiAgICAgICAgICBpZiAoZG90IDwgMCkgbGVuID0gaDI7XHJcbiAgICAgICAgICBlbHNlIGxlbiA9IC1oMjtcclxuICAgICAgICAgIGMyeCA9IHAyeCArIGxlbiAqIG4yeDtcclxuICAgICAgICAgIGMyeSA9IHAyeSArIGxlbiAqIG4yeTtcclxuICAgICAgICAgIGMyeiA9IHAyeiArIGxlbiAqIG4yejtcclxuICAgICAgICAgIGlmIChkb3QyID49IDAuOTk5OTk5KSB7XHJcbiAgICAgICAgICAgIHR4ID0gLW55O1xyXG4gICAgICAgICAgICB0eSA9IG56O1xyXG4gICAgICAgICAgICB0eiA9IG54O1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdHggPSBueDtcclxuICAgICAgICAgICAgdHkgPSBueTtcclxuICAgICAgICAgICAgdHogPSBuejtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGxlbiA9IHR4ICogbjJ4ICsgdHkgKiBuMnkgKyB0eiAqIG4yejtcclxuICAgICAgICAgIGR4ID0gbGVuICogbjJ4IC0gdHg7XHJcbiAgICAgICAgICBkeSA9IGxlbiAqIG4yeSAtIHR5O1xyXG4gICAgICAgICAgZHogPSBsZW4gKiBuMnogLSB0ejtcclxuICAgICAgICAgIGxlbiA9IF9NYXRoLnNxcnQoZHggKiBkeCArIGR5ICogZHkgKyBkeiAqIGR6KTtcclxuICAgICAgICAgIGlmIChsZW4gPT0gMCkgYnJlYWs7XHJcbiAgICAgICAgICBsZW4gPSByMiAvIGxlbjtcclxuICAgICAgICAgIGR4ICo9IGxlbjtcclxuICAgICAgICAgIGR5ICo9IGxlbjtcclxuICAgICAgICAgIGR6ICo9IGxlbjtcclxuICAgICAgICAgIHR4ID0gYzJ4ICsgZHg7XHJcbiAgICAgICAgICB0eSA9IGMyeSArIGR5O1xyXG4gICAgICAgICAgdHogPSBjMnogKyBkejtcclxuICAgICAgICAgIGlmIChkb3QgPCAtMC45NiB8fCBkb3QgPiAwLjk2KSB7XHJcbiAgICAgICAgICAgIHIwMCA9IG4yeCAqIG4yeCAqIDEuNSAtIDAuNTtcclxuICAgICAgICAgICAgcjAxID0gbjJ4ICogbjJ5ICogMS41IC0gbjJ6ICogMC44NjYwMjU0MDM7XHJcbiAgICAgICAgICAgIHIwMiA9IG4yeCAqIG4yeiAqIDEuNSArIG4yeSAqIDAuODY2MDI1NDAzO1xyXG4gICAgICAgICAgICByMTAgPSBuMnkgKiBuMnggKiAxLjUgKyBuMnogKiAwLjg2NjAyNTQwMztcclxuICAgICAgICAgICAgcjExID0gbjJ5ICogbjJ5ICogMS41IC0gMC41O1xyXG4gICAgICAgICAgICByMTIgPSBuMnkgKiBuMnogKiAxLjUgLSBuMnggKiAwLjg2NjAyNTQwMztcclxuICAgICAgICAgICAgcjIwID0gbjJ6ICogbjJ4ICogMS41IC0gbjJ5ICogMC44NjYwMjU0MDM7XHJcbiAgICAgICAgICAgIHIyMSA9IG4yeiAqIG4yeSAqIDEuNSArIG4yeCAqIDAuODY2MDI1NDAzO1xyXG4gICAgICAgICAgICByMjIgPSBuMnogKiBuMnogKiAxLjUgLSAwLjU7XHJcbiAgICAgICAgICAgIHB4ID0gdHg7XHJcbiAgICAgICAgICAgIHB5ID0gdHk7XHJcbiAgICAgICAgICAgIHB6ID0gdHo7XHJcbiAgICAgICAgICAgIHBkID0gbnggKiAocHggLSBjMXgpICsgbnkgKiAocHkgLSBjMXkpICsgbnogKiAocHogLSBjMXopO1xyXG4gICAgICAgICAgICB0eCA9IHB4IC0gcGQgKiBueCAtIGMxeDtcclxuICAgICAgICAgICAgdHkgPSBweSAtIHBkICogbnkgLSBjMXk7XHJcbiAgICAgICAgICAgIHR6ID0gcHogLSBwZCAqIG56IC0gYzF6O1xyXG4gICAgICAgICAgICBsZW4gPSB0eCAqIHR4ICsgdHkgKiB0eSArIHR6ICogdHo7XHJcbiAgICAgICAgICAgIGlmIChsZW4gPiByMSAqIHIxKSB7XHJcbiAgICAgICAgICAgICAgbGVuID0gcjEgLyBfTWF0aC5zcXJ0KGxlbik7XHJcbiAgICAgICAgICAgICAgdHggKj0gbGVuO1xyXG4gICAgICAgICAgICAgIHR5ICo9IGxlbjtcclxuICAgICAgICAgICAgICB0eiAqPSBsZW47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcHggPSBjMXggKyB0eDtcclxuICAgICAgICAgICAgcHkgPSBjMXkgKyB0eTtcclxuICAgICAgICAgICAgcHogPSBjMXogKyB0ejtcclxuICAgICAgICAgICAgbWFuaWZvbGQuYWRkUG9pbnQocHgsIHB5LCBweiwgbngsIG55LCBueiwgcGQsIGZhbHNlKTtcclxuICAgICAgICAgICAgcHggPSBkeCAqIHIwMCArIGR5ICogcjAxICsgZHogKiByMDI7XHJcbiAgICAgICAgICAgIHB5ID0gZHggKiByMTAgKyBkeSAqIHIxMSArIGR6ICogcjEyO1xyXG4gICAgICAgICAgICBweiA9IGR4ICogcjIwICsgZHkgKiByMjEgKyBkeiAqIHIyMjtcclxuICAgICAgICAgICAgcHggPSAoZHggPSBweCkgKyBjMng7XHJcbiAgICAgICAgICAgIHB5ID0gKGR5ID0gcHkpICsgYzJ5O1xyXG4gICAgICAgICAgICBweiA9IChkeiA9IHB6KSArIGMyejtcclxuICAgICAgICAgICAgcGQgPSBueCAqIChweCAtIGMxeCkgKyBueSAqIChweSAtIGMxeSkgKyBueiAqIChweiAtIGMxeik7XHJcbiAgICAgICAgICAgIGlmIChwZCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgdHggPSBweCAtIHBkICogbnggLSBjMXg7XHJcbiAgICAgICAgICAgICAgdHkgPSBweSAtIHBkICogbnkgLSBjMXk7XHJcbiAgICAgICAgICAgICAgdHogPSBweiAtIHBkICogbnogLSBjMXo7XHJcbiAgICAgICAgICAgICAgbGVuID0gdHggKiB0eCArIHR5ICogdHkgKyB0eiAqIHR6O1xyXG4gICAgICAgICAgICAgIGlmIChsZW4gPiByMSAqIHIxKSB7XHJcbiAgICAgICAgICAgICAgICBsZW4gPSByMSAvIF9NYXRoLnNxcnQobGVuKTtcclxuICAgICAgICAgICAgICAgIHR4ICo9IGxlbjtcclxuICAgICAgICAgICAgICAgIHR5ICo9IGxlbjtcclxuICAgICAgICAgICAgICAgIHR6ICo9IGxlbjtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgcHggPSBjMXggKyB0eDtcclxuICAgICAgICAgICAgICBweSA9IGMxeSArIHR5O1xyXG4gICAgICAgICAgICAgIHB6ID0gYzF6ICsgdHo7XHJcbiAgICAgICAgICAgICAgbWFuaWZvbGQuYWRkUG9pbnQocHgsIHB5LCBweiwgbngsIG55LCBueiwgcGQsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBweCA9IGR4ICogcjAwICsgZHkgKiByMDEgKyBkeiAqIHIwMjtcclxuICAgICAgICAgICAgcHkgPSBkeCAqIHIxMCArIGR5ICogcjExICsgZHogKiByMTI7XHJcbiAgICAgICAgICAgIHB6ID0gZHggKiByMjAgKyBkeSAqIHIyMSArIGR6ICogcjIyO1xyXG4gICAgICAgICAgICBweCA9IChkeCA9IHB4KSArIGMyeDtcclxuICAgICAgICAgICAgcHkgPSAoZHkgPSBweSkgKyBjMnk7XHJcbiAgICAgICAgICAgIHB6ID0gKGR6ID0gcHopICsgYzJ6O1xyXG4gICAgICAgICAgICBwZCA9IG54ICogKHB4IC0gYzF4KSArIG55ICogKHB5IC0gYzF5KSArIG56ICogKHB6IC0gYzF6KTtcclxuICAgICAgICAgICAgaWYgKHBkIDw9IDApIHtcclxuICAgICAgICAgICAgICB0eCA9IHB4IC0gcGQgKiBueCAtIGMxeDtcclxuICAgICAgICAgICAgICB0eSA9IHB5IC0gcGQgKiBueSAtIGMxeTtcclxuICAgICAgICAgICAgICB0eiA9IHB6IC0gcGQgKiBueiAtIGMxejtcclxuICAgICAgICAgICAgICBsZW4gPSB0eCAqIHR4ICsgdHkgKiB0eSArIHR6ICogdHo7XHJcbiAgICAgICAgICAgICAgaWYgKGxlbiA+IHIxICogcjEpIHtcclxuICAgICAgICAgICAgICAgIGxlbiA9IHIxIC8gX01hdGguc3FydChsZW4pO1xyXG4gICAgICAgICAgICAgICAgdHggKj0gbGVuO1xyXG4gICAgICAgICAgICAgICAgdHkgKj0gbGVuO1xyXG4gICAgICAgICAgICAgICAgdHogKj0gbGVuO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBweCA9IGMxeCArIHR4O1xyXG4gICAgICAgICAgICAgIHB5ID0gYzF5ICsgdHk7XHJcbiAgICAgICAgICAgICAgcHogPSBjMXogKyB0ejtcclxuICAgICAgICAgICAgICBtYW5pZm9sZC5hZGRQb2ludChweCwgcHksIHB6LCBueCwgbnksIG56LCBwZCwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzeCA9IHR4O1xyXG4gICAgICAgICAgICBzeSA9IHR5O1xyXG4gICAgICAgICAgICBzeiA9IHR6O1xyXG4gICAgICAgICAgICBkZXB0aDEgPSBueCAqIChzeCAtIGMxeCkgKyBueSAqIChzeSAtIGMxeSkgKyBueiAqIChzeiAtIGMxeik7XHJcbiAgICAgICAgICAgIHN4IC09IGRlcHRoMSAqIG54O1xyXG4gICAgICAgICAgICBzeSAtPSBkZXB0aDEgKiBueTtcclxuICAgICAgICAgICAgc3ogLT0gZGVwdGgxICogbno7XHJcbiAgICAgICAgICAgIGlmIChkb3QgPiAwKSB7XHJcbiAgICAgICAgICAgICAgZXggPSB0eCArIG4yeCAqIGgyICogMjtcclxuICAgICAgICAgICAgICBleSA9IHR5ICsgbjJ5ICogaDIgKiAyO1xyXG4gICAgICAgICAgICAgIGV6ID0gdHogKyBuMnogKiBoMiAqIDI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgZXggPSB0eCAtIG4yeCAqIGgyICogMjtcclxuICAgICAgICAgICAgICBleSA9IHR5IC0gbjJ5ICogaDIgKiAyO1xyXG4gICAgICAgICAgICAgIGV6ID0gdHogLSBuMnogKiBoMiAqIDI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGVwdGgyID0gbnggKiAoZXggLSBjMXgpICsgbnkgKiAoZXkgLSBjMXkpICsgbnogKiAoZXogLSBjMXopO1xyXG4gICAgICAgICAgICBleCAtPSBkZXB0aDIgKiBueDtcclxuICAgICAgICAgICAgZXkgLT0gZGVwdGgyICogbnk7XHJcbiAgICAgICAgICAgIGV6IC09IGRlcHRoMiAqIG56O1xyXG4gICAgICAgICAgICBkeCA9IGMxeCAtIHN4O1xyXG4gICAgICAgICAgICBkeSA9IGMxeSAtIHN5O1xyXG4gICAgICAgICAgICBkeiA9IGMxeiAtIHN6O1xyXG4gICAgICAgICAgICB0eCA9IGV4IC0gc3g7XHJcbiAgICAgICAgICAgIHR5ID0gZXkgLSBzeTtcclxuICAgICAgICAgICAgdHogPSBleiAtIHN6O1xyXG4gICAgICAgICAgICBhID0gZHggKiBkeCArIGR5ICogZHkgKyBkeiAqIGR6O1xyXG4gICAgICAgICAgICBiID0gZHggKiB0eCArIGR5ICogdHkgKyBkeiAqIHR6O1xyXG4gICAgICAgICAgICBlID0gdHggKiB0eCArIHR5ICogdHkgKyB0eiAqIHR6O1xyXG4gICAgICAgICAgICBmID0gYiAqIGIgLSBlICogKGEgLSByMSAqIHIxKTtcclxuICAgICAgICAgICAgaWYgKGYgPCAwKSBicmVhaztcclxuICAgICAgICAgICAgZiA9IF9NYXRoLnNxcnQoZik7XHJcbiAgICAgICAgICAgIHQxID0gKGIgKyBmKSAvIGU7XHJcbiAgICAgICAgICAgIHQyID0gKGIgLSBmKSAvIGU7XHJcbiAgICAgICAgICAgIGlmICh0MiA8IHQxKSB7XHJcbiAgICAgICAgICAgICAgbGVuID0gdDE7XHJcbiAgICAgICAgICAgICAgdDEgPSB0MjtcclxuICAgICAgICAgICAgICB0MiA9IGxlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodDIgPiAxKSB0MiA9IDE7XHJcbiAgICAgICAgICAgIGlmICh0MSA8IDApIHQxID0gMDtcclxuICAgICAgICAgICAgdHggPSBzeCArIChleCAtIHN4KSAqIHQxO1xyXG4gICAgICAgICAgICB0eSA9IHN5ICsgKGV5IC0gc3kpICogdDE7XHJcbiAgICAgICAgICAgIHR6ID0gc3ogKyAoZXogLSBzeikgKiB0MTtcclxuICAgICAgICAgICAgZXggPSBzeCArIChleCAtIHN4KSAqIHQyO1xyXG4gICAgICAgICAgICBleSA9IHN5ICsgKGV5IC0gc3kpICogdDI7XHJcbiAgICAgICAgICAgIGV6ID0gc3ogKyAoZXogLSBzeikgKiB0MjtcclxuICAgICAgICAgICAgc3ggPSB0eDtcclxuICAgICAgICAgICAgc3kgPSB0eTtcclxuICAgICAgICAgICAgc3ogPSB0ejtcclxuICAgICAgICAgICAgbGVuID0gZGVwdGgxICsgKGRlcHRoMiAtIGRlcHRoMSkgKiB0MTtcclxuICAgICAgICAgICAgZGVwdGgyID0gZGVwdGgxICsgKGRlcHRoMiAtIGRlcHRoMSkgKiB0MjtcclxuICAgICAgICAgICAgZGVwdGgxID0gbGVuO1xyXG4gICAgICAgICAgICBpZiAoZGVwdGgxIDwgMCkgbWFuaWZvbGQuYWRkUG9pbnQoc3gsIHN5LCBzeiwgbngsIG55LCBueiwgcGQsIGZhbHNlKTtcclxuICAgICAgICAgICAgaWYgKGRlcHRoMiA8IDApIG1hbmlmb2xkLmFkZFBvaW50KGV4LCBleSwgZXosIG54LCBueSwgbnosIHBkLCBmYWxzZSk7XHJcblxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgY2FzZSAyOlxyXG4gICAgICAgICAgaWYgKHJpZ2h0Mikge1xyXG4gICAgICAgICAgICBjMnggPSBwMnggLSBkMng7XHJcbiAgICAgICAgICAgIGMyeSA9IHAyeSAtIGQyeTtcclxuICAgICAgICAgICAgYzJ6ID0gcDJ6IC0gZDJ6O1xyXG4gICAgICAgICAgICBueCA9IC1uMng7XHJcbiAgICAgICAgICAgIG55ID0gLW4yeTtcclxuICAgICAgICAgICAgbnogPSAtbjJ6O1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgYzJ4ID0gcDJ4ICsgZDJ4O1xyXG4gICAgICAgICAgICBjMnkgPSBwMnkgKyBkMnk7XHJcbiAgICAgICAgICAgIGMyeiA9IHAyeiArIGQyejtcclxuICAgICAgICAgICAgbnggPSBuMng7XHJcbiAgICAgICAgICAgIG55ID0gbjJ5O1xyXG4gICAgICAgICAgICBueiA9IG4yejtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGRvdCA9IG54ICogbjF4ICsgbnkgKiBuMXkgKyBueiAqIG4xejtcclxuICAgICAgICAgIGlmIChkb3QgPCAwKSBsZW4gPSBoMTtcclxuICAgICAgICAgIGVsc2UgbGVuID0gLWgxO1xyXG4gICAgICAgICAgYzF4ID0gcDF4ICsgbGVuICogbjF4O1xyXG4gICAgICAgICAgYzF5ID0gcDF5ICsgbGVuICogbjF5O1xyXG4gICAgICAgICAgYzF6ID0gcDF6ICsgbGVuICogbjF6O1xyXG4gICAgICAgICAgaWYgKGRvdDEgPj0gMC45OTk5OTkpIHtcclxuICAgICAgICAgICAgdHggPSAtbnk7XHJcbiAgICAgICAgICAgIHR5ID0gbno7XHJcbiAgICAgICAgICAgIHR6ID0gbng7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0eCA9IG54O1xyXG4gICAgICAgICAgICB0eSA9IG55O1xyXG4gICAgICAgICAgICB0eiA9IG56O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgbGVuID0gdHggKiBuMXggKyB0eSAqIG4xeSArIHR6ICogbjF6O1xyXG4gICAgICAgICAgZHggPSBsZW4gKiBuMXggLSB0eDtcclxuICAgICAgICAgIGR5ID0gbGVuICogbjF5IC0gdHk7XHJcbiAgICAgICAgICBkeiA9IGxlbiAqIG4xeiAtIHR6O1xyXG4gICAgICAgICAgbGVuID0gX01hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSArIGR6ICogZHopO1xyXG4gICAgICAgICAgaWYgKGxlbiA9PSAwKSBicmVhaztcclxuICAgICAgICAgIGxlbiA9IHIxIC8gbGVuO1xyXG4gICAgICAgICAgZHggKj0gbGVuO1xyXG4gICAgICAgICAgZHkgKj0gbGVuO1xyXG4gICAgICAgICAgZHogKj0gbGVuO1xyXG4gICAgICAgICAgdHggPSBjMXggKyBkeDtcclxuICAgICAgICAgIHR5ID0gYzF5ICsgZHk7XHJcbiAgICAgICAgICB0eiA9IGMxeiArIGR6O1xyXG4gICAgICAgICAgaWYgKGRvdCA8IC0wLjk2IHx8IGRvdCA+IDAuOTYpIHtcclxuICAgICAgICAgICAgcjAwID0gbjF4ICogbjF4ICogMS41IC0gMC41O1xyXG4gICAgICAgICAgICByMDEgPSBuMXggKiBuMXkgKiAxLjUgLSBuMXogKiAwLjg2NjAyNTQwMztcclxuICAgICAgICAgICAgcjAyID0gbjF4ICogbjF6ICogMS41ICsgbjF5ICogMC44NjYwMjU0MDM7XHJcbiAgICAgICAgICAgIHIxMCA9IG4xeSAqIG4xeCAqIDEuNSArIG4xeiAqIDAuODY2MDI1NDAzO1xyXG4gICAgICAgICAgICByMTEgPSBuMXkgKiBuMXkgKiAxLjUgLSAwLjU7XHJcbiAgICAgICAgICAgIHIxMiA9IG4xeSAqIG4xeiAqIDEuNSAtIG4xeCAqIDAuODY2MDI1NDAzO1xyXG4gICAgICAgICAgICByMjAgPSBuMXogKiBuMXggKiAxLjUgLSBuMXkgKiAwLjg2NjAyNTQwMztcclxuICAgICAgICAgICAgcjIxID0gbjF6ICogbjF5ICogMS41ICsgbjF4ICogMC44NjYwMjU0MDM7XHJcbiAgICAgICAgICAgIHIyMiA9IG4xeiAqIG4xeiAqIDEuNSAtIDAuNTtcclxuICAgICAgICAgICAgcHggPSB0eDtcclxuICAgICAgICAgICAgcHkgPSB0eTtcclxuICAgICAgICAgICAgcHogPSB0ejtcclxuICAgICAgICAgICAgcGQgPSBueCAqIChweCAtIGMyeCkgKyBueSAqIChweSAtIGMyeSkgKyBueiAqIChweiAtIGMyeik7XHJcbiAgICAgICAgICAgIHR4ID0gcHggLSBwZCAqIG54IC0gYzJ4O1xyXG4gICAgICAgICAgICB0eSA9IHB5IC0gcGQgKiBueSAtIGMyeTtcclxuICAgICAgICAgICAgdHogPSBweiAtIHBkICogbnogLSBjMno7XHJcbiAgICAgICAgICAgIGxlbiA9IHR4ICogdHggKyB0eSAqIHR5ICsgdHogKiB0ejtcclxuICAgICAgICAgICAgaWYgKGxlbiA+IHIyICogcjIpIHtcclxuICAgICAgICAgICAgICBsZW4gPSByMiAvIF9NYXRoLnNxcnQobGVuKTtcclxuICAgICAgICAgICAgICB0eCAqPSBsZW47XHJcbiAgICAgICAgICAgICAgdHkgKj0gbGVuO1xyXG4gICAgICAgICAgICAgIHR6ICo9IGxlbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBweCA9IGMyeCArIHR4O1xyXG4gICAgICAgICAgICBweSA9IGMyeSArIHR5O1xyXG4gICAgICAgICAgICBweiA9IGMyeiArIHR6O1xyXG4gICAgICAgICAgICBtYW5pZm9sZC5hZGRQb2ludChweCwgcHksIHB6LCAtbngsIC1ueSwgLW56LCBwZCwgZmFsc2UpO1xyXG4gICAgICAgICAgICBweCA9IGR4ICogcjAwICsgZHkgKiByMDEgKyBkeiAqIHIwMjtcclxuICAgICAgICAgICAgcHkgPSBkeCAqIHIxMCArIGR5ICogcjExICsgZHogKiByMTI7XHJcbiAgICAgICAgICAgIHB6ID0gZHggKiByMjAgKyBkeSAqIHIyMSArIGR6ICogcjIyO1xyXG4gICAgICAgICAgICBweCA9IChkeCA9IHB4KSArIGMxeDtcclxuICAgICAgICAgICAgcHkgPSAoZHkgPSBweSkgKyBjMXk7XHJcbiAgICAgICAgICAgIHB6ID0gKGR6ID0gcHopICsgYzF6O1xyXG4gICAgICAgICAgICBwZCA9IG54ICogKHB4IC0gYzJ4KSArIG55ICogKHB5IC0gYzJ5KSArIG56ICogKHB6IC0gYzJ6KTtcclxuICAgICAgICAgICAgaWYgKHBkIDw9IDApIHtcclxuICAgICAgICAgICAgICB0eCA9IHB4IC0gcGQgKiBueCAtIGMyeDtcclxuICAgICAgICAgICAgICB0eSA9IHB5IC0gcGQgKiBueSAtIGMyeTtcclxuICAgICAgICAgICAgICB0eiA9IHB6IC0gcGQgKiBueiAtIGMyejtcclxuICAgICAgICAgICAgICBsZW4gPSB0eCAqIHR4ICsgdHkgKiB0eSArIHR6ICogdHo7XHJcbiAgICAgICAgICAgICAgaWYgKGxlbiA+IHIyICogcjIpIHtcclxuICAgICAgICAgICAgICAgIGxlbiA9IHIyIC8gX01hdGguc3FydChsZW4pO1xyXG4gICAgICAgICAgICAgICAgdHggKj0gbGVuO1xyXG4gICAgICAgICAgICAgICAgdHkgKj0gbGVuO1xyXG4gICAgICAgICAgICAgICAgdHogKj0gbGVuO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBweCA9IGMyeCArIHR4O1xyXG4gICAgICAgICAgICAgIHB5ID0gYzJ5ICsgdHk7XHJcbiAgICAgICAgICAgICAgcHogPSBjMnogKyB0ejtcclxuICAgICAgICAgICAgICBtYW5pZm9sZC5hZGRQb2ludChweCwgcHksIHB6LCAtbngsIC1ueSwgLW56LCBwZCwgZmFsc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHB4ID0gZHggKiByMDAgKyBkeSAqIHIwMSArIGR6ICogcjAyO1xyXG4gICAgICAgICAgICBweSA9IGR4ICogcjEwICsgZHkgKiByMTEgKyBkeiAqIHIxMjtcclxuICAgICAgICAgICAgcHogPSBkeCAqIHIyMCArIGR5ICogcjIxICsgZHogKiByMjI7XHJcbiAgICAgICAgICAgIHB4ID0gKGR4ID0gcHgpICsgYzF4O1xyXG4gICAgICAgICAgICBweSA9IChkeSA9IHB5KSArIGMxeTtcclxuICAgICAgICAgICAgcHogPSAoZHogPSBweikgKyBjMXo7XHJcbiAgICAgICAgICAgIHBkID0gbnggKiAocHggLSBjMngpICsgbnkgKiAocHkgLSBjMnkpICsgbnogKiAocHogLSBjMnopO1xyXG4gICAgICAgICAgICBpZiAocGQgPD0gMCkge1xyXG4gICAgICAgICAgICAgIHR4ID0gcHggLSBwZCAqIG54IC0gYzJ4O1xyXG4gICAgICAgICAgICAgIHR5ID0gcHkgLSBwZCAqIG55IC0gYzJ5O1xyXG4gICAgICAgICAgICAgIHR6ID0gcHogLSBwZCAqIG56IC0gYzJ6O1xyXG4gICAgICAgICAgICAgIGxlbiA9IHR4ICogdHggKyB0eSAqIHR5ICsgdHogKiB0ejtcclxuICAgICAgICAgICAgICBpZiAobGVuID4gcjIgKiByMikge1xyXG4gICAgICAgICAgICAgICAgbGVuID0gcjIgLyBfTWF0aC5zcXJ0KGxlbik7XHJcbiAgICAgICAgICAgICAgICB0eCAqPSBsZW47XHJcbiAgICAgICAgICAgICAgICB0eSAqPSBsZW47XHJcbiAgICAgICAgICAgICAgICB0eiAqPSBsZW47XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIHB4ID0gYzJ4ICsgdHg7XHJcbiAgICAgICAgICAgICAgcHkgPSBjMnkgKyB0eTtcclxuICAgICAgICAgICAgICBweiA9IGMyeiArIHR6O1xyXG4gICAgICAgICAgICAgIG1hbmlmb2xkLmFkZFBvaW50KHB4LCBweSwgcHosIC1ueCwgLW55LCAtbnosIHBkLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHN4ID0gdHg7XHJcbiAgICAgICAgICAgIHN5ID0gdHk7XHJcbiAgICAgICAgICAgIHN6ID0gdHo7XHJcbiAgICAgICAgICAgIGRlcHRoMSA9IG54ICogKHN4IC0gYzJ4KSArIG55ICogKHN5IC0gYzJ5KSArIG56ICogKHN6IC0gYzJ6KTtcclxuICAgICAgICAgICAgc3ggLT0gZGVwdGgxICogbng7XHJcbiAgICAgICAgICAgIHN5IC09IGRlcHRoMSAqIG55O1xyXG4gICAgICAgICAgICBzeiAtPSBkZXB0aDEgKiBuejtcclxuICAgICAgICAgICAgaWYgKGRvdCA+IDApIHtcclxuICAgICAgICAgICAgICBleCA9IHR4ICsgbjF4ICogaDEgKiAyO1xyXG4gICAgICAgICAgICAgIGV5ID0gdHkgKyBuMXkgKiBoMSAqIDI7XHJcbiAgICAgICAgICAgICAgZXogPSB0eiArIG4xeiAqIGgxICogMjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBleCA9IHR4IC0gbjF4ICogaDEgKiAyO1xyXG4gICAgICAgICAgICAgIGV5ID0gdHkgLSBuMXkgKiBoMSAqIDI7XHJcbiAgICAgICAgICAgICAgZXogPSB0eiAtIG4xeiAqIGgxICogMjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkZXB0aDIgPSBueCAqIChleCAtIGMyeCkgKyBueSAqIChleSAtIGMyeSkgKyBueiAqIChleiAtIGMyeik7XHJcbiAgICAgICAgICAgIGV4IC09IGRlcHRoMiAqIG54O1xyXG4gICAgICAgICAgICBleSAtPSBkZXB0aDIgKiBueTtcclxuICAgICAgICAgICAgZXogLT0gZGVwdGgyICogbno7XHJcbiAgICAgICAgICAgIGR4ID0gYzJ4IC0gc3g7XHJcbiAgICAgICAgICAgIGR5ID0gYzJ5IC0gc3k7XHJcbiAgICAgICAgICAgIGR6ID0gYzJ6IC0gc3o7XHJcbiAgICAgICAgICAgIHR4ID0gZXggLSBzeDtcclxuICAgICAgICAgICAgdHkgPSBleSAtIHN5O1xyXG4gICAgICAgICAgICB0eiA9IGV6IC0gc3o7XHJcbiAgICAgICAgICAgIGEgPSBkeCAqIGR4ICsgZHkgKiBkeSArIGR6ICogZHo7XHJcbiAgICAgICAgICAgIGIgPSBkeCAqIHR4ICsgZHkgKiB0eSArIGR6ICogdHo7XHJcbiAgICAgICAgICAgIGUgPSB0eCAqIHR4ICsgdHkgKiB0eSArIHR6ICogdHo7XHJcbiAgICAgICAgICAgIGYgPSBiICogYiAtIGUgKiAoYSAtIHIyICogcjIpO1xyXG4gICAgICAgICAgICBpZiAoZiA8IDApIGJyZWFrO1xyXG4gICAgICAgICAgICBmID0gX01hdGguc3FydChmKTtcclxuICAgICAgICAgICAgdDEgPSAoYiArIGYpIC8gZTtcclxuICAgICAgICAgICAgdDIgPSAoYiAtIGYpIC8gZTtcclxuICAgICAgICAgICAgaWYgKHQyIDwgdDEpIHtcclxuICAgICAgICAgICAgICBsZW4gPSB0MTtcclxuICAgICAgICAgICAgICB0MSA9IHQyO1xyXG4gICAgICAgICAgICAgIHQyID0gbGVuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0MiA+IDEpIHQyID0gMTtcclxuICAgICAgICAgICAgaWYgKHQxIDwgMCkgdDEgPSAwO1xyXG4gICAgICAgICAgICB0eCA9IHN4ICsgKGV4IC0gc3gpICogdDE7XHJcbiAgICAgICAgICAgIHR5ID0gc3kgKyAoZXkgLSBzeSkgKiB0MTtcclxuICAgICAgICAgICAgdHogPSBzeiArIChleiAtIHN6KSAqIHQxO1xyXG4gICAgICAgICAgICBleCA9IHN4ICsgKGV4IC0gc3gpICogdDI7XHJcbiAgICAgICAgICAgIGV5ID0gc3kgKyAoZXkgLSBzeSkgKiB0MjtcclxuICAgICAgICAgICAgZXogPSBzeiArIChleiAtIHN6KSAqIHQyO1xyXG4gICAgICAgICAgICBzeCA9IHR4O1xyXG4gICAgICAgICAgICBzeSA9IHR5O1xyXG4gICAgICAgICAgICBzeiA9IHR6O1xyXG4gICAgICAgICAgICBsZW4gPSBkZXB0aDEgKyAoZGVwdGgyIC0gZGVwdGgxKSAqIHQxO1xyXG4gICAgICAgICAgICBkZXB0aDIgPSBkZXB0aDEgKyAoZGVwdGgyIC0gZGVwdGgxKSAqIHQyO1xyXG4gICAgICAgICAgICBkZXB0aDEgPSBsZW47XHJcbiAgICAgICAgICAgIGlmIChkZXB0aDEgPCAwKSB7XHJcbiAgICAgICAgICAgICAgbWFuaWZvbGQuYWRkUG9pbnQoc3gsIHN5LCBzeiwgLW54LCAtbnksIC1ueiwgZGVwdGgxLCBmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGRlcHRoMiA8IDApIHtcclxuICAgICAgICAgICAgICBtYW5pZm9sZC5hZGRQb2ludChleCwgZXksIGV6LCAtbngsIC1ueSwgLW56LCBkZXB0aDIsIGZhbHNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gIH0pO1xyXG5cclxuICAvKipcclxuICAgKiBBIGNvbGxpc2lvbiBkZXRlY3RvciB3aGljaCBkZXRlY3RzIGNvbGxpc2lvbnMgYmV0d2VlbiBzcGhlcmUgYW5kIGJveC5cclxuICAgKiBAYXV0aG9yIHNhaGFyYW5cclxuICAgKi9cclxuICBmdW5jdGlvbiBTcGhlcmVCb3hDb2xsaXNpb25EZXRlY3RvcihmbGlwKSB7XHJcblxyXG4gICAgQ29sbGlzaW9uRGV0ZWN0b3IuY2FsbCh0aGlzKTtcclxuICAgIHRoaXMuZmxpcCA9IGZsaXA7XHJcblxyXG4gIH1cclxuICBTcGhlcmVCb3hDb2xsaXNpb25EZXRlY3Rvci5wcm90b3R5cGUgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoQ29sbGlzaW9uRGV0ZWN0b3IucHJvdG90eXBlKSwge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yOiBTcGhlcmVCb3hDb2xsaXNpb25EZXRlY3RvcixcclxuXHJcbiAgICBkZXRlY3RDb2xsaXNpb246IGZ1bmN0aW9uIChzaGFwZTEsIHNoYXBlMiwgbWFuaWZvbGQpIHtcclxuXHJcbiAgICAgIHZhciBzO1xyXG4gICAgICB2YXIgYjtcclxuICAgICAgaWYgKHRoaXMuZmxpcCkge1xyXG4gICAgICAgIHMgPSAoc2hhcGUyKTtcclxuICAgICAgICBiID0gKHNoYXBlMSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcyA9IChzaGFwZTEpO1xyXG4gICAgICAgIGIgPSAoc2hhcGUyKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIEQgPSBiLmRpbWVudGlvbnM7XHJcblxyXG4gICAgICB2YXIgcHMgPSBzLnBvc2l0aW9uO1xyXG4gICAgICB2YXIgcHN4ID0gcHMueDtcclxuICAgICAgdmFyIHBzeSA9IHBzLnk7XHJcbiAgICAgIHZhciBwc3ogPSBwcy56O1xyXG4gICAgICB2YXIgcGIgPSBiLnBvc2l0aW9uO1xyXG4gICAgICB2YXIgcGJ4ID0gcGIueDtcclxuICAgICAgdmFyIHBieSA9IHBiLnk7XHJcbiAgICAgIHZhciBwYnogPSBwYi56O1xyXG4gICAgICB2YXIgcmFkID0gcy5yYWRpdXM7XHJcblxyXG4gICAgICB2YXIgaHcgPSBiLmhhbGZXaWR0aDtcclxuICAgICAgdmFyIGhoID0gYi5oYWxmSGVpZ2h0O1xyXG4gICAgICB2YXIgaGQgPSBiLmhhbGZEZXB0aDtcclxuXHJcbiAgICAgIHZhciBkeCA9IHBzeCAtIHBieDtcclxuICAgICAgdmFyIGR5ID0gcHN5IC0gcGJ5O1xyXG4gICAgICB2YXIgZHogPSBwc3ogLSBwYno7XHJcbiAgICAgIHZhciBzeCA9IERbMF0gKiBkeCArIERbMV0gKiBkeSArIERbMl0gKiBkejtcclxuICAgICAgdmFyIHN5ID0gRFszXSAqIGR4ICsgRFs0XSAqIGR5ICsgRFs1XSAqIGR6O1xyXG4gICAgICB2YXIgc3ogPSBEWzZdICogZHggKyBEWzddICogZHkgKyBEWzhdICogZHo7XHJcbiAgICAgIHZhciBjeDtcclxuICAgICAgdmFyIGN5O1xyXG4gICAgICB2YXIgY3o7XHJcbiAgICAgIHZhciBsZW47XHJcbiAgICAgIHZhciBpbnZMZW47XHJcbiAgICAgIHZhciBvdmVybGFwID0gMDtcclxuICAgICAgaWYgKHN4ID4gaHcpIHtcclxuICAgICAgICBzeCA9IGh3O1xyXG4gICAgICB9IGVsc2UgaWYgKHN4IDwgLWh3KSB7XHJcbiAgICAgICAgc3ggPSAtaHc7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgb3ZlcmxhcCA9IDE7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHN5ID4gaGgpIHtcclxuICAgICAgICBzeSA9IGhoO1xyXG4gICAgICB9IGVsc2UgaWYgKHN5IDwgLWhoKSB7XHJcbiAgICAgICAgc3kgPSAtaGg7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgb3ZlcmxhcCB8PSAyO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChzeiA+IGhkKSB7XHJcbiAgICAgICAgc3ogPSBoZDtcclxuICAgICAgfSBlbHNlIGlmIChzeiA8IC1oZCkge1xyXG4gICAgICAgIHN6ID0gLWhkO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIG92ZXJsYXAgfD0gNDtcclxuICAgICAgfVxyXG4gICAgICBpZiAob3ZlcmxhcCA9PSA3KSB7XHJcbiAgICAgICAgLy8gY2VudGVyIG9mIHNwaGVyZSBpcyBpbiB0aGUgYm94XHJcbiAgICAgICAgaWYgKHN4IDwgMCkge1xyXG4gICAgICAgICAgZHggPSBodyArIHN4O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBkeCA9IGh3IC0gc3g7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzeSA8IDApIHtcclxuICAgICAgICAgIGR5ID0gaGggKyBzeTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgZHkgPSBoaCAtIHN5O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoc3ogPCAwKSB7XHJcbiAgICAgICAgICBkeiA9IGhkICsgc3o7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIGR6ID0gaGQgLSBzejtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGR4IDwgZHkpIHtcclxuICAgICAgICAgIGlmIChkeCA8IGR6KSB7XHJcbiAgICAgICAgICAgIGxlbiA9IGR4IC0gaHc7XHJcbiAgICAgICAgICAgIGlmIChzeCA8IDApIHtcclxuICAgICAgICAgICAgICBzeCA9IC1odztcclxuICAgICAgICAgICAgICBkeCA9IERbMF07XHJcbiAgICAgICAgICAgICAgZHkgPSBEWzFdO1xyXG4gICAgICAgICAgICAgIGR6ID0gRFsyXTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICBzeCA9IGh3O1xyXG4gICAgICAgICAgICAgIGR4ID0gLURbMF07XHJcbiAgICAgICAgICAgICAgZHkgPSAtRFsxXTtcclxuICAgICAgICAgICAgICBkeiA9IC1EWzJdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsZW4gPSBkeiAtIGhkO1xyXG4gICAgICAgICAgICBpZiAoc3ogPCAwKSB7XHJcbiAgICAgICAgICAgICAgc3ogPSAtaGQ7XHJcbiAgICAgICAgICAgICAgZHggPSBEWzZdO1xyXG4gICAgICAgICAgICAgIGR5ID0gRFs3XTtcclxuICAgICAgICAgICAgICBkeiA9IERbOF07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgc3ogPSBoZDtcclxuICAgICAgICAgICAgICBkeCA9IC1EWzZdO1xyXG4gICAgICAgICAgICAgIGR5ID0gLURbN107XHJcbiAgICAgICAgICAgICAgZHogPSAtRFs4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAoZHkgPCBkeikge1xyXG4gICAgICAgICAgICBsZW4gPSBkeSAtIGhoO1xyXG4gICAgICAgICAgICBpZiAoc3kgPCAwKSB7XHJcbiAgICAgICAgICAgICAgc3kgPSAtaGg7XHJcbiAgICAgICAgICAgICAgZHggPSBEWzNdO1xyXG4gICAgICAgICAgICAgIGR5ID0gRFs0XTtcclxuICAgICAgICAgICAgICBkeiA9IERbNV07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgc3kgPSBoaDtcclxuICAgICAgICAgICAgICBkeCA9IC1EWzNdO1xyXG4gICAgICAgICAgICAgIGR5ID0gLURbNF07XHJcbiAgICAgICAgICAgICAgZHogPSAtRFs1XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGVuID0gZHogLSBoZDtcclxuICAgICAgICAgICAgaWYgKHN6IDwgMCkge1xyXG4gICAgICAgICAgICAgIHN6ID0gLWhkO1xyXG4gICAgICAgICAgICAgIGR4ID0gRFs2XTtcclxuICAgICAgICAgICAgICBkeSA9IERbN107XHJcbiAgICAgICAgICAgICAgZHogPSBEWzhdO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHN6ID0gaGQ7XHJcbiAgICAgICAgICAgICAgZHggPSAtRFs2XTtcclxuICAgICAgICAgICAgICBkeSA9IC1EWzddO1xyXG4gICAgICAgICAgICAgIGR6ID0gLURbOF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY3ggPSBwYnggKyBzeCAqIERbMF0gKyBzeSAqIERbM10gKyBzeiAqIERbNl07XHJcbiAgICAgICAgY3kgPSBwYnkgKyBzeCAqIERbMV0gKyBzeSAqIERbNF0gKyBzeiAqIERbN107XHJcbiAgICAgICAgY3ogPSBwYnogKyBzeCAqIERbMl0gKyBzeSAqIERbNV0gKyBzeiAqIERbOF07XHJcbiAgICAgICAgbWFuaWZvbGQuYWRkUG9pbnQocHN4ICsgcmFkICogZHgsIHBzeSArIHJhZCAqIGR5LCBwc3ogKyByYWQgKiBkeiwgZHgsIGR5LCBkeiwgbGVuIC0gcmFkLCB0aGlzLmZsaXApO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGN4ID0gcGJ4ICsgc3ggKiBEWzBdICsgc3kgKiBEWzNdICsgc3ogKiBEWzZdO1xyXG4gICAgICAgIGN5ID0gcGJ5ICsgc3ggKiBEWzFdICsgc3kgKiBEWzRdICsgc3ogKiBEWzddO1xyXG4gICAgICAgIGN6ID0gcGJ6ICsgc3ggKiBEWzJdICsgc3kgKiBEWzVdICsgc3ogKiBEWzhdO1xyXG4gICAgICAgIGR4ID0gY3ggLSBwcy54O1xyXG4gICAgICAgIGR5ID0gY3kgLSBwcy55O1xyXG4gICAgICAgIGR6ID0gY3ogLSBwcy56O1xyXG4gICAgICAgIGxlbiA9IGR4ICogZHggKyBkeSAqIGR5ICsgZHogKiBkejtcclxuICAgICAgICBpZiAobGVuID4gMCAmJiBsZW4gPCByYWQgKiByYWQpIHtcclxuICAgICAgICAgIGxlbiA9IF9NYXRoLnNxcnQobGVuKTtcclxuICAgICAgICAgIGludkxlbiA9IDEgLyBsZW47XHJcbiAgICAgICAgICBkeCAqPSBpbnZMZW47XHJcbiAgICAgICAgICBkeSAqPSBpbnZMZW47XHJcbiAgICAgICAgICBkeiAqPSBpbnZMZW47XHJcbiAgICAgICAgICBtYW5pZm9sZC5hZGRQb2ludChwc3ggKyByYWQgKiBkeCwgcHN5ICsgcmFkICogZHksIHBzeiArIHJhZCAqIGR6LCBkeCwgZHksIGR6LCBsZW4gLSByYWQsIHRoaXMuZmxpcCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgZnVuY3Rpb24gU3BoZXJlQ3lsaW5kZXJDb2xsaXNpb25EZXRlY3RvcihmbGlwKSB7XHJcblxyXG4gICAgQ29sbGlzaW9uRGV0ZWN0b3IuY2FsbCh0aGlzKTtcclxuICAgIHRoaXMuZmxpcCA9IGZsaXA7XHJcblxyXG4gIH1cclxuICBTcGhlcmVDeWxpbmRlckNvbGxpc2lvbkRldGVjdG9yLnByb3RvdHlwZSA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShDb2xsaXNpb25EZXRlY3Rvci5wcm90b3R5cGUpLCB7XHJcblxyXG4gICAgY29uc3RydWN0b3I6IFNwaGVyZUN5bGluZGVyQ29sbGlzaW9uRGV0ZWN0b3IsXHJcblxyXG4gICAgZGV0ZWN0Q29sbGlzaW9uOiBmdW5jdGlvbiAoc2hhcGUxLCBzaGFwZTIsIG1hbmlmb2xkKSB7XHJcblxyXG4gICAgICB2YXIgcztcclxuICAgICAgdmFyIGM7XHJcbiAgICAgIGlmICh0aGlzLmZsaXApIHtcclxuICAgICAgICBzID0gc2hhcGUyO1xyXG4gICAgICAgIGMgPSBzaGFwZTE7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcyA9IHNoYXBlMTtcclxuICAgICAgICBjID0gc2hhcGUyO1xyXG4gICAgICB9XHJcbiAgICAgIHZhciBwcyA9IHMucG9zaXRpb247XHJcbiAgICAgIHZhciBwc3ggPSBwcy54O1xyXG4gICAgICB2YXIgcHN5ID0gcHMueTtcclxuICAgICAgdmFyIHBzeiA9IHBzLno7XHJcbiAgICAgIHZhciBwYyA9IGMucG9zaXRpb247XHJcbiAgICAgIHZhciBwY3ggPSBwYy54O1xyXG4gICAgICB2YXIgcGN5ID0gcGMueTtcclxuICAgICAgdmFyIHBjeiA9IHBjLno7XHJcbiAgICAgIHZhciBkaXJ4ID0gYy5ub3JtYWxEaXJlY3Rpb24ueDtcclxuICAgICAgdmFyIGRpcnkgPSBjLm5vcm1hbERpcmVjdGlvbi55O1xyXG4gICAgICB2YXIgZGlyeiA9IGMubm9ybWFsRGlyZWN0aW9uLno7XHJcbiAgICAgIHZhciByYWRzID0gcy5yYWRpdXM7XHJcbiAgICAgIHZhciByYWRjID0gYy5yYWRpdXM7XHJcbiAgICAgIHZhciByYWQyID0gcmFkcyArIHJhZGM7XHJcbiAgICAgIHZhciBoYWxmaCA9IGMuaGFsZkhlaWdodDtcclxuICAgICAgdmFyIGR4ID0gcHN4IC0gcGN4O1xyXG4gICAgICB2YXIgZHkgPSBwc3kgLSBwY3k7XHJcbiAgICAgIHZhciBkeiA9IHBzeiAtIHBjejtcclxuICAgICAgdmFyIGRvdCA9IGR4ICogZGlyeCArIGR5ICogZGlyeSArIGR6ICogZGlyejtcclxuICAgICAgaWYgKGRvdCA8IC1oYWxmaCAtIHJhZHMgfHwgZG90ID4gaGFsZmggKyByYWRzKSByZXR1cm47XHJcbiAgICAgIHZhciBjeCA9IHBjeCArIGRvdCAqIGRpcng7XHJcbiAgICAgIHZhciBjeSA9IHBjeSArIGRvdCAqIGRpcnk7XHJcbiAgICAgIHZhciBjeiA9IHBjeiArIGRvdCAqIGRpcno7XHJcbiAgICAgIHZhciBkMnggPSBwc3ggLSBjeDtcclxuICAgICAgdmFyIGQyeSA9IHBzeSAtIGN5O1xyXG4gICAgICB2YXIgZDJ6ID0gcHN6IC0gY3o7XHJcbiAgICAgIHZhciBsZW4gPSBkMnggKiBkMnggKyBkMnkgKiBkMnkgKyBkMnogKiBkMno7XHJcbiAgICAgIGlmIChsZW4gPiByYWQyICogcmFkMikgcmV0dXJuO1xyXG4gICAgICBpZiAobGVuID4gcmFkYyAqIHJhZGMpIHtcclxuICAgICAgICBsZW4gPSByYWRjIC8gX01hdGguc3FydChsZW4pO1xyXG4gICAgICAgIGQyeCAqPSBsZW47XHJcbiAgICAgICAgZDJ5ICo9IGxlbjtcclxuICAgICAgICBkMnogKj0gbGVuO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChkb3QgPCAtaGFsZmgpIGRvdCA9IC1oYWxmaDtcclxuICAgICAgZWxzZSBpZiAoZG90ID4gaGFsZmgpIGRvdCA9IGhhbGZoO1xyXG4gICAgICBjeCA9IHBjeCArIGRvdCAqIGRpcnggKyBkMng7XHJcbiAgICAgIGN5ID0gcGN5ICsgZG90ICogZGlyeSArIGQyeTtcclxuICAgICAgY3ogPSBwY3ogKyBkb3QgKiBkaXJ6ICsgZDJ6O1xyXG4gICAgICBkeCA9IGN4IC0gcHN4O1xyXG4gICAgICBkeSA9IGN5IC0gcHN5O1xyXG4gICAgICBkeiA9IGN6IC0gcHN6O1xyXG4gICAgICBsZW4gPSBkeCAqIGR4ICsgZHkgKiBkeSArIGR6ICogZHo7XHJcbiAgICAgIHZhciBpbnZMZW47XHJcbiAgICAgIGlmIChsZW4gPiAwICYmIGxlbiA8IHJhZHMgKiByYWRzKSB7XHJcbiAgICAgICAgbGVuID0gX01hdGguc3FydChsZW4pO1xyXG4gICAgICAgIGludkxlbiA9IDEgLyBsZW47XHJcbiAgICAgICAgZHggKj0gaW52TGVuO1xyXG4gICAgICAgIGR5ICo9IGludkxlbjtcclxuICAgICAgICBkeiAqPSBpbnZMZW47XHJcbiAgICAgICAgLy8vcmVzdWx0LmFkZENvbnRhY3RJbmZvKHBzeCtkeCpyYWRzLHBzeStkeSpyYWRzLHBzeitkeipyYWRzLGR4LGR5LGR6LGxlbi1yYWRzLHMsYywwLDAsZmFsc2UpO1xyXG4gICAgICAgIG1hbmlmb2xkLmFkZFBvaW50KHBzeCArIGR4ICogcmFkcywgcHN5ICsgZHkgKiByYWRzLCBwc3ogKyBkeiAqIHJhZHMsIGR4LCBkeSwgZHosIGxlbiAtIHJhZHMsIHRoaXMuZmxpcCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG5cclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgICogQSBjb2xsaXNpb24gZGV0ZWN0b3Igd2hpY2ggZGV0ZWN0cyBjb2xsaXNpb25zIGJldHdlZW4gdHdvIHNwaGVyZXMuXHJcbiAgICogQGF1dGhvciBzYWhhcmFuXHJcbiAgICovXHJcblxyXG4gIGZ1bmN0aW9uIFNwaGVyZVNwaGVyZUNvbGxpc2lvbkRldGVjdG9yKCkge1xyXG5cclxuICAgIENvbGxpc2lvbkRldGVjdG9yLmNhbGwodGhpcyk7XHJcblxyXG4gIH1cclxuICBTcGhlcmVTcGhlcmVDb2xsaXNpb25EZXRlY3Rvci5wcm90b3R5cGUgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoQ29sbGlzaW9uRGV0ZWN0b3IucHJvdG90eXBlKSwge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yOiBTcGhlcmVTcGhlcmVDb2xsaXNpb25EZXRlY3RvcixcclxuXHJcbiAgICBkZXRlY3RDb2xsaXNpb246IGZ1bmN0aW9uIChzaGFwZTEsIHNoYXBlMiwgbWFuaWZvbGQpIHtcclxuXHJcbiAgICAgIHZhciBzMSA9IHNoYXBlMTtcclxuICAgICAgdmFyIHMyID0gc2hhcGUyO1xyXG4gICAgICB2YXIgcDEgPSBzMS5wb3NpdGlvbjtcclxuICAgICAgdmFyIHAyID0gczIucG9zaXRpb247XHJcbiAgICAgIHZhciBkeCA9IHAyLnggLSBwMS54O1xyXG4gICAgICB2YXIgZHkgPSBwMi55IC0gcDEueTtcclxuICAgICAgdmFyIGR6ID0gcDIueiAtIHAxLno7XHJcbiAgICAgIHZhciBsZW4gPSBkeCAqIGR4ICsgZHkgKiBkeSArIGR6ICogZHo7XHJcbiAgICAgIHZhciByMSA9IHMxLnJhZGl1cztcclxuICAgICAgdmFyIHIyID0gczIucmFkaXVzO1xyXG4gICAgICB2YXIgcmFkID0gcjEgKyByMjtcclxuICAgICAgaWYgKGxlbiA+IDAgJiYgbGVuIDwgcmFkICogcmFkKSB7XHJcbiAgICAgICAgbGVuID0gX01hdGguc3FydChsZW4pO1xyXG4gICAgICAgIHZhciBpbnZMZW4gPSAxIC8gbGVuO1xyXG4gICAgICAgIGR4ICo9IGludkxlbjtcclxuICAgICAgICBkeSAqPSBpbnZMZW47XHJcbiAgICAgICAgZHogKj0gaW52TGVuO1xyXG4gICAgICAgIG1hbmlmb2xkLmFkZFBvaW50KHAxLnggKyBkeCAqIHIxLCBwMS55ICsgZHkgKiByMSwgcDEueiArIGR6ICogcjEsIGR4LCBkeSwgZHosIGxlbiAtIHJhZCwgZmFsc2UpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgICogQSBjb2xsaXNpb24gZGV0ZWN0b3Igd2hpY2ggZGV0ZWN0cyBjb2xsaXNpb25zIGJldHdlZW4gdHdvIHNwaGVyZXMuXHJcbiAgICogQGF1dGhvciBzYWhhcmFuIFxyXG4gICAqIEBhdXRob3IgbG8tdGhcclxuICAgKi9cclxuXHJcbiAgZnVuY3Rpb24gU3BoZXJlUGxhbmVDb2xsaXNpb25EZXRlY3RvcihmbGlwKSB7XHJcblxyXG4gICAgQ29sbGlzaW9uRGV0ZWN0b3IuY2FsbCh0aGlzKTtcclxuXHJcbiAgICB0aGlzLmZsaXAgPSBmbGlwO1xyXG5cclxuICAgIHRoaXMubiA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLnAgPSBuZXcgVmVjMygpO1xyXG5cclxuICB9XHJcbiAgU3BoZXJlUGxhbmVDb2xsaXNpb25EZXRlY3Rvci5wcm90b3R5cGUgPSBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoQ29sbGlzaW9uRGV0ZWN0b3IucHJvdG90eXBlKSwge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yOiBTcGhlcmVQbGFuZUNvbGxpc2lvbkRldGVjdG9yLFxyXG5cclxuICAgIGRldGVjdENvbGxpc2lvbjogZnVuY3Rpb24gKHNoYXBlMSwgc2hhcGUyLCBtYW5pZm9sZCkge1xyXG5cclxuICAgICAgdmFyIG4gPSB0aGlzLm47XHJcbiAgICAgIHZhciBwID0gdGhpcy5wO1xyXG5cclxuICAgICAgdmFyIHMgPSB0aGlzLmZsaXAgPyBzaGFwZTIgOiBzaGFwZTE7XHJcbiAgICAgIHZhciBwbiA9IHRoaXMuZmxpcCA/IHNoYXBlMSA6IHNoYXBlMjtcclxuICAgICAgdmFyIHJhZCA9IHMucmFkaXVzO1xyXG4gICAgICB2YXIgbGVuO1xyXG5cclxuICAgICAgbi5zdWIocy5wb3NpdGlvbiwgcG4ucG9zaXRpb24pO1xyXG4gICAgICAvL3ZhciBoID0gX01hdGguZG90VmVjdG9ycyggcG4ubm9ybWFsLCBuICk7XHJcblxyXG4gICAgICBuLnggKj0gcG4ubm9ybWFsLng7Ly8rIHJhZDtcclxuICAgICAgbi55ICo9IHBuLm5vcm1hbC55O1xyXG4gICAgICBuLnogKj0gcG4ubm9ybWFsLno7Ly8rIHJhZDtcclxuXHJcblxyXG4gICAgICB2YXIgbGVuID0gbi5sZW5ndGhTcSgpO1xyXG5cclxuICAgICAgaWYgKGxlbiA+IDAgJiYgbGVuIDwgcmFkICogcmFkKSB7Ly8mJiBoID4gcmFkKnJhZCApe1xyXG5cclxuXHJcbiAgICAgICAgbGVuID0gX01hdGguc3FydChsZW4pO1xyXG4gICAgICAgIC8vbGVuID0gX01hdGguc3FydCggaCApO1xyXG4gICAgICAgIG4uY29weShwbi5ub3JtYWwpLm5lZ2F0ZSgpO1xyXG4gICAgICAgIC8vbi5zY2FsZUVxdWFsKCAxL2xlbiApO1xyXG5cclxuICAgICAgICAvLygwLCAtMSwgMClcclxuXHJcbiAgICAgICAgLy9uLm5vcm1hbGl6ZSgpO1xyXG4gICAgICAgIHAuY29weShzLnBvc2l0aW9uKS5hZGRTY2FsZWRWZWN0b3IobiwgcmFkKTtcclxuICAgICAgICBtYW5pZm9sZC5hZGRQb2ludFZlYyhwLCBuLCBsZW4gLSByYWQsIHRoaXMuZmxpcCk7XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgICogQSBjb2xsaXNpb24gZGV0ZWN0b3Igd2hpY2ggZGV0ZWN0cyBjb2xsaXNpb25zIGJldHdlZW4gdHdvIHNwaGVyZXMuXHJcbiAgICogQGF1dGhvciBzYWhhcmFuIFxyXG4gICAqIEBhdXRob3IgbG8tdGhcclxuICAgKi9cclxuXHJcbiAgZnVuY3Rpb24gQm94UGxhbmVDb2xsaXNpb25EZXRlY3RvcihmbGlwKSB7XHJcblxyXG4gICAgQ29sbGlzaW9uRGV0ZWN0b3IuY2FsbCh0aGlzKTtcclxuXHJcbiAgICB0aGlzLmZsaXAgPSBmbGlwO1xyXG5cclxuICAgIHRoaXMubiA9IG5ldyBWZWMzKCk7XHJcbiAgICB0aGlzLnAgPSBuZXcgVmVjMygpO1xyXG5cclxuICAgIHRoaXMuZGl4ID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMuZGl5ID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMuZGl6ID0gbmV3IFZlYzMoKTtcclxuXHJcbiAgICB0aGlzLmNjID0gbmV3IFZlYzMoKTtcclxuICAgIHRoaXMuY2MyID0gbmV3IFZlYzMoKTtcclxuXHJcbiAgfVxyXG4gIEJveFBsYW5lQ29sbGlzaW9uRGV0ZWN0b3IucHJvdG90eXBlID0gT2JqZWN0LmFzc2lnbihPYmplY3QuY3JlYXRlKENvbGxpc2lvbkRldGVjdG9yLnByb3RvdHlwZSksIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcjogQm94UGxhbmVDb2xsaXNpb25EZXRlY3RvcixcclxuXHJcbiAgICBkZXRlY3RDb2xsaXNpb246IGZ1bmN0aW9uIChzaGFwZTEsIHNoYXBlMiwgbWFuaWZvbGQpIHtcclxuXHJcbiAgICAgIHZhciBuID0gdGhpcy5uO1xyXG4gICAgICB2YXIgcCA9IHRoaXMucDtcclxuICAgICAgdmFyIGNjID0gdGhpcy5jYztcclxuXHJcbiAgICAgIHZhciBiID0gdGhpcy5mbGlwID8gc2hhcGUyIDogc2hhcGUxO1xyXG4gICAgICB2YXIgcG4gPSB0aGlzLmZsaXAgPyBzaGFwZTEgOiBzaGFwZTI7XHJcblxyXG4gICAgICB2YXIgRCA9IGIuZGltZW50aW9ucztcclxuICAgICAgdmFyIGh3ID0gYi5oYWxmV2lkdGg7XHJcbiAgICAgIHZhciBoaCA9IGIuaGFsZkhlaWdodDtcclxuICAgICAgdmFyIGhkID0gYi5oYWxmRGVwdGg7XHJcbiAgICAgIHZhciBsZW47XHJcbiAgICAgIHZhciBvdmVybGFwID0gMDtcclxuXHJcbiAgICAgIHRoaXMuZGl4LnNldChEWzBdLCBEWzFdLCBEWzJdKTtcclxuICAgICAgdGhpcy5kaXkuc2V0KERbM10sIERbNF0sIERbNV0pO1xyXG4gICAgICB0aGlzLmRpei5zZXQoRFs2XSwgRFs3XSwgRFs4XSk7XHJcblxyXG4gICAgICBuLnN1YihiLnBvc2l0aW9uLCBwbi5wb3NpdGlvbik7XHJcblxyXG4gICAgICBuLnggKj0gcG4ubm9ybWFsLng7Ly8rIHJhZDtcclxuICAgICAgbi55ICo9IHBuLm5vcm1hbC55O1xyXG4gICAgICBuLnogKj0gcG4ubm9ybWFsLno7Ly8rIHJhZDtcclxuXHJcbiAgICAgIGNjLnNldChcclxuICAgICAgICBfTWF0aC5kb3RWZWN0b3JzKHRoaXMuZGl4LCBuKSxcclxuICAgICAgICBfTWF0aC5kb3RWZWN0b3JzKHRoaXMuZGl5LCBuKSxcclxuICAgICAgICBfTWF0aC5kb3RWZWN0b3JzKHRoaXMuZGl6LCBuKVxyXG4gICAgICApO1xyXG5cclxuXHJcbiAgICAgIGlmIChjYy54ID4gaHcpIGNjLnggPSBodztcclxuICAgICAgZWxzZSBpZiAoY2MueCA8IC1odykgY2MueCA9IC1odztcclxuICAgICAgZWxzZSBvdmVybGFwID0gMTtcclxuXHJcbiAgICAgIGlmIChjYy55ID4gaGgpIGNjLnkgPSBoaDtcclxuICAgICAgZWxzZSBpZiAoY2MueSA8IC1oaCkgY2MueSA9IC1oaDtcclxuICAgICAgZWxzZSBvdmVybGFwIHw9IDI7XHJcblxyXG4gICAgICBpZiAoY2MueiA+IGhkKSBjYy56ID0gaGQ7XHJcbiAgICAgIGVsc2UgaWYgKGNjLnogPCAtaGQpIGNjLnogPSAtaGQ7XHJcbiAgICAgIGVsc2Ugb3ZlcmxhcCB8PSA0O1xyXG5cclxuXHJcblxyXG4gICAgICBpZiAob3ZlcmxhcCA9PT0gNykge1xyXG5cclxuICAgICAgICAvLyBjZW50ZXIgb2Ygc3BoZXJlIGlzIGluIHRoZSBib3hcclxuXHJcbiAgICAgICAgbi5zZXQoXHJcbiAgICAgICAgICBjYy54IDwgMCA/IGh3ICsgY2MueCA6IGh3IC0gY2MueCxcclxuICAgICAgICAgIGNjLnkgPCAwID8gaGggKyBjYy55IDogaGggLSBjYy55LFxyXG4gICAgICAgICAgY2MueiA8IDAgPyBoZCArIGNjLnogOiBoZCAtIGNjLnpcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAobi54IDwgbi55KSB7XHJcbiAgICAgICAgICBpZiAobi54IDwgbi56KSB7XHJcbiAgICAgICAgICAgIGxlbiA9IG4ueCAtIGh3O1xyXG4gICAgICAgICAgICBpZiAoY2MueCA8IDApIHtcclxuICAgICAgICAgICAgICBjYy54ID0gLWh3O1xyXG4gICAgICAgICAgICAgIG4uY29weSh0aGlzLmRpeCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgY2MueCA9IGh3O1xyXG4gICAgICAgICAgICAgIG4uc3ViRXF1YWwodGhpcy5kaXgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsZW4gPSBuLnogLSBoZDtcclxuICAgICAgICAgICAgaWYgKGNjLnogPCAwKSB7XHJcbiAgICAgICAgICAgICAgY2MueiA9IC1oZDtcclxuICAgICAgICAgICAgICBuLmNvcHkodGhpcy5kaXopO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGNjLnogPSBoZDtcclxuICAgICAgICAgICAgICBuLnN1YkVxdWFsKHRoaXMuZGl6KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAobi55IDwgbi56KSB7XHJcbiAgICAgICAgICAgIGxlbiA9IG4ueSAtIGhoO1xyXG4gICAgICAgICAgICBpZiAoY2MueSA8IDApIHtcclxuICAgICAgICAgICAgICBjYy55ID0gLWhoO1xyXG4gICAgICAgICAgICAgIG4uY29weSh0aGlzLmRpeSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgY2MueSA9IGhoO1xyXG4gICAgICAgICAgICAgIG4uc3ViRXF1YWwodGhpcy5kaXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsZW4gPSBuLnogLSBoZDtcclxuICAgICAgICAgICAgaWYgKGNjLnogPCAwKSB7XHJcbiAgICAgICAgICAgICAgY2MueiA9IC1oZDtcclxuICAgICAgICAgICAgICBuLmNvcHkodGhpcy5kaXopO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGNjLnogPSBoZDtcclxuICAgICAgICAgICAgICBuLnN1YkVxdWFsKHRoaXMuZGl6KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcC5jb3B5KHBuLnBvc2l0aW9uKS5hZGRTY2FsZWRWZWN0b3IobiwgMSk7XHJcbiAgICAgICAgbWFuaWZvbGQuYWRkUG9pbnRWZWMocCwgbiwgbGVuLCB0aGlzLmZsaXApO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgfSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoZSBjbGFzcyBvZiBwaHlzaWNhbCBjb21wdXRpbmcgd29ybGQuXHJcbiAgICogWW91IG11c3QgYmUgYWRkZWQgdG8gdGhlIHdvcmxkIHBoeXNpY2FsIGFsbCBjb21wdXRpbmcgb2JqZWN0c1xyXG4gICAqXHJcbiAgICogQGF1dGhvciBzYWhhcmFuXHJcbiAgICogQGF1dGhvciBsby10aFxyXG4gICAqL1xyXG5cclxuICAvLyB0aW1lc3RlcCwgYnJvYWRwaGFzZSwgaXRlcmF0aW9ucywgd29ybGRzY2FsZSwgcmFuZG9tLCBzdGF0XHJcblxyXG4gIGZ1bmN0aW9uIFdvcmxkKG8pIHtcclxuXHJcbiAgICBpZiAoIShvIGluc3RhbmNlb2YgT2JqZWN0KSkgbyA9IHt9O1xyXG5cclxuICAgIC8vIHRoaXMgd29ybGQgc2NhbGUgZGVmYXV0IGlzIDAuMSB0byAxMCBtZXRlcnMgbWF4IGZvciBkeW5hbWlxdWUgYm9keVxyXG4gICAgdGhpcy5zY2FsZSA9IG8ud29ybGRzY2FsZSB8fCAxO1xyXG4gICAgdGhpcy5pbnZTY2FsZSA9IDEgLyB0aGlzLnNjYWxlO1xyXG5cclxuICAgIC8vIFRoZSB0aW1lIGJldHdlZW4gZWFjaCBzdGVwXHJcbiAgICB0aGlzLnRpbWVTdGVwID0gby50aW1lc3RlcCB8fCAwLjAxNjY2OyAvLyAxLzYwO1xyXG4gICAgdGhpcy50aW1lcmF0ZSA9IHRoaXMudGltZVN0ZXAgKiAxMDAwO1xyXG4gICAgdGhpcy50aW1lciA9IG51bGw7XHJcblxyXG4gICAgdGhpcy5wcmVMb29wID0gbnVsbDsvL2Z1bmN0aW9uKCl7fTtcclxuICAgIHRoaXMucG9zdExvb3AgPSBudWxsOy8vZnVuY3Rpb24oKXt9O1xyXG5cclxuICAgIC8vIFRoZSBudW1iZXIgb2YgaXRlcmF0aW9ucyBmb3IgY29uc3RyYWludCBzb2x2ZXJzLlxyXG4gICAgdGhpcy5udW1JdGVyYXRpb25zID0gby5pdGVyYXRpb25zIHx8IDg7XHJcblxyXG4gICAgLy8gSXQgaXMgYSB3aWRlLWFyZWEgY29sbGlzaW9uIGp1ZGdtZW50IHRoYXQgaXMgdXNlZCBpbiBvcmRlciB0byByZWR1Y2UgYXMgbXVjaCBhcyBwb3NzaWJsZSBhIGRldGFpbGVkIGNvbGxpc2lvbiBqdWRnbWVudC5cclxuICAgIHN3aXRjaCAoby5icm9hZHBoYXNlIHx8IDIpIHtcclxuICAgICAgY2FzZSAxOiB0aGlzLmJyb2FkUGhhc2UgPSBuZXcgQnJ1dGVGb3JjZUJyb2FkUGhhc2UoKTsgYnJlYWs7XHJcbiAgICAgIGNhc2UgMjogZGVmYXVsdDogdGhpcy5icm9hZFBoYXNlID0gbmV3IFNBUEJyb2FkUGhhc2UoKTsgYnJlYWs7XHJcbiAgICAgIGNhc2UgMzogdGhpcy5icm9hZFBoYXNlID0gbmV3IERCVlRCcm9hZFBoYXNlKCk7IGJyZWFrO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuQnR5cGVzID0gWydOb25lJywgJ0JydXRlRm9yY2UnLCAnU3dlZXAgJiBQcnVuZScsICdCb3VuZGluZyBWb2x1bWUgVHJlZSddO1xyXG4gICAgdGhpcy5icm9hZFBoYXNlVHlwZSA9IHRoaXMuQnR5cGVzW28uYnJvYWRwaGFzZSB8fCAyXTtcclxuXHJcbiAgICAvLyBUaGlzIGlzIHRoZSBkZXRhaWxlZCBpbmZvcm1hdGlvbiBvZiB0aGUgcGVyZm9ybWFuY2UuXHJcbiAgICB0aGlzLnBlcmZvcm1hbmNlID0gbnVsbDtcclxuICAgIHRoaXMuaXNTdGF0ID0gby5pbmZvID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IG8uaW5mbztcclxuICAgIGlmICh0aGlzLmlzU3RhdCkgdGhpcy5wZXJmb3JtYW5jZSA9IG5ldyBJbmZvRGlzcGxheSh0aGlzKTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFdoZXRoZXIgdGhlIGNvbnN0cmFpbnRzIHJhbmRvbWl6ZXIgaXMgZW5hYmxlZCBvciBub3QuXHJcbiAgICAgKlxyXG4gICAgICogQHByb3BlcnR5IGVuYWJsZVJhbmRvbWl6ZXJcclxuICAgICAqIEB0eXBlIHtCb29sZWFufVxyXG4gICAgICovXHJcbiAgICB0aGlzLmVuYWJsZVJhbmRvbWl6ZXIgPSBvLnJhbmRvbSAhPT0gdW5kZWZpbmVkID8gby5yYW5kb20gOiB0cnVlO1xyXG5cclxuICAgIC8vIFRoZSByaWdpZCBib2R5IGxpc3RcclxuICAgIHRoaXMucmlnaWRCb2RpZXMgPSBudWxsO1xyXG4gICAgLy8gbnVtYmVyIG9mIHJpZ2lkIGJvZHlcclxuICAgIHRoaXMubnVtUmlnaWRCb2RpZXMgPSAwO1xyXG4gICAgLy8gVGhlIGNvbnRhY3QgbGlzdFxyXG4gICAgdGhpcy5jb250YWN0cyA9IG51bGw7XHJcbiAgICB0aGlzLnVudXNlZENvbnRhY3RzID0gbnVsbDtcclxuICAgIC8vIFRoZSBudW1iZXIgb2YgY29udGFjdFxyXG4gICAgdGhpcy5udW1Db250YWN0cyA9IDA7XHJcbiAgICAvLyBUaGUgbnVtYmVyIG9mIGNvbnRhY3QgcG9pbnRzXHJcbiAgICB0aGlzLm51bUNvbnRhY3RQb2ludHMgPSAwO1xyXG4gICAgLy8gIFRoZSBqb2ludCBsaXN0XHJcbiAgICB0aGlzLmpvaW50cyA9IG51bGw7XHJcbiAgICAvLyBUaGUgbnVtYmVyIG9mIGpvaW50cy5cclxuICAgIHRoaXMubnVtSm9pbnRzID0gMDtcclxuICAgIC8vIFRoZSBudW1iZXIgb2Ygc2ltdWxhdGlvbiBpc2xhbmRzLlxyXG4gICAgdGhpcy5udW1Jc2xhbmRzID0gMDtcclxuXHJcblxyXG4gICAgLy8gVGhlIGdyYXZpdHkgaW4gdGhlIHdvcmxkLlxyXG4gICAgdGhpcy5ncmF2aXR5ID0gbmV3IFZlYzMoMCwgLTkuOCwgMCk7XHJcbiAgICBpZiAoby5ncmF2aXR5ICE9PSB1bmRlZmluZWQpIHRoaXMuZ3Jhdml0eS5mcm9tQXJyYXkoby5ncmF2aXR5KTtcclxuXHJcblxyXG5cclxuICAgIHZhciBudW1TaGFwZVR5cGVzID0gNTsvLzQ7Ly8zO1xyXG4gICAgdGhpcy5kZXRlY3RvcnMgPSBbXTtcclxuICAgIHRoaXMuZGV0ZWN0b3JzLmxlbmd0aCA9IG51bVNoYXBlVHlwZXM7XHJcbiAgICB2YXIgaSA9IG51bVNoYXBlVHlwZXM7XHJcbiAgICB3aGlsZSAoaS0tKSB7XHJcbiAgICAgIHRoaXMuZGV0ZWN0b3JzW2ldID0gW107XHJcbiAgICAgIHRoaXMuZGV0ZWN0b3JzW2ldLmxlbmd0aCA9IG51bVNoYXBlVHlwZXM7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5kZXRlY3RvcnNbU0hBUEVfU1BIRVJFXVtTSEFQRV9TUEhFUkVdID0gbmV3IFNwaGVyZVNwaGVyZUNvbGxpc2lvbkRldGVjdG9yKCk7XHJcbiAgICB0aGlzLmRldGVjdG9yc1tTSEFQRV9TUEhFUkVdW1NIQVBFX0JPWF0gPSBuZXcgU3BoZXJlQm94Q29sbGlzaW9uRGV0ZWN0b3IoZmFsc2UpO1xyXG4gICAgdGhpcy5kZXRlY3RvcnNbU0hBUEVfQk9YXVtTSEFQRV9TUEhFUkVdID0gbmV3IFNwaGVyZUJveENvbGxpc2lvbkRldGVjdG9yKHRydWUpO1xyXG4gICAgdGhpcy5kZXRlY3RvcnNbU0hBUEVfQk9YXVtTSEFQRV9CT1hdID0gbmV3IEJveEJveENvbGxpc2lvbkRldGVjdG9yKCk7XHJcblxyXG4gICAgLy8gQ1lMSU5ERVIgYWRkXHJcbiAgICB0aGlzLmRldGVjdG9yc1tTSEFQRV9DWUxJTkRFUl1bU0hBUEVfQ1lMSU5ERVJdID0gbmV3IEN5bGluZGVyQ3lsaW5kZXJDb2xsaXNpb25EZXRlY3RvcigpO1xyXG5cclxuICAgIHRoaXMuZGV0ZWN0b3JzW1NIQVBFX0NZTElOREVSXVtTSEFQRV9CT1hdID0gbmV3IEJveEN5bGluZGVyQ29sbGlzaW9uRGV0ZWN0b3IodHJ1ZSk7XHJcbiAgICB0aGlzLmRldGVjdG9yc1tTSEFQRV9CT1hdW1NIQVBFX0NZTElOREVSXSA9IG5ldyBCb3hDeWxpbmRlckNvbGxpc2lvbkRldGVjdG9yKGZhbHNlKTtcclxuXHJcbiAgICB0aGlzLmRldGVjdG9yc1tTSEFQRV9DWUxJTkRFUl1bU0hBUEVfU1BIRVJFXSA9IG5ldyBTcGhlcmVDeWxpbmRlckNvbGxpc2lvbkRldGVjdG9yKHRydWUpO1xyXG4gICAgdGhpcy5kZXRlY3RvcnNbU0hBUEVfU1BIRVJFXVtTSEFQRV9DWUxJTkRFUl0gPSBuZXcgU3BoZXJlQ3lsaW5kZXJDb2xsaXNpb25EZXRlY3RvcihmYWxzZSk7XHJcblxyXG4gICAgLy8gUExBTkUgYWRkXHJcblxyXG4gICAgdGhpcy5kZXRlY3RvcnNbU0hBUEVfUExBTkVdW1NIQVBFX1NQSEVSRV0gPSBuZXcgU3BoZXJlUGxhbmVDb2xsaXNpb25EZXRlY3Rvcih0cnVlKTtcclxuICAgIHRoaXMuZGV0ZWN0b3JzW1NIQVBFX1NQSEVSRV1bU0hBUEVfUExBTkVdID0gbmV3IFNwaGVyZVBsYW5lQ29sbGlzaW9uRGV0ZWN0b3IoZmFsc2UpO1xyXG5cclxuICAgIHRoaXMuZGV0ZWN0b3JzW1NIQVBFX1BMQU5FXVtTSEFQRV9CT1hdID0gbmV3IEJveFBsYW5lQ29sbGlzaW9uRGV0ZWN0b3IodHJ1ZSk7XHJcbiAgICB0aGlzLmRldGVjdG9yc1tTSEFQRV9CT1hdW1NIQVBFX1BMQU5FXSA9IG5ldyBCb3hQbGFuZUNvbGxpc2lvbkRldGVjdG9yKGZhbHNlKTtcclxuXHJcbiAgICAvLyBURVRSQSBhZGRcclxuICAgIC8vdGhpcy5kZXRlY3RvcnNbU0hBUEVfVEVUUkFdW1NIQVBFX1RFVFJBXSA9IG5ldyBUZXRyYVRldHJhQ29sbGlzaW9uRGV0ZWN0b3IoKTtcclxuXHJcblxyXG4gICAgdGhpcy5yYW5kWCA9IDY1NTM1O1xyXG4gICAgdGhpcy5yYW5kQSA9IDk4NzY1O1xyXG4gICAgdGhpcy5yYW5kQiA9IDEyMzQ1Njc4OTtcclxuXHJcbiAgICB0aGlzLmlzbGFuZFJpZ2lkQm9kaWVzID0gW107XHJcbiAgICB0aGlzLmlzbGFuZFN0YWNrID0gW107XHJcbiAgICB0aGlzLmlzbGFuZENvbnN0cmFpbnRzID0gW107XHJcblxyXG4gIH1cclxuXHJcbiAgT2JqZWN0LmFzc2lnbihXb3JsZC5wcm90b3R5cGUsIHtcclxuXHJcbiAgICBXb3JsZDogdHJ1ZSxcclxuXHJcbiAgICBwbGF5OiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICBpZiAodGhpcy50aW1lciAhPT0gbnVsbCkgcmV0dXJuO1xyXG5cclxuICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgdGhpcy50aW1lciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsgX3RoaXMuc3RlcCgpOyB9LCB0aGlzLnRpbWVyYXRlKTtcclxuICAgICAgLy90aGlzLnRpbWVyID0gc2V0SW50ZXJ2YWwoIHRoaXMubG9vcC5iaW5kKHRoaXMpICwgdGhpcy50aW1lcmF0ZSApO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc3RvcDogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgaWYgKHRoaXMudGltZXIgPT09IG51bGwpIHJldHVybjtcclxuXHJcbiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy50aW1lcik7XHJcbiAgICAgIHRoaXMudGltZXIgPSBudWxsO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgc2V0R3Jhdml0eTogZnVuY3Rpb24gKGFyKSB7XHJcblxyXG4gICAgICB0aGlzLmdyYXZpdHkuZnJvbUFycmF5KGFyKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGdldEluZm86IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgIHJldHVybiB0aGlzLmlzU3RhdCA/IHRoaXMucGVyZm9ybWFuY2Uuc2hvdygpIDogJyc7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvLyBSZXNldCB0aGUgd29ybGQgYW5kIHJlbW92ZSBhbGwgcmlnaWQgYm9kaWVzLCBzaGFwZXMsIGpvaW50cyBhbmQgYW55IG9iamVjdCBmcm9tIHRoZSB3b3JsZC5cclxuICAgIGNsZWFyOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB0aGlzLnN0b3AoKTtcclxuICAgICAgdGhpcy5wcmVMb29wID0gbnVsbDtcclxuICAgICAgdGhpcy5wb3N0TG9vcCA9IG51bGw7XHJcblxyXG4gICAgICB0aGlzLnJhbmRYID0gNjU1MzU7XHJcblxyXG4gICAgICB3aGlsZSAodGhpcy5qb2ludHMgIT09IG51bGwpIHtcclxuICAgICAgICB0aGlzLnJlbW92ZUpvaW50KHRoaXMuam9pbnRzKTtcclxuICAgICAgfVxyXG4gICAgICB3aGlsZSAodGhpcy5jb250YWN0cyAhPT0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlQ29udGFjdCh0aGlzLmNvbnRhY3RzKTtcclxuICAgICAgfVxyXG4gICAgICB3aGlsZSAodGhpcy5yaWdpZEJvZGllcyAhPT0gbnVsbCkge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlUmlnaWRCb2R5KHRoaXMucmlnaWRCb2RpZXMpO1xyXG4gICAgICB9XHJcblxyXG4gICAgfSxcclxuICAgIC8qKlxyXG4gICAgKiBJJ2xsIGFkZCBhIHJpZ2lkIGJvZHkgdG8gdGhlIHdvcmxkLlxyXG4gICAgKiBSaWdpZCBib2R5IHRoYXQgaGFzIGJlZW4gYWRkZWQgd2lsbCBiZSB0aGUgb3BlcmFuZHMgb2YgZWFjaCBzdGVwLlxyXG4gICAgKiBAcGFyYW0gIHJpZ2lkQm9keSAgUmlnaWQgYm9keSB0aGF0IHlvdSB3YW50IHRvIGFkZFxyXG4gICAgKi9cclxuICAgIGFkZFJpZ2lkQm9keTogZnVuY3Rpb24gKHJpZ2lkQm9keSkge1xyXG5cclxuICAgICAgaWYgKHJpZ2lkQm9keS5wYXJlbnQpIHtcclxuICAgICAgICBwcmludEVycm9yKFwiV29ybGRcIiwgXCJJdCBpcyBub3QgcG9zc2libGUgdG8gYmUgYWRkZWQgdG8gbW9yZSB0aGFuIG9uZSB3b3JsZCBvbmUgb2YgdGhlIHJpZ2lkIGJvZHlcIik7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJpZ2lkQm9keS5zZXRQYXJlbnQodGhpcyk7XHJcbiAgICAgIC8vcmlnaWRCb2R5LmF3YWtlKCk7XHJcblxyXG4gICAgICBmb3IgKHZhciBzaGFwZSA9IHJpZ2lkQm9keS5zaGFwZXM7IHNoYXBlICE9PSBudWxsOyBzaGFwZSA9IHNoYXBlLm5leHQpIHtcclxuICAgICAgICB0aGlzLmFkZFNoYXBlKHNoYXBlKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAodGhpcy5yaWdpZEJvZGllcyAhPT0gbnVsbCkgKHRoaXMucmlnaWRCb2RpZXMucHJldiA9IHJpZ2lkQm9keSkubmV4dCA9IHRoaXMucmlnaWRCb2RpZXM7XHJcbiAgICAgIHRoaXMucmlnaWRCb2RpZXMgPSByaWdpZEJvZHk7XHJcbiAgICAgIHRoaXMubnVtUmlnaWRCb2RpZXMrKztcclxuXHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAqIEkgd2lsbCByZW1vdmUgdGhlIHJpZ2lkIGJvZHkgZnJvbSB0aGUgd29ybGQuXHJcbiAgICAqIFJpZ2lkIGJvZHkgdGhhdCBoYXMgYmVlbiBkZWxldGVkIGlzIGV4Y2x1ZGVkIGZyb20gdGhlIGNhbGN1bGF0aW9uIG9uIGEgc3RlcC1ieS1zdGVwIGJhc2lzLlxyXG4gICAgKiBAcGFyYW0gIHJpZ2lkQm9keSAgUmlnaWQgYm9keSB0byBiZSByZW1vdmVkXHJcbiAgICAqL1xyXG4gICAgcmVtb3ZlUmlnaWRCb2R5OiBmdW5jdGlvbiAocmlnaWRCb2R5KSB7XHJcblxyXG4gICAgICB2YXIgcmVtb3ZlID0gcmlnaWRCb2R5O1xyXG4gICAgICBpZiAocmVtb3ZlLnBhcmVudCAhPT0gdGhpcykgcmV0dXJuO1xyXG4gICAgICByZW1vdmUuYXdha2UoKTtcclxuICAgICAgdmFyIGpzID0gcmVtb3ZlLmpvaW50TGluaztcclxuICAgICAgd2hpbGUgKGpzICE9IG51bGwpIHtcclxuICAgICAgICB2YXIgam9pbnQgPSBqcy5qb2ludDtcclxuICAgICAgICBqcyA9IGpzLm5leHQ7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVKb2ludChqb2ludCk7XHJcbiAgICAgIH1cclxuICAgICAgZm9yICh2YXIgc2hhcGUgPSByaWdpZEJvZHkuc2hhcGVzOyBzaGFwZSAhPT0gbnVsbDsgc2hhcGUgPSBzaGFwZS5uZXh0KSB7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVTaGFwZShzaGFwZSk7XHJcbiAgICAgIH1cclxuICAgICAgdmFyIHByZXYgPSByZW1vdmUucHJldjtcclxuICAgICAgdmFyIG5leHQgPSByZW1vdmUubmV4dDtcclxuICAgICAgaWYgKHByZXYgIT09IG51bGwpIHByZXYubmV4dCA9IG5leHQ7XHJcbiAgICAgIGlmIChuZXh0ICE9PSBudWxsKSBuZXh0LnByZXYgPSBwcmV2O1xyXG4gICAgICBpZiAodGhpcy5yaWdpZEJvZGllcyA9PSByZW1vdmUpIHRoaXMucmlnaWRCb2RpZXMgPSBuZXh0O1xyXG4gICAgICByZW1vdmUucHJldiA9IG51bGw7XHJcbiAgICAgIHJlbW92ZS5uZXh0ID0gbnVsbDtcclxuICAgICAgcmVtb3ZlLnBhcmVudCA9IG51bGw7XHJcbiAgICAgIHRoaXMubnVtUmlnaWRCb2RpZXMtLTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGdldEJ5TmFtZTogZnVuY3Rpb24gKG5hbWUpIHtcclxuXHJcbiAgICAgIHZhciBib2R5ID0gdGhpcy5yaWdpZEJvZGllcztcclxuICAgICAgd2hpbGUgKGJvZHkgIT09IG51bGwpIHtcclxuICAgICAgICBpZiAoYm9keS5uYW1lID09PSBuYW1lKSByZXR1cm4gYm9keTtcclxuICAgICAgICBib2R5ID0gYm9keS5uZXh0O1xyXG4gICAgICB9XHJcblxyXG4gICAgICB2YXIgam9pbnQgPSB0aGlzLmpvaW50cztcclxuICAgICAgd2hpbGUgKGpvaW50ICE9PSBudWxsKSB7XHJcbiAgICAgICAgaWYgKGpvaW50Lm5hbWUgPT09IG5hbWUpIHJldHVybiBqb2ludDtcclxuICAgICAgICBqb2ludCA9IGpvaW50Lm5leHQ7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBudWxsO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAqIEknbGwgYWRkIGEgc2hhcGUgdG8gdGhlIHdvcmxkLi5cclxuICAgICogQWRkIHRvIHRoZSByaWdpZCB3b3JsZCwgYW5kIGlmIHlvdSBhZGQgYSBzaGFwZSB0byBhIHJpZ2lkIGJvZHkgdGhhdCBoYXMgYmVlbiBhZGRlZCB0byB0aGUgd29ybGQsXHJcbiAgICAqIFNoYXBlIHdpbGwgYmUgYWRkZWQgdG8gdGhlIHdvcmxkIGF1dG9tYXRpY2FsbHksIHBsZWFzZSBkbyBub3QgY2FsbCBmcm9tIG91dHNpZGUgdGhpcyBtZXRob2QuXHJcbiAgICAqIEBwYXJhbSAgc2hhcGUgIFNoYXBlIHlvdSB3YW50IHRvIGFkZFxyXG4gICAgKi9cclxuICAgIGFkZFNoYXBlOiBmdW5jdGlvbiAoc2hhcGUpIHtcclxuXHJcbiAgICAgIGlmICghc2hhcGUucGFyZW50IHx8ICFzaGFwZS5wYXJlbnQucGFyZW50KSB7XHJcbiAgICAgICAgcHJpbnRFcnJvcihcIldvcmxkXCIsIFwiSXQgaXMgbm90IHBvc3NpYmxlIHRvIGJlIGFkZGVkIGFsb25lIHRvIHNoYXBlIHdvcmxkXCIpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBzaGFwZS5wcm94eSA9IHRoaXMuYnJvYWRQaGFzZS5jcmVhdGVQcm94eShzaGFwZSk7XHJcbiAgICAgIHNoYXBlLnVwZGF0ZVByb3h5KCk7XHJcbiAgICAgIHRoaXMuYnJvYWRQaGFzZS5hZGRQcm94eShzaGFwZS5wcm94eSk7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICogSSB3aWxsIHJlbW92ZSB0aGUgc2hhcGUgZnJvbSB0aGUgd29ybGQuXHJcbiAgICAqIEFkZCB0byB0aGUgcmlnaWQgd29ybGQsIGFuZCBpZiB5b3UgYWRkIGEgc2hhcGUgdG8gYSByaWdpZCBib2R5IHRoYXQgaGFzIGJlZW4gYWRkZWQgdG8gdGhlIHdvcmxkLFxyXG4gICAgKiBTaGFwZSB3aWxsIGJlIGFkZGVkIHRvIHRoZSB3b3JsZCBhdXRvbWF0aWNhbGx5LCBwbGVhc2UgZG8gbm90IGNhbGwgZnJvbSBvdXRzaWRlIHRoaXMgbWV0aG9kLlxyXG4gICAgKiBAcGFyYW0gIHNoYXBlICBTaGFwZSB5b3Ugd2FudCB0byBkZWxldGVcclxuICAgICovXHJcbiAgICByZW1vdmVTaGFwZTogZnVuY3Rpb24gKHNoYXBlKSB7XHJcblxyXG4gICAgICB0aGlzLmJyb2FkUGhhc2UucmVtb3ZlUHJveHkoc2hhcGUucHJveHkpO1xyXG4gICAgICBzaGFwZS5wcm94eSA9IG51bGw7XHJcblxyXG4gICAgfSxcclxuXHJcbiAgICAvKipcclxuICAgICogSSdsbCBhZGQgYSBqb2ludCB0byB0aGUgd29ybGQuXHJcbiAgICAqIEpvaW50IHRoYXQgaGFzIGJlZW4gYWRkZWQgd2lsbCBiZSB0aGUgb3BlcmFuZHMgb2YgZWFjaCBzdGVwLlxyXG4gICAgKiBAcGFyYW0gIHNoYXBlIEpvaW50IHRvIGJlIGFkZGVkXHJcbiAgICAqL1xyXG4gICAgYWRkSm9pbnQ6IGZ1bmN0aW9uIChqb2ludCkge1xyXG5cclxuICAgICAgaWYgKGpvaW50LnBhcmVudCkge1xyXG4gICAgICAgIHByaW50RXJyb3IoXCJXb3JsZFwiLCBcIkl0IGlzIG5vdCBwb3NzaWJsZSB0byBiZSBhZGRlZCB0byBtb3JlIHRoYW4gb25lIHdvcmxkIG9uZSBvZiB0aGUgam9pbnRcIik7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHRoaXMuam9pbnRzICE9IG51bGwpICh0aGlzLmpvaW50cy5wcmV2ID0gam9pbnQpLm5leHQgPSB0aGlzLmpvaW50cztcclxuICAgICAgdGhpcy5qb2ludHMgPSBqb2ludDtcclxuICAgICAgam9pbnQuc2V0UGFyZW50KHRoaXMpO1xyXG4gICAgICB0aGlzLm51bUpvaW50cysrO1xyXG4gICAgICBqb2ludC5hd2FrZSgpO1xyXG4gICAgICBqb2ludC5hdHRhY2goKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8qKlxyXG4gICAgKiBJIHdpbGwgcmVtb3ZlIHRoZSBqb2ludCBmcm9tIHRoZSB3b3JsZC5cclxuICAgICogSm9pbnQgdGhhdCBoYXMgYmVlbiBhZGRlZCB3aWxsIGJlIHRoZSBvcGVyYW5kcyBvZiBlYWNoIHN0ZXAuXHJcbiAgICAqIEBwYXJhbSAgc2hhcGUgSm9pbnQgdG8gYmUgZGVsZXRlZFxyXG4gICAgKi9cclxuICAgIHJlbW92ZUpvaW50OiBmdW5jdGlvbiAoam9pbnQpIHtcclxuXHJcbiAgICAgIHZhciByZW1vdmUgPSBqb2ludDtcclxuICAgICAgdmFyIHByZXYgPSByZW1vdmUucHJldjtcclxuICAgICAgdmFyIG5leHQgPSByZW1vdmUubmV4dDtcclxuICAgICAgaWYgKHByZXYgIT09IG51bGwpIHByZXYubmV4dCA9IG5leHQ7XHJcbiAgICAgIGlmIChuZXh0ICE9PSBudWxsKSBuZXh0LnByZXYgPSBwcmV2O1xyXG4gICAgICBpZiAodGhpcy5qb2ludHMgPT0gcmVtb3ZlKSB0aGlzLmpvaW50cyA9IG5leHQ7XHJcbiAgICAgIHJlbW92ZS5wcmV2ID0gbnVsbDtcclxuICAgICAgcmVtb3ZlLm5leHQgPSBudWxsO1xyXG4gICAgICB0aGlzLm51bUpvaW50cy0tO1xyXG4gICAgICByZW1vdmUuYXdha2UoKTtcclxuICAgICAgcmVtb3ZlLmRldGFjaCgpO1xyXG4gICAgICByZW1vdmUucGFyZW50ID0gbnVsbDtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGFkZENvbnRhY3Q6IGZ1bmN0aW9uIChzMSwgczIpIHtcclxuXHJcbiAgICAgIHZhciBuZXdDb250YWN0O1xyXG4gICAgICBpZiAodGhpcy51bnVzZWRDb250YWN0cyAhPT0gbnVsbCkge1xyXG4gICAgICAgIG5ld0NvbnRhY3QgPSB0aGlzLnVudXNlZENvbnRhY3RzO1xyXG4gICAgICAgIHRoaXMudW51c2VkQ29udGFjdHMgPSB0aGlzLnVudXNlZENvbnRhY3RzLm5leHQ7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbmV3Q29udGFjdCA9IG5ldyBDb250YWN0KCk7XHJcbiAgICAgIH1cclxuICAgICAgbmV3Q29udGFjdC5hdHRhY2goczEsIHMyKTtcclxuICAgICAgbmV3Q29udGFjdC5kZXRlY3RvciA9IHRoaXMuZGV0ZWN0b3JzW3MxLnR5cGVdW3MyLnR5cGVdO1xyXG4gICAgICBpZiAodGhpcy5jb250YWN0cykgKHRoaXMuY29udGFjdHMucHJldiA9IG5ld0NvbnRhY3QpLm5leHQgPSB0aGlzLmNvbnRhY3RzO1xyXG4gICAgICB0aGlzLmNvbnRhY3RzID0gbmV3Q29udGFjdDtcclxuICAgICAgdGhpcy5udW1Db250YWN0cysrO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgcmVtb3ZlQ29udGFjdDogZnVuY3Rpb24gKGNvbnRhY3QpIHtcclxuXHJcbiAgICAgIHZhciBwcmV2ID0gY29udGFjdC5wcmV2O1xyXG4gICAgICB2YXIgbmV4dCA9IGNvbnRhY3QubmV4dDtcclxuICAgICAgaWYgKG5leHQpIG5leHQucHJldiA9IHByZXY7XHJcbiAgICAgIGlmIChwcmV2KSBwcmV2Lm5leHQgPSBuZXh0O1xyXG4gICAgICBpZiAodGhpcy5jb250YWN0cyA9PSBjb250YWN0KSB0aGlzLmNvbnRhY3RzID0gbmV4dDtcclxuICAgICAgY29udGFjdC5wcmV2ID0gbnVsbDtcclxuICAgICAgY29udGFjdC5uZXh0ID0gbnVsbDtcclxuICAgICAgY29udGFjdC5kZXRhY2goKTtcclxuICAgICAgY29udGFjdC5uZXh0ID0gdGhpcy51bnVzZWRDb250YWN0cztcclxuICAgICAgdGhpcy51bnVzZWRDb250YWN0cyA9IGNvbnRhY3Q7XHJcbiAgICAgIHRoaXMubnVtQ29udGFjdHMtLTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGdldENvbnRhY3Q6IGZ1bmN0aW9uIChiMSwgYjIpIHtcclxuXHJcbiAgICAgIGIxID0gYjEuY29uc3RydWN0b3IgPT09IFJpZ2lkQm9keSA/IGIxLm5hbWUgOiBiMTtcclxuICAgICAgYjIgPSBiMi5jb25zdHJ1Y3RvciA9PT0gUmlnaWRCb2R5ID8gYjIubmFtZSA6IGIyO1xyXG5cclxuICAgICAgdmFyIG4xLCBuMjtcclxuICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLmNvbnRhY3RzO1xyXG4gICAgICB3aGlsZSAoY29udGFjdCAhPT0gbnVsbCkge1xyXG4gICAgICAgIG4xID0gY29udGFjdC5ib2R5MS5uYW1lO1xyXG4gICAgICAgIG4yID0gY29udGFjdC5ib2R5Mi5uYW1lO1xyXG4gICAgICAgIGlmICgobjEgPT09IGIxICYmIG4yID09PSBiMikgfHwgKG4yID09PSBiMSAmJiBuMSA9PT0gYjIpKSB7IGlmIChjb250YWN0LnRvdWNoaW5nKSByZXR1cm4gY29udGFjdDsgZWxzZSByZXR1cm4gbnVsbDsgfVxyXG4gICAgICAgIGVsc2UgY29udGFjdCA9IGNvbnRhY3QubmV4dDtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGNoZWNrQ29udGFjdDogZnVuY3Rpb24gKG5hbWUxLCBuYW1lMikge1xyXG5cclxuICAgICAgdmFyIG4xLCBuMjtcclxuICAgICAgdmFyIGNvbnRhY3QgPSB0aGlzLmNvbnRhY3RzO1xyXG4gICAgICB3aGlsZSAoY29udGFjdCAhPT0gbnVsbCkge1xyXG4gICAgICAgIG4xID0gY29udGFjdC5ib2R5MS5uYW1lIHx8ICcgJztcclxuICAgICAgICBuMiA9IGNvbnRhY3QuYm9keTIubmFtZSB8fCAnICc7XHJcbiAgICAgICAgaWYgKChuMSA9PSBuYW1lMSAmJiBuMiA9PSBuYW1lMikgfHwgKG4yID09IG5hbWUxICYmIG4xID09IG5hbWUyKSkgeyBpZiAoY29udGFjdC50b3VjaGluZykgcmV0dXJuIHRydWU7IGVsc2UgcmV0dXJuIGZhbHNlOyB9XHJcbiAgICAgICAgZWxzZSBjb250YWN0ID0gY29udGFjdC5uZXh0O1xyXG4gICAgICB9XHJcbiAgICAgIC8vcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgY2FsbFNsZWVwOiBmdW5jdGlvbiAoYm9keSkge1xyXG5cclxuICAgICAgaWYgKCFib2R5LmFsbG93U2xlZXApIHJldHVybiBmYWxzZTtcclxuICAgICAgaWYgKGJvZHkubGluZWFyVmVsb2NpdHkubGVuZ3RoU3EoKSA+IDAuMDQpIHJldHVybiBmYWxzZTtcclxuICAgICAgaWYgKGJvZHkuYW5ndWxhclZlbG9jaXR5Lmxlbmd0aFNxKCkgPiAwLjI1KSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLyoqXHJcbiAgICAqIEkgd2lsbCBwcm9jZWVkIG9ubHkgdGltZSBzdGVwIHNlY29uZHMgdGltZSBvZiBXb3JsZC5cclxuICAgICovXHJcbiAgICBzdGVwOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICB2YXIgc3RhdCA9IHRoaXMuaXNTdGF0O1xyXG5cclxuICAgICAgaWYgKHN0YXQpIHRoaXMucGVyZm9ybWFuY2Uuc2V0VGltZSgwKTtcclxuXHJcbiAgICAgIHZhciBib2R5ID0gdGhpcy5yaWdpZEJvZGllcztcclxuXHJcbiAgICAgIHdoaWxlIChib2R5ICE9PSBudWxsKSB7XHJcblxyXG4gICAgICAgIGJvZHkuYWRkZWRUb0lzbGFuZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICBpZiAoYm9keS5zbGVlcGluZykgYm9keS50ZXN0V2FrZVVwKCk7XHJcblxyXG4gICAgICAgIGJvZHkgPSBib2R5Lm5leHQ7XHJcblxyXG4gICAgICB9XHJcblxyXG5cclxuXHJcbiAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgIC8vICAgVVBEQVRFIEJST0FEUEhBU0UgQ09OVEFDVFxyXG4gICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgICAgaWYgKHN0YXQpIHRoaXMucGVyZm9ybWFuY2Uuc2V0VGltZSgxKTtcclxuXHJcbiAgICAgIHRoaXMuYnJvYWRQaGFzZS5kZXRlY3RQYWlycygpO1xyXG5cclxuICAgICAgdmFyIHBhaXJzID0gdGhpcy5icm9hZFBoYXNlLnBhaXJzO1xyXG5cclxuICAgICAgdmFyIGkgPSB0aGlzLmJyb2FkUGhhc2UubnVtUGFpcnM7XHJcbiAgICAgIC8vZG97XHJcbiAgICAgIHdoaWxlIChpLS0pIHtcclxuICAgICAgICAvL2Zvcih2YXIgaT0wLCBsPW51bVBhaXJzOyBpPGw7IGkrKyl7XHJcbiAgICAgICAgdmFyIHBhaXIgPSBwYWlyc1tpXTtcclxuICAgICAgICB2YXIgczE7XHJcbiAgICAgICAgdmFyIHMyO1xyXG4gICAgICAgIGlmIChwYWlyLnNoYXBlMS5pZCA8IHBhaXIuc2hhcGUyLmlkKSB7XHJcbiAgICAgICAgICBzMSA9IHBhaXIuc2hhcGUxO1xyXG4gICAgICAgICAgczIgPSBwYWlyLnNoYXBlMjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgczEgPSBwYWlyLnNoYXBlMjtcclxuICAgICAgICAgIHMyID0gcGFpci5zaGFwZTE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgbGluaztcclxuICAgICAgICBpZiAoczEubnVtQ29udGFjdHMgPCBzMi5udW1Db250YWN0cykgbGluayA9IHMxLmNvbnRhY3RMaW5rO1xyXG4gICAgICAgIGVsc2UgbGluayA9IHMyLmNvbnRhY3RMaW5rO1xyXG5cclxuICAgICAgICB2YXIgZXhpc3RzID0gZmFsc2U7XHJcbiAgICAgICAgd2hpbGUgKGxpbmspIHtcclxuICAgICAgICAgIHZhciBjb250YWN0ID0gbGluay5jb250YWN0O1xyXG4gICAgICAgICAgaWYgKGNvbnRhY3Quc2hhcGUxID09IHMxICYmIGNvbnRhY3Quc2hhcGUyID09IHMyKSB7XHJcbiAgICAgICAgICAgIGNvbnRhY3QucGVyc2lzdGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIGV4aXN0cyA9IHRydWU7Ly8gY29udGFjdCBhbHJlYWR5IGV4aXN0c1xyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGxpbmsgPSBsaW5rLm5leHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZXhpc3RzKSB7XHJcbiAgICAgICAgICB0aGlzLmFkZENvbnRhY3QoczEsIHMyKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0vLyB3aGlsZShpLS0gPjApO1xyXG5cclxuICAgICAgaWYgKHN0YXQpIHRoaXMucGVyZm9ybWFuY2UuY2FsY0Jyb2FkUGhhc2UoKTtcclxuXHJcbiAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgIC8vICAgVVBEQVRFIE5BUlJPV1BIQVNFIENPTlRBQ1RcclxuICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgICAgIC8vIHVwZGF0ZSAmIG5hcnJvdyBwaGFzZVxyXG4gICAgICB0aGlzLm51bUNvbnRhY3RQb2ludHMgPSAwO1xyXG4gICAgICBjb250YWN0ID0gdGhpcy5jb250YWN0cztcclxuICAgICAgd2hpbGUgKGNvbnRhY3QgIT09IG51bGwpIHtcclxuICAgICAgICBpZiAoIWNvbnRhY3QucGVyc2lzdGluZykge1xyXG4gICAgICAgICAgaWYgKGNvbnRhY3Quc2hhcGUxLmFhYmIuaW50ZXJzZWN0VGVzdChjb250YWN0LnNoYXBlMi5hYWJiKSkge1xyXG4gICAgICAgICAgICAvKnZhciBhYWJiMT1jb250YWN0LnNoYXBlMS5hYWJiO1xyXG4gICAgICAgICAgICB2YXIgYWFiYjI9Y29udGFjdC5zaGFwZTIuYWFiYjtcclxuICAgICAgICAgICAgaWYoXHJcbiAgICAgICAgICAgICAgYWFiYjEubWluWD5hYWJiMi5tYXhYIHx8IGFhYmIxLm1heFg8YWFiYjIubWluWCB8fFxyXG4gICAgICAgICAgICAgIGFhYmIxLm1pblk+YWFiYjIubWF4WSB8fCBhYWJiMS5tYXhZPGFhYmIyLm1pblkgfHxcclxuICAgICAgICAgICAgICBhYWJiMS5taW5aPmFhYmIyLm1heFogfHwgYWFiYjEubWF4WjxhYWJiMi5taW5aXHJcbiAgICAgICAgICAgICl7Ki9cclxuICAgICAgICAgICAgdmFyIG5leHQgPSBjb250YWN0Lm5leHQ7XHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQ29udGFjdChjb250YWN0KTtcclxuICAgICAgICAgICAgY29udGFjdCA9IG5leHQ7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB2YXIgYjEgPSBjb250YWN0LmJvZHkxO1xyXG4gICAgICAgIHZhciBiMiA9IGNvbnRhY3QuYm9keTI7XHJcblxyXG4gICAgICAgIGlmIChiMS5pc0R5bmFtaWMgJiYgIWIxLnNsZWVwaW5nIHx8IGIyLmlzRHluYW1pYyAmJiAhYjIuc2xlZXBpbmcpIGNvbnRhY3QudXBkYXRlTWFuaWZvbGQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5udW1Db250YWN0UG9pbnRzICs9IGNvbnRhY3QubWFuaWZvbGQubnVtUG9pbnRzO1xyXG4gICAgICAgIGNvbnRhY3QucGVyc2lzdGluZyA9IGZhbHNlO1xyXG4gICAgICAgIGNvbnRhY3QuY29uc3RyYWludC5hZGRlZFRvSXNsYW5kID0gZmFsc2U7XHJcbiAgICAgICAgY29udGFjdCA9IGNvbnRhY3QubmV4dDtcclxuXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChzdGF0KSB0aGlzLnBlcmZvcm1hbmNlLmNhbGNOYXJyb3dQaGFzZSgpO1xyXG5cclxuICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgLy8gICBTT0xWRSBJU0xBTkRTXHJcbiAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgICB2YXIgaW52VGltZVN0ZXAgPSAxIC8gdGhpcy50aW1lU3RlcDtcclxuICAgICAgdmFyIGpvaW50O1xyXG4gICAgICB2YXIgY29uc3RyYWludDtcclxuXHJcbiAgICAgIGZvciAoam9pbnQgPSB0aGlzLmpvaW50czsgam9pbnQgIT09IG51bGw7IGpvaW50ID0gam9pbnQubmV4dCkge1xyXG4gICAgICAgIGpvaW50LmFkZGVkVG9Jc2xhbmQgPSBmYWxzZTtcclxuICAgICAgfVxyXG5cclxuXHJcbiAgICAgIC8vIGNsZWFyIG9sZCBpc2xhbmQgYXJyYXlcclxuICAgICAgdGhpcy5pc2xhbmRSaWdpZEJvZGllcyA9IFtdO1xyXG4gICAgICB0aGlzLmlzbGFuZENvbnN0cmFpbnRzID0gW107XHJcbiAgICAgIHRoaXMuaXNsYW5kU3RhY2sgPSBbXTtcclxuXHJcbiAgICAgIGlmIChzdGF0KSB0aGlzLnBlcmZvcm1hbmNlLnNldFRpbWUoMSk7XHJcblxyXG4gICAgICB0aGlzLm51bUlzbGFuZHMgPSAwO1xyXG5cclxuICAgICAgLy8gYnVpbGQgYW5kIHNvbHZlIHNpbXVsYXRpb24gaXNsYW5kc1xyXG5cclxuICAgICAgZm9yICh2YXIgYmFzZSA9IHRoaXMucmlnaWRCb2RpZXM7IGJhc2UgIT09IG51bGw7IGJhc2UgPSBiYXNlLm5leHQpIHtcclxuXHJcbiAgICAgICAgaWYgKGJhc2UuYWRkZWRUb0lzbGFuZCB8fCBiYXNlLmlzU3RhdGljIHx8IGJhc2Uuc2xlZXBpbmcpIGNvbnRpbnVlOy8vIGlnbm9yZVxyXG5cclxuICAgICAgICBpZiAoYmFzZS5pc0xvbmVseSgpKSB7Ly8gdXBkYXRlIHNpbmdsZSBib2R5XHJcbiAgICAgICAgICBpZiAoYmFzZS5pc0R5bmFtaWMpIHtcclxuICAgICAgICAgICAgYmFzZS5saW5lYXJWZWxvY2l0eS5hZGRTY2FsZWRWZWN0b3IodGhpcy5ncmF2aXR5LCB0aGlzLnRpbWVTdGVwKTtcclxuICAgICAgICAgICAgLypiYXNlLmxpbmVhclZlbG9jaXR5LngrPXRoaXMuZ3Jhdml0eS54KnRoaXMudGltZVN0ZXA7XHJcbiAgICAgICAgICAgIGJhc2UubGluZWFyVmVsb2NpdHkueSs9dGhpcy5ncmF2aXR5LnkqdGhpcy50aW1lU3RlcDtcclxuICAgICAgICAgICAgYmFzZS5saW5lYXJWZWxvY2l0eS56Kz10aGlzLmdyYXZpdHkueip0aGlzLnRpbWVTdGVwOyovXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAodGhpcy5jYWxsU2xlZXAoYmFzZSkpIHtcclxuICAgICAgICAgICAgYmFzZS5zbGVlcFRpbWUgKz0gdGhpcy50aW1lU3RlcDtcclxuICAgICAgICAgICAgaWYgKGJhc2Uuc2xlZXBUaW1lID4gMC41KSBiYXNlLnNsZWVwKCk7XHJcbiAgICAgICAgICAgIGVsc2UgYmFzZS51cGRhdGVQb3NpdGlvbih0aGlzLnRpbWVTdGVwKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGJhc2Uuc2xlZXBUaW1lID0gMDtcclxuICAgICAgICAgICAgYmFzZS51cGRhdGVQb3NpdGlvbih0aGlzLnRpbWVTdGVwKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMubnVtSXNsYW5kcysrO1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaXNsYW5kTnVtUmlnaWRCb2RpZXMgPSAwO1xyXG4gICAgICAgIHZhciBpc2xhbmROdW1Db25zdHJhaW50cyA9IDA7XHJcbiAgICAgICAgdmFyIHN0YWNrQ291bnQgPSAxO1xyXG4gICAgICAgIC8vIGFkZCByaWdpZCBib2R5IHRvIHN0YWNrXHJcbiAgICAgICAgdGhpcy5pc2xhbmRTdGFja1swXSA9IGJhc2U7XHJcbiAgICAgICAgYmFzZS5hZGRlZFRvSXNsYW5kID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgLy8gYnVpbGQgYW4gaXNsYW5kXHJcbiAgICAgICAgZG8ge1xyXG4gICAgICAgICAgLy8gZ2V0IHJpZ2lkIGJvZHkgZnJvbSBzdGFja1xyXG4gICAgICAgICAgYm9keSA9IHRoaXMuaXNsYW5kU3RhY2tbLS1zdGFja0NvdW50XTtcclxuICAgICAgICAgIHRoaXMuaXNsYW5kU3RhY2tbc3RhY2tDb3VudF0gPSBudWxsO1xyXG4gICAgICAgICAgYm9keS5zbGVlcGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgLy8gYWRkIHJpZ2lkIGJvZHkgdG8gdGhlIGlzbGFuZFxyXG4gICAgICAgICAgdGhpcy5pc2xhbmRSaWdpZEJvZGllc1tpc2xhbmROdW1SaWdpZEJvZGllcysrXSA9IGJvZHk7XHJcbiAgICAgICAgICBpZiAoYm9keS5pc1N0YXRpYykgY29udGludWU7XHJcblxyXG4gICAgICAgICAgLy8gc2VhcmNoIGNvbm5lY3Rpb25zXHJcbiAgICAgICAgICBmb3IgKHZhciBjcyA9IGJvZHkuY29udGFjdExpbms7IGNzICE9PSBudWxsOyBjcyA9IGNzLm5leHQpIHtcclxuICAgICAgICAgICAgdmFyIGNvbnRhY3QgPSBjcy5jb250YWN0O1xyXG4gICAgICAgICAgICBjb25zdHJhaW50ID0gY29udGFjdC5jb25zdHJhaW50O1xyXG4gICAgICAgICAgICBpZiAoY29uc3RyYWludC5hZGRlZFRvSXNsYW5kIHx8ICFjb250YWN0LnRvdWNoaW5nKSBjb250aW51ZTsvLyBpZ25vcmVcclxuXHJcbiAgICAgICAgICAgIC8vIGFkZCBjb25zdHJhaW50IHRvIHRoZSBpc2xhbmRcclxuICAgICAgICAgICAgdGhpcy5pc2xhbmRDb25zdHJhaW50c1tpc2xhbmROdW1Db25zdHJhaW50cysrXSA9IGNvbnN0cmFpbnQ7XHJcbiAgICAgICAgICAgIGNvbnN0cmFpbnQuYWRkZWRUb0lzbGFuZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHZhciBuZXh0ID0gY3MuYm9keTtcclxuXHJcbiAgICAgICAgICAgIGlmIChuZXh0LmFkZGVkVG9Jc2xhbmQpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgLy8gYWRkIHJpZ2lkIGJvZHkgdG8gc3RhY2tcclxuICAgICAgICAgICAgdGhpcy5pc2xhbmRTdGFja1tzdGFja0NvdW50KytdID0gbmV4dDtcclxuICAgICAgICAgICAgbmV4dC5hZGRlZFRvSXNsYW5kID0gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGZvciAodmFyIGpzID0gYm9keS5qb2ludExpbms7IGpzICE9PSBudWxsOyBqcyA9IGpzLm5leHQpIHtcclxuICAgICAgICAgICAgY29uc3RyYWludCA9IGpzLmpvaW50O1xyXG5cclxuICAgICAgICAgICAgaWYgKGNvbnN0cmFpbnQuYWRkZWRUb0lzbGFuZCkgY29udGludWU7Ly8gaWdub3JlXHJcblxyXG4gICAgICAgICAgICAvLyBhZGQgY29uc3RyYWludCB0byB0aGUgaXNsYW5kXHJcbiAgICAgICAgICAgIHRoaXMuaXNsYW5kQ29uc3RyYWludHNbaXNsYW5kTnVtQ29uc3RyYWludHMrK10gPSBjb25zdHJhaW50O1xyXG4gICAgICAgICAgICBjb25zdHJhaW50LmFkZGVkVG9Jc2xhbmQgPSB0cnVlO1xyXG4gICAgICAgICAgICBuZXh0ID0ganMuYm9keTtcclxuICAgICAgICAgICAgaWYgKG5leHQuYWRkZWRUb0lzbGFuZCB8fCAhbmV4dC5pc0R5bmFtaWMpIGNvbnRpbnVlO1xyXG5cclxuICAgICAgICAgICAgLy8gYWRkIHJpZ2lkIGJvZHkgdG8gc3RhY2tcclxuICAgICAgICAgICAgdGhpcy5pc2xhbmRTdGFja1tzdGFja0NvdW50KytdID0gbmV4dDtcclxuICAgICAgICAgICAgbmV4dC5hZGRlZFRvSXNsYW5kID0gdHJ1ZTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9IHdoaWxlIChzdGFja0NvdW50ICE9IDApO1xyXG5cclxuICAgICAgICAvLyB1cGRhdGUgdmVsb2NpdGllc1xyXG4gICAgICAgIHZhciBnVmVsID0gbmV3IFZlYzMoKS5hZGRTY2FsZWRWZWN0b3IodGhpcy5ncmF2aXR5LCB0aGlzLnRpbWVTdGVwKTtcclxuICAgICAgICAvKnZhciBneD10aGlzLmdyYXZpdHkueCp0aGlzLnRpbWVTdGVwO1xyXG4gICAgICAgIHZhciBneT10aGlzLmdyYXZpdHkueSp0aGlzLnRpbWVTdGVwO1xyXG4gICAgICAgIHZhciBnej10aGlzLmdyYXZpdHkueip0aGlzLnRpbWVTdGVwOyovXHJcbiAgICAgICAgdmFyIGogPSBpc2xhbmROdW1SaWdpZEJvZGllcztcclxuICAgICAgICB3aGlsZSAoai0tKSB7XHJcbiAgICAgICAgICAvL29yKHZhciBqPTAsIGw9aXNsYW5kTnVtUmlnaWRCb2RpZXM7IGo8bDsgaisrKXtcclxuICAgICAgICAgIGJvZHkgPSB0aGlzLmlzbGFuZFJpZ2lkQm9kaWVzW2pdO1xyXG4gICAgICAgICAgaWYgKGJvZHkuaXNEeW5hbWljKSB7XHJcbiAgICAgICAgICAgIGJvZHkubGluZWFyVmVsb2NpdHkuYWRkRXF1YWwoZ1ZlbCk7XHJcbiAgICAgICAgICAgIC8qYm9keS5saW5lYXJWZWxvY2l0eS54Kz1neDtcclxuICAgICAgICAgICAgYm9keS5saW5lYXJWZWxvY2l0eS55Kz1neTtcclxuICAgICAgICAgICAgYm9keS5saW5lYXJWZWxvY2l0eS56Kz1nejsqL1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gcmFuZG9taXppbmcgb3JkZXJcclxuICAgICAgICBpZiAodGhpcy5lbmFibGVSYW5kb21pemVyKSB7XHJcbiAgICAgICAgICAvL2Zvcih2YXIgaj0xLCBsPWlzbGFuZE51bUNvbnN0cmFpbnRzOyBqPGw7IGorKyl7XHJcbiAgICAgICAgICBqID0gaXNsYW5kTnVtQ29uc3RyYWludHM7XHJcbiAgICAgICAgICB3aGlsZSAoai0tKSB7XHJcbiAgICAgICAgICAgIGlmIChqICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgdmFyIHN3YXAgPSAodGhpcy5yYW5kWCA9ICh0aGlzLnJhbmRYICogdGhpcy5yYW5kQSArIHRoaXMucmFuZEIgJiAweDdmZmZmZmZmKSkgLyAyMTQ3NDgzNjQ4LjAgKiBqIHwgMDtcclxuICAgICAgICAgICAgICBjb25zdHJhaW50ID0gdGhpcy5pc2xhbmRDb25zdHJhaW50c1tqXTtcclxuICAgICAgICAgICAgICB0aGlzLmlzbGFuZENvbnN0cmFpbnRzW2pdID0gdGhpcy5pc2xhbmRDb25zdHJhaW50c1tzd2FwXTtcclxuICAgICAgICAgICAgICB0aGlzLmlzbGFuZENvbnN0cmFpbnRzW3N3YXBdID0gY29uc3RyYWludDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gc29sdmUgY29udHJhaW50c1xyXG5cclxuICAgICAgICBqID0gaXNsYW5kTnVtQ29uc3RyYWludHM7XHJcbiAgICAgICAgd2hpbGUgKGotLSkge1xyXG4gICAgICAgICAgLy9mb3Ioaj0wLCBsPWlzbGFuZE51bUNvbnN0cmFpbnRzOyBqPGw7IGorKyl7XHJcbiAgICAgICAgICB0aGlzLmlzbGFuZENvbnN0cmFpbnRzW2pdLnByZVNvbHZlKHRoaXMudGltZVN0ZXAsIGludlRpbWVTdGVwKTsvLyBwcmUtc29sdmVcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGsgPSB0aGlzLm51bUl0ZXJhdGlvbnM7XHJcbiAgICAgICAgd2hpbGUgKGstLSkge1xyXG4gICAgICAgICAgLy9mb3IodmFyIGs9MCwgbD10aGlzLm51bUl0ZXJhdGlvbnM7IGs8bDsgaysrKXtcclxuICAgICAgICAgIGogPSBpc2xhbmROdW1Db25zdHJhaW50cztcclxuICAgICAgICAgIHdoaWxlIChqLS0pIHtcclxuICAgICAgICAgICAgLy9mb3Ioaj0wLCBtPWlzbGFuZE51bUNvbnN0cmFpbnRzOyBqPG07IGorKyl7XHJcbiAgICAgICAgICAgIHRoaXMuaXNsYW5kQ29uc3RyYWludHNbal0uc29sdmUoKTsvLyBtYWluLXNvbHZlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGogPSBpc2xhbmROdW1Db25zdHJhaW50cztcclxuICAgICAgICB3aGlsZSAoai0tKSB7XHJcbiAgICAgICAgICAvL2ZvcihqPTAsIGw9aXNsYW5kTnVtQ29uc3RyYWludHM7IGo8bDsgaisrKXtcclxuICAgICAgICAgIHRoaXMuaXNsYW5kQ29uc3RyYWludHNbal0ucG9zdFNvbHZlKCk7Ly8gcG9zdC1zb2x2ZVxyXG4gICAgICAgICAgdGhpcy5pc2xhbmRDb25zdHJhaW50c1tqXSA9IG51bGw7Ly8gZ2NcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIHNsZWVwaW5nIGNoZWNrXHJcblxyXG4gICAgICAgIHZhciBzbGVlcFRpbWUgPSAxMDtcclxuICAgICAgICBqID0gaXNsYW5kTnVtUmlnaWRCb2RpZXM7XHJcbiAgICAgICAgd2hpbGUgKGotLSkge1xyXG4gICAgICAgICAgLy9mb3Ioaj0wLCBsPWlzbGFuZE51bVJpZ2lkQm9kaWVzO2o8bDtqKyspe1xyXG4gICAgICAgICAgYm9keSA9IHRoaXMuaXNsYW5kUmlnaWRCb2RpZXNbal07XHJcbiAgICAgICAgICBpZiAodGhpcy5jYWxsU2xlZXAoYm9keSkpIHtcclxuICAgICAgICAgICAgYm9keS5zbGVlcFRpbWUgKz0gdGhpcy50aW1lU3RlcDtcclxuICAgICAgICAgICAgaWYgKGJvZHkuc2xlZXBUaW1lIDwgc2xlZXBUaW1lKSBzbGVlcFRpbWUgPSBib2R5LnNsZWVwVGltZTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGJvZHkuc2xlZXBUaW1lID0gMDtcclxuICAgICAgICAgICAgc2xlZXBUaW1lID0gMDtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzbGVlcFRpbWUgPiAwLjUpIHtcclxuICAgICAgICAgIC8vIHNsZWVwIHRoZSBpc2xhbmRcclxuICAgICAgICAgIGogPSBpc2xhbmROdW1SaWdpZEJvZGllcztcclxuICAgICAgICAgIHdoaWxlIChqLS0pIHtcclxuICAgICAgICAgICAgLy9mb3Ioaj0wLCBsPWlzbGFuZE51bVJpZ2lkQm9kaWVzO2o8bDtqKyspe1xyXG4gICAgICAgICAgICB0aGlzLmlzbGFuZFJpZ2lkQm9kaWVzW2pdLnNsZWVwKCk7XHJcbiAgICAgICAgICAgIHRoaXMuaXNsYW5kUmlnaWRCb2RpZXNbal0gPSBudWxsOy8vIGdjXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIC8vIHVwZGF0ZSBwb3NpdGlvbnNcclxuICAgICAgICAgIGogPSBpc2xhbmROdW1SaWdpZEJvZGllcztcclxuICAgICAgICAgIHdoaWxlIChqLS0pIHtcclxuICAgICAgICAgICAgLy9mb3Ioaj0wLCBsPWlzbGFuZE51bVJpZ2lkQm9kaWVzO2o8bDtqKyspe1xyXG4gICAgICAgICAgICB0aGlzLmlzbGFuZFJpZ2lkQm9kaWVzW2pdLnVwZGF0ZVBvc2l0aW9uKHRoaXMudGltZVN0ZXApO1xyXG4gICAgICAgICAgICB0aGlzLmlzbGFuZFJpZ2lkQm9kaWVzW2pdID0gbnVsbDsvLyBnY1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm51bUlzbGFuZHMrKztcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgLy8gICBFTkQgU0lNVUxBVElPTlxyXG4gICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgICAgaWYgKHN0YXQpIHRoaXMucGVyZm9ybWFuY2UuY2FsY0VuZCgpO1xyXG5cclxuICAgICAgaWYgKHRoaXMucG9zdExvb3AgIT09IG51bGwpIHRoaXMucG9zdExvb3AoKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHJlbW92ZSBzb21ldGluZyB0byB3b3JsZFxyXG5cclxuICAgIHJlbW92ZTogZnVuY3Rpb24gKG9iaikge1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgLy8gYWRkIHNvbWV0aW5nIHRvIHdvcmxkXHJcblxyXG4gICAgYWRkOiBmdW5jdGlvbiAobykge1xyXG5cclxuICAgICAgbyA9IG8gfHwge307XHJcblxyXG4gICAgICB2YXIgdHlwZSA9IG8udHlwZSB8fCBcImJveFwiO1xyXG4gICAgICBpZiAodHlwZS5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSB0eXBlID0gW3R5cGVdO1xyXG4gICAgICB2YXIgaXNKb2ludCA9IHR5cGVbMF0uc3Vic3RyaW5nKDAsIDUpID09PSAnam9pbnQnID8gdHJ1ZSA6IGZhbHNlO1xyXG5cclxuICAgICAgaWYgKGlzSm9pbnQpIHJldHVybiB0aGlzLmluaXRKb2ludCh0eXBlWzBdLCBvKTtcclxuICAgICAgZWxzZSByZXR1cm4gdGhpcy5pbml0Qm9keSh0eXBlLCBvKTtcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGluaXRCb2R5OiBmdW5jdGlvbiAodHlwZSwgbykge1xyXG5cclxuICAgICAgdmFyIGludlNjYWxlID0gdGhpcy5pbnZTY2FsZTtcclxuXHJcbiAgICAgIC8vIGJvZHkgZHluYW1pYyBvciBzdGF0aWNcclxuICAgICAgdmFyIG1vdmUgPSBvLm1vdmUgfHwgZmFsc2U7XHJcbiAgICAgIHZhciBraW5lbWF0aWMgPSBvLmtpbmVtYXRpYyB8fCBmYWxzZTtcclxuXHJcbiAgICAgIC8vIFBPU0lUSU9OXHJcblxyXG4gICAgICAvLyBib2R5IHBvc2l0aW9uXHJcbiAgICAgIHZhciBwID0gby5wb3MgfHwgWzAsIDAsIDBdO1xyXG4gICAgICBwID0gcC5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHggKiBpbnZTY2FsZTsgfSk7XHJcblxyXG4gICAgICAvLyBzaGFwZSBwb3NpdGlvblxyXG4gICAgICB2YXIgcDIgPSBvLnBvc1NoYXBlIHx8IFswLCAwLCAwXTtcclxuICAgICAgcDIgPSBwMi5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHggKiBpbnZTY2FsZTsgfSk7XHJcblxyXG4gICAgICAvLyBST1RBVElPTlxyXG5cclxuICAgICAgLy8gYm9keSByb3RhdGlvbiBpbiBkZWdyZWVcclxuICAgICAgdmFyIHIgPSBvLnJvdCB8fCBbMCwgMCwgMF07XHJcbiAgICAgIHIgPSByLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4geCAqIF9NYXRoLmRlZ3RvcmFkOyB9KTtcclxuXHJcbiAgICAgIC8vIHNoYXBlIHJvdGF0aW9uIGluIGRlZ3JlZVxyXG4gICAgICB2YXIgcjIgPSBvLnJvdFNoYXBlIHx8IFswLCAwLCAwXTtcclxuICAgICAgcjIgPSByLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4geCAqIF9NYXRoLmRlZ3RvcmFkOyB9KTtcclxuXHJcbiAgICAgIC8vIFNJWkVcclxuXHJcbiAgICAgIC8vIHNoYXBlIHNpemVcclxuICAgICAgdmFyIHMgPSBvLnNpemUgPT09IHVuZGVmaW5lZCA/IFsxLCAxLCAxXSA6IG8uc2l6ZTtcclxuICAgICAgaWYgKHMubGVuZ3RoID09PSAxKSB7IHNbMV0gPSBzWzBdOyB9XHJcbiAgICAgIGlmIChzLmxlbmd0aCA9PT0gMikgeyBzWzJdID0gc1swXTsgfVxyXG4gICAgICBzID0gcy5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHggKiBpbnZTY2FsZTsgfSk7XHJcblxyXG5cclxuXHJcbiAgICAgIC8vIGJvZHkgcGh5c2ljcyBzZXR0aW5nc1xyXG4gICAgICB2YXIgc2MgPSBuZXcgU2hhcGVDb25maWcoKTtcclxuICAgICAgLy8gVGhlIGRlbnNpdHkgb2YgdGhlIHNoYXBlLlxyXG4gICAgICBpZiAoby5kZW5zaXR5ICE9PSB1bmRlZmluZWQpIHNjLmRlbnNpdHkgPSBvLmRlbnNpdHk7XHJcbiAgICAgIC8vIFRoZSBjb2VmZmljaWVudCBvZiBmcmljdGlvbiBvZiB0aGUgc2hhcGUuXHJcbiAgICAgIGlmIChvLmZyaWN0aW9uICE9PSB1bmRlZmluZWQpIHNjLmZyaWN0aW9uID0gby5mcmljdGlvbjtcclxuICAgICAgLy8gVGhlIGNvZWZmaWNpZW50IG9mIHJlc3RpdHV0aW9uIG9mIHRoZSBzaGFwZS5cclxuICAgICAgaWYgKG8ucmVzdGl0dXRpb24gIT09IHVuZGVmaW5lZCkgc2MucmVzdGl0dXRpb24gPSBvLnJlc3RpdHV0aW9uO1xyXG4gICAgICAvLyBUaGUgYml0cyBvZiB0aGUgY29sbGlzaW9uIGdyb3VwcyB0byB3aGljaCB0aGUgc2hhcGUgYmVsb25ncy5cclxuICAgICAgaWYgKG8uYmVsb25nc1RvICE9PSB1bmRlZmluZWQpIHNjLmJlbG9uZ3NUbyA9IG8uYmVsb25nc1RvO1xyXG4gICAgICAvLyBUaGUgYml0cyBvZiB0aGUgY29sbGlzaW9uIGdyb3VwcyB3aXRoIHdoaWNoIHRoZSBzaGFwZSBjb2xsaWRlcy5cclxuICAgICAgaWYgKG8uY29sbGlkZXNXaXRoICE9PSB1bmRlZmluZWQpIHNjLmNvbGxpZGVzV2l0aCA9IG8uY29sbGlkZXNXaXRoO1xyXG5cclxuICAgICAgaWYgKG8uY29uZmlnICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBpZiAoby5jb25maWdbMF0gIT09IHVuZGVmaW5lZCkgc2MuZGVuc2l0eSA9IG8uY29uZmlnWzBdO1xyXG4gICAgICAgIGlmIChvLmNvbmZpZ1sxXSAhPT0gdW5kZWZpbmVkKSBzYy5mcmljdGlvbiA9IG8uY29uZmlnWzFdO1xyXG4gICAgICAgIGlmIChvLmNvbmZpZ1syXSAhPT0gdW5kZWZpbmVkKSBzYy5yZXN0aXR1dGlvbiA9IG8uY29uZmlnWzJdO1xyXG4gICAgICAgIGlmIChvLmNvbmZpZ1szXSAhPT0gdW5kZWZpbmVkKSBzYy5iZWxvbmdzVG8gPSBvLmNvbmZpZ1szXTtcclxuICAgICAgICBpZiAoby5jb25maWdbNF0gIT09IHVuZGVmaW5lZCkgc2MuY29sbGlkZXNXaXRoID0gby5jb25maWdbNF07XHJcbiAgICAgIH1cclxuXHJcblxyXG4gICAgICAvKiBpZihvLm1hc3NQb3Mpe1xyXG4gICAgICAgICAgIG8ubWFzc1BvcyA9IG8ubWFzc1Bvcy5tYXAoZnVuY3Rpb24oeCkgeyByZXR1cm4geCAqIGludlNjYWxlOyB9KTtcclxuICAgICAgICAgICBzYy5yZWxhdGl2ZVBvc2l0aW9uLnNldCggby5tYXNzUG9zWzBdLCBvLm1hc3NQb3NbMV0sIG8ubWFzc1Bvc1syXSApO1xyXG4gICAgICAgfVxyXG4gICAgICAgaWYoby5tYXNzUm90KXtcclxuICAgICAgICAgICBvLm1hc3NSb3QgPSBvLm1hc3NSb3QubWFwKGZ1bmN0aW9uKHgpIHsgcmV0dXJuIHggKiBfTWF0aC5kZWd0b3JhZDsgfSk7XHJcbiAgICAgICAgICAgdmFyIHEgPSBuZXcgUXVhdCgpLnNldEZyb21FdWxlciggby5tYXNzUm90WzBdLCBvLm1hc3NSb3RbMV0sIG8ubWFzc1JvdFsyXSApO1xyXG4gICAgICAgICAgIHNjLnJlbGF0aXZlUm90YXRpb24gPSBuZXcgTWF0MzMoKS5zZXRRdWF0KCBxICk7Ly9fTWF0aC5FdWxlclRvTWF0cml4KCBvLm1hc3NSb3RbMF0sIG8ubWFzc1JvdFsxXSwgby5tYXNzUm90WzJdICk7XHJcbiAgICAgICB9Ki9cclxuXHJcbiAgICAgIHZhciBwb3NpdGlvbiA9IG5ldyBWZWMzKHBbMF0sIHBbMV0sIHBbMl0pO1xyXG4gICAgICB2YXIgcm90YXRpb24gPSBuZXcgUXVhdCgpLnNldEZyb21FdWxlcihyWzBdLCByWzFdLCByWzJdKTtcclxuXHJcbiAgICAgIC8vIHJpZ2lkYm9keVxyXG4gICAgICB2YXIgYm9keSA9IG5ldyBSaWdpZEJvZHkocG9zaXRpb24sIHJvdGF0aW9uKTtcclxuICAgICAgLy92YXIgYm9keSA9IG5ldyBSaWdpZEJvZHkoIHBbMF0sIHBbMV0sIHBbMl0sIHJbMF0sIHJbMV0sIHJbMl0sIHJbM10sIHRoaXMuc2NhbGUsIHRoaXMuaW52U2NhbGUgKTtcclxuXHJcbiAgICAgIC8vIFNIQVBFU1xyXG5cclxuICAgICAgdmFyIHNoYXBlLCBuO1xyXG5cclxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0eXBlLmxlbmd0aDsgaSsrKSB7XHJcblxyXG4gICAgICAgIG4gPSBpICogMztcclxuXHJcbiAgICAgICAgaWYgKHAyW25dICE9PSB1bmRlZmluZWQpIHNjLnJlbGF0aXZlUG9zaXRpb24uc2V0KHAyW25dLCBwMltuICsgMV0sIHAyW24gKyAyXSk7XHJcbiAgICAgICAgaWYgKHIyW25dICE9PSB1bmRlZmluZWQpIHNjLnJlbGF0aXZlUm90YXRpb24uc2V0UXVhdChuZXcgUXVhdCgpLnNldEZyb21FdWxlcihyMltuXSwgcjJbbiArIDFdLCByMltuICsgMl0pKTtcclxuXHJcbiAgICAgICAgc3dpdGNoICh0eXBlW2ldKSB7XHJcbiAgICAgICAgICBjYXNlIFwic3BoZXJlXCI6IHNoYXBlID0gbmV3IFNwaGVyZShzYywgc1tuXSk7IGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSBcImN5bGluZGVyXCI6IHNoYXBlID0gbmV3IEN5bGluZGVyKHNjLCBzW25dLCBzW24gKyAxXSk7IGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSBcImJveFwiOiBzaGFwZSA9IG5ldyBCb3goc2MsIHNbbl0sIHNbbiArIDFdLCBzW24gKyAyXSk7IGJyZWFrO1xyXG4gICAgICAgICAgY2FzZSBcInBsYW5lXCI6IHNoYXBlID0gbmV3IFBsYW5lKHNjKTsgYnJlYWtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGJvZHkuYWRkU2hhcGUoc2hhcGUpO1xyXG5cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gYm9keSBjYW4gc2xlZXAgb3Igbm90XHJcbiAgICAgIGlmIChvLm5ldmVyU2xlZXAgfHwga2luZW1hdGljKSBib2R5LmFsbG93U2xlZXAgPSBmYWxzZTtcclxuICAgICAgZWxzZSBib2R5LmFsbG93U2xlZXAgPSB0cnVlO1xyXG5cclxuICAgICAgYm9keS5pc0tpbmVtYXRpYyA9IGtpbmVtYXRpYztcclxuXHJcbiAgICAgIC8vIGJvZHkgc3RhdGljIG9yIGR5bmFtaWNcclxuICAgICAgaWYgKG1vdmUpIHtcclxuXHJcbiAgICAgICAgaWYgKG8ubWFzc1BvcyB8fCBvLm1hc3NSb3QpIGJvZHkuc2V0dXBNYXNzKEJPRFlfRFlOQU1JQywgZmFsc2UpO1xyXG4gICAgICAgIGVsc2UgYm9keS5zZXR1cE1hc3MoQk9EWV9EWU5BTUlDLCB0cnVlKTtcclxuXHJcbiAgICAgICAgLy8gYm9keSBjYW4gc2xlZXAgb3Igbm90XHJcbiAgICAgICAgLy9pZiggby5uZXZlclNsZWVwICkgYm9keS5hbGxvd1NsZWVwID0gZmFsc2U7XHJcbiAgICAgICAgLy9lbHNlIGJvZHkuYWxsb3dTbGVlcCA9IHRydWU7XHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICBib2R5LnNldHVwTWFzcyhCT0RZX1NUQVRJQyk7XHJcblxyXG4gICAgICB9XHJcblxyXG4gICAgICBpZiAoby5uYW1lICE9PSB1bmRlZmluZWQpIGJvZHkubmFtZSA9IG8ubmFtZTtcclxuICAgICAgLy9lbHNlIGlmKCBtb3ZlICkgYm9keS5uYW1lID0gdGhpcy5udW1SaWdpZEJvZGllcztcclxuXHJcbiAgICAgIC8vIGZpbmFseSBhZGQgdG8gcGh5c2ljcyB3b3JsZFxyXG4gICAgICB0aGlzLmFkZFJpZ2lkQm9keShib2R5KTtcclxuXHJcbiAgICAgIC8vIGZvcmNlIHNsZWVwIG9uIG5vdFxyXG4gICAgICBpZiAobW92ZSkge1xyXG4gICAgICAgIGlmIChvLnNsZWVwKSBib2R5LnNsZWVwKCk7XHJcbiAgICAgICAgZWxzZSBib2R5LmF3YWtlKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBib2R5O1xyXG5cclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGluaXRKb2ludDogZnVuY3Rpb24gKHR5cGUsIG8pIHtcclxuXHJcbiAgICAgIC8vdmFyIHR5cGUgPSB0eXBlO1xyXG4gICAgICB2YXIgaW52U2NhbGUgPSB0aGlzLmludlNjYWxlO1xyXG5cclxuICAgICAgdmFyIGF4ZTEgPSBvLmF4ZTEgfHwgWzEsIDAsIDBdO1xyXG4gICAgICB2YXIgYXhlMiA9IG8uYXhlMiB8fCBbMSwgMCwgMF07XHJcbiAgICAgIHZhciBwb3MxID0gby5wb3MxIHx8IFswLCAwLCAwXTtcclxuICAgICAgdmFyIHBvczIgPSBvLnBvczIgfHwgWzAsIDAsIDBdO1xyXG5cclxuICAgICAgcG9zMSA9IHBvczEubWFwKGZ1bmN0aW9uICh4KSB7IHJldHVybiB4ICogaW52U2NhbGU7IH0pO1xyXG4gICAgICBwb3MyID0gcG9zMi5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIHggKiBpbnZTY2FsZTsgfSk7XHJcblxyXG4gICAgICB2YXIgbWluLCBtYXg7XHJcbiAgICAgIGlmICh0eXBlID09PSBcImpvaW50RGlzdGFuY2VcIikge1xyXG4gICAgICAgIG1pbiA9IG8ubWluIHx8IDA7XHJcbiAgICAgICAgbWF4ID0gby5tYXggfHwgMTA7XHJcbiAgICAgICAgbWluID0gbWluICogaW52U2NhbGU7XHJcbiAgICAgICAgbWF4ID0gbWF4ICogaW52U2NhbGU7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbWluID0gby5taW4gfHwgNTcuMjk1Nzg7XHJcbiAgICAgICAgbWF4ID0gby5tYXggfHwgMDtcclxuICAgICAgICBtaW4gPSBtaW4gKiBfTWF0aC5kZWd0b3JhZDtcclxuICAgICAgICBtYXggPSBtYXggKiBfTWF0aC5kZWd0b3JhZDtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIGxpbWl0ID0gby5saW1pdCB8fCBudWxsO1xyXG4gICAgICB2YXIgc3ByaW5nID0gby5zcHJpbmcgfHwgbnVsbDtcclxuICAgICAgdmFyIG1vdG9yID0gby5tb3RvciB8fCBudWxsO1xyXG5cclxuICAgICAgLy8gam9pbnQgc2V0dGluZ1xyXG4gICAgICB2YXIgamMgPSBuZXcgSm9pbnRDb25maWcoKTtcclxuICAgICAgamMuc2NhbGUgPSB0aGlzLnNjYWxlO1xyXG4gICAgICBqYy5pbnZTY2FsZSA9IHRoaXMuaW52U2NhbGU7XHJcbiAgICAgIGpjLmFsbG93Q29sbGlzaW9uID0gby5jb2xsaXNpb24gfHwgZmFsc2U7XHJcbiAgICAgIGpjLmxvY2FsQXhpczEuc2V0KGF4ZTFbMF0sIGF4ZTFbMV0sIGF4ZTFbMl0pO1xyXG4gICAgICBqYy5sb2NhbEF4aXMyLnNldChheGUyWzBdLCBheGUyWzFdLCBheGUyWzJdKTtcclxuICAgICAgamMubG9jYWxBbmNob3JQb2ludDEuc2V0KHBvczFbMF0sIHBvczFbMV0sIHBvczFbMl0pO1xyXG4gICAgICBqYy5sb2NhbEFuY2hvclBvaW50Mi5zZXQocG9zMlswXSwgcG9zMlsxXSwgcG9zMlsyXSk7XHJcblxyXG4gICAgICB2YXIgYjEgPSBudWxsO1xyXG4gICAgICB2YXIgYjIgPSBudWxsO1xyXG5cclxuICAgICAgaWYgKG8uYm9keTEgPT09IHVuZGVmaW5lZCB8fCBvLmJvZHkyID09PSB1bmRlZmluZWQpIHJldHVybiBwcmludEVycm9yKCdXb3JsZCcsIFwiQ2FuJ3QgYWRkIGpvaW50IGlmIGF0dGFjaCByaWdpZGJvZHlzIG5vdCBkZWZpbmUgIVwiKTtcclxuXHJcbiAgICAgIGlmIChvLmJvZHkxLmNvbnN0cnVjdG9yID09PSBTdHJpbmcpIHsgYjEgPSB0aGlzLmdldEJ5TmFtZShvLmJvZHkxKTsgfVxyXG4gICAgICBlbHNlIGlmIChvLmJvZHkxLmNvbnN0cnVjdG9yID09PSBOdW1iZXIpIHsgYjEgPSB0aGlzLmdldEJ5TmFtZShvLmJvZHkxKTsgfVxyXG4gICAgICBlbHNlIGlmIChvLmJvZHkxLmNvbnN0cnVjdG9yID09PSBSaWdpZEJvZHkpIHsgYjEgPSBvLmJvZHkxOyB9XHJcblxyXG4gICAgICBpZiAoby5ib2R5Mi5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nKSB7IGIyID0gdGhpcy5nZXRCeU5hbWUoby5ib2R5Mik7IH1cclxuICAgICAgZWxzZSBpZiAoby5ib2R5Mi5jb25zdHJ1Y3RvciA9PT0gTnVtYmVyKSB7IGIyID0gdGhpcy5nZXRCeU5hbWUoby5ib2R5Mik7IH1cclxuICAgICAgZWxzZSBpZiAoby5ib2R5Mi5jb25zdHJ1Y3RvciA9PT0gUmlnaWRCb2R5KSB7IGIyID0gby5ib2R5MjsgfVxyXG5cclxuICAgICAgaWYgKGIxID09PSBudWxsIHx8IGIyID09PSBudWxsKSByZXR1cm4gcHJpbnRFcnJvcignV29ybGQnLCBcIkNhbid0IGFkZCBqb2ludCBhdHRhY2ggcmlnaWRib2R5cyBub3QgZmluZCAhXCIpO1xyXG5cclxuICAgICAgamMuYm9keTEgPSBiMTtcclxuICAgICAgamMuYm9keTIgPSBiMjtcclxuXHJcbiAgICAgIHZhciBqb2ludDtcclxuICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgY2FzZSBcImpvaW50RGlzdGFuY2VcIjogam9pbnQgPSBuZXcgRGlzdGFuY2VKb2ludChqYywgbWluLCBtYXgpO1xyXG4gICAgICAgICAgaWYgKHNwcmluZyAhPT0gbnVsbCkgam9pbnQubGltaXRNb3Rvci5zZXRTcHJpbmcoc3ByaW5nWzBdLCBzcHJpbmdbMV0pO1xyXG4gICAgICAgICAgaWYgKG1vdG9yICE9PSBudWxsKSBqb2ludC5saW1pdE1vdG9yLnNldE1vdG9yKG1vdG9yWzBdLCBtb3RvclsxXSk7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIFwiam9pbnRIaW5nZVwiOiBjYXNlIFwiam9pbnRcIjogam9pbnQgPSBuZXcgSGluZ2VKb2ludChqYywgbWluLCBtYXgpO1xyXG4gICAgICAgICAgaWYgKHNwcmluZyAhPT0gbnVsbCkgam9pbnQubGltaXRNb3Rvci5zZXRTcHJpbmcoc3ByaW5nWzBdLCBzcHJpbmdbMV0pOy8vIHNvZnRlbiB0aGUgam9pbnQgZXg6IDEwMCwgMC4yXHJcbiAgICAgICAgICBpZiAobW90b3IgIT09IG51bGwpIGpvaW50LmxpbWl0TW90b3Iuc2V0TW90b3IobW90b3JbMF0sIG1vdG9yWzFdKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJqb2ludFByaXNtZVwiOiBqb2ludCA9IG5ldyBQcmlzbWF0aWNKb2ludChqYywgbWluLCBtYXgpOyBicmVhaztcclxuICAgICAgICBjYXNlIFwiam9pbnRTbGlkZVwiOiBqb2ludCA9IG5ldyBTbGlkZXJKb2ludChqYywgbWluLCBtYXgpOyBicmVhaztcclxuICAgICAgICBjYXNlIFwiam9pbnRCYWxsXCI6IGpvaW50ID0gbmV3IEJhbGxBbmRTb2NrZXRKb2ludChqYyk7IGJyZWFrO1xyXG4gICAgICAgIGNhc2UgXCJqb2ludFdoZWVsXCI6IGpvaW50ID0gbmV3IFdoZWVsSm9pbnQoamMpO1xyXG4gICAgICAgICAgaWYgKGxpbWl0ICE9PSBudWxsKSBqb2ludC5yb3RhdGlvbmFsTGltaXRNb3RvcjEuc2V0TGltaXQobGltaXRbMF0sIGxpbWl0WzFdKTtcclxuICAgICAgICAgIGlmIChzcHJpbmcgIT09IG51bGwpIGpvaW50LnJvdGF0aW9uYWxMaW1pdE1vdG9yMS5zZXRTcHJpbmcoc3ByaW5nWzBdLCBzcHJpbmdbMV0pO1xyXG4gICAgICAgICAgaWYgKG1vdG9yICE9PSBudWxsKSBqb2ludC5yb3RhdGlvbmFsTGltaXRNb3RvcjEuc2V0TW90b3IobW90b3JbMF0sIG1vdG9yWzFdKTtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBqb2ludC5uYW1lID0gby5uYW1lIHx8ICcnO1xyXG4gICAgICAvLyBmaW5hbHkgYWRkIHRvIHBoeXNpY3Mgd29ybGRcclxuICAgICAgdGhpcy5hZGRKb2ludChqb2ludCk7XHJcblxyXG4gICAgICByZXR1cm4gam9pbnQ7XHJcblxyXG4gICAgfSxcclxuXHJcblxyXG4gIH0pO1xyXG5cclxuICAvLyB0ZXN0IHZlcnNpb25cclxuXHJcbiAgLy9leHBvcnQgeyBSaWdpZEJvZHkgfSBmcm9tICcuL2NvcmUvUmlnaWRCb2R5X1guanMnO1xyXG4gIC8vZXhwb3J0IHsgV29ybGQgfSBmcm9tICcuL2NvcmUvV29ybGRfWC5qcyc7XHJcblxyXG4gIGV4cG9ydHMuTWF0aCA9IF9NYXRoO1xyXG4gIGV4cG9ydHMuVmVjMyA9IFZlYzM7XHJcbiAgZXhwb3J0cy5RdWF0ID0gUXVhdDtcclxuICBleHBvcnRzLk1hdDMzID0gTWF0MzM7XHJcbiAgZXhwb3J0cy5TaGFwZSA9IFNoYXBlO1xyXG4gIGV4cG9ydHMuQm94ID0gQm94O1xyXG4gIGV4cG9ydHMuU3BoZXJlID0gU3BoZXJlO1xyXG4gIGV4cG9ydHMuQ3lsaW5kZXIgPSBDeWxpbmRlcjtcclxuICBleHBvcnRzLlBsYW5lID0gUGxhbmU7XHJcbiAgZXhwb3J0cy5QYXJ0aWNsZSA9IFBhcnRpY2xlO1xyXG4gIGV4cG9ydHMuU2hhcGVDb25maWcgPSBTaGFwZUNvbmZpZztcclxuICBleHBvcnRzLkxpbWl0TW90b3IgPSBMaW1pdE1vdG9yO1xyXG4gIGV4cG9ydHMuSGluZ2VKb2ludCA9IEhpbmdlSm9pbnQ7XHJcbiAgZXhwb3J0cy5CYWxsQW5kU29ja2V0Sm9pbnQgPSBCYWxsQW5kU29ja2V0Sm9pbnQ7XHJcbiAgZXhwb3J0cy5EaXN0YW5jZUpvaW50ID0gRGlzdGFuY2VKb2ludDtcclxuICBleHBvcnRzLlByaXNtYXRpY0pvaW50ID0gUHJpc21hdGljSm9pbnQ7XHJcbiAgZXhwb3J0cy5TbGlkZXJKb2ludCA9IFNsaWRlckpvaW50O1xyXG4gIGV4cG9ydHMuV2hlZWxKb2ludCA9IFdoZWVsSm9pbnQ7XHJcbiAgZXhwb3J0cy5Kb2ludENvbmZpZyA9IEpvaW50Q29uZmlnO1xyXG4gIGV4cG9ydHMuUmlnaWRCb2R5ID0gUmlnaWRCb2R5O1xyXG4gIGV4cG9ydHMuV29ybGQgPSBXb3JsZDtcclxuICBleHBvcnRzLlJFVklTSU9OID0gUkVWSVNJT047XHJcbiAgZXhwb3J0cy5CUl9OVUxMID0gQlJfTlVMTDtcclxuICBleHBvcnRzLkJSX0JSVVRFX0ZPUkNFID0gQlJfQlJVVEVfRk9SQ0U7XHJcbiAgZXhwb3J0cy5CUl9TV0VFUF9BTkRfUFJVTkUgPSBCUl9TV0VFUF9BTkRfUFJVTkU7XHJcbiAgZXhwb3J0cy5CUl9CT1VORElOR19WT0xVTUVfVFJFRSA9IEJSX0JPVU5ESU5HX1ZPTFVNRV9UUkVFO1xyXG4gIGV4cG9ydHMuQk9EWV9OVUxMID0gQk9EWV9OVUxMO1xyXG4gIGV4cG9ydHMuQk9EWV9EWU5BTUlDID0gQk9EWV9EWU5BTUlDO1xyXG4gIGV4cG9ydHMuQk9EWV9TVEFUSUMgPSBCT0RZX1NUQVRJQztcclxuICBleHBvcnRzLkJPRFlfS0lORU1BVElDID0gQk9EWV9LSU5FTUFUSUM7XHJcbiAgZXhwb3J0cy5CT0RZX0dIT1NUID0gQk9EWV9HSE9TVDtcclxuICBleHBvcnRzLlNIQVBFX05VTEwgPSBTSEFQRV9OVUxMO1xyXG4gIGV4cG9ydHMuU0hBUEVfU1BIRVJFID0gU0hBUEVfU1BIRVJFO1xyXG4gIGV4cG9ydHMuU0hBUEVfQk9YID0gU0hBUEVfQk9YO1xyXG4gIGV4cG9ydHMuU0hBUEVfQ1lMSU5ERVIgPSBTSEFQRV9DWUxJTkRFUjtcclxuICBleHBvcnRzLlNIQVBFX1BMQU5FID0gU0hBUEVfUExBTkU7XHJcbiAgZXhwb3J0cy5TSEFQRV9QQVJUSUNMRSA9IFNIQVBFX1BBUlRJQ0xFO1xyXG4gIGV4cG9ydHMuU0hBUEVfVEVUUkEgPSBTSEFQRV9URVRSQTtcclxuICBleHBvcnRzLkpPSU5UX05VTEwgPSBKT0lOVF9OVUxMO1xyXG4gIGV4cG9ydHMuSk9JTlRfRElTVEFOQ0UgPSBKT0lOVF9ESVNUQU5DRTtcclxuICBleHBvcnRzLkpPSU5UX0JBTExfQU5EX1NPQ0tFVCA9IEpPSU5UX0JBTExfQU5EX1NPQ0tFVDtcclxuICBleHBvcnRzLkpPSU5UX0hJTkdFID0gSk9JTlRfSElOR0U7XHJcbiAgZXhwb3J0cy5KT0lOVF9XSEVFTCA9IEpPSU5UX1dIRUVMO1xyXG4gIGV4cG9ydHMuSk9JTlRfU0xJREVSID0gSk9JTlRfU0xJREVSO1xyXG4gIGV4cG9ydHMuSk9JTlRfUFJJU01BVElDID0gSk9JTlRfUFJJU01BVElDO1xyXG4gIGV4cG9ydHMuQUFCQl9QUk9YID0gQUFCQl9QUk9YO1xyXG4gIGV4cG9ydHMucHJpbnRFcnJvciA9IHByaW50RXJyb3I7XHJcbiAgZXhwb3J0cy5JbmZvRGlzcGxheSA9IEluZm9EaXNwbGF5O1xyXG5cclxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5cclxufSkpOyIsIi8qIGdsb2JhbCBBRlJBTUUsIFRIUkVFICovXHJcblxyXG5mdW5jdGlvbiBtYWtlUG9vbChDbGFzcykge1xyXG4gIENsYXNzLl9wb29sID0gW11cclxuICBDbGFzcy5faW5Vc2UgPSBbXVxyXG4gIENsYXNzLnRlbXAgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgdiA9IENsYXNzLl9wb29sLnBvcCgpIHx8IG5ldyBDbGFzcygpXHJcbiAgICBDbGFzcy5faW5Vc2UucHVzaCh2KVxyXG4gICAgaWYgKCFDbGFzcy5fZ2MpXHJcbiAgICAgIENsYXNzLl9nYyA9IHNldFRpbWVvdXQoQ2xhc3MuX3JlY3ljbGUpXHJcbiAgICByZXR1cm4gdlxyXG4gIH1cclxuICBDbGFzcy5fcmVjeWNsZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHdoaWxlIChDbGFzcy5faW5Vc2UubGVuZ3RoKVxyXG4gICAgICBDbGFzcy5fcG9vbC5wdXNoKENsYXNzLl9pblVzZS5wb3AoKSlcclxuICAgIENsYXNzLl9nYyA9IGZhbHNlXHJcbiAgfVxyXG59XHJcblxyXG5tYWtlUG9vbChUSFJFRS5WZWN0b3IyKVxyXG5tYWtlUG9vbChUSFJFRS5WZWN0b3IzKVxyXG5tYWtlUG9vbChUSFJFRS5RdWF0ZXJuaW9uKVxyXG5tYWtlUG9vbChUSFJFRS5NYXRyaXgzKVxyXG5tYWtlUG9vbChUSFJFRS5NYXRyaXg0KVxyXG4iLCIvKiBnbG9iYWwgQUZSQU1FLCBUSFJFRSwgT0lNTyAqL1xyXG5cclxuZ2xvYmFsLk9JTU8gPSByZXF1aXJlKFwiLi9saWJzL29pbW9cIilcclxuZ2xvYmFsLndvcmxkID0gbmV3IE9JTU8uV29ybGQoKVxyXG5nbG9iYWwuYm9kaWVzID0gW11cclxuZ2xvYmFsLm1vdmluZ0JvZGllcyA9IFtdXHJcblxyXG5sZXQgdmVjID0gbmV3IE9JTU8uVmVjMygpXHJcbmxldCBxdWF0ID0gbmV3IE9JTU8uUXVhdCgpXHJcblxyXG5mdW5jdGlvbiBpbml0KCkge1xyXG4gIGFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIG9uTWVzc2FnZSlcclxufVxyXG5cclxuZnVuY3Rpb24gb25NZXNzYWdlKGUpIHtcclxuICBpZiAodHlwZW9mIGUuZGF0YSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgbGV0IGNvbW1hbmQgPSBwYXJzZUNvbW1hbmQoZS5kYXRhKVxyXG4gICAgc3dpdGNoIChjb21tYW5kLnNoaWZ0KCkpIHtcclxuICAgICAgY2FzZSBcIndvcmxkXCI6XHJcbiAgICAgICAgd29ybGRDb21tYW5kKGNvbW1hbmQpXHJcbiAgICAgICAgYnJlYWtcclxuICAgIH1cclxuICB9XHJcbiAgZWxzZSBpZiAoZS5kYXRhIGluc3RhbmNlb2YgRmxvYXQ2NEFycmF5KSB7XHJcbiAgICBsZXQgYnVmZmVyID0gZS5kYXRhXHJcbiAgICB3b3JsZC5zdGVwKClcclxuICAgIGZvciAobGV0IG1pZCA9IDA7IG1pZCA8IG1vdmluZ0JvZGllcy5sZW5ndGg7IG1pZCsrKSB7XHJcbiAgICAgIGxldCBib2R5ID0gbW92aW5nQm9kaWVzW21pZF1cclxuICAgICAgaWYgKCFib2R5KSBjb250aW51ZVxyXG4gICAgICBpZiAoYm9keS5pc0tpbmVtYXRpYykge1xyXG4gICAgICAgIHZlYy5zZXQoYnVmZmVyW21pZCAqIDggKyAwXSwgYnVmZmVyW21pZCAqIDggKyAxXSwgYnVmZmVyW21pZCAqIDggKyAyXSlcclxuICAgICAgICBib2R5LnNldFBvc2l0aW9uKHZlYylcclxuICAgICAgICBxdWF0LnNldChidWZmZXJbbWlkICogOCArIDRdLCBidWZmZXJbbWlkICogOCArIDVdLCBidWZmZXJbbWlkICogOCArIDZdLCBidWZmZXJbbWlkICogOCArIDddKVxyXG4gICAgICAgIGJvZHkuc2V0UXVhdGVybmlvbihxdWF0KVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGJ1ZmZlclttaWQgKiA4ICsgMF0gPSBib2R5LnBvc2l0aW9uLnhcclxuICAgICAgICBidWZmZXJbbWlkICogOCArIDFdID0gYm9keS5wb3NpdGlvbi55XHJcbiAgICAgICAgYnVmZmVyW21pZCAqIDggKyAyXSA9IGJvZHkucG9zaXRpb24uelxyXG4gICAgICAgIGJ1ZmZlclttaWQgKiA4ICsgNF0gPSBib2R5LnF1YXRlcm5pb24ueFxyXG4gICAgICAgIGJ1ZmZlclttaWQgKiA4ICsgNV0gPSBib2R5LnF1YXRlcm5pb24ueVxyXG4gICAgICAgIGJ1ZmZlclttaWQgKiA4ICsgNl0gPSBib2R5LnF1YXRlcm5pb24uelxyXG4gICAgICAgIGJ1ZmZlclttaWQgKiA4ICsgN10gPSBib2R5LnF1YXRlcm5pb24ud1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBwb3N0TWVzc2FnZShidWZmZXIsIFtidWZmZXIuYnVmZmVyXSlcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHdvcmxkQ29tbWFuZChwYXJhbXMpIHtcclxuICBpZiAodHlwZW9mIHBhcmFtc1swXSA9PT0gXCJudW1iZXJcIikge1xyXG4gICAgcGFyYW1zLnNoaWZ0KClcclxuICB9XHJcbiAgc3dpdGNoIChwYXJhbXMuc2hpZnQoKSkge1xyXG4gICAgY2FzZSBcImJvZHlcIjpcclxuICAgICAgYm9keUNvbW1hbmQocGFyYW1zKVxyXG4gICAgICBicmVha1xyXG4gICAgY2FzZSBcImdyYXZpdHlcIjpcclxuICAgICAgd29ybGQuZ3Jhdml0eS5jb3B5KHBhcmFtc1swXSlcclxuICAgICAgYnJlYWtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGJvZHlDb21tYW5kKHBhcmFtcykge1xyXG4gIGxldCBpZCA9IHBhcmFtcy5zaGlmdCgpXHJcbiAgbGV0IGJvZHkgPSBib2RpZXNbaWRdXHJcbiAgc3dpdGNoIChwYXJhbXMuc2hpZnQoKSkge1xyXG4gICAgY2FzZSBcImNyZWF0ZVwiOlxyXG4gICAgICBib2RpZXNbaWRdID0gYm9keSA9IHdvcmxkLmFkZChwYXJhbXNbMF0pXHJcbiAgICAgIGJvZHkuX21pZF8gPSBwYXJhbXNbMF0ubWlkXHJcbiAgICAgIGlmIChib2R5Ll9taWRfICE9PSBudWxsKVxyXG4gICAgICAgIG1vdmluZ0JvZGllc1tib2R5Ll9taWRfXSA9IGJvZHlcclxuICAgICAgYnJlYWtcclxuICAgIGNhc2UgXCJyZW1vdmVcIjpcclxuICAgICAgd29ybGQucmVtb3ZlUmlnaWRCb2R5KGJvZHkpXHJcbiAgICAgIGJvZGllc1tpZF0gPSBudWxsXHJcbiAgICAgIGlmIChib2R5Ll9taWRfICE9PSBudWxsKVxyXG4gICAgICAgIG1vdmluZ0JvZGllc1tib2R5Ll9taWRfXSA9IG51bGxcclxuICAgICAgYnJlYWtcclxuICAgIGNhc2UgXCJwb3NpdGlvblwiOlxyXG4gICAgICBib2R5LnBvc2l0aW9uLmNvcHkocGFyYW1zWzBdKVxyXG4gICAgICBicmVha1xyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gcGFyc2VDb21tYW5kKGNtZCkge1xyXG4gIGxldCB3b3JkcyA9IGNtZC5zcGxpdChcIiBcIilcclxuICBsZXQgYXJncyA9IFtdXHJcbiAgZm9yIChsZXQgd29yZCBvZiB3b3Jkcykge1xyXG4gICAgaWYgKHdvcmQpIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBhcmdzLnB1c2goSlNPTi5wYXJzZSh3b3JkKSlcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICBpZiAod29yZCAhPT0gXCI9XCIpXHJcbiAgICAgICAgICBhcmdzLnB1c2god29yZClcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gYXJnc1xyXG59XHJcblxyXG5pbml0KCkiXX0=
